var Goe=Object.defineProperty;var Uoe=(n,e,t)=>e in n?Goe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var k=(n,e,t)=>Uoe(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();var l=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yoe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function R6(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var o=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:function(){return n[i]}})}),t}/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Zj;(function(n){(function(e){var t=typeof l=="object"?l:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),i=o(n);typeof t.Reflect>"u"?t.Reflect=n:i=o(t.Reflect,i),e(i);function o(r,s){return function(a,f){typeof r[a]!="function"&&Object.defineProperty(r,a,{configurable:!0,writable:!0,value:f}),s&&s(a,f)}}})(function(e){var t=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",o=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",r=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",a={__proto__:[]}instanceof Array,f=!s&&!a,h={create:s?function(){return bi(Object.create(null))}:a?function(){return bi({__proto__:null})}:function(){return bi({})},has:f?function(X,ne){return t.call(X,ne)}:function(X,ne){return ne in X},get:f?function(X,ne){return t.call(X,ne)?X[ne]:void 0}:function(X,ne){return X[ne]}},g=Object.getPrototypeOf(Function),y=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",S=!y&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:oi(),P=!y&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:_t(),w=!y&&typeof WeakMap=="function"?WeakMap:Zt(),C=new w;function E(X,ne,fe,ge){if(ae(fe)){if(!yi(X))throw new TypeError;if(!Ze(ne))throw new TypeError;return T(X,ne)}else{if(!yi(X))throw new TypeError;if(!et(ne))throw new TypeError;if(!et(ge)&&!ae(ge)&&!ot(ge))throw new TypeError;return ot(ge)&&(ge=void 0),fe=At(fe),$(X,ne,fe,ge)}}e("decorate",E);function D(X,ne){function fe(ge,Pe){if(!et(ge))throw new TypeError;if(!ae(Pe)&&!ii(Pe))throw new TypeError;Y(X,ne,ge,Pe)}return fe}e("metadata",D);function j(X,ne,fe,ge){if(!et(fe))throw new TypeError;return ae(ge)||(ge=At(ge)),Y(X,ne,fe,ge)}e("defineMetadata",j);function U(X,ne,fe){if(!et(ne))throw new TypeError;return ae(fe)||(fe=At(fe)),K(X,ne,fe)}e("hasMetadata",U);function p(X,ne,fe){if(!et(ne))throw new TypeError;return ae(fe)||(fe=At(fe)),Z(X,ne,fe)}e("hasOwnMetadata",p);function b(X,ne,fe){if(!et(ne))throw new TypeError;return ae(fe)||(fe=At(fe)),H(X,ne,fe)}e("getMetadata",b);function v(X,ne,fe){if(!et(ne))throw new TypeError;return ae(fe)||(fe=At(fe)),M(X,ne,fe)}e("getOwnMetadata",v);function R(X,ne){if(!et(X))throw new TypeError;return ae(ne)||(ne=At(ne)),te(X,ne)}e("getMetadataKeys",R);function O(X,ne){if(!et(X))throw new TypeError;return ae(ne)||(ne=At(ne)),ue(X,ne)}e("getOwnMetadataKeys",O);function N(X,ne,fe){if(!et(ne))throw new TypeError;ae(fe)||(fe=At(fe));var ge=Q(ne,fe,!1);if(ae(ge)||!ge.delete(X))return!1;if(ge.size>0)return!0;var Pe=C.get(ne);return Pe.delete(fe),Pe.size>0||C.delete(ne),!0}e("deleteMetadata",N);function T(X,ne){for(var fe=X.length-1;fe>=0;--fe){var ge=X[fe],Pe=ge(ne);if(!ae(Pe)&&!ot(Pe)){if(!Ze(Pe))throw new TypeError;ne=Pe}}return ne}function $(X,ne,fe,ge){for(var Pe=X.length-1;Pe>=0;--Pe){var Qt=X[Pe],Fe=Qt(ne,fe,ge);if(!ae(Fe)&&!ot(Fe)){if(!et(Fe))throw new TypeError;ge=Fe}}return ge}function Q(X,ne,fe){var ge=C.get(X);if(ae(ge)){if(!fe)return;ge=new S,C.set(X,ge)}var Pe=ge.get(ne);if(ae(Pe)){if(!fe)return;Pe=new S,ge.set(ne,Pe)}return Pe}function K(X,ne,fe){var ge=Z(X,ne,fe);if(ge)return!0;var Pe=gn(ne);return ot(Pe)?!1:K(X,Pe,fe)}function Z(X,ne,fe){var ge=Q(ne,fe,!1);return ae(ge)?!1:Ot(ge.has(X))}function H(X,ne,fe){var ge=Z(X,ne,fe);if(ge)return M(X,ne,fe);var Pe=gn(ne);if(!ot(Pe))return H(X,Pe,fe)}function M(X,ne,fe){var ge=Q(ne,fe,!1);if(!ae(ge))return ge.get(X)}function Y(X,ne,fe,ge){var Pe=Q(fe,ge,!0);Pe.set(X,ne)}function te(X,ne){var fe=ue(X,ne),ge=gn(X);if(ge===null)return fe;var Pe=te(ge,ne);if(Pe.length<=0)return fe;if(fe.length<=0)return Pe;for(var Qt=new P,Fe=[],xe=0,Te=fe;xe<Te.length;xe++){var Qe=Te[xe],Xe=Qt.has(Qe);Xe||(Qt.add(Qe),Fe.push(Qe))}for(var io=0,Xc=Pe;io<Xc.length;io++){var Qe=Xc[io],Xe=Qt.has(Qe);Xe||(Qt.add(Qe),Fe.push(Qe))}return Fe}function ue(X,ne){var fe=[],ge=Q(X,ne,!1);if(ae(ge))return fe;for(var Pe=ge.keys(),Qt=Ne(Pe),Fe=0;;){var xe=xt(Qt);if(!xe)return fe.length=Fe,fe;var Te=en(xe);try{fe[Fe]=Te}catch(Qe){try{Rn(Qt)}finally{throw Qe}}Fe++}}function Re(X){if(X===null)return 1;switch(typeof X){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return X===null?1:6;default:return 6}}function ae(X){return X===void 0}function ot(X){return X===null}function Ft(X){return typeof X=="symbol"}function et(X){return typeof X=="object"?X!==null:typeof X=="function"}function ht(X,ne){switch(Re(X)){case 0:return X;case 1:return X;case 2:return X;case 3:return X;case 4:return X;case 5:return X}var fe="string",ge=he(X,o);if(ge!==void 0){var Pe=ge.call(X,fe);if(et(Pe))throw new TypeError;return Pe}return wt(X)}function wt(X,ne){var fe,ge;{var Pe=X.toString;if(Wt(Pe)){var ge=Pe.call(X);if(!et(ge))return ge}var fe=X.valueOf;if(Wt(fe)){var ge=fe.call(X);if(!et(ge))return ge}}throw new TypeError}function Ot(X){return!!X}function vt(X){return""+X}function At(X){var ne=ht(X);return Ft(ne)?ne:vt(ne)}function yi(X){return Array.isArray?Array.isArray(X):X instanceof Object?X instanceof Array:Object.prototype.toString.call(X)==="[object Array]"}function Wt(X){return typeof X=="function"}function Ze(X){return typeof X=="function"}function ii(X){switch(Re(X)){case 3:return!0;case 4:return!0;default:return!1}}function he(X,ne){var fe=X[ne];if(fe!=null){if(!Wt(fe))throw new TypeError;return fe}}function Ne(X){var ne=he(X,r);if(!Wt(ne))throw new TypeError;var fe=ne.call(X);if(!et(fe))throw new TypeError;return fe}function en(X){return X.value}function xt(X){var ne=X.next();return ne.done?!1:ne}function Rn(X){var ne=X.return;ne&&ne.call(X)}function gn(X){var ne=Object.getPrototypeOf(X);if(typeof X!="function"||X===g||ne!==g)return ne;var fe=X.prototype,ge=fe&&Object.getPrototypeOf(fe);if(ge==null||ge===Object.prototype)return ne;var Pe=ge.constructor;return typeof Pe!="function"||Pe===X?ne:Pe}function oi(){var X={},ne=[],fe=function(){function Fe(xe,Te,Qe){this._index=0,this._keys=xe,this._values=Te,this._selector=Qe}return Fe.prototype["@@iterator"]=function(){return this},Fe.prototype[r]=function(){return this},Fe.prototype.next=function(){var xe=this._index;if(xe>=0&&xe<this._keys.length){var Te=this._selector(this._keys[xe],this._values[xe]);return xe+1>=this._keys.length?(this._index=-1,this._keys=ne,this._values=ne):this._index++,{value:Te,done:!1}}return{value:void 0,done:!0}},Fe.prototype.throw=function(xe){throw this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),xe},Fe.prototype.return=function(xe){return this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),{value:xe,done:!0}},Fe}();return function(){function Fe(){this._keys=[],this._values=[],this._cacheKey=X,this._cacheIndex=-2}return Object.defineProperty(Fe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Fe.prototype.has=function(xe){return this._find(xe,!1)>=0},Fe.prototype.get=function(xe){var Te=this._find(xe,!1);return Te>=0?this._values[Te]:void 0},Fe.prototype.set=function(xe,Te){var Qe=this._find(xe,!0);return this._values[Qe]=Te,this},Fe.prototype.delete=function(xe){var Te=this._find(xe,!1);if(Te>=0){for(var Qe=this._keys.length,Xe=Te+1;Xe<Qe;Xe++)this._keys[Xe-1]=this._keys[Xe],this._values[Xe-1]=this._values[Xe];return this._keys.length--,this._values.length--,xe===this._cacheKey&&(this._cacheKey=X,this._cacheIndex=-2),!0}return!1},Fe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=X,this._cacheIndex=-2},Fe.prototype.keys=function(){return new fe(this._keys,this._values,ge)},Fe.prototype.values=function(){return new fe(this._keys,this._values,Pe)},Fe.prototype.entries=function(){return new fe(this._keys,this._values,Qt)},Fe.prototype["@@iterator"]=function(){return this.entries()},Fe.prototype[r]=function(){return this.entries()},Fe.prototype._find=function(xe,Te){return this._cacheKey!==xe&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=xe)),this._cacheIndex<0&&Te&&(this._cacheIndex=this._keys.length,this._keys.push(xe),this._values.push(void 0)),this._cacheIndex},Fe}();function ge(Fe,xe){return Fe}function Pe(Fe,xe){return xe}function Qt(Fe,xe){return[Fe,xe]}}function _t(){return function(){function X(){this._map=new S}return Object.defineProperty(X.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),X.prototype.has=function(ne){return this._map.has(ne)},X.prototype.add=function(ne){return this._map.set(ne,ne),this},X.prototype.delete=function(ne){return this._map.delete(ne)},X.prototype.clear=function(){this._map.clear()},X.prototype.keys=function(){return this._map.keys()},X.prototype.values=function(){return this._map.values()},X.prototype.entries=function(){return this._map.entries()},X.prototype["@@iterator"]=function(){return this.keys()},X.prototype[r]=function(){return this.keys()},X}()}function Zt(){var X=16,ne=h.create(),fe=ge();return function(){function Te(){this._key=ge()}return Te.prototype.has=function(Qe){var Xe=Pe(Qe,!1);return Xe!==void 0?h.has(Xe,this._key):!1},Te.prototype.get=function(Qe){var Xe=Pe(Qe,!1);return Xe!==void 0?h.get(Xe,this._key):void 0},Te.prototype.set=function(Qe,Xe){var io=Pe(Qe,!0);return io[this._key]=Xe,this},Te.prototype.delete=function(Qe){var Xe=Pe(Qe,!1);return Xe!==void 0?delete Xe[this._key]:!1},Te.prototype.clear=function(){this._key=ge()},Te}();function ge(){var Te;do Te="@@WeakMap@@"+xe();while(h.has(ne,Te));return ne[Te]=!0,Te}function Pe(Te,Qe){if(!t.call(Te,fe)){if(!Qe)return;Object.defineProperty(Te,fe,{value:h.create()})}return Te[fe]}function Qt(Te,Qe){for(var Xe=0;Xe<Qe;++Xe)Te[Xe]=Math.random()*255|0;return Te}function Fe(Te){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(Te)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(Te)):Qt(new Uint8Array(Te),Te):Qt(new Array(Te),Te)}function xe(){var Te=Fe(X);Te[6]=Te[6]&79|64,Te[8]=Te[8]&191|128;for(var Qe="",Xe=0;Xe<X;++Xe){var io=Te[Xe];(Xe===4||Xe===6||Xe===8)&&(Qe+="-"),io<16&&(Qe+="0"),Qe+=io.toString(16).toLowerCase()}return Qe}}function bi(X){return X.__=void 0,delete X.__,X}})})(Zj||(Zj={}));var m={},Pt={},z={},Xd={},vo="named",Qw="name",l0="unmanaged",Xw="optional",f0="inject",xl="multi_inject",M6="inversify:tagged",I6="inversify:tagged_props",B3="inversify:paramtypes",vz="design:paramtypes",$3="post_construct",O_="pre_destroy";function qoe(){return[f0,xl,Qw,l0,vo,Xw]}var jT=qoe();const Woe=Object.freeze(Object.defineProperty({__proto__:null,DESIGN_PARAM_TYPES:vz,INJECT_TAG:f0,MULTI_INJECT_TAG:xl,NAMED_TAG:vo,NAME_TAG:Qw,NON_CUSTOM_TAG_KEYS:jT,OPTIONAL_TAG:Xw,PARAM_TYPES:B3,POST_CONSTRUCT:$3,PRE_DESTROY:O_,TAGGED:M6,TAGGED_PROP:I6,UNMANAGED_TAG:l0},Symbol.toStringTag,{value:"Module"}));var Cn={Request:"Request",Singleton:"Singleton",Transient:"Transient"},zt={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},eg={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},Zoe=0;function Lu(){return Zoe++}var Qoe=function(){function n(e,t){this.id=Lu(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=zt.Invalid,this.constraint=function(i){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return n.prototype.clone=function(){var e=new n(this.serviceIdentifier,this.scope);return e.activated=e.scope===Cn.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},n}(),Xoe="Cannot apply @injectable decorator multiple times.",_z="Metadata key was used more than once in a parameter:",av="NULL argument",Qj="Key Not Found",Joe="Ambiguous match found for serviceIdentifier:",ere="Could not unbind serviceIdentifier:",tre="No matching bindings found for serviceIdentifier:",yz="Missing required @injectable annotation in:",nre="Missing required @inject or @multiInject annotation in:",ire=function(n){return"@inject called with undefined this could mean that the class "+n+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation."},ore="Circular dependency found:",rre="Invalid binding type:",sre="No snapshot available to restore.",are="Invalid return type in middleware. Middleware must return!",cre="Value provided to function binding must be a function!",dre=function(n){return"You are attempting to construct '"+n+`' in a synchronous way
 but it has asynchronous dependencies.`},ure="The toSelf function can only be applied when a constructor is used as service identifier",bz="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",lre=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return"The number of constructor arguments in the derived class "+(n[0]+" must be >= than the number of constructor arguments of its base class.")},fre="Invalid Container constructor argument. Container options must be an object.",hre='Invalid Container option. Default scope must be a string ("singleton" or "transient").',pre="Invalid Container option. Auto bind injectable must be a boolean",mre="Invalid Container option. Skip base check must be a boolean",gre="Cannot apply @preDestroy decorator multiple times in the same class",vre="Cannot apply @postConstruct decorator multiple times in the same class",_re="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",yre=function(n,e){return"@postConstruct error in class "+n+": "+e},bre=function(n,e){return"@preDestroy error in class "+n+": "+e},BT=function(n,e){return"onDeactivation() error in class "+n+": "+e},Sre=function(n,e){return"It looks like there is a circular dependency in one of the '"+n+"' bindings. Please investigate bindings with "+("service identifier '"+e+"'.")},Ere="Maximum call stack size exceeded",Sz=function(){function n(){}return n.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(B3,e),i=Reflect.getMetadata(M6,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:i||{}}},n.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(I6,e)||[];return t},n}(),t3={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function Ez(n){return n instanceof RangeError||n.message===Ere}var Cre=function(n,e){try{return n()}catch(t){throw Ez(t)&&(t=e()),t}};function kp(n){if(typeof n=="function"){var e=n;return e.name}else{if(typeof n=="symbol")return n.toString();var e=n;return e}}function Xj(n,e,t){var i="",o=t(n,e);return o.length!==0&&(i=`
Registered bindings:`,o.forEach(function(r){var s="Object";r.implementationType!==null&&(s=Jw(r.implementationType)),i=i+`
 `+s,r.constraint.metaData&&(i=i+" - "+r.constraint.metaData)})),i}function Cz(n,e){return n.parentRequest===null?!1:n.parentRequest.serviceIdentifier===e?!0:Cz(n.parentRequest,e)}function Pre(n){function e(i,o){o===void 0&&(o=[]);var r=kp(i.serviceIdentifier);return o.push(r),i.parentRequest!==null?e(i.parentRequest,o):o}var t=e(n);return t.reverse().join(" --> ")}function Pz(n){n.childRequests.forEach(function(e){if(Cz(e,e.serviceIdentifier)){var t=Pre(e);throw new Error(ore+" "+t)}else Pz(e)})}function wre(n,e){if(e.isTagged()||e.isNamed()){var t="",i=e.getNamedTag(),o=e.getCustomTags();return i!==null&&(t+=i.toString()+`
`),o!==null&&o.forEach(function(r){t+=r.toString()+`
`})," "+n+`
 `+n+" - "+t}else return" "+n}function Jw(n){if(n.name)return n.name;var e=n.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}function Are(n){return n.toString().slice(7,-1)}var wz=function(){function n(e){this.id=Lu(),this.container=e}return n.prototype.addPlan=function(e){this.plan=e},n.prototype.setCurrentRequest=function(e){this.currentRequest=e},n}(),ir=function(){function n(e,t){this.key=e,this.value=t}return n.prototype.toString=function(){return this.key===vo?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},n}(),Rre=function(){function n(e,t){this.parentContext=e,this.rootRequest=t}return n}(),$T=function(){function n(e){this._cb=e}return n.prototype.unwrap=function(){return this._cb()},n}(),Mre=function(){function n(e){this.str=e}return n.prototype.startsWith=function(e){return this.str.indexOf(e)===0},n.prototype.endsWith=function(e){var t="",i=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},i)},n.prototype.contains=function(e){return this.str.indexOf(e)!==-1},n.prototype.equals=function(e){return this.str===e},n.prototype.value=function(){return this.str},n}(),eA=function(){function n(e,t,i,o){this.id=Lu(),this.type=e,this.serviceIdentifier=i;var r=typeof t=="symbol"?Are(t):t;this.name=new Mre(r||""),this.identifier=t,this.metadata=new Array;var s=null;typeof o=="string"?s=new ir(vo,o):o instanceof ir&&(s=o),s!==null&&this.metadata.push(s)}return n.prototype.hasTag=function(e){for(var t=0,i=this.metadata;t<i.length;t++){var o=i[t];if(o.key===e)return!0}return!1},n.prototype.isArray=function(){return this.hasTag(xl)},n.prototype.matchesArray=function(e){return this.matchesTag(xl)(e)},n.prototype.isNamed=function(){return this.hasTag(vo)},n.prototype.isTagged=function(){return this.metadata.some(function(e){return jT.every(function(t){return e.key!==t})})},n.prototype.isOptional=function(){return this.matchesTag(Xw)(!0)},n.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===vo})[0]:null},n.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return jT.every(function(t){return e.key!==t})}):null},n.prototype.matchesNamedTag=function(e){return this.matchesTag(vo)(e)},n.prototype.matchesTag=function(e){var t=this;return function(i){for(var o=0,r=t.metadata;o<r.length;o++){var s=r[o];if(s.key===e&&s.value===i)return!0}return!1}},n}(),k3=function(n,e,t){if(t||arguments.length===2)for(var i=0,o=e.length,r;i<o;i++)(r||!(i in e))&&(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))};function Ire(n,e){var t=Jw(e);return Az(n,t,e,!1)}function Az(n,e,t,i){var o=n.getConstructorMetadata(t),r=o.compilerGeneratedMetadata;if(r===void 0){var s=yz+" "+e+".";throw new Error(s)}var a=o.userGeneratedMetadata,f=Object.keys(a),h=t.length===0&&f.length>0,g=f.length>t.length,y=h||g?f.length:t.length,S=Tre(i,e,r,a,y),P=Rz(n,t,e),w=k3(k3([],S,!0),P,!0);return w}function Dre(n,e,t,i,o){var r=o[n.toString()]||[],s=Iz(r),a=s.unmanaged!==!0,f=i[n],h=s.inject||s.multiInject;if(f=h||f,f instanceof $T&&(f=f.unwrap()),a){var g=f===Object,y=f===Function,S=f===void 0,P=g||y||S;if(!e&&P){var w=nre+" argument "+n+" in class "+t+".";throw new Error(w)}var C=new eA(eg.ConstructorArgument,s.targetName,f);return C.metadata=r,C}return null}function Tre(n,e,t,i,o){for(var r=[],s=0;s<o;s++){var a=s,f=Dre(a,n,e,t,i);f!==null&&r.push(f)}return r}function Ore(n,e,t,i){var o=n||e;if(o===void 0){var r=yz+" for property "+String(t)+" in class "+i+".";throw new Error(r)}return o}function Rz(n,e,t){for(var i=n.getPropertiesMetadata(e),o=[],r=Object.getOwnPropertySymbols(i),s=Object.keys(i),a=s.concat(r),f=0,h=a;f<h.length;f++){var g=h[f],y=i[g],S=Iz(y),P=S.targetName||g,w=Ore(S.inject,S.multiInject,g,t),C=new eA(eg.ClassProperty,P,w);C.metadata=y,o.push(C)}var E=Object.getPrototypeOf(e.prototype).constructor;if(E!==Object){var D=Rz(n,E,t);o=k3(k3([],o,!0),D,!0)}return o}function Mz(n,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var i=Jw(t),o=Az(n,i,t,!0),r=o.map(function(f){return f.metadata.filter(function(h){return h.key===l0})}),s=[].concat.apply([],r).length,a=o.length-s;return a>0?a:Mz(n,t)}else return 0}function Iz(n){var e={};return n.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[f0],multiInject:e[xl],targetName:e[Qw],unmanaged:e[l0]}}var D6=function(){function n(e,t,i,o,r){this.id=Lu(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=i,this.target=r,this.childRequests=[],this.bindings=Array.isArray(o)?o:[o],this.requestScope=i===null?new Map:null}return n.prototype.addChildRequest=function(e,t,i){var o=new n(e,this.parentContext,this,t,i);return this.childRequests.push(o),o},n}();function F3(n){return n._bindingDictionary}function Lre(n,e,t,i,o,r){var s=n?xl:f0,a=new ir(s,t),f=new eA(e,i,t,a);if(o!==void 0){var h=new ir(o,r);f.metadata.push(h)}return f}function Jj(n,e,t,i,o){var r=L_(t.container,o.serviceIdentifier),s=[];return r.length===t3.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof o.serviceIdentifier=="function"&&n.getConstructorMetadata(o.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(o.serviceIdentifier).toSelf(),r=L_(t.container,o.serviceIdentifier)),e?s=r:s=r.filter(function(a){var f=new D6(a.serviceIdentifier,t,i,a,o);return a.constraint(f)}),Nre(o.serviceIdentifier,s,o,t.container),s}function Nre(n,e,t,i){switch(e.length){case t3.NoBindingsAvailable:if(t.isOptional())return e;var o=kp(n),r=tre;throw r+=wre(o,t),r+=Xj(i,o,L_),new Error(r);case t3.OnlyOneBindingAvailable:return e;case t3.MultipleBindingsAvailable:default:if(t.isArray())return e;var o=kp(n),r=Joe+" "+o;throw r+=Xj(i,o,L_),new Error(r)}}function Dz(n,e,t,i,o,r){var s,a;if(o===null){s=Jj(n,e,i,null,r),a=new D6(t,i,null,s,r);var f=new Rre(i,a);i.addPlan(f)}else s=Jj(n,e,i,o,r),a=o.addChildRequest(r.serviceIdentifier,s,r);s.forEach(function(h){var g=null;if(r.isArray())g=a.addChildRequest(h.serviceIdentifier,h,r);else{if(h.cache)return;g=a}if(h.type===zt.Instance&&h.implementationType!==null){var y=Ire(n,h.implementationType);if(!i.container.options.skipBaseClassChecks){var S=Mz(n,h.implementationType);if(y.length<S){var P=lre(Jw(h.implementationType));throw new Error(P)}}y.forEach(function(w){Dz(n,!1,w.serviceIdentifier,i,g,w)})}})}function L_(n,e){var t=[],i=F3(n);return i.hasKey(e)?t=i.get(e):n.parent!==null&&(t=L_(n.parent,e)),t}function jre(n,e,t,i,o,r,s,a){a===void 0&&(a=!1);var f=new wz(e),h=Lre(t,i,o,"",r,s);try{return Dz(n,a,o,f,null,h),f}catch(g){throw Ez(g)&&Pz(f.plan.rootRequest),g}}function Bre(n,e,t,i){var o=new eA(eg.Variable,"",e,new ir(t,i)),r=new wz(n),s=new D6(e,r,null,[],o);return s}function mo(n){var e=typeof n=="object"&&n!==null||typeof n=="function";return e&&typeof n.then=="function"}function Tz(n){return mo(n)?!0:Array.isArray(n)&&n.some(mo)}var $re=function(n,e,t,i){function o(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function a(g){try{h(i.next(g))}catch(y){s(y)}}function f(g){try{h(i.throw(g))}catch(y){s(y)}}function h(g){g.done?r(g.value):o(g.value).then(a,f)}h((i=i.apply(n,e||[])).next())})},kre=function(n,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,o,r,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(g){return f([h,g])}}function f(h){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(r=h[0]&2?o.return:h[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,h[1])).done)return r;switch(o=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,o=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){t.label=h[1];break}if(h[0]===6&&t.label<r[1]){t.label=r[1],r=h;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(h);break}r[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(g){h=[6,g],o=0}finally{i=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},Fre=function(n,e){return e.scope===Cn.Singleton&&e.activated?e.cache:e.scope===Cn.Request&&n.has(e.id)?n.get(e.id):null},xre=function(n,e,t){e.scope===Cn.Singleton&&Kre(e,t),e.scope===Cn.Request&&Hre(n,e,t)},Hre=function(n,e,t){n.has(e.id)||n.set(e.id,t)},Kre=function(n,e){n.cache=e,n.activated=!0,mo(e)&&Vre(n,e)},Vre=function(n,e){return $re(void 0,void 0,void 0,function(){var t,i;return kre(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e];case 1:return t=o.sent(),n.cache=t,[3,3];case 2:throw i=o.sent(),n.cache=null,n.activated=!1,i;case 3:return[2]}})})},s_;(function(n){n.DynamicValue="toDynamicValue",n.Factory="toFactory",n.Provider="toProvider"})(s_||(s_={}));var zre=function(n){return function(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.forEach(function(o){return n.bind(o).toService(e)})}}},Gre=function(n){var e=null;switch(n.type){case zt.ConstantValue:case zt.Function:e=n.cache;break;case zt.Constructor:case zt.Instance:e=n.implementationType;break;case zt.DynamicValue:e=n.dynamicValue;break;case zt.Provider:e=n.provider;break;case zt.Factory:e=n.factory;break}if(e===null){var t=kp(n.serviceIdentifier);throw new Error(rre+" "+t)}},Ure=function(n){switch(n.type){case zt.Factory:return{factory:n.factory,factoryType:s_.Factory};case zt.Provider:return{factory:n.provider,factoryType:s_.Provider};case zt.DynamicValue:return{factory:n.dynamicValue,factoryType:s_.DynamicValue};default:throw new Error("Unexpected factory type "+n.type)}},Fp=function(){return Fp=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},Fp.apply(this,arguments)},Oz=function(n,e,t,i){function o(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function a(g){try{h(i.next(g))}catch(y){s(y)}}function f(g){try{h(i.throw(g))}catch(y){s(y)}}function h(g){g.done?r(g.value):o(g.value).then(a,f)}h((i=i.apply(n,e||[])).next())})},Lz=function(n,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,o,r,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(g){return f([h,g])}}function f(h){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(r=h[0]&2?o.return:h[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,h[1])).done)return r;switch(o=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,o=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){t.label=h[1];break}if(h[0]===6&&t.label<r[1]){t.label=r[1],r=h;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(h);break}r[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(g){h=[6,g],o=0}finally{i=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},Yre=function(n,e,t){if(t||arguments.length===2)for(var i=0,o=e.length,r;i<o;i++)(r||!(i in e))&&(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))};function qre(n,e){return n.reduce(function(t,i){var o=e(i),r=i.target.type;return r===eg.ConstructorArgument?t.constructorInjections.push(o):(t.propertyRequests.push(i),t.propertyInjections.push(o)),t.isAsync||(t.isAsync=Tz(o)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function Wre(n,e,t){var i;if(e.length>0){var o=qre(e,t),r=Fp(Fp({},o),{constr:n});o.isAsync?i=Zre(r):i=Nz(r)}else i=new n;return i}function Nz(n){var e,t=new((e=n.constr).bind.apply(e,Yre([void 0],n.constructorInjections,!1)));return n.propertyRequests.forEach(function(i,o){var r=i.target.identifier,s=n.propertyInjections[o];(!i.target.isOptional()||s!==void 0)&&(t[r]=s)}),t}function Zre(n){return Oz(this,void 0,void 0,function(){var e,t;return Lz(this,function(i){switch(i.label){case 0:return[4,eB(n.constructorInjections)];case 1:return e=i.sent(),[4,eB(n.propertyInjections)];case 2:return t=i.sent(),[2,Nz(Fp(Fp({},n),{constructorInjections:e,propertyInjections:t}))]}})})}function eB(n){return Oz(this,void 0,void 0,function(){var e,t,i,o;return Lz(this,function(r){for(e=[],t=0,i=n;t<i.length;t++)o=i[t],Array.isArray(o)?e.push(Promise.all(o)):e.push(o);return[2,Promise.all(e)]})})}function tB(n,e){var t=Qre(n,e);return mo(t)?t.then(function(){return e}):e}function Qre(n,e){var t,i;if(Reflect.hasMetadata($3,n)){var o=Reflect.getMetadata($3,n);try{return(i=(t=e)[o.value])===null||i===void 0?void 0:i.call(t)}catch(r){if(r instanceof Error)throw new Error(yre(n.name,r.message))}}}function Xre(n,e){n.scope!==Cn.Singleton&&Jre(n,e)}function Jre(n,e){var t="Class cannot be instantiated in "+(n.scope===Cn.Request?"request":"transient")+" scope.";if(typeof n.onDeactivation=="function")throw new Error(BT(e.name,t));if(Reflect.hasMetadata(O_,e))throw new Error(bre(e.name,t))}function ese(n,e,t,i){Xre(n,e);var o=Wre(e,t,i);return mo(o)?o.then(function(r){return tB(e,r)}):tB(e,o)}var tse=function(n,e,t,i){function o(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function a(g){try{h(i.next(g))}catch(y){s(y)}}function f(g){try{h(i.throw(g))}catch(y){s(y)}}function h(g){g.done?r(g.value):o(g.value).then(a,f)}h((i=i.apply(n,e||[])).next())})},nse=function(n,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,o,r,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(g){return f([h,g])}}function f(h){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(r=h[0]&2?o.return:h[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,h[1])).done)return r;switch(o=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,o=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){t.label=h[1];break}if(h[0]===6&&t.label<r[1]){t.label=r[1],r=h;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(h);break}r[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(g){h=[6,g],o=0}finally{i=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},T6=function(n){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,i=e.childRequests,o=e.target&&e.target.isArray(),r=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(o&&r)return i.map(function(a){var f=T6(n);return f(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return sse(n,e,s)}},ise=function(n,e){var t=Ure(n);return Cre(function(){return t.factory.bind(n)(e)},function(){return new Error(Sre(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},ose=function(n,e,t){var i,o=e.childRequests;switch(Gre(t),t.type){case zt.ConstantValue:case zt.Function:i=t.cache;break;case zt.Constructor:i=t.implementationType;break;case zt.Instance:i=ese(t,t.implementationType,o,T6(n));break;default:i=ise(t,e.parentContext)}return i},rse=function(n,e,t){var i=Fre(n,e);return i!==null||(i=t(),xre(n,e,i)),i},sse=function(n,e,t){return rse(n,t,function(){var i=ose(n,e,t);return mo(i)?i=i.then(function(o){return nB(e,t,o)}):i=nB(e,t,i),i})};function nB(n,e,t){var i=ase(n.parentContext,e,t),o=use(n.parentContext.container),r,s=o.next();do{r=s.value;var a=n.parentContext,f=n.serviceIdentifier,h=dse(r,f);mo(i)?i=jz(h,a,i):i=cse(h,a,i),s=o.next()}while(s.done!==!0&&!F3(r).hasKey(n.serviceIdentifier));return i}var ase=function(n,e,t){var i;return typeof e.onActivation=="function"?i=e.onActivation(n,t):i=t,i},cse=function(n,e,t){for(var i=n.next();!i.done;){if(t=i.value(e,t),mo(t))return jz(n,e,t);i=n.next()}return t},jz=function(n,e,t){return tse(void 0,void 0,void 0,function(){var i,o;return nse(this,function(r){switch(r.label){case 0:return[4,t];case 1:i=r.sent(),o=n.next(),r.label=2;case 2:return o.done?[3,4]:[4,o.value(e,i)];case 3:return i=r.sent(),o=n.next(),[3,2];case 4:return[2,i]}})})},dse=function(n,e){var t=n._activations;return t.hasKey(e)?t.get(e).values():[].values()},use=function(n){for(var e=[n],t=n.parent;t!==null;)e.push(t),t=t.parent;var i=function(){var r=e.pop();return r!==void 0?{done:!1,value:r}:{done:!0,value:void 0}},o={next:i};return o};function lse(n){var e=T6(n.plan.rootRequest.requestScope);return e(n.plan.rootRequest)}var ks=function(n,e){var t=n.parentRequest;return t!==null?e(t)?!0:ks(t,e):!1},mp=function(n){return function(e){var t=function(i){return i!==null&&i.target!==null&&i.target.matchesTag(n)(e)};return t.metaData=new ir(n,e),t}},Vv=mp(vo),n3=function(n){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof n=="string"){var i=t.serviceIdentifier;return i===n}else{var o=e.bindings[0].implementationType;return n===o}return!1}},x3=function(){function n(e){this._binding=e}return n.prototype.when=function(e){return this._binding.constraint=e,new li(this._binding)},n.prototype.whenTargetNamed=function(e){return this._binding.constraint=Vv(e),new li(this._binding)},n.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return!1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new li(this._binding)},n.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=mp(e)(t),new li(this._binding)},n.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&n3(e)(t.parentRequest)},new li(this._binding)},n.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&Vv(e)(t.parentRequest)},new li(this._binding)},n.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(i){return i!==null&&mp(e)(t)(i.parentRequest)},new li(this._binding)},n.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&ks(t,n3(e))},new li(this._binding)},n.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!ks(t,n3(e))},new li(this._binding)},n.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&ks(t,Vv(e))},new li(this._binding)},n.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!ks(t,Vv(e))},new li(this._binding)},n.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(i){return i!==null&&ks(i,mp(e)(t))},new li(this._binding)},n.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(i){return i!==null&&!ks(i,mp(e)(t))},new li(this._binding)},n.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&ks(t,e)},new li(this._binding)},n.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!ks(t,e)},new li(this._binding)},n}(),li=function(){function n(e){this._binding=e}return n.prototype.onActivation=function(e){return this._binding.onActivation=e,new x3(this._binding)},n.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new x3(this._binding)},n}(),Qa=function(){function n(e){this._binding=e,this._bindingWhenSyntax=new x3(this._binding),this._bindingOnSyntax=new li(this._binding)}return n.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},n.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},n.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},n.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},n.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},n.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},n.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},n.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},n.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},n.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},n.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},n.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},n.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},n.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},n.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},n.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},n.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},n}(),fse=function(){function n(e){this._binding=e}return n.prototype.inRequestScope=function(){return this._binding.scope=Cn.Request,new Qa(this._binding)},n.prototype.inSingletonScope=function(){return this._binding.scope=Cn.Singleton,new Qa(this._binding)},n.prototype.inTransientScope=function(){return this._binding.scope=Cn.Transient,new Qa(this._binding)},n}(),iB=function(){function n(e){this._binding=e,this._bindingWhenSyntax=new x3(this._binding),this._bindingOnSyntax=new li(this._binding),this._bindingInSyntax=new fse(e)}return n.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},n.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},n.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},n.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},n.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},n.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},n.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},n.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},n.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},n.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},n.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},n.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},n.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},n.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},n.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},n.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},n.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},n.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},n.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},n.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},n}(),hse=function(){function n(e){this._binding=e}return n.prototype.to=function(e){return this._binding.type=zt.Instance,this._binding.implementationType=e,new iB(this._binding)},n.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+ure);var e=this._binding.serviceIdentifier;return this.to(e)},n.prototype.toConstantValue=function(e){return this._binding.type=zt.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Cn.Singleton,new Qa(this._binding)},n.prototype.toDynamicValue=function(e){return this._binding.type=zt.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new iB(this._binding)},n.prototype.toConstructor=function(e){return this._binding.type=zt.Constructor,this._binding.implementationType=e,this._binding.scope=Cn.Singleton,new Qa(this._binding)},n.prototype.toFactory=function(e){return this._binding.type=zt.Factory,this._binding.factory=e,this._binding.scope=Cn.Singleton,new Qa(this._binding)},n.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(cre);var t=this.toConstantValue(e);return this._binding.type=zt.Function,this._binding.scope=Cn.Singleton,t},n.prototype.toAutoFactory=function(e){return this._binding.type=zt.Factory,this._binding.factory=function(t){var i=function(){return t.container.get(e)};return i},this._binding.scope=Cn.Singleton,new Qa(this._binding)},n.prototype.toAutoNamedFactory=function(e){return this._binding.type=zt.Factory,this._binding.factory=function(t){return function(i){return t.container.getNamed(e,i)}},new Qa(this._binding)},n.prototype.toProvider=function(e){return this._binding.type=zt.Provider,this._binding.provider=e,this._binding.scope=Cn.Singleton,new Qa(this._binding)},n.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},n}(),pse=function(){function n(){}return n.of=function(e,t,i,o,r){var s=new n;return s.bindings=e,s.middleware=t,s.deactivations=o,s.activations=i,s.moduleActivationStore=r,s},n}();function mse(n){return typeof n=="object"&&n!==null&&"clone"in n&&typeof n.clone=="function"}var _l=function(){function n(){this._map=new Map}return n.prototype.getMap=function(){return this._map},n.prototype.add=function(e,t){if(e==null)throw new Error(av);if(t==null)throw new Error(av);var i=this._map.get(e);i!==void 0?i.push(t):this._map.set(e,[t])},n.prototype.get=function(e){if(e==null)throw new Error(av);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(Qj)},n.prototype.remove=function(e){if(e==null)throw new Error(av);if(!this._map.delete(e))throw new Error(Qj)},n.prototype.removeIntersection=function(e){var t=this;this.traverse(function(i,o){var r=e.hasKey(i)?e.get(i):void 0;if(r!==void 0){var s=o.filter(function(a){return!r.some(function(f){return a===f})});t._setValue(i,s)}})},n.prototype.removeByCondition=function(e){var t=this,i=[];return this._map.forEach(function(o,r){for(var s=[],a=0,f=o;a<f.length;a++){var h=f[a],g=e(h);g?i.push(h):s.push(h)}t._setValue(r,s)}),i},n.prototype.hasKey=function(e){if(e==null)throw new Error(av);return this._map.has(e)},n.prototype.clone=function(){var e=new n;return this._map.forEach(function(t,i){t.forEach(function(o){return e.add(i,mse(o)?o.clone():o)})}),e},n.prototype.traverse=function(e){this._map.forEach(function(t,i){e(i,t)})},n.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},n}(),gse=function(){function n(){this._map=new Map}return n.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},n.prototype.addDeactivation=function(e,t,i){this._getModuleActivationHandlers(e).onDeactivations.add(t,i)},n.prototype.addActivation=function(e,t,i){this._getModuleActivationHandlers(e).onActivations.add(t,i)},n.prototype.clone=function(){var e=new n;return this._map.forEach(function(t,i){e._map.set(i,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e},n.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},n.prototype._getEmptyHandlersStore=function(){var e={onActivations:new _l,onDeactivations:new _l};return e},n}(),H3=function(){return H3=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},H3.apply(this,arguments)},mr=function(n,e,t,i){function o(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function a(g){try{h(i.next(g))}catch(y){s(y)}}function f(g){try{h(i.throw(g))}catch(y){s(y)}}function h(g){g.done?r(g.value):o(g.value).then(a,f)}h((i=i.apply(n,e||[])).next())})},gr=function(n,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,o,r,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(g){return f([h,g])}}function f(h){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(r=h[0]&2?o.return:h[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,h[1])).done)return r;switch(o=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,o=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){t.label=h[1];break}if(h[0]===6&&t.label<r[1]){t.label=r[1],r=h;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(h);break}r[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(g){h=[6,g],o=0}finally{i=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},vse=function(n,e,t){if(t||arguments.length===2)for(var i=0,o=e.length,r;i<o;i++)(r||!(i in e))&&(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))},Bz=function(){function n(e){var t=e||{};if(typeof t!="object")throw new Error(""+fre);if(t.defaultScope===void 0)t.defaultScope=Cn.Transient;else if(t.defaultScope!==Cn.Singleton&&t.defaultScope!==Cn.Transient&&t.defaultScope!==Cn.Request)throw new Error(""+hre);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+pre);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+mre);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Lu(),this._bindingDictionary=new _l,this._snapshots=[],this._middleware=null,this._activations=new _l,this._deactivations=new _l,this.parent=null,this._metadataReader=new Sz,this._moduleActivationStore=new gse}return n.merge=function(e,t){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var r=new n,s=vse([e,t],i,!0).map(function(h){return F3(h)}),a=F3(r);function f(h,g){h.traverse(function(y,S){S.forEach(function(P){g.add(P.serviceIdentifier,P.clone())})})}return s.forEach(function(h){f(h,a)}),r},n.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=this._getContainerModuleHelpersFactory(),o=0,r=e;o<r.length;o++){var s=r[o],a=i(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},n.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return mr(this,void 0,void 0,function(){var i,o,r,s,a;return gr(this,function(f){switch(f.label){case 0:i=this._getContainerModuleHelpersFactory(),o=0,r=e,f.label=1;case 1:return o<r.length?(s=r[o],a=i(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:f.sent(),f.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},n.prototype.unload=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t.forEach(function(o){var r=e._removeModuleBindings(o.id);e._deactivateSingletons(r),e._removeModuleHandlers(o.id)})},n.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return mr(this,void 0,void 0,function(){var i,o,r,s;return gr(this,function(a){switch(a.label){case 0:i=0,o=e,a.label=1;case 1:return i<o.length?(r=o[i],s=this._removeModuleBindings(r.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(r.id),a.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},n.prototype.bind=function(e){var t=this.options.defaultScope||Cn.Transient,i=new Qoe(e,t);return this._bindingDictionary.add(e,i),new hse(i)},n.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},n.prototype.rebindAsync=function(e){return mr(this,void 0,void 0,function(){return gr(this,function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},n.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},n.prototype.unbindAsync=function(e){return mr(this,void 0,void 0,function(){var t;return gr(this,function(i){switch(i.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:i.sent(),i.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},n.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,i){e._deactivateSingletons(i)}),this._bindingDictionary=new _l},n.prototype.unbindAllAsync=function(){return mr(this,void 0,void 0,function(){var e,t=this;return gr(this,function(i){switch(i.label){case 0:return e=[],this._bindingDictionary.traverse(function(o,r){e.push(t._deactivateSingletonsAsync(r))}),[4,Promise.all(e)];case 1:return i.sent(),this._bindingDictionary=new _l,[2]}})})},n.prototype.onActivation=function(e,t){this._activations.add(e,t)},n.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},n.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},n.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},n.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,vo,t)},n.prototype.isBoundTagged=function(e,t,i){var o=!1;if(this._bindingDictionary.hasKey(e)){var r=this._bindingDictionary.get(e),s=Bre(this,e,t,i);o=r.some(function(a){return a.constraint(s)})}return!o&&this.parent&&(o=this.parent.isBoundTagged(e,t,i)),o},n.prototype.snapshot=function(){this._snapshots.push(pse.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},n.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(sre);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},n.prototype.createChild=function(e){var t=new n(e||this.options);return t.parent=this,t},n.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(o,r){return r(o)},i)},n.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},n.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},n.prototype.getAsync=function(e){return mr(this,void 0,void 0,function(){var t;return gr(this,function(i){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},n.prototype.getTagged=function(e,t,i){var o=this._getNotAllArgs(e,!1,t,i);return this._getButThrowIfAsync(o)},n.prototype.getTaggedAsync=function(e,t,i){return mr(this,void 0,void 0,function(){var o;return gr(this,function(r){return o=this._getNotAllArgs(e,!1,t,i),[2,this._get(o)]})})},n.prototype.getNamed=function(e,t){return this.getTagged(e,vo,t)},n.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,vo,t)},n.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},n.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},n.prototype.getAllTagged=function(e,t,i){var o=this._getNotAllArgs(e,!0,t,i);return this._getButThrowIfAsync(o)},n.prototype.getAllTaggedAsync=function(e,t,i){var o=this._getNotAllArgs(e,!0,t,i);return this._getAll(o)},n.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,vo,t)},n.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,vo,t)},n.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var i=this.get(e);return t||this.unbind(e),i},n.prototype._preDestroy=function(e,t){var i,o;if(Reflect.hasMetadata(O_,e)){var r=Reflect.getMetadata(O_,e);return(o=(i=t)[r.value])===null||o===void 0?void 0:o.call(i)}},n.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},n.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},n.prototype._deactivate=function(e,t){var i=this,o=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var r=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(mo(r))return this._handleDeactivationError(r.then(function(){return i._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,o)}),o)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,o);if(mo(s))return this._handleDeactivationError(s,o)}catch(a){if(a instanceof Error)throw new Error(BT(o.name,a.message))}},n.prototype._handleDeactivationError=function(e,t){return mr(this,void 0,void 0,function(){var i;return gr(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e];case 1:return o.sent(),[3,3];case 2:if(i=o.sent(),i instanceof Error)throw new Error(BT(t.name,i.message));return[3,3];case 3:return[2]}})})},n.prototype._deactivateContainer=function(e,t){for(var i=this,o=t.next();o.value;){var r=o.value(e);if(mo(r))return r.then(function(){return i._deactivateContainerAsync(e,t)});o=t.next()}},n.prototype._deactivateContainerAsync=function(e,t){return mr(this,void 0,void 0,function(){var i;return gr(this,function(o){switch(o.label){case 0:i=t.next(),o.label=1;case 1:return i.value?[4,i.value(e)]:[3,3];case 2:return o.sent(),i=t.next(),[3,1];case 3:return[2]}})})},n.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(g,y){g._binding.moduleId=y},i=function(g){return function(y){var S=e.bind(y);return t(S,g),S}},o=function(){return function(g){return e.unbind(g)}},r=function(){return function(g){return e.unbindAsync(g)}},s=function(){return function(g){return e.isBound(g)}},a=function(g){return function(y){var S=e.rebind(y);return t(S,g),S}},f=function(g){return function(y,S){e._moduleActivationStore.addActivation(g,y,S),e.onActivation(y,S)}},h=function(g){return function(y,S){e._moduleActivationStore.addDeactivation(g,y,S),e.onDeactivation(y,S)}};return function(g){return{bindFunction:i(g),isboundFunction:s(),onActivationFunction:f(g),onDeactivationFunction:h(g),rebindFunction:a(g),unbindFunction:o(),unbindAsyncFunction:r()}}},n.prototype._getAll=function(e){return Promise.all(this._get(e))},n.prototype._get=function(e){var t=H3(H3({},e),{contextInterceptor:function(o){return o},targetType:eg.Variable});if(this._middleware){var i=this._middleware(t);if(i==null)throw new Error(are);return i}return this._planAndResolve()(t)},n.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(Tz(t))throw new Error(dre(e.serviceIdentifier));return t},n.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},n.prototype._getNotAllArgs=function(e,t,i,o){var r={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:i,value:o};return r},n.prototype._planAndResolve=function(){var e=this;return function(t){var i=jre(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);i=t.contextInterceptor(i);var o=lse(i);return o}},n.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return mo(e.cache)?e.cache.then(function(i){return t._deactivate(e,i)}):this._deactivate(e,e.cache)},n.prototype._deactivateSingletons=function(e){for(var t=0,i=e;t<i.length;t++){var o=i[t],r=this._deactivateIfSingleton(o);if(mo(r))throw new Error(_re)}},n.prototype._deactivateSingletonsAsync=function(e){return mr(this,void 0,void 0,function(){var t=this;return gr(this,function(i){switch(i.label){case 0:return[4,Promise.all(e.map(function(o){return t._deactivateIfSingleton(o)}))];case 1:return i.sent(),[2]}})})},n.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,i){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,i)},n.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,i){return mr(this,void 0,void 0,function(){return gr(this,function(o){switch(o.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return o.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,i)];case 3:o.sent(),o.label=4;case 4:return[2]}})})},n.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch{throw new Error(ere+" "+kp(e))}},n.prototype._bindingDeactivationAndPreDestroy=function(e,t,i){var o=this;if(typeof e.onDeactivation=="function"){var r=e.onDeactivation(t);if(mo(r))return r.then(function(){return o._preDestroy(i,t)})}return this._preDestroy(i,t)},n.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,i){return mr(this,void 0,void 0,function(){return gr(this,function(o){switch(o.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:o.sent(),o.label=2;case 2:return[4,this._preDestroy(i,t)];case 3:return o.sent(),[2]}})})},n}(),$z=function(){function n(e){this.id=Lu(),this.registry=e}return n}(),_se=function(){function n(e){this.id=Lu(),this.registry=e}return n}();function yse(n){for(var e=new Set,t=0,i=n;t<i.length;t++){var o=i[t];if(e.has(o))return o;e.add(o)}}function bse(n){return n.prototype!==void 0}function Sse(n){if(n!==void 0)throw new Error(bz)}function O6(n,e,t,i){Sse(e),kz(M6,n,t.toString(),i)}function Ese(n,e,t){if(bse(n))throw new Error(bz);kz(I6,n.constructor,e,t)}function Cse(n){var e=[];if(Array.isArray(n)){e=n;var t=yse(e.map(function(i){return i.key}));if(t!==void 0)throw new Error(_z+" "+t.toString())}else e=[n];return e}function kz(n,e,t,i){var o=Cse(i),r={};Reflect.hasOwnMetadata(n,e)&&(r=Reflect.getMetadata(n,e));var s=r[t];if(s===void 0)s=[];else for(var a=function(y){if(o.some(function(S){return S.key===y.key}))throw new Error(_z+" "+y.key.toString())},f=0,h=s;f<h.length;f++){var g=h[f];a(g)}s.push.apply(s,o),r[t]=s,Reflect.defineMetadata(n,r,e)}function h0(n){return function(e,t,i){typeof i=="number"?O6(e,t,i,n):Ese(e,t,n)}}function oB(n,e){Reflect.decorate(n,e)}function Pse(n,e){return function(t,i){e(t,i,n)}}function wse(n,e,t){typeof t=="number"?oB([Pse(t,n)],e):typeof t=="string"?Reflect.decorate([n],e,t):oB([n],e)}function le(){return function(n){if(Reflect.hasOwnMetadata(B3,n))throw new Error(Xoe);var e=Reflect.getMetadata(vz,n)||[];return Reflect.defineMetadata(B3,e,n),n}}function Ase(n,e){return h0(new ir(n,e))}function Rse(n){return h0(new ir(vo,n))}function Fz(n){return function(e){return function(t,i,o){if(e===void 0){var r=typeof t=="function"?t.name:t.constructor.name;throw new Error(ire(r))}return h0(new ir(n,e))(t,i,o)}}}var _e=Fz(f0);function tg(){return h0(new ir(Xw,!0))}function Mse(){return function(n,e,t){var i=new ir(l0,!0);O6(n,e,t,i)}}var L6=Fz(xl);function Ise(n){return function(e,t,i){var o=new ir(Qw,n);O6(e,t,i,o)}}function xz(n,e){return function(){return function(t,i){var o=new ir(n,i);if(Reflect.hasOwnMetadata(n,t.constructor))throw new Error(e);Reflect.defineMetadata(n,o,t.constructor)}}}var p0=xz($3,vre),Dse=xz(O_,gre),kT;kT||(kT={});var Tse=Woe;const Ose=Object.freeze(Object.defineProperty({__proto__:null,AsyncContainerModule:_se,BindingScopeEnum:Cn,BindingTypeEnum:zt,Container:Bz,ContainerModule:$z,LazyServiceIdentifer:$T,LazyServiceIdentifier:$T,METADATA_KEY:Tse,MetadataReader:Sz,TargetTypeEnum:eg,createTaggedDecorator:h0,decorate:wse,getServiceIdentifierAsString:kp,id:Lu,inject:_e,injectable:le,get interfaces(){return kT},multiBindToService:zre,multiInject:L6,named:Rse,namedConstraint:Vv,optional:tg,postConstruct:p0,preDestroy:Dse,tagged:Ase,taggedConstraint:mp,targetName:Ise,traverseAncerstors:ks,typeConstraint:n3,unmanaged:Mse},Symbol.toStringTag,{value:"Module"})),F=R6(Ose);var tA={},Jd={};Object.defineProperty(Jd,"__esModule",{value:!0});Jd.isLabeledAction=Jd.LabeledAction=void 0;let Lse=class{constructor(e,t,i){this.label=e,this.actions=t,this.icon=i}};Jd.LabeledAction=Lse;function Nse(n){return n!==void 0&&n.label!==void 0&&n.actions!==void 0}Jd.isLabeledAction=Nse;var Nu={},se={},Xi={};Object.defineProperty(Xi,"__esModule",{value:!0});var Hz=Xi.safeAssign=Xi.hasOwnProperty=Xi.isObject=void 0;function Kz(n){return typeof n=="object"&&n!==null}Xi.isObject=Kz;function jse(n,e,t){if(!Kz(n))return!1;if(Array.isArray(e))for(const i of e){if(!Object.prototype.hasOwnProperty.call(n,i)||typeof t=="string"&&typeof n[i]!==t)return!1;if(typeof t=="function"&&!t(n[i]))return!1}else{if(!Object.prototype.hasOwnProperty.call(n,e))return!1;if(typeof t=="string")return typeof n[e]===t;if(typeof t=="function")return t(n[e])}return!0}Xi.hasOwnProperty=jse;function Bse(n,e){return Object.assign(n,e)}Hz=Xi.safeAssign=Bse;Object.defineProperty(se,"__esModule",{value:!0});se.ReconnectAction=se.ApplyLabelEditAction=se.DeleteElementAction=se.CreateElementAction=se.HoverFeedbackAction=se.MoveAction=se.RedoAction=se.UndoAction=se.BringToFrontAction=se.ViewportResult=se.GetViewportAction=se.SetViewportAction=se.FitToScreenAction=se.CenterAction=se.LayoutAction=se.OpenAction=se.CollapseExpandAllAction=se.CollapseExpandAction=se.SelectionResult=se.GetSelectionAction=se.SelectAllAction=se.SelectAction=se.LoggingAction=se.ComputedBoundsAction=se.RequestBoundsAction=se.SetBoundsAction=se.SetPopupModelAction=se.RequestPopupModelAction=se.UpdateModelAction=se.SetModelAction=se.RequestModelAction=se.RejectAction=se.isResponseAction=se.setRequestContext=se.generateRequestId=se.isRequestAction=se.isAction=se.isActionMessage=void 0;const nA=Xi;function $se(n){return(0,nA.hasOwnProperty)(n,"action")}se.isActionMessage=$se;function kse(n){return(0,nA.hasOwnProperty)(n,"kind","string")}se.isAction=kse;function Fse(n){return(0,nA.hasOwnProperty)(n,"requestId","string")}se.isRequestAction=Fse;let Vz="",xse=1;function ng(){return`${Vz}_${xse++}`}se.generateRequestId=ng;function Hse(n){Vz=n}se.setRequestContext=Hse;function Kse(n){return(0,nA.hasOwnProperty)(n,"responseId","string")&&n.responseId!==""}se.isResponseAction=Kse;var rB;(function(n){n.KIND="rejectRequest";function e(t){return{kind:n.KIND,message:t.message,detail:t.detail,responseId:t.requestId}}n.create=e})(rB||(se.RejectAction=rB={}));var sB;(function(n){n.KIND="requestModel";function e(t){return{kind:n.KIND,options:t,requestId:ng()}}n.create=e})(sB||(se.RequestModelAction=sB={}));var aB;(function(n){n.KIND="setModel";function e(t,i=""){return{kind:n.KIND,newRoot:t,responseId:i}}n.create=e})(aB||(se.SetModelAction=aB={}));var cB;(function(n){n.KIND="updateModel";function e(t,i={}){return Array.isArray(t)?{kind:n.KIND,matches:t,animate:i.animate,cause:i.cause}:{kind:n.KIND,newRoot:t,animate:i.animate,cause:i.cause}}n.create=e})(cB||(se.UpdateModelAction=cB={}));var dB;(function(n){n.KIND="requestPopupModel";function e(t){return{kind:n.KIND,elementId:t.elementId,bounds:t.bounds,requestId:ng()}}n.create=e})(dB||(se.RequestPopupModelAction=dB={}));var uB;(function(n){n.KIND="setPopupModel";function e(t,i=""){return{kind:n.KIND,newRoot:t,responseId:i}}n.create=e})(uB||(se.SetPopupModelAction=uB={}));var lB;(function(n){n.KIND="setBounds";function e(t){return{kind:n.KIND,bounds:t}}n.create=e})(lB||(se.SetBoundsAction=lB={}));var fB;(function(n){n.KIND="requestBounds";function e(t){return{kind:n.KIND,newRoot:t,requestId:ng()}}n.create=e})(fB||(se.RequestBoundsAction=fB={}));var hB;(function(n){n.KIND="computedBounds";function e(t,i={}){var o;return{kind:n.KIND,bounds:t,revision:i.revision,alignments:i.alignments,responseId:(o=i.requestId)!==null&&o!==void 0?o:""}}n.create=e})(hB||(se.ComputedBoundsAction=hB={}));var pB;(function(n){n.KIND="logging";function e(t){return Object.assign({kind:n.KIND},t)}n.create=e})(pB||(se.LoggingAction=pB={}));var mB;(function(n){n.KIND="elementSelected";function e(t){var i,o;return{kind:n.KIND,selectedElementsIDs:(i=t.selectedElementsIDs)!==null&&i!==void 0?i:[],deselectedElementsIDs:(o=t.deselectedElementsIDs)!==null&&o!==void 0?o:[]}}n.create=e})(mB||(se.SelectAction=mB={}));var gB;(function(n){n.KIND="allSelected";function e(t={}){var i;return{kind:n.KIND,select:(i=t.select)!==null&&i!==void 0?i:!0}}n.create=e})(gB||(se.SelectAllAction=gB={}));var vB;(function(n){n.KIND="getSelection";function e(){return{kind:n.KIND,requestId:ng()}}n.create=e})(vB||(se.GetSelectionAction=vB={}));var _B;(function(n){n.KIND="selectionResult";function e(t,i){return{kind:n.KIND,selectedElementsIDs:t,responseId:i}}n.create=e})(_B||(se.SelectionResult=_B={}));var yB;(function(n){n.KIND="collapseExpand";function e(t){var i,o;return{kind:n.KIND,expandIds:(i=t.expandIds)!==null&&i!==void 0?i:[],collapseIds:(o=t.collapseIds)!==null&&o!==void 0?o:[]}}n.create=e})(yB||(se.CollapseExpandAction=yB={}));var bB;(function(n){n.KIND="collapseExpandAll";function e(t={}){var i;return{kind:n.KIND,expand:(i=t.expand)!==null&&i!==void 0?i:!0}}n.create=e})(bB||(se.CollapseExpandAllAction=bB={}));var SB;(function(n){n.KIND="open";function e(t){return{kind:n.KIND,elementId:t}}n.create=e})(SB||(se.OpenAction=SB={}));var EB;(function(n){n.KIND="layout";function e(t={}){return{kind:n.KIND,layoutType:t.layoutType,elementIds:t.elementIds}}n.create=e})(EB||(se.LayoutAction=EB={}));var CB;(function(n){n.KIND="center";function e(t,i={}){var o,r;return{kind:n.KIND,elementIds:t,animate:(o=i.animate)!==null&&o!==void 0?o:!0,retainZoom:(r=i.retainZoom)!==null&&r!==void 0?r:!1,zoomScale:i.zoomScale}}n.create=e})(CB||(se.CenterAction=CB={}));var PB;(function(n){n.KIND="fit";function e(t,i={}){var o;return{kind:n.KIND,elementIds:t,padding:i.padding,maxZoom:i.maxZoom,animate:(o=i.animate)!==null&&o!==void 0?o:!0}}n.create=e})(PB||(se.FitToScreenAction=PB={}));var wB;(function(n){n.KIND="viewport";function e(t,i,o={}){var r;return{kind:n.KIND,elementId:t,newViewport:i,animate:(r=o.animate)!==null&&r!==void 0?r:!0}}n.create=e})(wB||(se.SetViewportAction=wB={}));var AB;(function(n){n.KIND="getViewport";function e(){return{kind:n.KIND,requestId:ng()}}n.create=e})(AB||(se.GetViewportAction=AB={}));var RB;(function(n){n.KIND="viewportResult";function e(t,i,o){return{kind:n.KIND,viewport:t,canvasBounds:i,responseId:o}}n.create=e})(RB||(se.ViewportResult=RB={}));var MB;(function(n){n.KIND="bringToFront";function e(t){return{kind:n.KIND,elementIDs:t}}n.create=e})(MB||(se.BringToFrontAction=MB={}));var IB;(function(n){n.KIND="undo";function e(){return{kind:n.KIND}}n.create=e})(IB||(se.UndoAction=IB={}));var DB;(function(n){n.KIND="redo";function e(){return{kind:n.KIND}}n.create=e})(DB||(se.RedoAction=DB={}));var TB;(function(n){n.KIND="move";function e(t,i={}){var o,r,s;return{kind:n.KIND,moves:t,animate:(o=i.animate)!==null&&o!==void 0?o:!0,finished:(r=i.finished)!==null&&r!==void 0?r:!1,stoppable:(s=i.stoppable)!==null&&s!==void 0?s:!1}}n.create=e})(TB||(se.MoveAction=TB={}));var OB;(function(n){n.KIND="hoverFeedback";function e(t){return{kind:n.KIND,mouseoverElement:t.mouseoverElement,mouseIsOver:t.mouseIsOver}}n.create=e})(OB||(se.HoverFeedbackAction=OB={}));var LB;(function(n){n.KIND="createElement";function e(t,i){return{kind:n.KIND,elementSchema:t,containerId:i.containerId}}n.create=e})(LB||(se.CreateElementAction=LB={}));var NB;(function(n){n.KIND="delete";function e(t){return{kind:n.KIND,elementIds:t}}n.create=e})(NB||(se.DeleteElementAction=NB={}));var jB;(function(n){n.KIND="applyLabelEdit";function e(t,i){return{kind:n.KIND,labelId:t,text:i}}n.create=e})(jB||(se.ApplyLabelEditAction=jB={}));var BB;(function(n){n.KIND="reconnect";function e(t){return{kind:n.KIND,routableId:t.routableId,newSourceId:t.newSourceId,newTargetId:t.newTargetId}}n.create=e})(BB||(se.ReconnectAction=BB={}));var Cf={};Object.defineProperty(Cf,"__esModule",{value:!0});Cf.Deferred=void 0;class Vse{constructor(){this._state="unresolved",this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),this.promise.then(e=>this._state="resolved",e=>this._state="rejected")}set state(e){this._state==="unresolved"&&(this._state=e)}get state(){return this._state}}Cf.Deferred=Vse;var me={};Object.defineProperty(me,"__esModule",{value:!0});me.TYPES=void 0;me.TYPES={Action:Symbol("Action"),IActionDispatcher:Symbol("IActionDispatcher"),IActionDispatcherProvider:Symbol("IActionDispatcherProvider"),IActionHandlerInitializer:Symbol("IActionHandlerInitializer"),ActionHandlerRegistration:Symbol("ActionHandlerRegistration"),ActionHandlerRegistryProvider:Symbol("ActionHandlerRegistryProvider"),IAnchorComputer:Symbol("IAnchor"),AnimationFrameSyncer:Symbol("AnimationFrameSyncer"),IButtonHandlerRegistration:Symbol("IButtonHandlerRegistration"),ICommandPaletteActionProvider:Symbol("ICommandPaletteActionProvider"),ICommandPaletteActionProviderRegistry:Symbol("ICommandPaletteActionProviderRegistry"),CommandRegistration:Symbol("CommandRegistration"),ICommandStack:Symbol("ICommandStack"),CommandStackOptions:Symbol("CommandStackOptions"),ICommandStackProvider:Symbol("ICommandStackProvider"),IContextMenuItemProvider:Symbol.for("IContextMenuProvider"),IContextMenuProviderRegistry:Symbol.for("IContextMenuProviderRegistry"),IContextMenuService:Symbol.for("IContextMenuService"),IContextMenuServiceProvider:Symbol.for("IContextMenuServiceProvider"),DOMHelper:Symbol("DOMHelper"),IDiagramLocker:Symbol("IDiagramLocker"),IEdgeRouter:Symbol("IEdgeRouter"),IEdgeRoutePostprocessor:Symbol("IEdgeRoutePostprocessor"),IEditLabelValidationDecorator:Symbol("IEditLabelValidationDecorator"),IEditLabelValidator:Symbol("IEditLabelValidator"),HiddenModelViewer:Symbol("HiddenModelViewer"),HiddenVNodePostprocessor:Symbol("HiddenVNodeDecorator"),HoverState:Symbol("HoverState"),KeyListener:Symbol("KeyListener"),LayoutRegistration:Symbol("LayoutRegistration"),LayoutRegistry:Symbol("LayoutRegistry"),Layouter:Symbol("Layouter"),LogLevel:Symbol("LogLevel"),ILogger:Symbol("ILogger"),IModelFactory:Symbol("IModelFactory"),IModelLayoutEngine:Symbol("IModelLayoutEngine"),ModelRendererFactory:Symbol("ModelRendererFactory"),ModelSource:Symbol("ModelSource"),ModelSourceProvider:Symbol("ModelSourceProvider"),ModelViewer:Symbol("ModelViewer"),MouseListener:Symbol("MouseListener"),PatcherProvider:Symbol("PatcherProvider"),IPopupModelProvider:Symbol("IPopupModelProvider"),PopupModelViewer:Symbol("PopupModelViewer"),PopupMouseListener:Symbol("PopupMouseListener"),PopupVNodePostprocessor:Symbol("PopupVNodeDecorator"),SModelElementRegistration:Symbol("SModelElementRegistration"),SModelRegistry:Symbol("SModelRegistry"),ISnapper:Symbol("ISnapper"),SvgExporter:Symbol("SvgExporter"),IUIExtension:Symbol("IUIExtension"),UIExtensionRegistry:Symbol("UIExtensionRegistry"),IVNodePostprocessor:Symbol("IVNodePostprocessor"),ViewRegistration:Symbol("ViewRegistration"),ViewRegistry:Symbol("ViewRegistry"),IViewer:Symbol("IViewer"),ViewerOptions:Symbol("ViewerOptions"),IViewerProvider:Symbol("IViewerProvider")};var $n={},pn={},iA=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(pn,"__esModule",{value:!0});pn.MultiInstanceRegistry=pn.InstanceRegistry=pn.FactoryRegistry=pn.ProviderRegistry=void 0;const oA=F;let FT=class{constructor(){this.elements=new Map}register(e,t){if(e===void 0)throw new Error("Key is undefined");if(this.hasKey(e))throw new Error("Key is already registered: "+e);this.elements.set(e,t)}deregister(e){if(e===void 0)throw new Error("Key is undefined");this.elements.delete(e)}hasKey(e){return this.elements.has(e)}get(e,t){const i=this.elements.get(e);return i?new i(t):this.missing(e,t)}missing(e,t){throw new Error("Unknown registry key: "+e)}};pn.ProviderRegistry=FT;pn.ProviderRegistry=FT=iA([(0,oA.injectable)()],FT);let xT=class{constructor(){this.elements=new Map}register(e,t){if(e===void 0)throw new Error("Key is undefined");if(this.hasKey(e))throw new Error(`Key is already registered: ${e}. Use \`overrideModelElement\` instead.`);this.elements.set(e,t)}override(e,t){if(e===void 0)throw new Error("Key is undefined");if(!this.hasKey(e))throw new Error(`Key is not registered: ${e}. Use \`configureModelElement\` instead.`);this.elements.set(e,t)}deregister(e){if(e===void 0)throw new Error("Key is undefined");this.elements.delete(e)}hasKey(e){return this.elements.has(e)}get(e,t){const i=this.elements.get(e);return i?i(t):this.missing(e,t)}missing(e,t){throw new Error("Unknown registry key: "+e)}};pn.FactoryRegistry=xT;pn.FactoryRegistry=xT=iA([(0,oA.injectable)()],xT);let HT=class{constructor(){this.elements=new Map}register(e,t){if(e===void 0)throw new Error("Key is undefined");if(this.hasKey(e))throw new Error(`Key is already registered: ${e}. Use \`overrideModelElement\` instead.`);this.elements.set(e,t)}override(e,t){if(e===void 0)throw new Error("Key is undefined");if(!this.hasKey(e))throw new Error(`Key is not registered: ${e}. Use \`configureModelElement\` instead.`);this.elements.set(e,t)}deregister(e){if(e===void 0)throw new Error("Key is undefined");this.elements.delete(e)}hasKey(e){return this.elements.has(e)}get(e){const t=this.elements.get(e);return t||this.missing(e)}missing(e){throw new Error("Unknown registry key: "+e)}};pn.InstanceRegistry=HT;pn.InstanceRegistry=HT=iA([(0,oA.injectable)()],HT);let KT=class{constructor(){this.elements=new Map}register(e,t){if(e===void 0)throw new Error("Key is undefined");const i=this.elements.get(e);i!==void 0?i.push(t):this.elements.set(e,[t])}deregisterAll(e){if(e===void 0)throw new Error("Key is undefined");this.elements.delete(e)}get(e){const t=this.elements.get(e);return t!==void 0?t:[]}};pn.MultiInstanceRegistry=KT;pn.MultiInstanceRegistry=KT=iA([(0,oA.injectable)()],KT);var ke={},De={};Object.defineProperty(De,"__esModule",{value:!0});De.almostEquals=De.toRadians=De.toDegrees=De.Bounds=De.isBounds=De.Dimension=De.centerOfLine=De.angleBetweenPoints=De.angleOfPoint=De.Point=void 0;const zse=Xi;var $B;(function(n){n.ORIGIN=Object.freeze({x:0,y:0});function e(S,P){return{x:S.x+P.x,y:S.y+P.y}}n.add=e;function t(S,P){return{x:S.x-P.x,y:S.y-P.y}}n.subtract=t;function i(S,P){return S.x===P.x&&S.y===P.y}n.equals=i;function o(S,P,w){const C=t(P,S),E=r(C),D={x:E.x*w,y:E.y*w};return e(S,D)}n.shiftTowards=o;function r(S){const P=s(S);return P===0||P===1?n.ORIGIN:{x:S.x/P,y:S.y/P}}n.normalize=r;function s(S){return Math.sqrt(Math.pow(S.x,2)+Math.pow(S.y,2))}n.magnitude=s;function a(S,P,w){return{x:(1-w)*S.x+w*P.x,y:(1-w)*S.y+w*P.y}}n.linear=a;function f(S,P){const w=P.x-S.x,C=P.y-S.y;return Math.sqrt(w*w+C*C)}n.euclideanDistance=f;function h(S,P){return Math.abs(P.x-S.x)+Math.abs(P.y-S.y)}n.manhattanDistance=h;function g(S,P){return Math.max(Math.abs(P.x-S.x),Math.abs(P.y-S.y))}n.maxDistance=g;function y(S,P){return S.x*P.x+S.y*P.y}n.dotProduct=y})($B||(De.Point=$B={}));function Gse(n){return Math.atan2(n.y,n.x)}De.angleOfPoint=Gse;function Use(n,e){const t=Math.sqrt((n.x*n.x+n.y*n.y)*(e.x*e.x+e.y*e.y));if(isNaN(t)||t===0)return NaN;const i=n.x*e.x+n.y*e.y;return Math.acos(i/t)}De.angleBetweenPoints=Use;function Yse(n,e){const t={x:n.x>e.x?e.x:n.x,y:n.y>e.y?e.y:n.y,width:Math.abs(e.x-n.x),height:Math.abs(e.y-n.y)};return VT.center(t)}De.centerOfLine=Yse;var a_;(function(n){n.EMPTY=Object.freeze({width:-1,height:-1});function e(t){return t.width>=0&&t.height>=0}n.isValid=e})(a_||(De.Dimension=a_={}));function qse(n){return(0,zse.hasOwnProperty)(n,["x","y","width","height"])}De.isBounds=qse;var VT;(function(n){n.EMPTY=Object.freeze({x:0,y:0,width:-1,height:-1});function e(r,s){if(!a_.isValid(r))return a_.isValid(s)?s:n.EMPTY;if(!a_.isValid(s))return r;const a=Math.min(r.x,s.x),f=Math.min(r.y,s.y),h=Math.max(r.x+(r.width>=0?r.width:0),s.x+(s.width>=0?s.width:0)),g=Math.max(r.y+(r.height>=0?r.height:0),s.y+(s.height>=0?s.height:0));return{x:a,y:f,width:h-a,height:g-f}}n.combine=e;function t(r,s){return{x:r.x+s.x,y:r.y+s.y,width:r.width,height:r.height}}n.translate=t;function i(r){return{x:r.x+(r.width>=0?.5*r.width:0),y:r.y+(r.height>=0?.5*r.height:0)}}n.center=i;function o(r,s){return s.x>=r.x&&s.x<=r.x+r.width&&s.y>=r.y&&s.y<=r.y+r.height}n.includes=o})(VT||(De.Bounds=VT={}));function Wse(n){return n*180/Math.PI}De.toDegrees=Wse;function Zse(n){return n*Math.PI/180}De.toRadians=Zse;function Qse(n,e){return Math.abs(n-e)<.001}De.almostEquals=Qse;var Mo={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.mapIterable=n.filterIterable=n.DONE_RESULT=n.toArray=n.FluentIterableImpl=void 0;class e{constructor(f,h){this.startFn=f,this.nextFn=h}[Symbol.iterator](){const f={state:this.startFn(),next:()=>this.nextFn(f.state),[Symbol.iterator]:()=>f};return f}filter(f){return i(this,f)}map(f){return o(this,f)}forEach(f){const h=this[Symbol.iterator]();let g=0,y;do y=h.next(),y.value!==void 0&&f(y.value,g),g++;while(!y.done)}indexOf(f){const h=this[Symbol.iterator]();let g=0,y;do{if(y=h.next(),y.value===f)return g;g++}while(!y.done);return-1}}n.FluentIterableImpl=e;function t(a){if(a.constructor===Array)return a;const f=[];return a.forEach(h=>f.push(h)),f}n.toArray=t,n.DONE_RESULT=Object.freeze({done:!0,value:void 0});function i(a,f){return new e(()=>r(a),h=>{let g;do g=h.next();while(!g.done&&!f(g.value));return g})}n.filterIterable=i;function o(a,f){return new e(()=>r(a),h=>{const{done:g,value:y}=h.next();return g?n.DONE_RESULT:{done:!1,value:f(y)}})}n.mapIterable=o;function r(a){const f=a[Symbol.iterator];if(typeof f=="function")return f.call(a);const h=a.length;return typeof h=="number"&&h>=0?new s(a):{next:()=>n.DONE_RESULT}}class s{constructor(f){this.array=f,this.index=0}next(){return this.index<this.array.length?{done:!1,value:this.array[this.index++]}:n.DONE_RESULT}[Symbol.iterator](){return this}}})(Mo);Object.defineProperty(ke,"__esModule",{value:!0});ke.ModelIndexImpl=ke.createRandomId=ke.SModelRootImpl=ke.SChildElementImpl=ke.SParentElementImpl=ke.isParent=ke.SModelElementImpl=void 0;const zT=De,Xse=Mo;class zz{get root(){let e=this;for(;e;){if(e instanceof Uz)return e;e instanceof Gz?e=e.parent:e=void 0}throw new Error("Element has no root")}get index(){return this.root.index}hasFeature(e){return this.features!==void 0&&this.features.has(e)}}ke.SModelElementImpl=zz;function Jse(n){const e=n.children;return e!==void 0&&e.constructor===Array}ke.isParent=Jse;class N_ extends zz{constructor(){super(...arguments),this.children=[]}add(e,t){const i=this.children;if(t===void 0)i.push(e);else{if(t<0||t>this.children.length)throw new Error(`Child index ${t} out of bounds (0..${i.length})`);i.splice(t,0,e)}e.parent=this,this.index.add(e)}remove(e){const t=this.children,i=t.indexOf(e);if(i<0)throw new Error(`No such child ${e.id}`);t.splice(i,1),this.index.remove(e)}removeAll(e){const t=this.children;if(e!==void 0){for(let i=t.length-1;i>=0;i--)if(e(t[i])){const o=t.splice(i,1)[0];this.index.remove(o)}}else t.forEach(i=>{this.index.remove(i)}),t.splice(0,t.length)}move(e,t){const i=this.children,o=i.indexOf(e);if(o===-1)throw new Error(`No such child ${e.id}`);if(t<0||t>i.length-1)throw new Error(`Child index ${t} out of bounds (0..${i.length})`);i.splice(o,1),i.splice(t,0,e)}localToParent(e){return(0,zT.isBounds)(e)?e:{x:e.x,y:e.y,width:-1,height:-1}}parentToLocal(e){return(0,zT.isBounds)(e)?e:{x:e.x,y:e.y,width:-1,height:-1}}}ke.SParentElementImpl=N_;class Gz extends N_{}ke.SChildElementImpl=Gz;class Uz extends N_{constructor(e=new qz){super(),this.canvasBounds=zT.Bounds.EMPTY,Object.defineProperty(this,"index",{value:e,writable:!1})}}ke.SModelRootImpl=Uz;const kB="0123456789abcdefghijklmnopqrstuvwxyz";function Yz(n=8){let e="";for(let t=0;t<n;t++)e+=kB.charAt(Math.floor(Math.random()*kB.length));return e}ke.createRandomId=Yz;class qz{constructor(){this.id2element=new Map}add(e){if(e.id){if(this.contains(e))throw new Error("Duplicate ID in model: "+e.id)}else do e.id=Yz();while(this.contains(e));if(this.id2element.set(e.id,e),e instanceof N_)for(const t of e.children)this.add(t)}remove(e){if(this.id2element.delete(e.id),e instanceof N_)for(const t of e.children)this.remove(t)}contains(e){return this.id2element.has(e.id)}getById(e){return this.id2element.get(e)}getAttachedElements(e){return[]}all(){return(0,Xse.mapIterable)(this.id2element,([e,t])=>t)}}ke.ModelIndexImpl=qz;var N6=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Wz=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},FB=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty($n,"__esModule",{value:!0});$n.createFeatureSet=$n.EMPTY_ROOT=$n.SModelFactory=$n.SModelRegistry=void 0;const c_=F,Zz=me,eae=pn,Oh=ke;let K3=class extends eae.FactoryRegistry{constructor(e){super(),e.forEach(t=>{let i=this.getDefaultFeatures(t.constr);if(!i&&t.features&&t.features.enable&&(i=[]),i){const o=Qz(i,t.features);t.isOverride?this.override(t.type,()=>{const r=new t.constr;return r.features=o,r}):this.register(t.type,()=>{const r=new t.constr;return r.features=o,r})}else t.isOverride?this.override(t.type,()=>new t.constr):this.register(t.type,()=>new t.constr)})}getDefaultFeatures(e){let t=e;do{const i=t.DEFAULT_FEATURES;if(i)return i;t=Object.getPrototypeOf(t)}while(t)}};$n.SModelRegistry=K3;$n.SModelRegistry=K3=N6([(0,c_.injectable)(),FB(0,(0,c_.multiInject)(Zz.TYPES.SModelElementRegistration)),FB(0,(0,c_.optional)()),Wz("design:paramtypes",[Array])],K3);let V3=class{createElement(e,t){let i;if(this.registry.hasKey(e.type)){const o=this.registry.get(e.type,void 0);if(!(o instanceof Oh.SChildElementImpl))throw new Error(`Element with type ${e.type} was expected to be an SChildElement.`);i=o}else i=new Oh.SChildElementImpl;return this.initializeChild(i,e,t)}createRoot(e){let t;if(this.registry.hasKey(e.type)){const i=this.registry.get(e.type,void 0);if(!(i instanceof Oh.SModelRootImpl))throw new Error(`Element with type ${e.type} was expected to be an SModelRoot.`);t=i}else t=new Oh.SModelRootImpl;return this.initializeRoot(t,e)}createSchema(e){const t={};for(const i in e)if(!this.isReserved(e,i)){const o=e[i];typeof o!="function"&&(t[i]=o)}return e instanceof Oh.SParentElementImpl&&(t.children=e.children.map(i=>this.createSchema(i))),t}initializeElement(e,t){for(const i in t)if(!this.isReserved(e,i)){const o=t[i];typeof o!="function"&&(e[i]=o)}return e}isReserved(e,t){if(["children","parent","index"].indexOf(t)>=0)return!0;let i=e;do{const o=Object.getOwnPropertyDescriptor(i,t);if(o!==void 0)return o.get!==void 0;i=Object.getPrototypeOf(i)}while(i);return!1}initializeParent(e,t){return this.initializeElement(e,t),(0,Oh.isParent)(t)&&(e.children=t.children.map(i=>this.createElement(i,e))),e}initializeChild(e,t,i){return this.initializeParent(e,t),i!==void 0&&(e.parent=i),e}initializeRoot(e,t){return this.initializeParent(e,t),e.index.add(e),e}};$n.SModelFactory=V3;N6([(0,c_.inject)(Zz.TYPES.SModelRegistry),Wz("design:type",K3)],V3.prototype,"registry",void 0);$n.SModelFactory=V3=N6([(0,c_.injectable)()],V3);$n.EMPTY_ROOT=Object.freeze({type:"NONE",id:"EMPTY"});function Qz(n,e){const t=new Set(n);if(e&&e.enable)for(const i of e.enable)t.add(i);if(e&&e.disable)for(const i of e.disable)t.delete(i);return t}$n.createFeatureSet=Qz;var Pa={},tae=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Pa,"__esModule",{value:!0});Pa.AnimationFrameSyncer=void 0;const nae=F;let GT=class{constructor(){this.tasks=[],this.endTasks=[],this.triggered=!1}isAvailable(){return typeof requestAnimationFrame=="function"}onNextFrame(e){this.tasks.push(e),this.trigger()}onEndOfNextFrame(e){this.endTasks.push(e),this.trigger()}trigger(){this.triggered||(this.triggered=!0,this.isAvailable()?requestAnimationFrame(e=>this.run(e)):setTimeout(e=>this.run(e)))}run(e){const t=this.tasks,i=this.endTasks;this.triggered=!1,this.tasks=[],this.endTasks=[],t.forEach(o=>o.call(void 0,e)),i.forEach(o=>o.call(void 0,e))}};Pa.AnimationFrameSyncer=GT;Pa.AnimationFrameSyncer=GT=tae([(0,nae.injectable)()],GT);var ig=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},m0=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Nu,"__esModule",{value:!0});Nu.ActionDispatcher=void 0;const og=F,vd=se,iae=Cf,g0=me,oae=$n,rae=Pa;(0,vd.setRequestContext)("client");let eu=class{constructor(){this.postponedActions=[],this.requests=new Map}initialize(){return this.initialized||(this.initialized=this.actionHandlerRegistryProvider().then(e=>{this.actionHandlerRegistry=e,this.handleAction(vd.SetModelAction.create(oae.EMPTY_ROOT)).catch(()=>{})})),this.initialized}dispatch(e){return this.initialize().then(()=>{if(this.blockUntil!==void 0)return this.handleBlocked(e,this.blockUntil);if(this.diagramLocker.isAllowed(e))return this.handleAction(e)})}dispatchAll(e){return Promise.all(e.map(t=>this.dispatch(t)))}request(e){if(!e.requestId)return Promise.reject(new Error("Request without requestId"));const t=new iae.Deferred;return this.requests.set(e.requestId,t),this.dispatch(e).catch(()=>{}),t.promise}handleAction(e){if(e.kind===vd.UndoAction.KIND)return this.commandStack.undo().then(()=>{});if(e.kind===vd.RedoAction.KIND)return this.commandStack.redo().then(()=>{});if((0,vd.isResponseAction)(e)){const o=this.requests.get(e.responseId);if(o!==void 0){if(this.requests.delete(e.responseId),e.kind===vd.RejectAction.KIND){const r=e;o.reject(new Error(r.message)),this.logger.warn(this,`Request with id ${e.responseId} failed.`,r.message,r.detail)}else o.resolve(e);return Promise.resolve()}this.logger.log(this,"No matching request for response",e)}const t=this.actionHandlerRegistry.get(e.kind);if(t.length===0){this.logger.warn(this,"Missing handler for action",e);const o=new Error(`Missing handler for action '${e.kind}'`);if((0,vd.isRequestAction)(e)){const r=this.requests.get(e.requestId);r!==void 0&&(this.requests.delete(e.requestId),r.reject(o))}return Promise.reject(o)}this.logger.log(this,"Handle",e);const i=[];for(const o of t){const r=o.handle(e);(0,vd.isAction)(r)?i.push(this.dispatch(r)):r!==void 0&&(i.push(this.commandStack.execute(r)),this.blockUntil=r.blockUntil)}return Promise.all(i)}handleBlocked(e,t){if(t(e)){this.blockUntil=void 0;const i=this.handleAction(e),o=this.postponedActions;this.postponedActions=[];for(const r of o)this.dispatch(r.action).then(r.resolve,r.reject);return i}else return this.logger.log(this,"Action is postponed due to block condition",e),new Promise((i,o)=>{this.postponedActions.push({action:e,resolve:i,reject:o})})}};Nu.ActionDispatcher=eu;ig([(0,og.inject)(g0.TYPES.ActionHandlerRegistryProvider),m0("design:type",Function)],eu.prototype,"actionHandlerRegistryProvider",void 0);ig([(0,og.inject)(g0.TYPES.ICommandStack),m0("design:type",Object)],eu.prototype,"commandStack",void 0);ig([(0,og.inject)(g0.TYPES.ILogger),m0("design:type",Object)],eu.prototype,"logger",void 0);ig([(0,og.inject)(g0.TYPES.AnimationFrameSyncer),m0("design:type",rae.AnimationFrameSyncer)],eu.prototype,"syncer",void 0);ig([(0,og.inject)(g0.TYPES.IDiagramLocker),m0("design:type",Object)],eu.prototype,"diagramLocker",void 0);Nu.ActionDispatcher=eu=ig([(0,og.injectable)()],eu);var qo={},wa={};Object.defineProperty(wa,"__esModule",{value:!0});wa.isInjectable=void 0;function sae(n){return Reflect.getMetadata("inversify:paramtypes",n)!==void 0}wa.isInjectable=sae;var aae=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cae=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},aE=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(qo,"__esModule",{value:!0});qo.onAction=qo.configureActionHandler=qo.ActionHandlerRegistry=void 0;const cv=F,z3=me,dae=pn,uae=wa;let UT=class extends dae.MultiInstanceRegistry{constructor(e,t){super(),e.forEach(i=>this.register(i.actionKind,i.factory())),t.forEach(i=>this.initializeActionHandler(i))}initializeActionHandler(e){e.initialize(this)}};qo.ActionHandlerRegistry=UT;qo.ActionHandlerRegistry=UT=aae([(0,cv.injectable)(),aE(0,(0,cv.multiInject)(z3.TYPES.ActionHandlerRegistration)),aE(0,(0,cv.optional)()),aE(1,(0,cv.multiInject)(z3.TYPES.IActionHandlerInitializer)),aE(1,(0,cv.optional)()),cae("design:paramtypes",[Array,Array])],UT);function lae(n,e,t){if(typeof t=="function"){if(!(0,uae.isInjectable)(t))throw new Error(`Action handlers should be @injectable: ${t.name}`);n.isBound(t)||n.bind(t).toSelf()}n.bind(z3.TYPES.ActionHandlerRegistration).toDynamicValue(i=>({actionKind:e,factory:()=>i.container.get(t)}))}qo.configureActionHandler=lae;function fae(n,e,t){n.bind(z3.TYPES.ActionHandlerRegistration).toConstantValue({actionKind:e,factory:()=>({handle:t})})}qo.onAction=fae;var Pf={},hae=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Pf,"__esModule",{value:!0});Pf.DefaultDiagramLocker=void 0;const pae=F;let YT=class{isAllowed(e){return!0}};Pf.DefaultDiagramLocker=YT;Pf.DefaultDiagramLocker=YT=hae([(0,pae.injectable)()],YT);var Or={},rg={};Object.defineProperty(rg,"__esModule",{value:!0});rg.easeInOut=void 0;function mae(n){return n<.5?n*n*2:1-(1-n)*(1-n)*2}rg.easeInOut=mae;Object.defineProperty(Or,"__esModule",{value:!0});Or.CompoundAnimation=Or.Animation=void 0;const Xz=rg;class Jz{constructor(e,t=Xz.easeInOut){this.context=e,this.ease=t,this.stopped=!1}start(){return this.stopped=!1,new Promise((e,t)=>{let i,o=0;const r=s=>{o++;let a;i===void 0?(i=s,a=0):a=s-i;const f=Math.min(1,a/this.context.duration),h=this.tween(this.ease(f),this.context);this.context.modelChanged.update(h),f===1?(this.context.logger.log(this,o*1e3/this.context.duration+" fps"),e(h)):this.stopped?(this.context.logger.log(this,"Animation stopped at "+f*100+"%"),e(h)):this.context.syncer.onNextFrame(r)};if(this.context.syncer.isAvailable())this.context.syncer.onNextFrame(r);else{const s=this.tween(1,this.context);e(s)}})}stop(){this.stopped=!0}}Or.Animation=Jz;class gae extends Jz{constructor(e,t,i=[],o=Xz.easeInOut){super(t,o),this.model=e,this.context=t,this.components=i,this.ease=o}include(e){return this.components.push(e),this}tween(e,t){for(const i of this.components)i.tween(e,t);return this.model}}Or.CompoundAnimation=gae;var Ve={},kr={},rA={};Object.defineProperty(rA,"__esModule",{value:!0});rA.ServerActionHandlerRegistry=void 0;class vae{constructor(){this.handlers=new Map}getHandler(e){return this.handlers.get(e)}onAction(e,t){this.handlers.has(e)?this.handlers.get(e).push(t):this.handlers.set(e,[t])}removeActionHandler(e,t){const i=this.handlers.get(e);if(i){const o=i.indexOf(t);o>=0&&i.splice(o,1)}}}rA.ServerActionHandlerRegistry=vae;var sA={},jn={};Object.defineProperty(jn,"__esModule",{value:!0});jn.SModelIndex=jn.findElement=jn.getSubType=jn.getBasicType=jn.applyBounds=jn.cloneModel=void 0;function _ae(n){return JSON.parse(JSON.stringify(n))}jn.cloneModel=_ae;function yae(n,e){const t=new tG;t.add(n);for(const i of e.bounds){const o=t.getById(i.elementId);if(o){const r=o;i.newPosition&&(r.position={x:i.newPosition.x,y:i.newPosition.y}),i.newSize&&(r.size={width:i.newSize.width,height:i.newSize.height})}}if(e.alignments)for(const i of e.alignments){const o=t.getById(i.elementId);if(o){const r=o;r.alignment={x:i.newAlignment.x,y:i.newAlignment.y}}}}jn.applyBounds=yae;function bae(n){if(!n.type)return"";const e=n.type.indexOf(":");return e>=0?n.type.substring(0,e):n.type}jn.getBasicType=bae;function Sae(n){if(!n.type)return"";const e=n.type.indexOf(":");return e>=0?n.type.substring(e+1):n.type}jn.getSubType=Sae;function eG(n,e){if(n.id===e)return n;if(n.children)for(const t of n.children){const i=eG(t,e);if(i!==void 0)return i}}jn.findElement=eG;class tG{constructor(){this.id2element=new Map,this.id2parent=new Map}add(e){if(e.id){if(this.contains(e))throw new Error("Duplicate ID in model: "+e.id)}else throw new Error("Model element has no ID.");if(this.id2element.set(e.id,e),Array.isArray(e.children))for(const t of e.children)this.add(t),this.id2parent.set(t.id,e);return this}remove(e){if(this.id2element.delete(e.id),Array.isArray(e.children))for(const t of e.children)this.id2parent.delete(t.id),this.remove(t);return this}contains(e){return this.id2element.has(e.id)}getById(e){return this.id2element.get(e)}getParent(e){return this.id2parent.get(e)}getRoot(e){let t=e;for(;t;){const i=this.id2parent.get(t.id);if(i===void 0)return t;t=i}throw new Error("Element has no root")}}jn.SModelIndex=tG;Object.defineProperty(sA,"__esModule",{value:!0});sA.DiagramServer=void 0;const co=se,Eae=Cf,GI=jn;class Cae{constructor(e,t){this.state={currentRoot:{type:"NONE",id:"ROOT"},revision:0},this.requests=new Map,this.dispatch=e,this.diagramGenerator=t.DiagramGenerator,this.layoutEngine=t.ModelLayoutEngine,this.actionHandlerRegistry=t.ServerActionHandlerRegistry}setModel(e){return e.revision=++this.state.revision,this.state.currentRoot=e,this.submitModel(e,!1)}updateModel(e){return e.revision=++this.state.revision,this.state.currentRoot=e,this.submitModel(e,!0)}get needsClientLayout(){return this.state.options&&this.state.options.needsClientLayout!==void 0?!!this.state.options.needsClientLayout:!0}get needsServerLayout(){return this.state.options&&this.state.options.needsServerLayout!==void 0?!!this.state.options.needsServerLayout:!1}accept(e){if((0,co.isResponseAction)(e)){const t=e.responseId,i=this.requests.get(t);if(i){if(this.requests.delete(t),e.kind===co.RejectAction.KIND){const o=e;i.reject(new Error(o.message)),console.warn(`Request with id ${e.responseId} failed: ${o.message}`,o.detail)}else i.resolve(e);return Promise.resolve()}console.info("No matching request for response:",e)}return this.handleAction(e)}request(e){e.requestId||(e.requestId="server_"+(0,co.generateRequestId)());const t=new Eae.Deferred;return this.requests.set(e.requestId,t),this.dispatch(e).catch(i=>{this.requests.delete(e.requestId),t.reject(i)}),t.promise}rejectRemoteRequest(e,t){e&&(0,co.isRequestAction)(e)&&this.dispatch({kind:co.RejectAction.KIND,responseId:e.requestId,message:t.message,detail:t.stack})}handleAction(e){var t,i;const o=(t=this.actionHandlerRegistry)===null||t===void 0?void 0:t.getHandler(e.kind);if(o&&o.length===1)return(i=o[0](e,this.state,this))!==null&&i!==void 0?i:Promise.resolve();if(o&&o.length>1)return Promise.all(o.map(r=>{var s;return(s=r(e,this.state,this))!==null&&s!==void 0?s:Promise.resolve()}));switch(e.kind){case co.RequestModelAction.KIND:return this.handleRequestModel(e);case co.ComputedBoundsAction.KIND:return this.handleComputedBounds(e);case co.LayoutAction.KIND:return this.handleLayout(e)}return console.warn(`Unhandled action from client: ${e.kind}`),Promise.resolve()}async handleRequestModel(e){var t;this.state.options=e.options;try{const i=await this.diagramGenerator.generate({options:(t=this.state.options)!==null&&t!==void 0?t:{},state:this.state});i.revision=++this.state.revision,this.state.currentRoot=i,await this.submitModel(this.state.currentRoot,!1,e)}catch(i){this.rejectRemoteRequest(e,i),console.error("Failed to generate diagram:",i)}}async submitModel(e,t,i){if(this.needsClientLayout)if(!this.needsServerLayout)this.dispatch({kind:co.RequestBoundsAction.KIND,newRoot:e});else{const o=co.RequestBoundsAction.create(e),r=await this.request(o),s=this.state.currentRoot;r.revision===s.revision?((0,GI.applyBounds)(s,r),await this.doSubmitModel(s,t,i)):this.rejectRemoteRequest(i,new Error(`Model revision does not match: ${r.revision}`))}else await this.doSubmitModel(e,t,i)}async doSubmitModel(e,t,i){if(e.revision!==this.state.revision)return;this.needsServerLayout&&this.layoutEngine&&(e=await this.layoutEngine.layout(e));const o=e.type;if(i&&i.kind===co.RequestModelAction.KIND){const r=i.requestId,s=co.SetModelAction.create(e,r);await this.dispatch(s)}else t&&o===this.state.lastSubmittedModelType?await this.dispatch({kind:co.UpdateModelAction.KIND,newRoot:e,cause:i}):await this.dispatch({kind:co.SetModelAction.KIND,newRoot:e});this.state.lastSubmittedModelType=o}handleComputedBounds(e){return e.revision!==this.state.currentRoot.revision?Promise.reject():((0,GI.applyBounds)(this.state.currentRoot,e),Promise.resolve())}async handleLayout(e){if(this.layoutEngine){if(!this.needsServerLayout){let t=(0,GI.cloneModel)(this.state.currentRoot);t=await this.layoutEngine.layout(t),t.revision=++this.state.revision,this.state.currentRoot=t}await this.doSubmitModel(this.state.currentRoot,!0,e)}}}sA.DiagramServer=Cae;var nG={};Object.defineProperty(nG,"__esModule",{value:!0});var Hl={};Object.defineProperty(Hl,"__esModule",{value:!0});Hl.isZoomable=Hl.isScrollable=void 0;const iG=Xi;function Pae(n){return(0,iG.hasOwnProperty)(n,"scroll")}Hl.isScrollable=Pae;function wae(n){return(0,iG.hasOwnProperty)(n,"zoom")}Hl.isZoomable=wae;var j6={};Object.defineProperty(j6,"__esModule",{value:!0});(function(n){var e=l&&l.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=l&&l.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(rA,n),t(se,n),t(sA,n),t(nG,n),t(Hl,n),t(Cf,n),t(De,n),t(j6,n),t(jn,n),t(Xi,n)})(kr);var sg=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Ve,"__esModule",{value:!0});Ve.ResetCommand=Ve.SystemCommand=Ve.PopupCommand=Ve.HiddenCommand=Ve.MergeableCommand=Ve.Command=Ve.isStoppableCommand=void 0;const ag=F,Aae=kr;function Rae(n){return n&&(0,Aae.hasOwnProperty)(n,"stoppableCommandKey")&&"stopExecution"in n&&typeof n.stopExecution=="function"}Ve.isStoppableCommand=Rae;let tu=class{};Ve.Command=tu;Ve.Command=tu=sg([(0,ag.injectable)()],tu);let qT=class extends tu{merge(e,t){return!1}};Ve.MergeableCommand=qT;Ve.MergeableCommand=qT=sg([(0,ag.injectable)()],qT);let WT=class extends tu{undo(e){return e.logger.error(this,"Cannot undo a hidden command"),e.root}redo(e){return e.logger.error(this,"Cannot redo a hidden command"),e.root}};Ve.HiddenCommand=WT;Ve.HiddenCommand=WT=sg([(0,ag.injectable)()],WT);let ZT=class extends tu{};Ve.PopupCommand=ZT;Ve.PopupCommand=ZT=sg([(0,ag.injectable)()],ZT);let QT=class extends tu{};Ve.SystemCommand=QT;Ve.SystemCommand=QT=sg([(0,ag.injectable)()],QT);let XT=class extends tu{};Ve.ResetCommand=XT;Ve.ResetCommand=XT=sg([(0,ag.injectable)()],XT);var wn={},Mae=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Iae=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},xB=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(wn,"__esModule",{value:!0});wn.configureCommand=wn.CommandActionHandlerInitializer=wn.CommandActionHandler=void 0;const i3=F,Dae=wa,JT=me;class oG{constructor(e){this.commandRegistration=e}handle(e){return this.commandRegistration.factory(e)}}wn.CommandActionHandler=oG;let e2=class{constructor(e){this.registrations=e}initialize(e){this.registrations.forEach(t=>e.register(t.kind,new oG(t)))}};wn.CommandActionHandlerInitializer=e2;wn.CommandActionHandlerInitializer=e2=Mae([(0,i3.injectable)(),xB(0,(0,i3.multiInject)(JT.TYPES.CommandRegistration)),xB(0,(0,i3.optional)()),Iae("design:paramtypes",[Array])],e2);function Tae(n,e){if(!(0,Dae.isInjectable)(e))throw new Error(`Commands should be @injectable: ${e.name}`);n.isBound(e)||n.bind(e).toSelf(),n.bind(JT.TYPES.CommandRegistration).toDynamicValue(t=>({kind:e.KIND,factory:i=>{const o=new i3.Container;return o.parent=t.container,o.bind(JT.TYPES.Action).toConstantValue(i),o.get(e)}}))}wn.configureCommand=Tae;var aA={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.overrideCommandStackOptions=n.configureCommandStackOptions=n.defaultCommandStackOptions=void 0;const e=Xi,t=me,i=()=>({defaultDuration:250,undoHistoryLimit:50});n.defaultCommandStackOptions=i;function o(s,a){const f=Object.assign(Object.assign({},(0,n.defaultCommandStackOptions)()),a);s.isBound(t.TYPES.CommandStackOptions)?s.rebind(t.TYPES.CommandStackOptions).toConstantValue(f):s.bind(t.TYPES.CommandStackOptions).toConstantValue(f)}n.configureCommandStackOptions=o;function r(s,a){const f=s.get(t.TYPES.CommandStackOptions);return(0,e.safeAssign)(f,a),f}n.overrideCommandStackOptions=r})(aA);var wf={},Af=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},kd=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(wf,"__esModule",{value:!0});wf.CommandStack=void 0;const Rf=F,v0=me,UI=$n,Oae=ke,Lae=Pa,ud=Ve;let cc=class{constructor(){this.undoStack=[],this.redoStack=[],this.stoppableCommands=new Map,this.offStack=[]}initialize(){this.currentPromise=Promise.resolve({main:{model:this.modelFactory.createRoot(UI.EMPTY_ROOT),modelChanged:!1},hidden:{model:this.modelFactory.createRoot(UI.EMPTY_ROOT),modelChanged:!1},popup:{model:this.modelFactory.createRoot(UI.EMPTY_ROOT),modelChanged:!1}})}get currentModel(){return this.currentPromise.then(e=>e.main.model)}executeAll(e){return e.forEach(t=>{this.logger.log(this,"Executing",t),this.handleCommand(t,t.execute,this.mergeOrPush)}),this.thenUpdate()}execute(e){return this.logger.log(this,"Executing",e),this.handleCommand(e,e.execute,this.mergeOrPush),this.thenUpdate()}undo(){this.undoOffStackSystemCommands(),this.undoPreceedingSystemCommands();const e=this.undoStack[this.undoStack.length-1];return e!==void 0&&!this.isBlockUndo(e)&&(this.undoStack.pop(),this.logger.log(this,"Undoing",e),this.handleCommand(e,e.undo,(t,i)=>{this.redoStack.push(t)})),this.thenUpdate()}redo(){this.undoOffStackSystemCommands();const e=this.redoStack.pop();return e!==void 0&&(this.logger.log(this,"Redoing",e),this.handleCommand(e,e.redo,(t,i)=>{this.pushToUndoStack(t)})),this.redoFollowingSystemCommands(),this.thenUpdate()}handleCommand(e,t,i){if((0,ud.isStoppableCommand)(e)){const o=this.stoppableCommands.get(e.stoppableCommandKey);o&&o.stopExecution(),this.stoppableCommands.set(e.stoppableCommandKey,e)}this.currentPromise=this.currentPromise.then(o=>new Promise(r=>{let s;e instanceof ud.HiddenCommand?s="hidden":e instanceof ud.PopupCommand?s="popup":s="main";const a=this.createContext(o.main.model);let f;try{f=t.call(e,a)}catch(g){this.logger.error(this,"Failed to execute command:",g),f=o[s].model}const h=HB(o);f instanceof Promise?f.then(g=>{s==="main"&&i.call(this,e,a),h[s]={model:g,modelChanged:!0},r(h)}):f instanceof Oae.SModelRootImpl?(s==="main"&&i.call(this,e,a),h[s]={model:f,modelChanged:!0},r(h)):(s==="main"&&i.call(this,e,a),h[s]={model:f.model,modelChanged:o[s].modelChanged||f.modelChanged,cause:f.cause},r(h))}))}pushToUndoStack(e){this.undoStack.push(e),this.options.undoHistoryLimit>=0&&this.undoStack.length>this.options.undoHistoryLimit&&this.undoStack.splice(0,this.undoStack.length-this.options.undoHistoryLimit)}thenUpdate(){return this.currentPromise=this.currentPromise.then(e=>{const t=HB(e);return e.hidden.modelChanged&&(this.updateHidden(e.hidden.model,e.hidden.cause),t.hidden.modelChanged=!1,t.hidden.cause=void 0),e.main.modelChanged&&(this.update(e.main.model,e.main.cause),t.main.modelChanged=!1,t.main.cause=void 0),e.popup.modelChanged&&(this.updatePopup(e.popup.model,e.popup.cause),t.popup.modelChanged=!1,t.popup.cause=void 0),t}),this.currentModel}update(e,t){this.modelViewer===void 0&&(this.modelViewer=this.viewerProvider.modelViewer),this.modelViewer.update(e,t)}updateHidden(e,t){this.hiddenModelViewer===void 0&&(this.hiddenModelViewer=this.viewerProvider.hiddenModelViewer),this.hiddenModelViewer.update(e,t)}updatePopup(e,t){this.popupModelViewer===void 0&&(this.popupModelViewer=this.viewerProvider.popupModelViewer),this.popupModelViewer.update(e,t)}mergeOrPush(e,t){if(this.isBlockUndo(e)){this.undoStack=[],this.redoStack=[],this.offStack=[],this.pushToUndoStack(e);return}if(this.isPushToOffStack(e)&&this.redoStack.length>0){if(this.offStack.length>0){const i=this.offStack[this.offStack.length-1];if(i instanceof ud.MergeableCommand&&i.merge(e,t))return}this.offStack.push(e);return}if(this.isPushToUndoStack(e)){if(this.offStack.forEach(i=>this.undoStack.push(i)),this.offStack=[],this.redoStack=[],this.undoStack.length>0){const i=this.undoStack[this.undoStack.length-1];if(i instanceof ud.MergeableCommand&&i.merge(e,t))return}this.pushToUndoStack(e)}}undoOffStackSystemCommands(){let e=this.offStack.pop();for(;e!==void 0;)this.logger.log(this,"Undoing off-stack",e),this.handleCommand(e,e.undo,()=>{}),e=this.offStack.pop()}undoPreceedingSystemCommands(){let e=this.undoStack[this.undoStack.length-1];for(;e!==void 0&&this.isPushToOffStack(e);)this.undoStack.pop(),this.logger.log(this,"Undoing",e),this.handleCommand(e,e.undo,(t,i)=>{this.redoStack.push(t)}),e=this.undoStack[this.undoStack.length-1]}redoFollowingSystemCommands(){let e=this.redoStack[this.redoStack.length-1];for(;e!==void 0&&this.isPushToOffStack(e);)this.redoStack.pop(),this.logger.log(this,"Redoing ",e),this.handleCommand(e,e.redo,(t,i)=>{this.pushToUndoStack(t)}),e=this.redoStack[this.redoStack.length-1]}createContext(e){return{root:e,modelChanged:this,modelFactory:this.modelFactory,duration:this.options.defaultDuration,logger:this.logger,syncer:this.syncer}}isPushToOffStack(e){return e instanceof ud.SystemCommand}isPushToUndoStack(e){return!(e instanceof ud.HiddenCommand)}isBlockUndo(e){return e instanceof ud.ResetCommand}};wf.CommandStack=cc;Af([(0,Rf.inject)(v0.TYPES.IModelFactory),kd("design:type",Object)],cc.prototype,"modelFactory",void 0);Af([(0,Rf.inject)(v0.TYPES.IViewerProvider),kd("design:type",Object)],cc.prototype,"viewerProvider",void 0);Af([(0,Rf.inject)(v0.TYPES.ILogger),kd("design:type",Object)],cc.prototype,"logger",void 0);Af([(0,Rf.inject)(v0.TYPES.AnimationFrameSyncer),kd("design:type",Lae.AnimationFrameSyncer)],cc.prototype,"syncer",void 0);Af([(0,Rf.inject)(v0.TYPES.CommandStackOptions),kd("design:type",Object)],cc.prototype,"options",void 0);Af([(0,Rf.postConstruct)(),kd("design:type",Function),kd("design:paramtypes",[]),kd("design:returntype",void 0)],cc.prototype,"initialize",null);wf.CommandStack=cc=Af([(0,Rf.injectable)()],cc);function HB(n){return{main:Object.assign({},n.main),hidden:Object.assign({},n.hidden),popup:Object.assign({},n.popup)}}var Eo={},sn={};Object.defineProperty(sn,"__esModule",{value:!0});sn.isSVGGraphicsElement=sn.hitsMouseEvent=sn.getWindowScroll=sn.isCrossSite=sn.isMac=sn.isCtrlOrCmd=void 0;const Nae=kr;function jae(n){return rG()?n.metaKey:n.ctrlKey}sn.isCtrlOrCmd=jae;function rG(){return window.navigator.userAgent.indexOf("Mac")!==-1}sn.isMac=rG;function Bae(n){if(n&&typeof window<"u"&&window.location){let e="";return window.location.protocol&&(e+=window.location.protocol+"//"),window.location.host&&(e+=window.location.host),e.length>0&&!n.startsWith(e)}return!1}sn.isCrossSite=Bae;function $ae(){return typeof window>"u"?Nae.Point.ORIGIN:{x:window.pageXOffset,y:window.pageYOffset}}sn.getWindowScroll=$ae;function kae(n,e){const t=n.getBoundingClientRect();return e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom}sn.hitsMouseEvent=kae;function Fae(n){return typeof n.getBBox=="function"}sn.isSVGGraphicsElement=Fae;var B6=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},sG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},xae=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Eo,"__esModule",{value:!0});Eo.InitializeCanvasBoundsCommand=Eo.InitializeCanvasBoundsAction=Eo.CanvasBoundsInitializer=void 0;const G3=F,dv=De,aG=me,Hae=ke,Kae=Ve,Vae=sn;let U3=class{decorate(e,t){return t instanceof Hae.SModelRootImpl&&!dv.Dimension.isValid(t.canvasBounds)&&(this.rootAndVnode=[t,e]),e}postUpdate(){if(this.rootAndVnode!==void 0){const e=this.rootAndVnode[1].elm,t=this.rootAndVnode[0].canvasBounds;if(e!==void 0){const i=this.getBoundsInPage(e);(0,dv.almostEquals)(i.x,t.x)&&(0,dv.almostEquals)(i.y,t.y)&&(0,dv.almostEquals)(i.width,t.width)&&(0,dv.almostEquals)(i.height,t.width)||this.actionDispatcher.dispatch(Y3.create(i))}this.rootAndVnode=void 0}}getBoundsInPage(e){const t=e.getBoundingClientRect(),i=(0,Vae.getWindowScroll)();return{x:t.left+i.x,y:t.top+i.y,width:t.width,height:t.height}}};Eo.CanvasBoundsInitializer=U3;B6([(0,G3.inject)(aG.TYPES.IActionDispatcher),sG("design:type",Object)],U3.prototype,"actionDispatcher",void 0);Eo.CanvasBoundsInitializer=U3=B6([(0,G3.injectable)()],U3);var Y3;(function(n){n.KIND="initializeCanvasBounds";function e(t){return{kind:n.KIND,newCanvasBounds:t}}n.create=e})(Y3||(Eo.InitializeCanvasBoundsAction=Y3={}));let q3=class extends Kae.SystemCommand{constructor(e){super(),this.action=e}execute(e){return this.newCanvasBounds=this.action.newCanvasBounds,e.root.canvasBounds=this.newCanvasBounds,e.root}undo(e){return e.root}redo(e){return e.root}};Eo.InitializeCanvasBoundsCommand=q3;q3.KIND=Y3.KIND;Eo.InitializeCanvasBoundsCommand=q3=B6([(0,G3.injectable)(),xae(0,(0,G3.inject)(aG.TYPES.Action)),sG("design:paramtypes",[Object])],q3);var ju={},zae=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Gae=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Uae=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(ju,"__esModule",{value:!0});ju.SetModelCommand=void 0;const KB=F,Yae=se,qae=Ve,Wae=me,Zae=Eo;let W3=class extends qae.ResetCommand{constructor(e){super(),this.action=e}execute(e){return this.oldRoot=e.modelFactory.createRoot(e.root),this.newRoot=e.modelFactory.createRoot(this.action.newRoot),this.newRoot}undo(e){return this.oldRoot}redo(e){return this.newRoot}get blockUntil(){return e=>e.kind===Zae.InitializeCanvasBoundsCommand.KIND}};ju.SetModelCommand=W3;W3.KIND=Yae.SetModelAction.KIND;ju.SetModelCommand=W3=zae([(0,KB.injectable)(),Uae(0,(0,KB.inject)(Wae.TYPES.Action)),Gae("design:paramtypes",[Object])],W3);var yt={};Object.defineProperty(yt,"__esModule",{value:!0});yt.transformToRootBounds=yt.containsSome=yt.translateBounds=yt.translatePoint=yt.findParentByFeature=yt.findParent=yt.registerModelElement=void 0;const Qae=me,j_=ke;function Xae(n,e,t,i,o){n.bind(Qae.TYPES.SModelElementRegistration).toConstantValue({type:e,constr:t,features:i,isOverride:o})}yt.registerModelElement=Xae;function Jae(n,e){let t=n;for(;t!==void 0;){if(e(t))return t;t instanceof j_.SChildElementImpl?t=t.parent:t=void 0}return t}yt.findParent=Jae;function ece(n,e){let t=n;for(;t!==void 0;){if(e(t))return t;t instanceof j_.SChildElementImpl?t=t.parent:t=void 0}return t}yt.findParentByFeature=ece;function t2(n,e,t){if(e!==t){for(;e instanceof j_.SChildElementImpl;)if(n=e.localToParent(n),e=e.parent,e===t)return n;const i=[];for(;t instanceof j_.SChildElementImpl;)i.push(t),t=t.parent;if(e!==t)throw new Error("Incompatible source and target: "+e.id+", "+t.id);for(let o=i.length-1;o>=0;o--)n=i[o].parentToLocal(n)}return n}yt.translatePoint=t2;function tce(n,e,t){const i=t2(n,e,t),o=t2({x:n.x+n.width,y:n.y+n.height},e,t);return{x:i.x,y:i.y,width:o.x-i.x,height:o.y-i.y}}yt.translateBounds=tce;function nce(n,e){const t=o=>n.index.getById(o.id)!==void 0,i=o=>o.some(r=>t(r)||i(r.children));return i([e])}yt.containsSome=nce;function ice(n,e){for(;n instanceof j_.SChildElementImpl;)e=n.localToParent(e),n=n.parent;return e}yt.transformToRootBounds=ice;var Co={},$6=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},k6=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},n2=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Co,"__esModule",{value:!0});Co.SetUIExtensionVisibilityCommand=Co.SetUIExtensionVisibilityAction=Co.UIExtensionRegistry=void 0;const Sp=F,oce=pn,rce=Ve,F6=me;let Z3=class extends oce.InstanceRegistry{constructor(e=[]){super(),e.forEach(t=>this.register(t.id(),t))}};Co.UIExtensionRegistry=Z3;Co.UIExtensionRegistry=Z3=$6([(0,Sp.injectable)(),n2(0,(0,Sp.multiInject)(F6.TYPES.IUIExtension)),n2(0,(0,Sp.optional)()),k6("design:paramtypes",[Array])],Z3);var i2;(function(n){n.KIND="setUIExtensionVisibility";function e(t){var i;return{kind:n.KIND,extensionId:t.extensionId,visible:t.visible,contextElementsId:(i=t.contextElementsId)!==null&&i!==void 0?i:[]}}n.create=e})(i2||(Co.SetUIExtensionVisibilityAction=i2={}));let B_=class extends rce.SystemCommand{constructor(e){super(),this.action=e}execute(e){const t=this.registry.get(this.action.extensionId);return t&&(this.action.visible?t.show(e.root,...this.action.contextElementsId):t.hide()),{model:e.root,modelChanged:!1}}undo(e){return{model:e.root,modelChanged:!1}}redo(e){return{model:e.root,modelChanged:!1}}};Co.SetUIExtensionVisibilityCommand=B_;B_.KIND=i2.KIND;$6([(0,Sp.inject)(F6.TYPES.UIExtensionRegistry),k6("design:type",Z3)],B_.prototype,"registry",void 0);Co.SetUIExtensionVisibilityCommand=B_=$6([(0,Sp.injectable)(),n2(0,(0,Sp.inject)(F6.TYPES.Action)),k6("design:paramtypes",[Object])],B_);var sa={},x6=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(sa,"__esModule",{value:!0});sa.AbstractUIExtension=sa.isUIExtension=void 0;const H6=F,YI=kr,dG=me;function sce(n){return(0,YI.hasOwnProperty)(n,"id","function")&&(0,YI.hasOwnProperty)(n,"show","function")&&(0,YI.hasOwnProperty)(n,"hide","function")}sa.isUIExtension=sce;let $_=class{show(e,...t){this.activeElement=document.activeElement,!(!this.containerElement&&!this.initialize())&&(this.onBeforeShow(this.containerElement,e,...t),this.setContainerVisible(!0))}hide(){this.setContainerVisible(!1),this.restoreFocus(),this.activeElement=null}restoreFocus(){const e=this.activeElement;e&&e.focus()}initialize(){const e=document.getElementById(this.options.baseDiv);return e?(this.containerElement=this.getOrCreateContainer(e.id),this.initializeContents(this.containerElement),e&&e.insertBefore(this.containerElement,e.firstChild),!0):(this.logger.warn(this,`Could not obtain sprotty base container for initializing UI extension ${this.id}`,this),!1)}getOrCreateContainer(e){let t=document.getElementById(this.id());return t===null&&(t=document.createElement("div"),t.id=e+"_"+this.id(),t.classList.add(this.containerClass())),t}setContainerVisible(e){this.containerElement&&(e?(this.containerElement.style.visibility="visible",this.containerElement.style.opacity="1"):(this.containerElement.style.visibility="hidden",this.containerElement.style.opacity="0"))}onBeforeShow(e,t,...i){}};sa.AbstractUIExtension=$_;x6([(0,H6.inject)(dG.TYPES.ViewerOptions),cG("design:type",Object)],$_.prototype,"options",void 0);x6([(0,H6.inject)(dG.TYPES.ILogger),cG("design:type",Object)],$_.prototype,"logger",void 0);sa.AbstractUIExtension=$_=x6([(0,H6.injectable)()],$_);var gi={},ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.getAttrs=ft.on=ft.mergeStyle=ft.copyClassesFromElement=ft.copyClassesFromVNode=ft.setNamespace=ft.setClass=ft.setAttr=void 0;function ace(n,e,t){lG(n)[e]=t}ft.setAttr=ace;function K6(n,e,t){fG(n)[e]=t}ft.setClass=K6;function uG(n,e){n.data===void 0&&(n.data={}),n.data.ns=e;const t=n.children;if(t!==void 0)for(let i=0;i<t.length;i++){const o=t[i];typeof o!="string"&&uG(o,e)}}ft.setNamespace=uG;function cce(n,e){const t=fG(n);Object.keys(t).forEach(i=>K6(e,i,!0))}ft.copyClassesFromVNode=cce;function dce(n,e){const t=n.classList;for(let i=0;i<t.length;i++){const o=t.item(i);o&&K6(e,o,!0)}}ft.copyClassesFromElement=dce;function uce(n,e){k_(n).style=Object.assign(Object.assign({},k_(n).style||{}),e)}ft.mergeStyle=uce;function lce(n,e,t){const i=fce(n);if(i[e])throw new Error("EventListener for "+e+" already registered on VNode");i[e]=t}ft.on=lce;function lG(n){const e=k_(n);return e.attrs||(e.attrs={}),e.attrs}ft.getAttrs=lG;function k_(n){return n.data||(n.data={}),n.data}function fG(n){const e=k_(n);return e.class||(e.class={}),e.class}function fce(n){const e=k_(n);return e.on||(e.on={}),e.on}var V6=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},hG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},VB=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(gi,"__esModule",{value:!0});gi.KeyListener=gi.KeyTool=void 0;const d_=F,pG=me,hce=ke,qI=ft;let Q3=class{constructor(e=[]){this.keyListeners=e}register(e){this.keyListeners.push(e)}deregister(e){const t=this.keyListeners.indexOf(e);t>=0&&this.keyListeners.splice(t,1)}handleEvent(e,t,i){const o=this.keyListeners.map(r=>r[e].apply(r,[t,i])).reduce((r,s)=>r.concat(s));o.length>0&&(i.preventDefault(),this.actionDispatcher.dispatchAll(o))}keyDown(e,t){this.handleEvent("keyDown",e,t)}keyUp(e,t){this.handleEvent("keyUp",e,t)}focus(){}decorate(e,t){return t instanceof hce.SModelRootImpl&&((0,qI.on)(e,"focus",this.focus.bind(this,t)),(0,qI.on)(e,"keydown",this.keyDown.bind(this,t)),(0,qI.on)(e,"keyup",this.keyUp.bind(this,t))),e}postUpdate(){}};gi.KeyTool=Q3;V6([(0,d_.inject)(pG.TYPES.IActionDispatcher),hG("design:type",Object)],Q3.prototype,"actionDispatcher",void 0);gi.KeyTool=Q3=V6([(0,d_.injectable)(),VB(0,(0,d_.multiInject)(pG.TYPES.KeyListener)),VB(0,(0,d_.optional)()),hG("design:paramtypes",[Array])],Q3);let o2=class{keyDown(e,t){return[]}keyUp(e,t){return[]}};gi.KeyListener=o2;gi.KeyListener=o2=V6([(0,d_.injectable)()],o2);var Ut={},Aa={},mG=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},pce=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Aa,"__esModule",{value:!0});Aa.DOMHelper=void 0;const gG=F,mce=me;let X3=class{getPrefix(){return this.viewerOptions!==void 0&&this.viewerOptions.baseDiv!==void 0?this.viewerOptions.baseDiv+"_":""}createUniqueDOMElementId(e){return this.getPrefix()+e.id}findSModelIdByDOMElement(e){return e.id.replace(this.getPrefix(),"")}};Aa.DOMHelper=X3;mG([(0,gG.inject)(mce.TYPES.ViewerOptions),pce("design:type",Object)],X3.prototype,"viewerOptions",void 0);Aa.DOMHelper=X3=mG([(0,gG.injectable)()],X3);var cg=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cA=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},J3=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Ut,"__esModule",{value:!0});Ut.MousePositionTracker=Ut.MouseListener=Ut.PopupMouseTool=Ut.MouseTool=void 0;const Js=F,gce=se,vce=ke,dA=me,_ce=Aa,vr=ft;let xp=class{constructor(e=[]){this.mouseListeners=e}register(e){this.mouseListeners.push(e)}deregister(e){const t=this.mouseListeners.indexOf(e);t>=0&&this.mouseListeners.splice(t,1)}getTargetElement(e,t){let i=t.target;const o=e.index;for(;i;){if(i.id){const r=o.getById(this.domHelper.findSModelIdByDOMElement(i));if(r!==void 0)return r}i=i.parentNode}}handleEvent(e,t,i){this.focusOnMouseEvent(e,t);const o=this.getTargetElement(t,i);if(!o)return;const r=this.mouseListeners.map(s=>s[e](o,i)).reduce((s,a)=>s.concat(a));if(r.length>0){i.preventDefault();for(const s of r)(0,gce.isAction)(s)?this.actionDispatcher.dispatch(s):s.then(a=>{this.actionDispatcher.dispatch(a)})}}focusOnMouseEvent(e,t){if(document&&e==="mouseDown"){const i=document.getElementById(this.domHelper.createUniqueDOMElementId(t));i!==null&&typeof i.focus=="function"&&i.focus()}}mouseOver(e,t){this.handleEvent("mouseOver",e,t)}mouseOut(e,t){this.handleEvent("mouseOut",e,t)}mouseEnter(e,t){this.handleEvent("mouseEnter",e,t)}mouseLeave(e,t){this.handleEvent("mouseLeave",e,t)}mouseDown(e,t){this.handleEvent("mouseDown",e,t)}mouseMove(e,t){this.handleEvent("mouseMove",e,t)}mouseUp(e,t){this.handleEvent("mouseUp",e,t)}wheel(e,t){this.handleEvent("wheel",e,t)}contextMenu(e,t){t.preventDefault(),this.handleEvent("contextMenu",e,t)}doubleClick(e,t){this.handleEvent("doubleClick",e,t)}decorate(e,t){return t instanceof vce.SModelRootImpl&&((0,vr.on)(e,"mouseover",this.mouseOver.bind(this,t)),(0,vr.on)(e,"mouseout",this.mouseOut.bind(this,t)),(0,vr.on)(e,"mouseenter",this.mouseEnter.bind(this,t)),(0,vr.on)(e,"mouseleave",this.mouseLeave.bind(this,t)),(0,vr.on)(e,"mousedown",this.mouseDown.bind(this,t)),(0,vr.on)(e,"mouseup",this.mouseUp.bind(this,t)),(0,vr.on)(e,"mousemove",this.mouseMove.bind(this,t)),(0,vr.on)(e,"wheel",this.wheel.bind(this,t)),(0,vr.on)(e,"contextmenu",this.contextMenu.bind(this,t)),(0,vr.on)(e,"dblclick",this.doubleClick.bind(this,t)),(0,vr.on)(e,"dragover",i=>this.handleEvent("dragOver",t,i)),(0,vr.on)(e,"drop",i=>this.handleEvent("drop",t,i))),e=this.mouseListeners.reduce((i,o)=>o.decorate(i,t),e),e}postUpdate(){}};Ut.MouseTool=xp;cg([(0,Js.inject)(dA.TYPES.IActionDispatcher),cA("design:type",Object)],xp.prototype,"actionDispatcher",void 0);cg([(0,Js.inject)(dA.TYPES.DOMHelper),cA("design:type",_ce.DOMHelper)],xp.prototype,"domHelper",void 0);Ut.MouseTool=xp=cg([(0,Js.injectable)(),J3(0,(0,Js.multiInject)(dA.TYPES.MouseListener)),J3(0,(0,Js.optional)()),cA("design:paramtypes",[Array])],xp);let r2=class extends xp{constructor(e=[]){super(e),this.mouseListeners=e}};Ut.PopupMouseTool=r2;Ut.PopupMouseTool=r2=cg([(0,Js.injectable)(),J3(0,(0,Js.multiInject)(dA.TYPES.PopupMouseListener)),J3(0,(0,Js.optional)()),cA("design:paramtypes",[Array])],r2);let eC=class{mouseOver(e,t){return[]}mouseOut(e,t){return[]}mouseEnter(e,t){return[]}mouseLeave(e,t){return[]}mouseDown(e,t){return[]}mouseMove(e,t){return[]}mouseUp(e,t){return[]}wheel(e,t){return[]}doubleClick(e,t){return[]}contextMenu(e,t){return[]}dragOver(e,t){return[]}drop(e,t){return[]}decorate(e,t){return e}};Ut.MouseListener=eC;Ut.MouseListener=eC=cg([(0,Js.injectable)()],eC);let s2=class extends eC{mouseMove(e,t){return this.lastPosition=e.root.parentToLocal({x:t.offsetX,y:t.offsetY}),[]}get lastPositionOnDiagram(){return this.lastPosition}};Ut.MousePositionTracker=s2;Ut.MousePositionTracker=s2=cg([(0,Js.injectable)()],s2);var dc={};function yce(n,e){return document.createElement(n,e)}function bce(n,e,t){return document.createElementNS(n,e,t)}function Sce(){return Ol(document.createDocumentFragment())}function Ece(n){return document.createTextNode(n)}function Cce(n){return document.createComment(n)}function Pce(n,e,t){if(ec(n)){let i=n;for(;i&&ec(i);)i=Ol(i).parent;n=i??n}ec(e)&&(e=Ol(e,n)),t&&ec(t)&&(t=Ol(t).firstChildNode),n.insertBefore(e,t)}function wce(n,e){n.removeChild(e)}function Ace(n,e){ec(e)&&(e=Ol(e,n)),n.appendChild(e)}function vG(n){if(ec(n)){for(;n&&ec(n);)n=Ol(n).parent;return n??null}return n.parentNode}function Rce(n){var e;if(ec(n)){const t=Ol(n),i=vG(t);if(i&&t.lastChildNode){const o=Array.from(i.childNodes),r=o.indexOf(t.lastChildNode);return(e=o[r+1])!==null&&e!==void 0?e:null}return null}return n.nextSibling}function Mce(n){return n.tagName}function Ice(n,e){n.textContent=e}function Dce(n){return n.textContent}function Tce(n){return n.nodeType===1}function Oce(n){return n.nodeType===3}function Lce(n){return n.nodeType===8}function ec(n){return n.nodeType===11}function Ol(n,e){var t,i,o;const r=n;return(t=r.parent)!==null&&t!==void 0||(r.parent=e??null),(i=r.firstChildNode)!==null&&i!==void 0||(r.firstChildNode=n.firstChild),(o=r.lastChildNode)!==null&&o!==void 0||(r.lastChildNode=n.lastChild),r}const z6={createElement:yce,createElementNS:bce,createTextNode:Ece,createDocumentFragment:Sce,createComment:Cce,insertBefore:Pce,removeChild:wce,appendChild:Ace,parentNode:vG,nextSibling:Rce,tagName:Mce,setTextContent:Ice,getTextContent:Dce,isElement:Tce,isText:Oce,isComment:Lce,isDocumentFragment:ec};function Ui(n,e,t,i,o){const r=e===void 0?void 0:e.key;return{sel:n,data:e,children:t,text:i,elm:o,key:r}}const F_=Array.isArray;function Ll(n){return typeof n=="string"||typeof n=="number"||n instanceof String||n instanceof Number}function WI(n){return n===void 0}function uo(n){return n!==void 0}const ZI=Ui("",{},[],void 0,void 0);function uv(n,e){var t,i;const o=n.key===e.key,r=((t=n.data)===null||t===void 0?void 0:t.is)===((i=e.data)===null||i===void 0?void 0:i.is),s=n.sel===e.sel,a=!n.sel&&n.sel===e.sel?typeof n.text==typeof e.text:!0;return s&&o&&r&&a}function Nce(){throw new Error("The document fragment is not supported on this platform.")}function jce(n,e){return n.isElement(e)}function Bce(n,e){return n.isDocumentFragment(e)}function $ce(n,e,t){var i;const o={};for(let r=e;r<=t;++r){const s=(i=n[r])===null||i===void 0?void 0:i.key;s!==void 0&&(o[s]=r)}return o}const kce=["create","update","remove","destroy","pre","post"];function Fce(n,e,t){const i={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},o=e!==void 0?e:z6;for(const w of kce)for(const C of n){const E=C[w];E!==void 0&&i[w].push(E)}function r(w){const C=w.id?"#"+w.id:"",E=w.getAttribute("class"),D=E?"."+E.split(" ").join("."):"";return Ui(o.tagName(w).toLowerCase()+C+D,{},[],void 0,w)}function s(w){return Ui(void 0,{},[],void 0,w)}function a(w,C){return function(){if(--C===0){const D=o.parentNode(w);o.removeChild(D,w)}}}function f(w,C){var E,D,j,U;let p,b=w.data;if(b!==void 0){const O=(E=b.hook)===null||E===void 0?void 0:E.init;uo(O)&&(O(w),b=w.data)}const v=w.children,R=w.sel;if(R==="!")WI(w.text)&&(w.text=""),w.elm=o.createComment(w.text);else if(R!==void 0){const O=R.indexOf("#"),N=R.indexOf(".",O),T=O>0?O:R.length,$=N>0?N:R.length,Q=O!==-1||N!==-1?R.slice(0,Math.min(T,$)):R,K=w.elm=uo(b)&&uo(p=b.ns)?o.createElementNS(p,Q,b):o.createElement(Q,b);for(T<$&&K.setAttribute("id",R.slice(T+1,$)),N>0&&K.setAttribute("class",R.slice($+1).replace(/\./g," ")),p=0;p<i.create.length;++p)i.create[p](ZI,w);if(F_(v))for(p=0;p<v.length;++p){const H=v[p];H!=null&&o.appendChild(K,f(H,C))}else Ll(w.text)&&o.appendChild(K,o.createTextNode(w.text));const Z=w.data.hook;uo(Z)&&((D=Z.create)===null||D===void 0||D.call(Z,ZI,w),Z.insert&&C.push(w))}else if(!((j=t==null?void 0:t.experimental)===null||j===void 0)&&j.fragments&&w.children){for(w.elm=((U=o.createDocumentFragment)!==null&&U!==void 0?U:Nce)(),p=0;p<i.create.length;++p)i.create[p](ZI,w);for(p=0;p<w.children.length;++p){const O=w.children[p];O!=null&&o.appendChild(w.elm,f(O,C))}}else w.elm=o.createTextNode(w.text);return w.elm}function h(w,C,E,D,j,U){for(;D<=j;++D){const p=E[D];p!=null&&o.insertBefore(w,f(p,U),C)}}function g(w){var C,E;const D=w.data;if(D!==void 0){(E=(C=D==null?void 0:D.hook)===null||C===void 0?void 0:C.destroy)===null||E===void 0||E.call(C,w);for(let j=0;j<i.destroy.length;++j)i.destroy[j](w);if(w.children!==void 0)for(let j=0;j<w.children.length;++j){const U=w.children[j];U!=null&&typeof U!="string"&&g(U)}}}function y(w,C,E,D){for(var j,U;E<=D;++E){let p,b;const v=C[E];if(v!=null)if(uo(v.sel)){g(v),p=i.remove.length+1,b=a(v.elm,p);for(let O=0;O<i.remove.length;++O)i.remove[O](v,b);const R=(U=(j=v==null?void 0:v.data)===null||j===void 0?void 0:j.hook)===null||U===void 0?void 0:U.remove;uo(R)?R(v,b):b()}else v.children?(g(v),y(w,v.children,0,v.children.length-1)):o.removeChild(w,v.elm)}}function S(w,C,E,D){let j=0,U=0,p=C.length-1,b=C[0],v=C[p],R=E.length-1,O=E[0],N=E[R],T,$,Q,K;for(;j<=p&&U<=R;)b==null?b=C[++j]:v==null?v=C[--p]:O==null?O=E[++U]:N==null?N=E[--R]:uv(b,O)?(P(b,O,D),b=C[++j],O=E[++U]):uv(v,N)?(P(v,N,D),v=C[--p],N=E[--R]):uv(b,N)?(P(b,N,D),o.insertBefore(w,b.elm,o.nextSibling(v.elm)),b=C[++j],N=E[--R]):uv(v,O)?(P(v,O,D),o.insertBefore(w,v.elm,b.elm),v=C[--p],O=E[++U]):(T===void 0&&(T=$ce(C,j,p)),$=T[O.key],WI($)?o.insertBefore(w,f(O,D),b.elm):(Q=C[$],Q.sel!==O.sel?o.insertBefore(w,f(O,D),b.elm):(P(Q,O,D),C[$]=void 0,o.insertBefore(w,Q.elm,b.elm))),O=E[++U]);U<=R&&(K=E[R+1]==null?null:E[R+1].elm,h(w,K,E,U,R,D)),j<=p&&y(w,C,j,p)}function P(w,C,E){var D,j,U,p,b,v,R,O;const N=(D=C.data)===null||D===void 0?void 0:D.hook;(j=N==null?void 0:N.prepatch)===null||j===void 0||j.call(N,w,C);const T=C.elm=w.elm;if(w===C)return;if(C.data!==void 0||uo(C.text)&&C.text!==w.text){(U=C.data)!==null&&U!==void 0||(C.data={}),(p=w.data)!==null&&p!==void 0||(w.data={});for(let K=0;K<i.update.length;++K)i.update[K](w,C);(R=(v=(b=C.data)===null||b===void 0?void 0:b.hook)===null||v===void 0?void 0:v.update)===null||R===void 0||R.call(v,w,C)}const $=w.children,Q=C.children;WI(C.text)?uo($)&&uo(Q)?$!==Q&&S(T,$,Q,E):uo(Q)?(uo(w.text)&&o.setTextContent(T,""),h(T,null,Q,0,Q.length-1,E)):uo($)?y(T,$,0,$.length-1):uo(w.text)&&o.setTextContent(T,""):w.text!==C.text&&(uo($)&&y(T,$,0,$.length-1),o.setTextContent(T,C.text)),(O=N==null?void 0:N.postpatch)===null||O===void 0||O.call(N,w,C)}return function(C,E){let D,j,U;const p=[];for(D=0;D<i.pre.length;++D)i.pre[D]();for(jce(o,C)?C=r(C):Bce(o,C)&&(C=s(C)),uv(C,E)?P(C,E,p):(j=C.elm,U=o.parentNode(j),f(E,p),U!==null&&(o.insertBefore(U,E.elm,o.nextSibling(j)),y(U,[C],0,0))),D=0;D<p.length;++D)p[D].data.hook.insert(p[D]);for(D=0;D<i.post.length;++D)i.post[D]();return E}}function uA(n,e,t){if(n.ns="http://www.w3.org/2000/svg",t!=="foreignObject"&&e!==void 0)for(let i=0;i<e.length;++i){const o=e[i];if(typeof o=="string")continue;const r=o.data;r!==void 0&&uA(r,o.children,o.sel)}}function tC(n,e,t){let i={},o,r,s;if(t!==void 0?(e!==null&&(i=e),F_(t)?o=t:Ll(t)?r=t.toString():t&&t.sel&&(o=[t])):e!=null&&(F_(e)?o=e:Ll(e)?r=e.toString():e&&e.sel?o=[e]:i=e),o!==void 0)for(s=0;s<o.length;++s)Ll(o[s])&&(o[s]=Ui(void 0,void 0,void 0,o[s],void 0));return n[0]==="s"&&n[1]==="v"&&n[2]==="g"&&(n.length===3||n[3]==="."||n[3]==="#")&&uA(i,o,n),Ui(n,i,o,r,void 0)}function xce(n){let e,t;if(F_(n)?e=n:Ll(e)?t=n:e&&e.sel&&(e=[n]),e!==void 0)for(let i=0;i<e.length;++i)Ll(e[i])&&(e[i]=Ui(void 0,void 0,void 0,e[i],void 0));return Ui(void 0,{},e,t,void 0)}function o3(n,e){var t;const i=(t=e.data)===null||t===void 0?void 0:t.ns;n.data.fn=e.data.fn,n.data.args=e.data.args,e.data=n.data,e.children=n.children,e.text=n.text,e.elm=n.elm,i&&uA(e.data,e.children,e.sel)}function Hce(n){const e=n.data,t=e.fn(...e.args);o3(t,n)}function Kce(n,e){let t;const i=n.data,o=e.data,r=i.args,s=o.args;if(i.fn!==o.fn||r.length!==s.length){o3(o.fn(...s),e);return}for(t=0;t<s.length;++t)if(r[t]!==s[t]){o3(o.fn(...s),e);return}o3(n,e)}const Vce=function(e,t,i,o){return o===void 0&&(o=i,i=t,t=void 0),tC(e,{key:t,hook:{init:Hce,prepatch:Kce},fn:i,args:o})};function zce(n,e){const t=n.data.attachData;e.data.attachData.placeholder=t.placeholder,e.data.attachData.real=t.real,n.elm=n.data.attachData.real}function Gce(n,e){e.elm=e.data.attachData.placeholder}function Uce(n){n.elm!==void 0&&n.elm.parentNode.removeChild(n.elm),n.elm=n.data.attachData.real}function Yce(n,e){const t=e.elm,i=e.data.attachData,o=document.createElement("span");e.elm=o,i.target.appendChild(t),i.real=t,i.placeholder=o}function qce(n,e){e.data===void 0&&(e.data={}),e.data.hook===void 0&&(e.data.hook={});const t=e.data,i=e.data.hook;return t.attachData={target:n,placeholder:void 0,real:void 0},i.create=Yce,i.prepatch=zce,i.postpatch=Gce,i.destroy=Uce,e}function _G(n,e){const t=e!==void 0?e:z6;let i;if(t.isElement(n)){const o=n.id?"#"+n.id:"",r=n.getAttribute("class"),s=r?"."+r.split(" ").join("."):"",a=t.tagName(n).toLowerCase()+o+s,f={},h={},g={},y=[];let S,P,w;const C=n.attributes,E=n.childNodes;for(P=0,w=C.length;P<w;P++)S=C[P].nodeName,S[0]==="d"&&S[1]==="a"&&S[2]==="t"&&S[3]==="a"&&S[4]==="-"?h[S.slice(5)]=C[P].nodeValue||"":S!=="id"&&S!=="class"&&(f[S]=C[P].nodeValue);for(P=0,w=E.length;P<w;P++)y.push(_G(E[P],e));return Object.keys(f).length>0&&(g.attrs=f),Object.keys(h).length>0&&(g.dataset=h),a[0]==="s"&&a[1]==="v"&&a[2]==="g"&&(a.length===3||a[3]==="."||a[3]==="#")&&uA(g,y,a),Ui(a,g,y,void 0,n)}else return t.isText(n)?(i=t.getTextContent(n),Ui(void 0,void 0,void 0,i,n)):t.isComment(n)?(i=t.getTextContent(n),Ui("!",{},[],i,n)):Ui("",{},[],void 0,n)}const Wce="http://www.w3.org/1999/xlink",Zce="http://www.w3.org/XML/1998/namespace",zB=58,Qce=120;function GB(n,e){let t;const i=e.elm;let o=n.data.attrs,r=e.data.attrs;if(!(!o&&!r)&&o!==r){o=o||{},r=r||{};for(t in r){const s=r[t];o[t]!==s&&(s===!0?i.setAttribute(t,""):s===!1?i.removeAttribute(t):t.charCodeAt(0)!==Qce?i.setAttribute(t,s):t.charCodeAt(3)===zB?i.setAttributeNS(Zce,t,s):t.charCodeAt(5)===zB?i.setAttributeNS(Wce,t,s):i.setAttribute(t,s))}for(t in o)t in r||i.removeAttribute(t)}}const Xce={create:GB,update:GB};function UB(n,e){let t,i;const o=e.elm;let r=n.data.class,s=e.data.class;if(!(!r&&!s)&&r!==s){r=r||{},s=s||{};for(i in r)r[i]&&!Object.prototype.hasOwnProperty.call(s,i)&&o.classList.remove(i);for(i in s)t=s[i],t!==r[i]&&o.classList[t?"add":"remove"](i)}}const Jce={create:UB,update:UB},YB=/[A-Z]/g;function qB(n,e){const t=e.elm;let i=n.data.dataset,o=e.data.dataset,r;if(!i&&!o||i===o)return;i=i||{},o=o||{};const s=t.dataset;for(r in i)o[r]||(s?r in s&&delete s[r]:t.removeAttribute("data-"+r.replace(YB,"-$&").toLowerCase()));for(r in o)i[r]!==o[r]&&(s?s[r]=o[r]:t.setAttribute("data-"+r.replace(YB,"-$&").toLowerCase(),o[r]))}const ede={create:qB,update:qB};function yG(n,e,t){if(typeof n=="function")n.call(e,t,e);else if(typeof n=="object")for(let i=0;i<n.length;i++)yG(n[i],e,t)}function tde(n,e){const t=n.type,i=e.data.on;i&&i[t]&&yG(i[t],e,n)}function nde(){return function n(e){tde(e,n.vnode)}}function QI(n,e){const t=n.data.on,i=n.listener,o=n.elm,r=e&&e.data.on,s=e&&e.elm;let a;if(t!==r){if(t&&i)if(r)for(a in t)r[a]||o.removeEventListener(a,i,!1);else for(a in t)o.removeEventListener(a,i,!1);if(r){const f=e.listener=n.listener||nde();if(f.vnode=e,t)for(a in r)t[a]||s.addEventListener(a,f,!1);else for(a in r)s.addEventListener(a,f,!1)}}}const ide={create:QI,update:QI,destroy:QI};function WB(n,e){let t,i,o;const r=e.elm;let s=n.data.props,a=e.data.props;if(!(!s&&!a)&&s!==a){s=s||{},a=a||{};for(t in a)i=a[t],o=s[t],o!==i&&(t!=="value"||r[t]!==i)&&(r[t]=i)}}const ode={create:WB,update:WB},ZB=typeof window<"u"&&window.requestAnimationFrame.bind(window)||setTimeout,rde=function(n){ZB(function(){ZB(n)})};let a2=!1;function sde(n,e,t){rde(function(){n[e]=t})}function QB(n,e){let t,i;const o=e.elm;let r=n.data.style,s=e.data.style;if(!r&&!s||r===s)return;r=r||{},s=s||{};const a="delayed"in r;for(i in r)s[i]||(i[0]==="-"&&i[1]==="-"?o.style.removeProperty(i):o.style[i]="");for(i in s)if(t=s[i],i==="delayed"&&s.delayed)for(const f in s.delayed)t=s.delayed[f],(!a||t!==r.delayed[f])&&sde(o.style,f,t);else i!=="remove"&&t!==r[i]&&(i[0]==="-"&&i[1]==="-"?o.style.setProperty(i,t):o.style[i]=t)}function ade(n){let e,t;const i=n.elm,o=n.data.style;if(!(!o||!(e=o.destroy)))for(t in e)i.style[t]=e[t]}function cde(n,e){const t=n.data.style;if(!t||!t.remove){e();return}a2||(n.elm.offsetLeft,a2=!0);let i;const o=n.elm;let r=0;const s=t.remove;let a=0;const f=[];for(i in s)f.push(i),o.style[i]=s[i];const g=getComputedStyle(o)["transition-property"].split(", ");for(;r<g.length;++r)f.indexOf(g[r])!==-1&&a++;o.addEventListener("transitionend",function(y){y.target===o&&--a,a===0&&e()})}function dde(){a2=!1}const ude={pre:dde,create:QB,update:QB,destroy:ade,remove:cde};function lde(n,...e){const t=G6(e,[]);return t.length===1&&!t[0].sel&&t[0].text?Ui(void 0,void 0,void 0,t[0].text,void 0):Ui(void 0,n??{},t,void 0,void 0)}function G6(n,e){for(const t of n)t!=null&&t!==!1&&t!==""&&(Array.isArray(t)?G6(t,e):typeof t=="string"||typeof t=="number"||typeof t=="boolean"?e.push(Ui(void 0,void 0,void 0,String(t),void 0)):e.push(t));return e}function c2(n,e,...t){const i=G6(t,[]);return typeof n=="function"?n(e,i):i.length===1&&!i[0].sel&&i[0].text?tC(n,e,i[0].text):tC(n,e,i)}c2||(c2={});const fde=Object.freeze(Object.defineProperty({__proto__:null,Fragment:lde,array:F_,attachTo:qce,attributesModule:Xce,classModule:Jce,datasetModule:ede,eventListenersModule:ide,fragment:xce,h:tC,htmlDomApi:z6,init:Fce,get jsx(){return c2},primitive:Ll,propsModule:ode,styleModule:ude,thunk:Vce,toVNode:_G,vnode:Ui},Symbol.toStringTag,{value:"Module"})),dg=R6(fde);var hde=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(dc,"__esModule",{value:!0});dc.isThunk=dc.ThunkView=void 0;const pde=dg,mde=F;let d2=class{render(e,t){return(0,pde.h)(this.selector(e),{key:e.id,hook:{init:this.init.bind(this),prepatch:this.prepatch.bind(this)},fn:()=>this.renderAndDecorate(e,t),args:this.watchedArgs(e),thunk:!0})}renderAndDecorate(e,t){const i=this.doRender(e,t);return t.decorate(i,e),i}copyToThunk(e,t){t.elm=e.elm,e.data.fn=t.data.fn,e.data.args=t.data.args,t.data=e.data,t.children=e.children,t.text=e.text,t.elm=e.elm}init(e){const t=e.data,i=t.fn.apply(void 0,t.args);this.copyToThunk(i,e)}prepatch(e,t){const i=e.data,o=t.data;this.equals(i.args,o.args)?this.copyToThunk(e,t):this.copyToThunk(o.fn.apply(void 0,o.args),t)}equals(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let i=0;i<t.length;++i)if(!this.equals(e[i],t[i]))return!1}else if(typeof e=="object"&&typeof t=="object"){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(i!=="parent"&&i!=="root"&&(!(i in t)||!this.equals(e[i],t[i])))return!1}else if(e!==t)return!1;return!0}};dc.ThunkView=d2;dc.ThunkView=d2=hde([(0,mde.injectable)()],d2);function gde(n){return"thunk"in n}dc.isThunk=gde;var rn={},ei={};Object.defineProperty(ei,"__esModule",{value:!0});ei.JSX=ei.svg=ei.html=void 0;const vde=dg,XB=["hook","on","style","class","props","attrs","dataset"],_de="http://www.w3.org/2000/svg";function yde(n,e,t){const i={};if(t&&(i.ns=t),n===null)return i;return XB.forEach(r=>{n[r]&&(i[r]=n[r])}),Object.keys(n).forEach(r=>{if(r==="key"||r==="classNames"||r==="selector")return;const s=r.indexOf("-");if(s>0){const a=r.slice(0,s);XB.includes(a)?o(a,r.slice(s+1),n[r]):o(e,r,n[r])}else i[r]||o(e,r,n[r])}),i;function o(r,s,a){const f=i[r]||(i[r]={});f[s]=a}}function U6(n,e="props"){return(t,i,...o)=>{const r=typeof t=="function";return(0,vde.jsx)(t,r?i:yde(i,e,n),o)}}ei.JSX=U6;const bde=U6();ei.html=bde;const Sde=U6(_de,"attrs");ei.svg=Sde;var lA=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},bG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},JB=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}},zv;Object.defineProperty(rn,"__esModule",{value:!0});rn.MissingView=rn.EmptyView=rn.configureView=rn.overrideModelElement=rn.configureModelElement=rn.ViewRegistry=rn.findArgValue=void 0;const SG=ei,Ep=F,Y6=me,Ede=pn,Cde=wa,Pde=$n,EG=yt,wde=kr;function Ade(n,e){for(;n!==void 0&&!(e in n)&&n.parentArgs;)n=n.parentArgs;return n?n[e]:void 0}rn.findArgValue=Ade;let nC=class extends Ede.InstanceRegistry{constructor(e){super(),this.registerDefaults(),e.forEach(t=>{t.isOverride?this.override(t.type,t.factory()):this.register(t.type,t.factory())})}registerDefaults(){this.register(Pde.EMPTY_ROOT.type,new iC)}missing(e){return this.logger.warn(this,`no registered view for type '${e}', please configure a view in the ContainerModule`),new x_}};rn.ViewRegistry=nC;lA([(0,Ep.inject)(Y6.TYPES.ILogger),bG("design:type",Object)],nC.prototype,"logger",void 0);rn.ViewRegistry=nC=lA([(0,Ep.injectable)(),JB(0,(0,Ep.multiInject)(Y6.TYPES.ViewRegistration)),JB(0,(0,Ep.optional)()),bG("design:paramtypes",[Array])],nC);function Rde(n,e,t,i,o){(0,EG.registerModelElement)(n,e,t,o),q6(n,e,i)}rn.configureModelElement=Rde;function Mde(n,e,t,i,o){(0,EG.registerModelElement)(n,e,t,o,!0),q6(n,e,i,!0)}rn.overrideModelElement=Mde;function q6(n,e,t,i){if(typeof t=="function"){if(!(0,Cde.isInjectable)(t))throw new Error(`Views should be @injectable: ${t.name}`);n.isBound(t)||n.bind(t).toSelf()}n.bind(Y6.TYPES.ViewRegistration).toDynamicValue(o=>({type:e,factory:()=>o.container.get(t),isOverride:i}))}rn.configureView=q6;let iC=class{render(e,t){return(0,SG.svg)("svg",{"class-sprotty-empty":!0})}};rn.EmptyView=iC;rn.EmptyView=iC=lA([(0,Ep.injectable)()],iC);let x_=zv=class{render(e,t){const i=e.position||this.getPostion(e.type);return(0,SG.svg)("text",{"class-sprotty-missing":!0,x:i.x,y:i.y},'missing "',e.type,'" view')}getPostion(e){let t=zv.positionMap.get(e);return t||(t=wde.Point.ORIGIN,zv.positionMap.forEach(i=>t=i.y>=t.y?{x:0,y:i.y+20}:t),zv.positionMap.set(e,t)),t}};rn.MissingView=x_;x_.positionMap=new Map;rn.MissingView=x_=zv=lA([(0,Ep.injectable)()],x_);var Mf={},W6=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},CG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Mf,"__esModule",{value:!0});Mf.ViewerCache=void 0;const Z6=F,PG=me,Ide=Pa;let H_=class{update(e,t){if(t!==void 0)this.delegate.update(e,t),this.cachedModel=void 0;else{const i=this.cachedModel===void 0;this.cachedModel=e,i&&this.scheduleUpdate()}}scheduleUpdate(){this.syncer.onEndOfNextFrame(()=>{this.cachedModel&&(this.delegate.update(this.cachedModel),this.cachedModel=void 0)})}};Mf.ViewerCache=H_;W6([(0,Z6.inject)(PG.TYPES.IViewer),CG("design:type",Object)],H_.prototype,"delegate",void 0);W6([(0,Z6.inject)(PG.TYPES.AnimationFrameSyncer),CG("design:type",Ide.AnimationFrameSyncer)],H_.prototype,"syncer",void 0);Mf.ViewerCache=H_=W6([(0,Z6.injectable)()],H_);var fA={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.overrideViewerOptions=n.configureViewerOptions=n.defaultViewerOptions=void 0;const e=Xi,t=me,i=()=>({baseDiv:"sprotty",baseClass:"sprotty",hiddenDiv:"sprotty-hidden",hiddenClass:"sprotty-hidden",popupDiv:"sprotty-popup",popupClass:"sprotty-popup",popupClosedClass:"sprotty-popup-closed",needsClientLayout:!0,needsServerLayout:!1,popupOpenDelay:1e3,popupCloseDelay:300,zoomLimits:{min:.01,max:10},horizontalScrollLimits:{min:-1e5,max:1e5},verticalScrollLimits:{min:-1e5,max:1e5}});n.defaultViewerOptions=i;function o(s,a){const f=Object.assign(Object.assign({},(0,n.defaultViewerOptions)()),a);s.isBound(t.TYPES.ViewerOptions)?s.rebind(t.TYPES.ViewerOptions).toConstantValue(f):s.bind(t.TYPES.ViewerOptions).toConstantValue(f)}n.configureViewerOptions=o;function r(s,a){const f=s.get(t.TYPES.ViewerOptions);return(0,e.safeAssign)(f,a),f}n.overrideViewerOptions=r})(fA);var Qn={},ws=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},As=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},wr=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Qn,"__esModule",{value:!0});Qn.PopupModelViewer=Qn.HiddenModelViewer=Qn.ModelViewer=Qn.PatcherProvider=Qn.ModelRenderer=void 0;const hn=F,Lh=dg,K_=ei,Dde=sn,Tde=Eo,wG=$n,Li=me,Ode=dc,zo=ft;class Q6{constructor(e,t,i,o={}){this.viewRegistry=e,this.targetKind=t,this.postprocessors=i,this.args=o}decorate(e,t){return(0,Ode.isThunk)(e)?e:this.postprocessors.reduce((i,o)=>o.decorate(i,t),e)}renderElement(e){const i=this.viewRegistry.get(e.type).render(e,this,this.args);if(i)return this.decorate(i,e)}renderChildren(e,t){const i=t?new Q6(this.viewRegistry,this.targetKind,this.postprocessors,Object.assign(Object.assign({},t),{parentArgs:this.args})):this;return e.children.map(o=>i.renderElement(o)).filter(o=>o!==void 0)}postUpdate(e){this.postprocessors.forEach(t=>t.postUpdate(e))}}Qn.ModelRenderer=Q6;let Hp=class{constructor(){this.patcher=(0,Lh.init)(this.createModules())}createModules(){return[Lh.propsModule,Lh.attributesModule,Lh.classModule,Lh.styleModule,Lh.eventListenersModule]}};Qn.PatcherProvider=Hp;Qn.PatcherProvider=Hp=ws([(0,hn.injectable)(),As("design:paramtypes",[])],Hp);let Kp=class{constructor(e,t,i){this.renderer=e("main",i),this.patcher=t.patcher}update(e,t){var i;this.logger.log(this,"rendering",e);const o=(0,K_.html)("div",{id:this.options.baseDiv},this.renderer.renderElement(e));if(this.lastVDOM!==void 0){const r=this.hasFocus();(0,zo.copyClassesFromVNode)(this.lastVDOM,o),this.lastVDOM=this.patcher.call(this,this.lastVDOM,o),this.restoreFocus(r)}else if(typeof document<"u"){let r=null;if(this.options.shadowRoot){const s=(i=document.getElementById(this.options.shadowRoot))===null||i===void 0?void 0:i.shadowRoot;s&&(r=s.getElementById(this.options.baseDiv))}else r=document.getElementById(this.options.baseDiv);r!==null?(typeof window<"u"&&window.addEventListener("resize",()=>{this.onWindowResize(o)}),(0,zo.copyClassesFromElement)(r,o),(0,zo.setClass)(o,this.options.baseClass,!0),this.lastVDOM=this.patcher.call(this,r,o)):this.logger.error(this,"element not in DOM:",this.options.baseDiv)}this.renderer.postUpdate(t)}hasFocus(){if(typeof document<"u"&&document.activeElement&&this.lastVDOM.children&&this.lastVDOM.children.length>0){const e=this.lastVDOM.children[0];if(typeof e=="object"){const t=e.elm;return document.activeElement===t}}return!1}restoreFocus(e){if(e&&this.lastVDOM.children&&this.lastVDOM.children.length>0){const t=this.lastVDOM.children[0];if(typeof t=="object"){const i=t.elm;i&&typeof i.focus=="function"&&i.focus()}}}onWindowResize(e){const t=document.getElementById(this.options.baseDiv);if(t!==null){const i=this.getBoundsInPage(t);this.actiondispatcher.dispatch(Tde.InitializeCanvasBoundsAction.create(i))}}getBoundsInPage(e){const t=e.getBoundingClientRect(),i=(0,Dde.getWindowScroll)();return{x:t.left+i.x,y:t.top+i.y,width:t.width,height:t.height}}};Qn.ModelViewer=Kp;ws([(0,hn.inject)(Li.TYPES.ViewerOptions),As("design:type",Object)],Kp.prototype,"options",void 0);ws([(0,hn.inject)(Li.TYPES.ILogger),As("design:type",Object)],Kp.prototype,"logger",void 0);ws([(0,hn.inject)(Li.TYPES.IActionDispatcher),As("design:type",Object)],Kp.prototype,"actiondispatcher",void 0);Qn.ModelViewer=Kp=ws([(0,hn.injectable)(),wr(0,(0,hn.inject)(Li.TYPES.ModelRendererFactory)),wr(1,(0,hn.inject)(Li.TYPES.PatcherProvider)),wr(2,(0,hn.multiInject)(Li.TYPES.IVNodePostprocessor)),wr(2,(0,hn.optional)()),As("design:paramtypes",[Function,Hp,Array])],Kp);let V_=class{constructor(e,t,i){this.hiddenRenderer=e("hidden",i),this.patcher=t.patcher}update(e,t){this.logger.log(this,"rendering hidden");let i;if(e.type===wG.EMPTY_ROOT.type)i=(0,K_.html)("div",{id:this.options.hiddenDiv});else{const o=this.hiddenRenderer.renderElement(e);o&&(0,zo.setAttr)(o,"opacity",0),i=(0,K_.html)("div",{id:this.options.hiddenDiv},o)}if(this.lastHiddenVDOM!==void 0)(0,zo.copyClassesFromVNode)(this.lastHiddenVDOM,i),this.lastHiddenVDOM=this.patcher.call(this,this.lastHiddenVDOM,i);else{let o=document.getElementById(this.options.hiddenDiv);o===null?(o=document.createElement("div"),document.body.appendChild(o)):(0,zo.copyClassesFromElement)(o,i),(0,zo.setClass)(i,this.options.baseClass,!0),(0,zo.setClass)(i,this.options.hiddenClass,!0),this.lastHiddenVDOM=this.patcher.call(this,o,i)}this.hiddenRenderer.postUpdate(t)}};Qn.HiddenModelViewer=V_;ws([(0,hn.inject)(Li.TYPES.ViewerOptions),As("design:type",Object)],V_.prototype,"options",void 0);ws([(0,hn.inject)(Li.TYPES.ILogger),As("design:type",Object)],V_.prototype,"logger",void 0);Qn.HiddenModelViewer=V_=ws([(0,hn.injectable)(),wr(0,(0,hn.inject)(Li.TYPES.ModelRendererFactory)),wr(1,(0,hn.inject)(Li.TYPES.PatcherProvider)),wr(2,(0,hn.multiInject)(Li.TYPES.HiddenVNodePostprocessor)),wr(2,(0,hn.optional)()),As("design:paramtypes",[Function,Hp,Array])],V_);let z_=class{constructor(e,t,i){this.modelRendererFactory=e,this.popupRenderer=this.modelRendererFactory("popup",i),this.patcher=t.patcher}update(e,t){this.logger.log(this,"rendering popup",e);const i=e.type===wG.EMPTY_ROOT.type;let o;if(i)o=(0,K_.html)("div",{id:this.options.popupDiv});else{const r=e.canvasBounds,s={top:r.y+"px",left:r.x+"px"};o=(0,K_.html)("div",{id:this.options.popupDiv,style:s},this.popupRenderer.renderElement(e))}if(this.lastPopupVDOM!==void 0)(0,zo.copyClassesFromVNode)(this.lastPopupVDOM,o),(0,zo.setClass)(o,this.options.popupClosedClass,i),this.lastPopupVDOM=this.patcher.call(this,this.lastPopupVDOM,o);else if(typeof document<"u"){let r=document.getElementById(this.options.popupDiv);r===null?(r=document.createElement("div"),document.body.appendChild(r)):(0,zo.copyClassesFromElement)(r,o),(0,zo.setClass)(o,this.options.popupClass,!0),(0,zo.setClass)(o,this.options.popupClosedClass,i),this.lastPopupVDOM=this.patcher.call(this,r,o)}this.popupRenderer.postUpdate(t)}};Qn.PopupModelViewer=z_;ws([(0,hn.inject)(Li.TYPES.ViewerOptions),As("design:type",Object)],z_.prototype,"options",void 0);ws([(0,hn.inject)(Li.TYPES.ILogger),As("design:type",Object)],z_.prototype,"logger",void 0);Qn.PopupModelViewer=z_=ws([(0,hn.injectable)(),wr(0,(0,hn.inject)(Li.TYPES.ModelRendererFactory)),wr(1,(0,hn.inject)(Li.TYPES.PatcherProvider)),wr(2,(0,hn.multiInject)(Li.TYPES.PopupVNodePostprocessor)),wr(2,(0,hn.optional)()),As("design:paramtypes",[Function,Hp,Array])],z_);var If={},Lde=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(If,"__esModule",{value:!0});If.FocusFixPostprocessor=void 0;const Nde=F,jde=ft;let u2=class{decorate(e,t){return e.sel&&e.sel.startsWith("svg")&&(0,jde.setAttr)(e,"tabindex",0),e}postUpdate(){}};If.FocusFixPostprocessor=u2;If.FocusFixPostprocessor=u2=Lde([(0,Nde.injectable)()],u2);var _0={},Wo={},hA=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},AG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.ConsoleLogger=Wo.NullLogger=Wo.LogLevel=void 0;const pA=F,RG=me;var Pd;(function(n){n[n.none=0]="none",n[n.error=1]="error",n[n.warn=2]="warn",n[n.info=3]="info",n[n.log=4]="log"})(Pd||(Wo.LogLevel=Pd={}));let l2=class{constructor(){this.logLevel=Pd.none}error(e,t,...i){}warn(e,t,...i){}info(e,t,...i){}log(e,t,...i){}};Wo.NullLogger=l2;Wo.NullLogger=l2=hA([(0,pA.injectable)()],l2);let G_=class{constructor(){this.logLevel=Pd.log,this.viewOptions={baseDiv:""}}error(e,t,...i){if(this.logLevel>=Pd.error)try{console.error.apply(e,this.consoleArguments(e,t,i))}catch{}}warn(e,t,...i){if(this.logLevel>=Pd.warn)try{console.warn.apply(e,this.consoleArguments(e,t,i))}catch{}}info(e,t,...i){if(this.logLevel>=Pd.info)try{console.info.apply(e,this.consoleArguments(e,t,i))}catch{}}log(e,t,...i){if(this.logLevel>=Pd.log)try{console.log.apply(e,this.consoleArguments(e,t,i))}catch{}}consoleArguments(e,t,i){let o;return typeof e=="object"?o=e.constructor.name:o=e,[new Date().toLocaleTimeString()+" "+this.viewOptions.baseDiv+" "+o+": "+t,...i]}};Wo.ConsoleLogger=G_;hA([(0,pA.inject)(RG.TYPES.LogLevel),AG("design:type",Number)],G_.prototype,"logLevel",void 0);hA([(0,pA.inject)(RG.TYPES.ViewerOptions),AG("design:type",Object)],G_.prototype,"viewOptions",void 0);Wo.ConsoleLogger=G_=hA([(0,pA.injectable)()],G_);var y0={},X6=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},MG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(y0,"__esModule",{value:!0});y0.IdPostprocessor=void 0;const J6=F,IG=me,Bde=Aa,$de=ft;let U_=class{decorate(e,t){const i=(0,$de.getAttrs)(e);return i.id!==void 0&&this.logger.warn(e,"Overriding id of vnode ("+i.id+"). Make sure not to set it manually in view."),i.id=this.domHelper.createUniqueDOMElementId(t),e.key||(e.key=t.id),e}postUpdate(){}};y0.IdPostprocessor=U_;X6([(0,J6.inject)(IG.TYPES.ILogger),MG("design:type",Object)],U_.prototype,"logger",void 0);X6([(0,J6.inject)(IG.TYPES.DOMHelper),MG("design:type",Bde.DOMHelper)],U_.prototype,"domHelper",void 0);y0.IdPostprocessor=U_=X6([(0,J6.injectable)()],U_);var b0={},kde=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(b0,"__esModule",{value:!0});b0.CssClassPostprocessor=void 0;const Fde=jn,e$=ft,xde=F;let f2=class{decorate(e,t){if(t.cssClasses)for(const o of t.cssClasses)(0,e$.setClass)(e,o,!0);const i=(0,Fde.getSubType)(t);return i&&i!==t.type&&(0,e$.setClass)(e,i,!0),e}postUpdate(){}};b0.CssClassPostprocessor=f2;b0.CssClassPostprocessor=f2=kde([(0,xde.injectable)()],f2);Object.defineProperty(_0,"__esModule",{value:!0});const Hde=F,Ge=me,XI=Eo,t$=Wo,Kde=Nu,n$=qo,Vde=wf,zde=aA,i$=$n,Gde=Pa,ld=Qn,Ude=fA,Nh=Ut,o$=gi,r$=If,Yde=rn,cE=Mf,qde=Aa,dE=y0,uE=wn,JI=b0,Wde=ju,s$=Co,Zde=Pf,Qde=new Hde.ContainerModule((n,e,t)=>{n(Ge.TYPES.ILogger).to(t$.NullLogger).inSingletonScope(),n(Ge.TYPES.LogLevel).toConstantValue(t$.LogLevel.warn),n(Ge.TYPES.SModelRegistry).to(i$.SModelRegistry).inSingletonScope(),n(n$.ActionHandlerRegistry).toSelf().inSingletonScope(),n(Ge.TYPES.ActionHandlerRegistryProvider).toProvider(o=>()=>new Promise(r=>{r(o.container.get(n$.ActionHandlerRegistry))})),n(Ge.TYPES.ViewRegistry).to(Yde.ViewRegistry).inSingletonScope(),n(Ge.TYPES.IModelFactory).to(i$.SModelFactory).inSingletonScope(),n(Ge.TYPES.IActionDispatcher).to(Kde.ActionDispatcher).inSingletonScope(),n(Ge.TYPES.IActionDispatcherProvider).toProvider(o=>()=>new Promise(r=>{r(o.container.get(Ge.TYPES.IActionDispatcher))})),n(Ge.TYPES.IDiagramLocker).to(Zde.DefaultDiagramLocker).inSingletonScope(),n(Ge.TYPES.IActionHandlerInitializer).to(uE.CommandActionHandlerInitializer),n(Ge.TYPES.ICommandStack).to(Vde.CommandStack).inSingletonScope(),n(Ge.TYPES.ICommandStackProvider).toProvider(o=>()=>new Promise(r=>{r(o.container.get(Ge.TYPES.ICommandStack))})),n(Ge.TYPES.CommandStackOptions).toConstantValue((0,zde.defaultCommandStackOptions)()),n(ld.ModelViewer).toSelf().inSingletonScope(),n(ld.HiddenModelViewer).toSelf().inSingletonScope(),n(ld.PopupModelViewer).toSelf().inSingletonScope(),n(Ge.TYPES.ModelViewer).toDynamicValue(o=>{const r=o.container.createChild();return r.bind(Ge.TYPES.IViewer).toService(ld.ModelViewer),r.bind(cE.ViewerCache).toSelf(),r.get(cE.ViewerCache)}).inSingletonScope(),n(Ge.TYPES.PopupModelViewer).toDynamicValue(o=>{const r=o.container.createChild();return r.bind(Ge.TYPES.IViewer).toService(ld.PopupModelViewer),r.bind(cE.ViewerCache).toSelf(),r.get(cE.ViewerCache)}).inSingletonScope(),n(Ge.TYPES.HiddenModelViewer).toService(ld.HiddenModelViewer),n(Ge.TYPES.IViewerProvider).toDynamicValue(o=>({get modelViewer(){return o.container.get(Ge.TYPES.ModelViewer)},get hiddenModelViewer(){return o.container.get(Ge.TYPES.HiddenModelViewer)},get popupModelViewer(){return o.container.get(Ge.TYPES.PopupModelViewer)}})),n(Ge.TYPES.ViewerOptions).toConstantValue((0,Ude.defaultViewerOptions)()),n(Ge.TYPES.PatcherProvider).to(ld.PatcherProvider).inSingletonScope(),n(Ge.TYPES.DOMHelper).to(qde.DOMHelper).inSingletonScope(),n(Ge.TYPES.ModelRendererFactory).toFactory(o=>(r,s,a={})=>{const f=o.container.get(Ge.TYPES.ViewRegistry);return new ld.ModelRenderer(f,r,s,a)}),n(dE.IdPostprocessor).toSelf().inSingletonScope(),n(Ge.TYPES.IVNodePostprocessor).toService(dE.IdPostprocessor),n(Ge.TYPES.HiddenVNodePostprocessor).toService(dE.IdPostprocessor),n(JI.CssClassPostprocessor).toSelf().inSingletonScope(),n(Ge.TYPES.IVNodePostprocessor).toService(JI.CssClassPostprocessor),n(Ge.TYPES.HiddenVNodePostprocessor).toService(JI.CssClassPostprocessor),n(Nh.MouseTool).toSelf().inSingletonScope(),n(Ge.TYPES.IVNodePostprocessor).toService(Nh.MouseTool),n(o$.KeyTool).toSelf().inSingletonScope(),n(Ge.TYPES.IVNodePostprocessor).toService(o$.KeyTool),n(r$.FocusFixPostprocessor).toSelf().inSingletonScope(),n(Ge.TYPES.IVNodePostprocessor).toService(r$.FocusFixPostprocessor),n(Ge.TYPES.PopupVNodePostprocessor).toService(dE.IdPostprocessor),n(Nh.PopupMouseTool).toSelf().inSingletonScope(),n(Ge.TYPES.PopupVNodePostprocessor).toService(Nh.PopupMouseTool),n(Ge.TYPES.AnimationFrameSyncer).to(Gde.AnimationFrameSyncer).inSingletonScope();const i={bind:n,isBound:t};(0,uE.configureCommand)(i,XI.InitializeCanvasBoundsCommand),n(XI.CanvasBoundsInitializer).toSelf().inSingletonScope(),n(Ge.TYPES.IVNodePostprocessor).toService(XI.CanvasBoundsInitializer),(0,uE.configureCommand)(i,Wde.SetModelCommand),n(Ge.TYPES.UIExtensionRegistry).to(s$.UIExtensionRegistry).inSingletonScope(),(0,uE.configureCommand)(i,s$.SetUIExtensionVisibilityCommand),n(Nh.MousePositionTracker).toSelf().inSingletonScope(),n(Ge.TYPES.MouseListener).toService(Nh.MousePositionTracker)});_0.default=Qde;var hs={},$t={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SShapeElementImpl=n.findChildrenAtPosition=n.getAbsoluteClientBounds=n.getAbsoluteBounds=n.isAlignable=n.isSizeable=n.isLayoutableChild=n.isLayoutContainer=n.isBoundsAware=n.alignFeature=n.layoutableChildFeature=n.layoutContainerFeature=n.boundsFeature=void 0;const e=De,t=ke,i=yt,o=sn;n.boundsFeature=Symbol("boundsFeature"),n.layoutContainerFeature=Symbol("layoutContainerFeature"),n.layoutableChildFeature=Symbol("layoutableChildFeature"),n.alignFeature=Symbol("alignFeature");function r(C){return"bounds"in C}n.isBoundsAware=r;function s(C){return r(C)&&C.hasFeature(n.layoutContainerFeature)&&"layout"in C}n.isLayoutContainer=s;function a(C){return r(C)&&C.hasFeature(n.layoutableChildFeature)}n.isLayoutableChild=a;function f(C){return C.hasFeature(n.boundsFeature)&&r(C)}n.isSizeable=f;function h(C){return C.hasFeature(n.alignFeature)&&"alignment"in C}n.isAlignable=h;function g(C){const E=(0,i.findParentByFeature)(C,r);if(E!==void 0){let D=E.bounds,j=E;for(;j instanceof t.SChildElementImpl;){const U=j.parent;D=U.localToParent(D),j=U}return D}else if(C instanceof t.SModelRootImpl){const D=C.canvasBounds;return{x:0,y:0,width:D.width,height:D.height}}else return e.Bounds.EMPTY}n.getAbsoluteBounds=g;function y(C,E,D){let j=0,U=0,p=0,b=0;const v=E.createUniqueDOMElementId(C),R=document.getElementById(v);if(R){const N=R.getBoundingClientRect(),T=(0,o.getWindowScroll)();j=N.left+T.x,U=N.top+T.y,p=N.width,b=N.height}let O=document.getElementById(D.baseDiv);if(O)for(;O.offsetParent instanceof HTMLElement&&(O=O.offsetParent);)j-=O.offsetLeft,U-=O.offsetTop;return{x:j,y:U,width:p,height:b}}n.getAbsoluteClientBounds=y;function S(C,E){const D=[];return P(C,E,D),D}n.findChildrenAtPosition=S;function P(C,E,D){C.children.forEach(j=>{if(r(j)&&e.Bounds.includes(j.bounds,E)&&D.push(j),j instanceof t.SParentElementImpl){const U=j.parentToLocal(E);P(j,U,D)}})}class w extends t.SChildElementImpl{constructor(){super(...arguments),this.position=e.Point.ORIGIN,this.size=e.Dimension.EMPTY}get bounds(){return{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}}set bounds(E){this.position={x:E.x,y:E.y},this.size={width:E.width,height:E.height}}localToParent(E){const D={x:E.x+this.position.x,y:E.y+this.position.y,width:-1,height:-1};return(0,e.isBounds)(E)&&(D.width=E.width,D.height=E.height),D}parentToLocal(E){const D={x:E.x-this.position.x,y:E.y-this.position.y,width:-1,height:-1};return(0,e.isBounds)(E)&&(D.width=E.width,D.height=E.height),D}}n.SShapeElementImpl=w})($t);var DG=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},TG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},OG=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(hs,"__esModule",{value:!0});hs.RequestBoundsCommand=hs.SetBoundsCommand=void 0;const oC=F,e7=se,LG=Ve,NG=me,Xde=$t;let rC=class extends LG.SystemCommand{constructor(e){super(),this.action=e,this.bounds=[]}execute(e){return this.action.bounds.forEach(t=>{const i=e.root.index.getById(t.elementId);i&&(0,Xde.isBoundsAware)(i)&&this.bounds.push({element:i,oldBounds:i.bounds,newPosition:t.newPosition,newSize:t.newSize})}),this.redo(e)}undo(e){return this.bounds.forEach(t=>t.element.bounds=t.oldBounds),e.root}redo(e){return this.bounds.forEach(t=>{t.newPosition?t.element.bounds=Object.assign(Object.assign({},t.newPosition),t.newSize):t.element.bounds=Object.assign({x:t.element.bounds.x,y:t.element.bounds.y},t.newSize)}),e.root}};hs.SetBoundsCommand=rC;rC.KIND=e7.SetBoundsAction.KIND;hs.SetBoundsCommand=rC=DG([(0,oC.injectable)(),OG(0,(0,oC.inject)(NG.TYPES.Action)),TG("design:paramtypes",[Object])],rC);let sC=class extends LG.HiddenCommand{constructor(e){super(),this.action=e}execute(e){return{model:e.modelFactory.createRoot(this.action.newRoot),modelChanged:!0,cause:this.action}}get blockUntil(){return e=>e.kind===e7.ComputedBoundsAction.KIND}};hs.RequestBoundsCommand=sC;sC.KIND=e7.RequestBoundsAction.KIND;hs.RequestBoundsCommand=sC=DG([(0,oC.injectable)(),OG(0,(0,oC.inject)(NG.TYPES.Action)),TG("design:paramtypes",[Object])],sC);var mA={},Yi={},S0=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},gA=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},a$=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Yi,"__esModule",{value:!0});Yi.configureLayout=Yi.StatefulLayouter=Yi.Layouter=Yi.LayoutRegistry=void 0;const Nl=F,Jde=De,E0=me,eue=pn,c$=$t,tue=wa;let Y_=class extends eue.InstanceRegistry{constructor(e=[]){super(),e.forEach(t=>{this.hasKey(t.layoutKind)?this.logger.warn("Layout kind is already defined: ",t.layoutKind):this.register(t.layoutKind,t.factory())})}};Yi.LayoutRegistry=Y_;S0([(0,Nl.inject)(E0.TYPES.ILogger),gA("design:type",Object)],Y_.prototype,"logger",void 0);Yi.LayoutRegistry=Y_=S0([(0,Nl.injectable)(),a$(0,(0,Nl.multiInject)(E0.TYPES.LayoutRegistration)),a$(0,(0,Nl.optional)()),gA("design:paramtypes",[Array])],Y_);let q_=class{layout(e){new jG(e,this.layoutRegistry,this.logger).layout()}};Yi.Layouter=q_;S0([(0,Nl.inject)(E0.TYPES.LayoutRegistry),gA("design:type",Y_)],q_.prototype,"layoutRegistry",void 0);S0([(0,Nl.inject)(E0.TYPES.ILogger),gA("design:type",Object)],q_.prototype,"logger",void 0);Yi.Layouter=q_=S0([(0,Nl.injectable)()],q_);class jG{constructor(e,t,i){this.element2boundsData=e,this.layoutRegistry=t,this.log=i,this.toBeLayouted=[],e.forEach((o,r)=>{(0,c$.isLayoutContainer)(r)&&this.toBeLayouted.push(r)})}getBoundsData(e){let t=this.element2boundsData.get(e),i=e.bounds;return(0,c$.isLayoutContainer)(e)&&this.toBeLayouted.indexOf(e)>=0&&(i=this.doLayout(e)),t||(t={bounds:i,boundsChanged:!1,alignmentChanged:!1},this.element2boundsData.set(e,t)),t}layout(){for(;this.toBeLayouted.length>0;){const e=this.toBeLayouted[0];this.doLayout(e)}}doLayout(e){const t=this.toBeLayouted.indexOf(e);t>=0&&this.toBeLayouted.splice(t,1);const i=this.layoutRegistry.get(e.layout);i&&i.layout(e,this);const o=this.element2boundsData.get(e);return o!==void 0&&o.bounds!==void 0?o.bounds:(this.log.error(e,"Layout failed"),Jde.Bounds.EMPTY)}}Yi.StatefulLayouter=jG;function nue(n,e,t){if(typeof t=="function"){if(!(0,tue.isInjectable)(t))throw new Error(`Layouts be @injectable: ${t.name}`);n.isBound(t)||n.bind(t).toSelf()}n.bind(E0.TYPES.LayoutRegistration).toDynamicValue(i=>({layoutKind:e,factory:()=>i.container.get(t)}))}Yi.configureLayout=nue;(function(n){var e=l&&l.__decorate||function(P,w,C,E){var D=arguments.length,j=D<3?w:E===null?E=Object.getOwnPropertyDescriptor(w,C):E,U;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(P,w,C,E);else for(var p=P.length-1;p>=0;p--)(U=P[p])&&(j=(D<3?U(j):D>3?U(w,C,j):U(w,C))||j);return D>3&&j&&Object.defineProperty(w,C,j),j},t=l&&l.__metadata||function(P,w){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(P,w)};Object.defineProperty(n,"__esModule",{value:!0}),n.ATTR_BBOX_ELEMENT=n.HiddenBoundsUpdater=n.BoundsData=void 0;const i=F,o=se,r=De,s=sn,a=ke,f=me,h=Yi,g=$t;class y{}n.BoundsData=y;let S=class{constructor(){this.element2boundsData=new Map}decorate(w,C){return((0,g.isSizeable)(C)||(0,g.isLayoutContainer)(C))&&this.element2boundsData.set(C,{vnode:w,bounds:C.bounds,boundsChanged:!1,alignmentChanged:!1}),C instanceof a.SModelRootImpl&&(this.root=C),w}postUpdate(w){if(w===void 0||w.kind!==o.RequestBoundsAction.KIND)return;const C=w;this.getBoundsFromDOM(),this.layouter.layout(this.element2boundsData);const E=[],D=[];this.element2boundsData.forEach((U,p)=>{if(U.boundsChanged&&U.bounds!==void 0){const b={elementId:p.id,newSize:{width:U.bounds.width,height:U.bounds.height}};p instanceof a.SChildElementImpl&&(0,g.isLayoutContainer)(p.parent)&&(b.newPosition={x:U.bounds.x,y:U.bounds.y}),E.push(b)}U.alignmentChanged&&U.alignment!==void 0&&D.push({elementId:p.id,newAlignment:U.alignment})});const j=this.root!==void 0?this.root.revision:void 0;this.actionDispatcher.dispatch(o.ComputedBoundsAction.create(E,{revision:j,alignments:D,requestId:C.requestId})),this.element2boundsData.clear()}getBoundsFromDOM(){this.element2boundsData.forEach((w,C)=>{if(w.bounds&&(0,g.isSizeable)(C)){const E=w.vnode;if(E&&E.elm){const D=this.getBounds(E.elm,C);(0,g.isAlignable)(C)&&!((0,r.almostEquals)(D.x,0)&&(0,r.almostEquals)(D.y,0))&&(w.alignment={x:-D.x,y:-D.y},w.alignmentChanged=!0);const j={x:C.bounds.x,y:C.bounds.y,width:D.width,height:D.height};(0,r.almostEquals)(j.x,C.bounds.x)&&(0,r.almostEquals)(j.y,C.bounds.y)&&(0,r.almostEquals)(j.width,C.bounds.width)&&(0,r.almostEquals)(j.height,C.bounds.height)||(w.bounds=j,w.boundsChanged=!0)}}})}getBounds(w,C){if(!(0,s.isSVGGraphicsElement)(w))return this.logger.error(this,"Not an SVG element:",w),r.Bounds.EMPTY;if(w.tagName==="g"){for(const D of Array.from(w.children))if(D.getAttribute(n.ATTR_BBOX_ELEMENT)!==null)return this.getBounds(D,C)}const E=w.getBBox();return{x:E.x,y:E.y,width:E.width,height:E.height}}};n.HiddenBoundsUpdater=S,e([(0,i.inject)(f.TYPES.ILogger),t("design:type",Object)],S.prototype,"logger",void 0),e([(0,i.inject)(f.TYPES.IActionDispatcher),t("design:type",Object)],S.prototype,"actionDispatcher",void 0),e([(0,i.inject)(f.TYPES.Layouter),t("design:type",h.Layouter)],S.prototype,"layouter",void 0),n.HiddenBoundsUpdater=S=e([(0,i.injectable)()],S),n.ATTR_BBOX_ELEMENT="bboxElement"})(mA);var Df={},Bu={},iue=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Bu,"__esModule",{value:!0});Bu.AbstractLayout=void 0;const eD=De,d$=ke,tD=$t,oue=F;let h2=class{layout(e,t){const i=t.getBoundsData(e),o=this.getLayoutOptions(e),r=this.getChildrenSize(e,o,t),s=o.paddingFactor*(o.resizeContainer?Math.max(r.width,o.minWidth):Math.max(0,this.getFixedContainerBounds(e,o,t).width)-o.paddingLeft-o.paddingRight),a=o.paddingFactor*(o.resizeContainer?Math.max(r.height,o.minHeight):Math.max(0,this.getFixedContainerBounds(e,o,t).height)-o.paddingTop-o.paddingBottom);if(s>0&&a>0){const f=this.layoutChildren(e,t,o,s,a);i.bounds=this.getFinalContainerBounds(e,f,o,s,a),i.boundsChanged=!0}}getFinalContainerBounds(e,t,i,o,r){return{x:e.bounds.x,y:e.bounds.y,width:Math.max(i.minWidth,o+i.paddingLeft+i.paddingRight),height:Math.max(i.minHeight,r+i.paddingTop+i.paddingBottom)}}getFixedContainerBounds(e,t,i){let o=e;for(;;){if((0,tD.isBoundsAware)(o)){const r=o.bounds;if((0,tD.isLayoutContainer)(o)&&t.resizeContainer&&i.log.error(o,"Resizable container found while detecting fixed bounds"),eD.Dimension.isValid(r))return r}if(o instanceof d$.SChildElementImpl)o=o.parent;else return i.log.error(o,"Cannot detect fixed bounds"),eD.Bounds.EMPTY}}layoutChildren(e,t,i,o,r){let s={x:i.paddingLeft+.5*(o-o/i.paddingFactor),y:i.paddingTop+.5*(r-r/i.paddingFactor)};return e.children.forEach(a=>{if((0,tD.isLayoutableChild)(a)){const f=t.getBoundsData(a),h=f.bounds,g=this.getChildLayoutOptions(a,i);h!==void 0&&eD.Dimension.isValid(h)&&(s=this.layoutChild(a,f,h,g,i,s,o,r))}}),s}getDx(e,t,i){switch(e){case"left":return 0;case"center":return .5*(i-t.width);case"right":return i-t.width}}getDy(e,t,i){switch(e){case"top":return 0;case"center":return .5*(i-t.height);case"bottom":return i-t.height}}getChildLayoutOptions(e,t){const i=e.layoutOptions;return i===void 0?t:this.spread(t,i)}getLayoutOptions(e){let t=e;const i=[];for(;t!==void 0;){const o=t.layoutOptions;if(o!==void 0&&i.push(o),t instanceof d$.SChildElementImpl)t=t.parent;else break}return i.reverse().reduce((o,r)=>this.spread(o,r),this.getDefaultLayoutOptions())}};Bu.AbstractLayout=h2;Bu.AbstractLayout=h2=iue([(0,oue.injectable)()],h2);var rue=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Df,"__esModule",{value:!0});Df.VBoxLayouter=void 0;const sue=F,aue=De,cue=Bu,due=$t;let aC=class extends cue.AbstractLayout{getChildrenSize(e,t,i){let o=-1,r=0,s=!0;return e.children.forEach(a=>{if((0,due.isLayoutableChild)(a)){const f=i.getBoundsData(a).bounds;f!==void 0&&aue.Dimension.isValid(f)&&(r+=f.height,s?s=!1:r+=t.vGap,o=Math.max(o,f.width))}}),{width:o,height:r}}layoutChild(e,t,i,o,r,s,a,f){const h=this.getDx(o.hAlign,i,a);return t.bounds={x:r.paddingLeft+e.bounds.x-i.x+h,y:s.y+e.bounds.y-i.y,width:i.width,height:i.height},t.boundsChanged=!0,{x:s.x,y:s.y+i.height+r.vGap}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,vGap:1,hAlign:"center",minWidth:0,minHeight:0}}spread(e,t){return Object.assign(Object.assign({},e),t)}};Df.VBoxLayouter=aC;aC.KIND="vbox";Df.VBoxLayouter=aC=rue([(0,sue.injectable)()],aC);var Tf={},uue=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Tf,"__esModule",{value:!0});Tf.HBoxLayouter=void 0;const lue=F,fue=De,hue=Bu,pue=$t;let cC=class extends hue.AbstractLayout{getChildrenSize(e,t,i){let o=0,r=-1,s=!0;return e.children.forEach(a=>{if((0,pue.isLayoutableChild)(a)){const f=i.getBoundsData(a).bounds;f!==void 0&&fue.Dimension.isValid(f)&&(s?s=!1:o+=t.hGap,o+=f.width,r=Math.max(r,f.height))}}),{width:o,height:r}}layoutChild(e,t,i,o,r,s,a,f){const h=this.getDy(o.vAlign,i,f);return t.bounds={x:s.x+e.bounds.x-i.x,y:r.paddingTop+e.bounds.y-i.y+h,width:i.width,height:i.height},t.boundsChanged=!0,{x:s.x+i.width+r.hGap,y:s.y}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,hGap:1,vAlign:"center",minWidth:0,minHeight:0}}spread(e,t){return Object.assign(Object.assign({},e),t)}};Tf.HBoxLayouter=cC;cC.KIND="hbox";Tf.HBoxLayouter=cC=uue([(0,lue.injectable)()],cC);var ug={},mue=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(ug,"__esModule",{value:!0});ug.StackLayouter=void 0;const gue=F,vue=De,_ue=Bu,yue=$t;let dC=class extends _ue.AbstractLayout{getChildrenSize(e,t,i){let o=-1,r=-1;return e.children.forEach(s=>{if((0,yue.isLayoutableChild)(s)){const a=i.getBoundsData(s).bounds;a!==void 0&&vue.Dimension.isValid(a)&&(o=Math.max(o,a.width),r=Math.max(r,a.height))}}),{width:o,height:r}}layoutChild(e,t,i,o,r,s,a,f){const h=this.getDx(o.hAlign,i,a),g=this.getDy(o.vAlign,i,f);return t.bounds={x:r.paddingLeft+e.bounds.x-i.x+h,y:r.paddingTop+e.bounds.y-i.y+g,width:i.width,height:i.height},t.boundsChanged=!0,s}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,hAlign:"center",vAlign:"center",minWidth:0,minHeight:0}}spread(e,t){return Object.assign(Object.assign({},e),t)}};ug.StackLayouter=dC;dC.KIND="stack";ug.StackLayouter=dC=mue([(0,gue.injectable)()],dC);var xc={},bue=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(xc,"__esModule",{value:!0});xc.ShapeView=void 0;const Sue=F,Eue=De,Cue=$t;let p2=class{isVisible(e,t){if(t.targetKind==="hidden"||!Eue.Dimension.isValid(e.bounds))return!0;const i=(0,Cue.getAbsoluteBounds)(e),o=e.root.canvasBounds;return i.x<=o.width&&i.x+i.width>=0&&i.y<=o.height&&i.y+i.height>=0}};xc.ShapeView=p2;xc.ShapeView=p2=bue([(0,Sue.injectable)()],p2);var ps={},Pue=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},wue=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},u$=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(ps,"__esModule",{value:!0});ps.configureButtonHandler=ps.ButtonHandlerRegistry=void 0;const nD=F,Aue=pn,BG=me,Rue=wa;let m2=class extends Aue.InstanceRegistry{constructor(e){super(),e.forEach(t=>this.register(t.TYPE,t.factory()))}};ps.ButtonHandlerRegistry=m2;ps.ButtonHandlerRegistry=m2=Pue([(0,nD.injectable)(),u$(0,(0,nD.multiInject)(BG.TYPES.IButtonHandlerRegistration)),u$(0,(0,nD.optional)()),wue("design:paramtypes",[Array])],m2);function Mue(n,e,t){if(typeof t=="function"){if(!(0,Rue.isInjectable)(t))throw new Error(`Button handlers should be @injectable: ${t.name}`);n.isBound(t)||n.bind(t).toSelf()}n.bind(BG.TYPES.IButtonHandlerRegistration).toDynamicValue(i=>({TYPE:e,factory:()=>i.container.get(t)}))}ps.configureButtonHandler=Mue;var lg={},Of={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isFadeable=n.fadeFeature=void 0,n.fadeFeature=Symbol("fadeFeature");function e(t){return t.hasFeature(n.fadeFeature)&&t.opacity!==void 0}n.isFadeable=e})(Of);Object.defineProperty(lg,"__esModule",{value:!0});lg.SButtonImpl=void 0;const g2=$t,Iue=Of;class $G extends g2.SShapeElementImpl{constructor(){super(...arguments),this.enabled=!0}}lg.SButtonImpl=$G;$G.DEFAULT_FEATURES=[g2.boundsFeature,g2.layoutableChildFeature,Iue.fadeFeature];var ms={},vA={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.name=n.isNameable=n.nameFeature=void 0,n.nameFeature=Symbol("nameableFeature");function e(i){return i.hasFeature(n.nameFeature)}n.isNameable=e;function t(i){if(e(i))return i.name}n.name=t})(vA);var kG=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},FG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},v2=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(ms,"__esModule",{value:!0});ms.RevealNamedElementActionProvider=ms.CommandPaletteActionProviderRegistry=void 0;const u_=F,iD=se,l$=Jd,xG=me,Due=Mo,f$=vA;let _2=class{constructor(e=[]){this.actionProviders=e}getActions(e,t,i,o){const r=this.actionProviders.map(s=>s.getActions(e,t,i,o));return Promise.all(r).then(s=>s.reduce((a,f)=>f!==void 0?a.concat(f):a))}};ms.CommandPaletteActionProviderRegistry=_2;ms.CommandPaletteActionProviderRegistry=_2=kG([(0,u_.injectable)(),v2(0,(0,u_.multiInject)(xG.TYPES.ICommandPaletteActionProvider)),v2(0,(0,u_.optional)()),FG("design:paramtypes",[Array])],_2);let y2=class{constructor(e){this.logger=e}getActions(e,t,i,o){return o!==void 0&&o%2===0?Promise.resolve(this.createSelectActions(e)):Promise.resolve([new l$.LabeledAction("Select all",[iD.SelectAllAction.create()])])}createSelectActions(e){return(0,Due.toArray)(e.index.all().filter(i=>(0,f$.isNameable)(i))).map(i=>new l$.LabeledAction(`Reveal ${(0,f$.name)(i)}`,[iD.SelectAction.create({selectedElementsIDs:[i.id]}),iD.CenterAction.create([i.id])],"eye"))}};ms.RevealNamedElementActionProvider=y2;ms.RevealNamedElementActionProvider=y2=kG([(0,u_.injectable)(),v2(0,(0,u_.inject)(xG.TYPES.ILogger)),FG("design:paramtypes",[Object])],y2);var uc={},_A={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.codiconCSSClasses=n.codiconCSSString=n.ANIMATION_SPIN=n.ACTION_ITEM=void 0,n.ACTION_ITEM="action-item",n.ANIMATION_SPIN="animation-spin";function e(i,o=!1,r=!1,s=[]){return t(i,o,r,s).join(" ")}n.codiconCSSString=e;function t(i,o=!1,r=!1,s=[]){const a=["codicon",`codicon-${i}`];return o&&a.push(n.ACTION_ITEM),r&&a.push(n.ANIMATION_SPIN),s.length>0&&a.push(...s),a}n.codiconCSSClasses=t})(_A);var qt={};Object.defineProperty(qt,"__esModule",{value:!0});qt.getActualCode=zi=qt.matchesKeystroke=void 0;const Tue=sn;function Oue(n,e,...t){if(HG(n)!==e)return!1;if((0,Tue.isMac)()){if(n.ctrlKey!==t.findIndex(i=>i==="ctrl")>=0||n.metaKey!==t.findIndex(i=>i==="meta"||i==="ctrlCmd")>=0)return!1}else if(n.ctrlKey!==t.findIndex(i=>i==="ctrl"||i==="ctrlCmd")>=0||n.metaKey!==t.findIndex(i=>i==="meta")>=0)return!1;return!(n.altKey!==t.findIndex(i=>i==="alt")>=0||n.shiftKey!==t.findIndex(i=>i==="shift")>=0)}var zi=qt.matchesKeystroke=Oue;function HG(n){if(n.keyCode){const e=b2[n.keyCode];if(e!==void 0)return e}return n.code}qt.getActualCode=HG;const b2=new Array(256);(()=>{function n(e,t){b2[t]===void 0&&(b2[t]=e)}n("Pause",3),n("Backspace",8),n("Tab",9),n("Enter",13),n("ShiftLeft",16),n("ShiftRight",16),n("ControlLeft",17),n("ControlRight",17),n("AltLeft",18),n("AltRight",18),n("CapsLock",20),n("Escape",27),n("Space",32),n("PageUp",33),n("PageDown",34),n("End",35),n("Home",36),n("ArrowLeft",37),n("ArrowUp",38),n("ArrowRight",39),n("ArrowDown",40),n("Insert",45),n("Delete",46),n("Digit1",49),n("Digit2",50),n("Digit3",51),n("Digit4",52),n("Digit5",53),n("Digit6",54),n("Digit7",55),n("Digit8",56),n("Digit9",57),n("Digit0",48),n("KeyA",65),n("KeyB",66),n("KeyC",67),n("KeyD",68),n("KeyE",69),n("KeyF",70),n("KeyG",71),n("KeyH",72),n("KeyI",73),n("KeyJ",74),n("KeyK",75),n("KeyL",76),n("KeyM",77),n("KeyN",78),n("KeyO",79),n("KeyP",80),n("KeyQ",81),n("KeyR",82),n("KeyS",83),n("KeyT",84),n("KeyU",85),n("KeyV",86),n("KeyW",87),n("KeyX",88),n("KeyY",89),n("KeyZ",90),n("OSLeft",91),n("MetaLeft",91),n("OSRight",92),n("MetaRight",92),n("ContextMenu",93),n("Numpad0",96),n("Numpad1",97),n("Numpad2",98),n("Numpad3",99),n("Numpad4",100),n("Numpad5",101),n("Numpad6",102),n("Numpad7",103),n("Numpad8",104),n("Numpad9",105),n("NumpadMultiply",106),n("NumpadAdd",107),n("NumpadSeparator",108),n("NumpadSubtract",109),n("NumpadDecimal",110),n("NumpadDivide",111),n("F1",112),n("F2",113),n("F3",114),n("F4",115),n("F5",116),n("F6",117),n("F7",118),n("F8",119),n("F9",120),n("F10",121),n("F11",122),n("F12",123),n("F13",124),n("F14",125),n("F15",126),n("F16",127),n("F17",128),n("F18",129),n("F19",130),n("F20",131),n("F21",132),n("F22",133),n("F23",134),n("F24",135),n("NumLock",144),n("ScrollLock",145),n("Semicolon",186),n("Equal",187),n("Comma",188),n("Minus",189),n("Period",190),n("Slash",191),n("Backquote",192),n("IntlRo",193),n("BracketLeft",219),n("Backslash",220),n("BracketRight",221),n("Quote",222),n("IntlYen",255)})();var to={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSelected=n.isSelectable=n.selectFeature=void 0,n.selectFeature=Symbol("selectFeature");function e(i){return i.hasFeature(n.selectFeature)}n.isSelectable=e;function t(i){return i!==void 0&&e(i)&&i.selected}n.isSelected=t})(to);var KG={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(l,function(){function t(i){var o=document,r=i.container||o.createElement("div"),s=i.preventSubmit||0;r.id=r.id||"autocomplete-"+b();var a=r.style,f=i.debounceWaitMs||0,h=i.disableAutoSelect||!1,g=r.parentElement,y=[],S="",P=2,w=i.showOnFocus,C,E=0,D,j=!1,U=!1;if(i.minLength!==void 0&&(P=i.minLength),!i.input)throw new Error("input undefined");var p=i.input;r.className=[r.className,"autocomplete",i.className||""].join(" ").trim(),r.setAttribute("role","listbox"),p.setAttribute("role","combobox"),p.setAttribute("aria-expanded","false"),p.setAttribute("aria-autocomplete","list"),p.setAttribute("aria-controls",r.id),p.setAttribute("aria-owns",r.id),p.setAttribute("aria-activedescendant",""),p.setAttribute("aria-haspopup","listbox"),a.position="absolute";function b(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function v(){var he=r.parentNode;he&&he.removeChild(r)}function R(){D&&window.clearTimeout(D)}function O(){r.parentNode||(g||o.body).appendChild(r)}function N(){return!!r.parentNode}function T(){E++,y=[],S="",C=void 0,p.setAttribute("aria-activedescendant",""),p.setAttribute("aria-expanded","false"),v()}function $(){if(!N())return;p.setAttribute("aria-expanded","true"),a.height="auto",a.width=p.offsetWidth+"px";var he=0,Ne;function en(){var xt=o.documentElement,Rn=xt.clientTop||o.body.clientTop||0,gn=xt.clientLeft||o.body.clientLeft||0,oi=window.pageYOffset||xt.scrollTop,_t=window.pageXOffset||xt.scrollLeft;Ne=p.getBoundingClientRect();var Zt=Ne.top+p.offsetHeight+oi-Rn,bi=Ne.left+_t-gn;a.top=Zt+"px",a.left=bi+"px",he=window.innerHeight-(Ne.top+p.offsetHeight),he<0&&(he=0),a.top=Zt+"px",a.bottom="",a.left=bi+"px",a.maxHeight=he+"px"}en(),en(),i.customize&&Ne&&i.customize(p,Ne,r,he)}function Q(){r.textContent="",p.setAttribute("aria-activedescendant","");var he=function(gn,oi,_t){var Zt=o.createElement("div");return Zt.textContent=gn.label||"",Zt};i.render&&(he=i.render);var Ne=function(gn,oi){var _t=o.createElement("div");return _t.textContent=gn,_t};i.renderGroup&&(Ne=i.renderGroup);var en=o.createDocumentFragment(),xt=b();if(y.forEach(function(gn,oi){if(gn.group&&gn.group!==xt){xt=gn.group;var _t=Ne(gn.group,S);_t&&(_t.className+=" group",en.appendChild(_t))}var Zt=he(gn,S,oi);Zt&&(Zt.id=r.id+"_"+oi,Zt.setAttribute("role","option"),Zt.addEventListener("click",function(bi){U=!0;try{i.onSelect(gn,p)}finally{U=!1}T(),bi.preventDefault(),bi.stopPropagation()}),gn===C&&(Zt.className+=" selected",Zt.setAttribute("aria-selected","true"),p.setAttribute("aria-activedescendant",Zt.id)),en.appendChild(Zt))}),r.appendChild(en),y.length<1)if(i.emptyMsg){var Rn=o.createElement("div");Rn.id=r.id+"_"+b(),Rn.className="empty",Rn.textContent=i.emptyMsg,r.appendChild(Rn),p.setAttribute("aria-activedescendant",Rn.id)}else{T();return}O(),$(),Y()}function K(){N()&&Q()}function Z(){K()}function H(he){he.target!==r?K():he.preventDefault()}function M(){U||Ot(0)}function Y(){var he=r.getElementsByClassName("selected");if(he.length>0){var Ne=he[0],en=Ne.previousElementSibling;if(en&&en.className.indexOf("group")!==-1&&!en.previousElementSibling&&(Ne=en),Ne.offsetTop<r.scrollTop)r.scrollTop=Ne.offsetTop;else{var xt=Ne.offsetTop+Ne.offsetHeight,Rn=r.scrollTop+r.offsetHeight;xt>Rn&&(r.scrollTop+=xt-Rn)}}}function te(){var he=y.indexOf(C);C=he===-1?void 0:y[(he+y.length-1)%y.length],Re(he)}function ue(){var he=y.indexOf(C);C=y.length<1?void 0:he===-1?y[0]:y[(he+1)%y.length],Re(he)}function Re(he){y.length>0&&(ot(he),ae(y.indexOf(C)),Y())}function ae(he){var Ne=o.getElementById(r.id+"_"+he);Ne&&(Ne.classList.add("selected"),Ne.setAttribute("aria-selected","true"),p.setAttribute("aria-activedescendant",Ne.id))}function ot(he){var Ne=o.getElementById(r.id+"_"+he);Ne&&(Ne.classList.remove("selected"),Ne.removeAttribute("aria-selected"),p.removeAttribute("aria-activedescendant"))}function Ft(he,Ne){var en=N();if(Ne==="Escape")T();else{if(!en||y.length<1)return;Ne==="ArrowUp"?te():ue()}he.preventDefault(),en&&he.stopPropagation()}function et(he){if(C){s===2&&he.preventDefault(),U=!0;try{i.onSelect(C,p)}finally{U=!1}T()}s===1&&he.preventDefault()}function ht(he){var Ne=he.key;switch(Ne){case"ArrowUp":case"ArrowDown":case"Escape":Ft(he,Ne);break;case"Enter":et(he);break}}function wt(){w&&Ot(1)}function Ot(he){p.value.length>=P||he===1?(R(),D=window.setTimeout(function(){return vt(p.value,he,p.selectionStart||0)},he===0||he===2?f:0)):T()}function vt(he,Ne,en){if(!j){var xt=++E;i.fetch(he,function(Rn){E===xt&&Rn&&(y=Rn,S=he,C=y.length<1||h?void 0:y[0],Q())},Ne,en)}}function At(he){if(i.keyup){i.keyup({event:he,fetch:function(){return Ot(0)}});return}!N()&&he.key==="ArrowDown"&&Ot(0)}function yi(he){i.click&&i.click({event:he,fetch:function(){return Ot(2)}})}function Wt(){setTimeout(function(){o.activeElement!==p&&T()},200)}function Ze(){vt(p.value,3,p.selectionStart||0)}r.addEventListener("mousedown",function(he){he.stopPropagation(),he.preventDefault()}),r.addEventListener("focus",function(){return p.focus()}),v();function ii(){p.removeEventListener("focus",wt),p.removeEventListener("keyup",At),p.removeEventListener("click",yi),p.removeEventListener("keydown",ht),p.removeEventListener("input",M),p.removeEventListener("blur",Wt),window.removeEventListener("resize",Z),o.removeEventListener("scroll",H,!0),p.removeAttribute("role"),p.removeAttribute("aria-expanded"),p.removeAttribute("aria-autocomplete"),p.removeAttribute("aria-controls"),p.removeAttribute("aria-activedescendant"),p.removeAttribute("aria-owns"),p.removeAttribute("aria-haspopup"),R(),T(),j=!0}return p.addEventListener("keyup",At),p.addEventListener("click",yi),p.addEventListener("keydown",ht),p.addEventListener("input",M),p.addEventListener("blur",Wt),p.addEventListener("focus",wt),window.addEventListener("resize",Z),o.addEventListener("scroll",H,!0),{destroy:ii,fetch:Ze}}return t})})(KG);var VG=KG.exports,fg=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},C0=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Lue=l&&l.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},r3;Object.defineProperty(uc,"__esModule",{value:!0});uc.CommandPaletteKeyListener=uc.CommandPalette=void 0;const hg=F,Nue=se,jue=Jd,yA=me,Bue=sa,h$=Co,$ue=Aa,kue=gi,p$=_A,S2=Mo,t7=qt,m$=$t,zG=to,Fue=ms,g$=Ut,xue=Lue(VG);let Zo=r3=class extends Bue.AbstractUIExtension{constructor(){super(...arguments),this.loadingIndicatorClasses=(0,p$.codiconCSSClasses)("loading",!1,!0,["loading"]),this.xOffset=20,this.yOffset=20,this.defaultWidth=400,this.debounceWaitMs=100,this.noCommandsMsg="No commands available",this.paletteIndex=0}id(){return r3.ID}containerClass(){return"command-palette"}show(e,...t){super.show(e,...t),this.paletteIndex=0,this.contextActions=void 0,this.inputElement.value="",this.autoCompleteResult=(0,xue.default)(this.autocompleteSettings(e)),this.inputElement.focus()}initializeContents(e){e.style.position="absolute",this.inputElement=document.createElement("input"),this.inputElement.style.width="100%",this.inputElement.addEventListener("keydown",t=>this.hideIfEscapeEvent(t)),this.inputElement.addEventListener("keydown",t=>this.cylceIfInvokePaletteKey(t)),this.inputElement.onblur=()=>window.setTimeout(()=>this.hide(),200),e.appendChild(this.inputElement)}hideIfEscapeEvent(e){(0,t7.matchesKeystroke)(e,"Escape")&&this.hide()}cylceIfInvokePaletteKey(e){r3.isInvokePaletteKey(e)&&this.cycle()}cycle(){this.contextActions=void 0,this.paletteIndex++}onBeforeShow(e,t,...i){let o=this.xOffset,r=this.yOffset;const s=(0,S2.toArray)(t.index.all().filter(a=>(0,zG.isSelectable)(a)&&a.selected));if(s.length===1){const a=(0,m$.getAbsoluteClientBounds)(s[0],this.domHelper,this.viewerOptions);o+=a.x+a.width,r+=a.y}else{const a=(0,m$.getAbsoluteClientBounds)(t,this.domHelper,this.viewerOptions);o+=a.x,r+=a.y}e.style.left=`${o}px`,e.style.top=`${r}px`,e.style.width=`${this.defaultWidth}px`}autocompleteSettings(e){return{input:this.inputElement,emptyMsg:this.noCommandsMsg,className:"command-palette-suggestions",debounceWaitMs:this.debounceWaitMs,showOnFocus:!0,minLength:-1,fetch:(t,i)=>this.updateAutoCompleteActions(i,t,e),onSelect:t=>this.onSelect(t),render:(t,i)=>this.renderLabeledActionSuggestion(t,i),customize:(t,i,o,r)=>{this.customizeSuggestionContainer(o,i,r)}}}onSelect(e){this.executeAction(e),this.hide()}updateAutoCompleteActions(e,t,i){this.onLoading(),this.contextActions?(e(this.filterActions(t,this.contextActions)),this.onLoaded("success")):this.actionProviderRegistry.getActions(i,t,this.mousePositionTracker.lastPositionOnDiagram,this.paletteIndex).then(o=>{this.contextActions=o,e(this.filterActions(t,o)),this.onLoaded("success")}).catch(o=>{this.logger.error(this,"Failed to obtain actions from command palette action providers",o),this.onLoaded("error")})}onLoading(){this.loadingIndicator&&this.containerElement.contains(this.loadingIndicator)||(this.loadingIndicator=document.createElement("span"),this.loadingIndicator.classList.add(...this.loadingIndicatorClasses),this.containerElement.appendChild(this.loadingIndicator))}onLoaded(e){this.containerElement.contains(this.loadingIndicator)&&this.containerElement.removeChild(this.loadingIndicator)}renderLabeledActionSuggestion(e,t){const i=document.createElement("div"),o=Kue(t).split(" ").join("|"),r=new RegExp(o,"gi");return e.icon&&this.renderIcon(i,e.icon),t.length>0?i.innerHTML+=e.label.replace(r,s=>"<em>"+s+"</em>").replace(/ /g,"&nbsp;"):i.innerHTML+=e.label.replace(/ /g,"&nbsp;"),i}renderIcon(e,t){e.innerHTML+=`<span class="icon ${this.getCodicon(t)}"></span>`}getFontAwesomeIcon(e){return`fa fa-${e}`}getCodicon(e){return(0,p$.codiconCSSString)(e)}filterActions(e,t){return(0,S2.toArray)(t.filter(i=>{const o=i.label.toLowerCase();return e.split(" ").every(s=>o.indexOf(s.toLowerCase())!==-1)}))}customizeSuggestionContainer(e,t,i){e.style.position="fixed",this.containerElement&&this.containerElement.appendChild(e)}hide(){super.hide(),this.autoCompleteResult&&this.autoCompleteResult.destroy()}executeAction(e){this.actionDispatcherProvider().then(t=>t.dispatchAll(Hue(e))).catch(t=>this.logger.error(this,"No action dispatcher available to execute command palette action",t))}};uc.CommandPalette=Zo;Zo.ID="command-palette";Zo.isInvokePaletteKey=n=>(0,t7.matchesKeystroke)(n,"Space","ctrl");fg([(0,hg.inject)(yA.TYPES.IActionDispatcherProvider),C0("design:type",Function)],Zo.prototype,"actionDispatcherProvider",void 0);fg([(0,hg.inject)(yA.TYPES.ICommandPaletteActionProviderRegistry),C0("design:type",Fue.CommandPaletteActionProviderRegistry)],Zo.prototype,"actionProviderRegistry",void 0);fg([(0,hg.inject)(yA.TYPES.ViewerOptions),C0("design:type",Object)],Zo.prototype,"viewerOptions",void 0);fg([(0,hg.inject)(yA.TYPES.DOMHelper),C0("design:type",$ue.DOMHelper)],Zo.prototype,"domHelper",void 0);fg([(0,hg.inject)(g$.MousePositionTracker),C0("design:type",g$.MousePositionTracker)],Zo.prototype,"mousePositionTracker",void 0);uc.CommandPalette=Zo=r3=fg([(0,hg.injectable)()],Zo);function Hue(n){return(0,jue.isLabeledAction)(n)?n.actions:(0,Nue.isAction)(n)?[n]:[]}function Kue(n){return n.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}class Vue extends kue.KeyListener{keyDown(e,t){if((0,t7.matchesKeystroke)(t,"Escape"))return[h$.SetUIExtensionVisibilityAction.create({extensionId:Zo.ID,visible:!1,contextElementsId:[]})];if(Zo.isInvokePaletteKey(t)){const i=(0,S2.toArray)(e.index.all().filter(o=>(0,zG.isSelectable)(o)&&o.selected).map(o=>o.id));return[h$.SetUIExtensionVisibilityAction.create({extensionId:Zo.ID,visible:!0,contextElementsId:i})]}return[]}}uc.CommandPaletteKeyListener=Vue;var bA={};Object.defineProperty(bA,"__esModule",{value:!0});bA.toAnchor=void 0;function zue(n){return n instanceof HTMLElement?{x:n.offsetLeft,y:n.offsetTop}:n}bA.toAnchor=zue;var gs={},Lf={};(function(n){var e=l&&l.__decorate||function(S,P,w,C){var E=arguments.length,D=E<3?P:C===null?C=Object.getOwnPropertyDescriptor(P,w):C,j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(S,P,w,C);else for(var U=S.length-1;U>=0;U--)(j=S[U])&&(D=(E<3?j(D):E>3?j(P,w,D):j(P,w))||D);return E>3&&D&&Object.defineProperty(P,w,D),D},t=l&&l.__metadata||function(S,P){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(S,P)},i=l&&l.__param||function(S,P){return function(w,C){P(w,C,S)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DeleteElementCommand=n.ResolvedDelete=n.isDeletable=n.deletableFeature=void 0;const o=F,r=se,s=Ve,a=ke,f=me;n.deletableFeature=Symbol("deletableFeature");function h(S){return S instanceof a.SChildElementImpl&&S.hasFeature(n.deletableFeature)}n.isDeletable=h;class g{}n.ResolvedDelete=g;let y=class extends s.Command{constructor(P){super(),this.action=P,this.resolvedDeletes=[]}execute(P){const w=P.root.index;for(const C of this.action.elementIds){const E=w.getById(C);E&&h(E)&&(this.resolvedDeletes.push({child:E,parent:E.parent}),E.parent.remove(E))}return P.root}undo(P){for(const w of this.resolvedDeletes)w.parent.add(w.child);return P.root}redo(P){for(const w of this.resolvedDeletes)w.parent.remove(w.child);return P.root}};n.DeleteElementCommand=y,y.KIND=r.DeleteElementAction.KIND,n.DeleteElementCommand=y=e([(0,o.injectable)(),i(0,(0,o.inject)(f.TYPES.Action)),t("design:paramtypes",[Object])],y)})(Lf);var GG=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Gue=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},v$=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(gs,"__esModule",{value:!0});gs.DeleteContextMenuItemProvider=gs.ContextMenuProviderRegistry=void 0;const s3=F,Uue=me,Yue=Lf,que=to,Wue=kr;let E2=class{constructor(e=[]){this.menuProviders=e}getItems(e,t){const i=this.menuProviders.map(o=>o.getItems(e,t));return Promise.all(i).then(this.flattenAndRestructure)}flattenAndRestructure(e){let t=e.reduce((o,r)=>r!==void 0?o.concat(r):o,[]);const i=t.filter(o=>o.parentId);for(const o of i)if(o.parentId){const r=o.parentId.split(".");let s,a=t;for(const f of r)s=a.find(h=>f===h.id),s&&s.children&&(a=s.children);s&&(s.children?s.children.push(o):s.children=[o],t=t.filter(f=>f!==o))}return t}};gs.ContextMenuProviderRegistry=E2;gs.ContextMenuProviderRegistry=E2=GG([(0,s3.injectable)(),v$(0,(0,s3.multiInject)(Uue.TYPES.IContextMenuItemProvider)),v$(0,(0,s3.optional)()),Gue("design:paramtypes",[Array])],E2);let C2=class{getItems(e,t){const i=Array.from(e.index.all().filter(que.isSelected).filter(Yue.isDeletable));return Promise.resolve([{id:"delete",label:"Delete",sortString:"d",group:"edit",actions:[Wue.DeleteElementAction.create(i.map(o=>o.id))],isEnabled:()=>i.length>0}])}};gs.DeleteContextMenuItemProvider=C2;gs.DeleteContextMenuItemProvider=C2=GG([(0,s3.injectable)()],C2);var Nf={},UG=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},YG=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},_$=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Nf,"__esModule",{value:!0});Nf.ContextMenuMouseListener=void 0;const P2=F,Zue=se,Que=yt,w2=me,Xue=Ut,lE=to,Jue=gs;let uC=class extends Xue.MouseListener{constructor(e,t){super(),this.contextMenuService=e,this.menuProvider=t}contextMenu(e,t){return this.showContextMenu(e,t),[]}async showContextMenu(e,t){let i;try{i=await this.contextMenuService()}catch{return}let o=!1;const r=(0,Que.findParentByFeature)(e,lE.isSelectable);r&&(o=r.selected,r.selected=!0);const s=e.root,a={x:t.x,y:t.y};if(e.id===s.id||(0,lE.isSelected)(r)){const f=await this.menuProvider.getItems(s,a),h=()=>{r&&(r.selected=o)};i.show(f,a,h)}else{if((0,lE.isSelectable)(e)){const h={selectedElementsIDs:[e.id],deselectedElementsIDs:Array.from(s.index.all().filter(lE.isSelected),g=>g.id)};await this.actionDispatcher.dispatch(Zue.SelectAction.create(h))}const f=await this.menuProvider.getItems(s,a);i.show(f,a)}}};Nf.ContextMenuMouseListener=uC;UG([(0,P2.inject)(w2.TYPES.IActionDispatcher),YG("design:type",Object)],uC.prototype,"actionDispatcher",void 0);Nf.ContextMenuMouseListener=uC=UG([_$(0,(0,P2.inject)(w2.TYPES.IContextMenuServiceProvider)),_$(1,(0,P2.inject)(w2.TYPES.IContextMenuProviderRegistry)),YG("design:paramtypes",[Function,Jue.ContextMenuProviderRegistry])],uC);var Kl={},jf={},Sn={},Bf={},an={},$u={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hasPopupFeature=n.popupFeature=n.isHoverable=n.hoverFeedbackFeature=void 0,n.hoverFeedbackFeature=Symbol("hoverFeedbackFeature");function e(i){return i.hasFeature(n.hoverFeedbackFeature)}n.isHoverable=e,n.popupFeature=Symbol("popupFeature");function t(i){return i.hasFeature(n.popupFeature)}n.hasPopupFeature=t})($u);var Hc={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isMoveable=n.isLocateable=n.moveFeature=void 0;const e=Xi;n.moveFeature=Symbol("moveFeature");function t(o){return(0,e.hasOwnProperty)(o,"position")}n.isLocateable=t;function i(o){return o.hasFeature(n.moveFeature)&&t(o)}n.isMoveable=i})(Hc);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.edgeInProgressTargetHandleID=n.edgeInProgressID=n.SDanglingAnchorImpl=n.SRoutingHandleImpl=n.SConnectableElementImpl=n.getRouteBounds=n.getAbsoluteRouteBounds=n.isConnectable=n.connectableFeature=n.SRoutableElementImpl=void 0;const e=De,t=ke,i=$t,o=Lf,r=to,s=$u,a=Hc;class f extends t.SChildElementImpl{constructor(){super(...arguments),this.routingPoints=[]}get source(){return this.index.getById(this.sourceId)}get target(){return this.index.getById(this.targetId)}get bounds(){return this.routingPoints.reduce((E,D)=>e.Bounds.combine(E,{x:D.x,y:D.y,width:0,height:0}),e.Bounds.EMPTY)}}n.SRoutableElementImpl=f,n.connectableFeature=Symbol("connectableFeature");function h(C){return C.hasFeature(n.connectableFeature)&&C.canConnect}n.isConnectable=h;function g(C,E=C.routingPoints){let D=y(E),j=C;for(;j instanceof t.SChildElementImpl;){const U=j.parent;D=U.localToParent(D),j=U}return D}n.getAbsoluteRouteBounds=g;function y(C){const E={x:NaN,y:NaN,width:0,height:0};for(const D of C)isNaN(E.x)?(E.x=D.x,E.y=D.y):(D.x<E.x?(E.width+=E.x-D.x,E.x=D.x):D.x>E.x+E.width&&(E.width=D.x-E.x),D.y<E.y?(E.height+=E.y-D.y,E.y=D.y):D.y>E.y+E.height&&(E.height=D.y-E.y));return E}n.getRouteBounds=y;class S extends i.SShapeElementImpl{constructor(){super(...arguments),this.strokeWidth=0}get anchorKind(){}get incomingEdges(){return this.index.all().filter(D=>D instanceof f).filter(D=>D.targetId===this.id)}get outgoingEdges(){return this.index.all().filter(D=>D instanceof f).filter(D=>D.sourceId===this.id)}canConnect(E,D){return!0}}n.SConnectableElementImpl=S;class P extends t.SChildElementImpl{constructor(){super(...arguments),this.editMode=!1,this.hoverFeedback=!1,this.selected=!1}hasFeature(E){return P.DEFAULT_FEATURES.indexOf(E)!==-1}}n.SRoutingHandleImpl=P,P.DEFAULT_FEATURES=[r.selectFeature,a.moveFeature,s.hoverFeedbackFeature];class w extends S{constructor(){super(),this.type="dangling-anchor",this.size={width:0,height:0}}}n.SDanglingAnchorImpl=w,w.DEFAULT_FEATURES=[o.deletableFeature],n.edgeInProgressID="edge-in-progress",n.edgeInProgressTargetHandleID=n.edgeInProgressID+"-target-anchor"})(an);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_EDGE_PLACEMENT=n.EdgePlacement=n.checkEdgePlacement=n.isEdgeLayoutable=n.edgeLayoutFeature=void 0;const e=ke,t=$t,i=an;n.edgeLayoutFeature=Symbol("edgeLayout");function o(a){return a instanceof e.SChildElementImpl&&a.parent instanceof i.SRoutableElementImpl&&(0,t.isBoundsAware)(a)&&a.hasFeature(n.edgeLayoutFeature)}n.isEdgeLayoutable=o;function r(a){return"edgePlacement"in a}n.checkEdgePlacement=r;class s extends Object{}n.EdgePlacement=s,n.DEFAULT_EDGE_PLACEMENT={rotate:!0,side:"top",position:.5,offset:7,moveMode:"edge"}})(Bf);var $f={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isWithEditableLabel=n.withEditLabelFeature=n.isEditableLabel=n.editLabelFeature=n.canEditRouting=n.editFeature=void 0;const e=an;n.editFeature=Symbol("editFeature");function t(r){return r instanceof e.SRoutableElementImpl&&r.hasFeature(n.editFeature)}n.canEditRouting=t,n.editLabelFeature=Symbol("editLabelFeature");function i(r){return"text"in r&&r.hasFeature(n.editLabelFeature)}n.isEditableLabel=i,n.withEditLabelFeature=Symbol("withEditLabelFeature");function o(r){return"editableLabel"in r&&r.hasFeature(n.withEditLabelFeature)}n.isWithEditableLabel=o})($f);var kf={},Rs={},Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.limit=Jn.intersection=Jn.PointToPointLine=Jn.Diamond=void 0;const rp=kr;class ele{constructor(e){this.bounds=e}get topPoint(){return{x:this.bounds.x+this.bounds.width/2,y:this.bounds.y}}get rightPoint(){return{x:this.bounds.x+this.bounds.width,y:this.bounds.y+this.bounds.height/2}}get bottomPoint(){return{x:this.bounds.x+this.bounds.width/2,y:this.bounds.y+this.bounds.height}}get leftPoint(){return{x:this.bounds.x,y:this.bounds.y+this.bounds.height/2}}get topRightSideLine(){return new Gv(this.topPoint,this.rightPoint)}get topLeftSideLine(){return new Gv(this.topPoint,this.leftPoint)}get bottomRightSideLine(){return new Gv(this.bottomPoint,this.rightPoint)}get bottomLeftSideLine(){return new Gv(this.bottomPoint,this.leftPoint)}closestSideLine(e){const t=rp.Bounds.center(this.bounds);return e.x>t.x?e.y>t.y?this.bottomRightSideLine:this.topRightSideLine:e.y>t.y?this.bottomLeftSideLine:this.topLeftSideLine}}Jn.Diamond=ele;class Gv{constructor(e,t){this.p1=e,this.p2=t}get a(){return this.p1.y-this.p2.y}get b(){return this.p2.x-this.p1.x}get c(){return this.p2.x*this.p1.y-this.p1.x*this.p2.y}get angle(){return Math.atan2(-this.a,this.b)}get slope(){if(this.b!==0)return this.a/this.b}get slopeOrMax(){return this.slope===void 0?Number.MAX_SAFE_INTEGER:this.slope}get direction(){const e=(0,rp.toDegrees)(this.angle),t=e<0?360+e:e;if(t===90)return"south";if(t===0||t===360)return"east";if(t===270)return"north";if(t===180)return"west";if(t>0&&t<90)return"south-east";if(t>90&&t<180)return"south-west";if(t>180&&t<270)return"north-west";if(t>270&&t<360)return"north-east";throw new Error(`Cannot determine direction of line (${this.p1.x},${this.p1.y}) to (${this.p2.x},${this.p2.y})`)}intersection(e){if(this.hasIndistinctPoints(e))return;const t=this.p1.x,i=this.p1.y,o=this.p2.x,r=this.p2.y,s=e.p1.x,a=e.p1.y,f=e.p2.x,h=e.p2.y,g=(h-a)*(o-t)-(f-s)*(r-i);if(g===0)return;const y=(f-s)*(i-a)-(h-a)*(t-s),S=(o-t)*(i-a)-(r-i)*(t-s);if(y===0&&S===0)return;const P=y/g,w=S/g;if(P<0||P>1||w<0||w>1)return;const C=t+P*(o-t),E=i+P*(r-i);return{x:C,y:E}}hasIndistinctPoints(e){return rp.Point.equals(this.p1,e.p1)||rp.Point.equals(this.p1,e.p2)||rp.Point.equals(this.p2,e.p1)||rp.Point.equals(this.p2,e.p2)}}Jn.PointToPointLine=Gv;function tle(n,e){return{x:(n.c*e.b-e.c*n.b)/(n.a*e.b-e.a*n.b),y:(n.a*e.c-e.a*n.c)/(n.a*e.b-e.a*n.b)}}Jn.intersection=tle;function nle(n,e){return n<e.min?e.min:n>e.max?e.max:n}Jn.limit=nle;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.limitViewport=n.isViewport=n.viewportFeature=void 0;const e=kr,t=ke,i=Jn;n.viewportFeature=Symbol("viewportFeature");function o(s){return s instanceof t.SModelRootImpl&&s.hasFeature(n.viewportFeature)&&"zoom"in s&&"scroll"in s}n.isViewport=o;function r(s,a,f,h,g){a&&!e.Dimension.isValid(a)&&(a=void 0);let y=g?(0,i.limit)(s.zoom,g):s.zoom;if(a&&f){const w=a.width/(f.max-f.min);y<w&&(y=w)}if(a&&h){const w=a.height/(h.max-h.min);y<w&&(y=w)}let S;if(f){const w=f.min,C=a?f.max-a.width/y:f.max;S=(0,i.limit)(s.scroll.x,{min:w,max:C})}else S=s.scroll.x;let P;if(h){const w=h.min,C=a?h.max-a.height/y:h.max;P=(0,i.limit)(s.scroll.y,{min:w,max:C})}else P=s.scroll.y;return{scroll:{x:S,y:P},zoom:y}}n.limitViewport=r})(Rs);var P0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isExportable=n.exportFeature=void 0,n.exportFeature=Symbol("exportFeature");function e(t){return t.hasFeature(n.exportFeature)}n.isExportable=e})(P0);Object.defineProperty(kf,"__esModule",{value:!0});kf.ViewportRootElementImpl=void 0;const lv=De,ile=ke,ole=Rs,rle=P0;class qG extends ile.SModelRootImpl{constructor(e){super(e),this.scroll={x:0,y:0},this.zoom=1,this.position=lv.Point.ORIGIN,this.size=lv.Dimension.EMPTY}get bounds(){return{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}}set bounds(e){this.position={x:e.x,y:e.y},this.size={width:e.width,height:e.height}}localToParent(e){const t={x:(e.x-this.scroll.x)*this.zoom,y:(e.y-this.scroll.y)*this.zoom,width:-1,height:-1};return(0,lv.isBounds)(e)&&(t.width=e.width*this.zoom,t.height=e.height*this.zoom),t}parentToLocal(e){const t={x:e.x/this.zoom+this.scroll.x,y:e.y/this.zoom+this.scroll.y,width:-1,height:-1};return(0,lv.isBounds)(e)&&lv.Dimension.isValid(e)&&(t.width=e.width/this.zoom,t.height=e.height/this.zoom),t}}kf.ViewportRootElementImpl=qG;qG.DEFAULT_FEATURES=[ole.viewportFeature,rle.exportFeature];Object.defineProperty(Sn,"__esModule",{value:!0});Sn.SGraphIndex=Sn.SCompartmentImpl=Sn.SLabelImpl=Sn.SEdgeImpl=Sn.SPortImpl=Sn.SNodeImpl=Sn.SGraphImpl=void 0;const sle=De,ale=ke,rs=$t,cle=Bf,WG=Lf,dle=$f,w0=Of,lC=$u,ule=Hc,A0=an,n7=to,lle=kf,fle=Mo;class hle extends lle.ViewportRootElementImpl{constructor(e=new Vp){super(e)}}Sn.SGraphImpl=hle;class ZG extends A0.SConnectableElementImpl{constructor(){super(...arguments),this.selected=!1,this.hoverFeedback=!1,this.opacity=1}canConnect(e,t){return this.children.find(i=>i instanceof i7)===void 0}get incomingEdges(){const e=this.index;return e instanceof Vp?e.getIncomingEdges(this):this.index.all().filter(i=>i instanceof nu).filter(i=>i.targetId===this.id)}get outgoingEdges(){const e=this.index;return e instanceof Vp?e.getOutgoingEdges(this):this.index.all().filter(i=>i instanceof nu).filter(i=>i.sourceId===this.id)}}Sn.SNodeImpl=ZG;ZG.DEFAULT_FEATURES=[A0.connectableFeature,WG.deletableFeature,n7.selectFeature,rs.boundsFeature,ule.moveFeature,rs.layoutContainerFeature,w0.fadeFeature,lC.hoverFeedbackFeature,lC.popupFeature];class i7 extends A0.SConnectableElementImpl{constructor(){super(...arguments),this.selected=!1,this.hoverFeedback=!1,this.opacity=1}get incomingEdges(){const e=this.index;return e instanceof Vp?e.getIncomingEdges(this):super.incomingEdges.filter(t=>t instanceof nu)}get outgoingEdges(){const e=this.index;return e instanceof Vp?e.getOutgoingEdges(this):super.outgoingEdges.filter(t=>t instanceof nu)}}Sn.SPortImpl=i7;i7.DEFAULT_FEATURES=[A0.connectableFeature,n7.selectFeature,rs.boundsFeature,w0.fadeFeature,lC.hoverFeedbackFeature];class nu extends A0.SRoutableElementImpl{constructor(){super(...arguments),this.selected=!1,this.hoverFeedback=!1,this.opacity=1}}Sn.SEdgeImpl=nu;nu.DEFAULT_FEATURES=[dle.editFeature,WG.deletableFeature,n7.selectFeature,w0.fadeFeature,lC.hoverFeedbackFeature];class QG extends rs.SShapeElementImpl{constructor(){super(...arguments),this.selected=!1,this.alignment=sle.Point.ORIGIN,this.opacity=1}}Sn.SLabelImpl=QG;QG.DEFAULT_FEATURES=[rs.boundsFeature,rs.alignFeature,rs.layoutableChildFeature,cle.edgeLayoutFeature,w0.fadeFeature];class XG extends rs.SShapeElementImpl{constructor(){super(...arguments),this.opacity=1}}Sn.SCompartmentImpl=XG;XG.DEFAULT_FEATURES=[rs.boundsFeature,rs.layoutContainerFeature,rs.layoutableChildFeature,w0.fadeFeature];class Vp extends ale.ModelIndexImpl{constructor(){super(...arguments),this.outgoing=new Map,this.incoming=new Map}add(e){if(super.add(e),e instanceof nu){if(e.sourceId){const t=this.outgoing.get(e.sourceId);t===void 0?this.outgoing.set(e.sourceId,[e]):t.push(e)}if(e.targetId){const t=this.incoming.get(e.targetId);t===void 0?this.incoming.set(e.targetId,[e]):t.push(e)}}}remove(e){if(super.remove(e),e instanceof nu){const t=this.outgoing.get(e.sourceId);if(t!==void 0){const o=t.indexOf(e);o>=0&&(t.length===1?this.outgoing.delete(e.sourceId):t.splice(o,1))}const i=this.incoming.get(e.targetId);if(i!==void 0){const o=i.indexOf(e);o>=0&&(i.length===1?this.incoming.delete(e.targetId):i.splice(o,1))}}}getAttachedElements(e){return new fle.FluentIterableImpl(()=>({outgoing:this.outgoing.get(e.id),incoming:this.incoming.get(e.id),nextOutgoingIndex:0,nextIncomingIndex:0}),t=>{let i=t.nextOutgoingIndex;if(t.outgoing!==void 0&&i<t.outgoing.length)return t.nextOutgoingIndex=i+1,{done:!1,value:t.outgoing[i]};if(i=t.nextIncomingIndex,t.incoming!==void 0)for(;i<t.incoming.length;){const o=t.incoming[i];if(o.sourceId!==o.targetId)return t.nextIncomingIndex=i+1,{done:!1,value:o};i++}return{done:!0,value:void 0}})}getIncomingEdges(e){return this.incoming.get(e.id)||[]}getOutgoingEdges(e){return this.outgoing.get(e.id)||[]}}Sn.SGraphIndex=Vp;var vi={},Kc={},Ra={};(function(n){var e=l&&l.__decorate||function(f,h,g,y){var S=arguments.length,P=S<3?h:y===null?y=Object.getOwnPropertyDescriptor(h,g):y,w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(f,h,g,y);else for(var C=f.length-1;C>=0;C--)(w=f[C])&&(P=(S<3?w(P):S>3?w(h,g,P):w(h,g))||P);return S>3&&P&&Object.defineProperty(h,g,P),P},t=l&&l.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)},i=l&&l.__param||function(f,h){return function(g,y){h(g,y,f)}};Object.defineProperty(n,"__esModule",{value:!0}),n.AnchorComputerRegistry=n.RECTANGULAR_ANCHOR_KIND=n.ELLIPTIC_ANCHOR_KIND=n.DIAMOND_ANCHOR_KIND=void 0;const o=F,r=me,s=pn;n.DIAMOND_ANCHOR_KIND="diamond",n.ELLIPTIC_ANCHOR_KIND="elliptic",n.RECTANGULAR_ANCHOR_KIND="rectangular";let a=class extends s.InstanceRegistry{constructor(h){super(),h.forEach(g=>this.register(g.kind,g))}get defaultAnchorKind(){return n.RECTANGULAR_ANCHOR_KIND}get(h,g){return super.get(`${h}:${g||this.defaultAnchorKind}`)}};n.AnchorComputerRegistry=a,n.AnchorComputerRegistry=a=e([(0,o.injectable)(),i(0,(0,o.multiInject)(r.TYPES.IAnchorComputer)),t("design:paramtypes",[Array])],a)})(Ra);var Qo={},JG=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ple=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Qo,"__esModule",{value:!0});Qo.AbstractEdgeRouter=Qo.DefaultAnchors=Qo.Side=void 0;const eU=F,fo=De,A2=yt,ci=an,y$=Ra,b$=an;var Et;(function(n){n[n.RIGHT=0]="RIGHT",n[n.LEFT=1]="LEFT",n[n.TOP=2]="TOP",n[n.BOTTOM=3]="BOTTOM"})(Et||(Qo.Side=Et={}));class R2{constructor(e,t,i){this.element=e,this.kind=i;const o=e.bounds;this.bounds=(0,A2.translateBounds)(o,e.parent,t),this.left={x:this.bounds.x,y:this.bounds.y+.5*this.bounds.height,kind:i},this.right={x:this.bounds.x+this.bounds.width,y:this.bounds.y+.5*this.bounds.height,kind:i},this.top={x:this.bounds.x+.5*this.bounds.width,y:this.bounds.y,kind:i},this.bottom={x:this.bounds.x+.5*this.bounds.width,y:this.bounds.y+this.bounds.height,kind:i}}get(e){return this[Et[e].toLowerCase()]}getNearestSide(e){const t=fo.Point.euclideanDistance(e,this.left),i=fo.Point.euclideanDistance(e,this.right),o=fo.Point.euclideanDistance(e,this.top),r=fo.Point.euclideanDistance(e,this.bottom);let s=Et.LEFT,a=t;return i<a&&(a=i,s=Et.RIGHT),o<a&&(a=o,s=Et.TOP),r<a&&(a=r,s=Et.BOTTOM),s}}Qo.DefaultAnchors=R2;let fC=class{findOrthogonalIntersection(e,t){const i=(f,h)=>{const g=fo.Point.subtract(h,f),y=fo.Point.subtract(t,f),S=fo.Point.dotProduct(y,g)/fo.Point.dotProduct(g,g);return S>=0&&S<=1?fo.Point.linear(f,h,S):S<0?f:h},o=this.route(e);let r=o[0],s=0;for(let f=0;f<o.length-1;++f){const h=i(o[f],o[f+1]);fo.Point.euclideanDistance(t,h)<fo.Point.euclideanDistance(t,r)&&(r=h,s=f)}const a=fo.Point.subtract(o[s+1],o[s]);return{point:r,derivative:a}}pointAt(e,t){const i=this.calculateSegment(e,t);if(!i)return;const{segmentStart:o,segmentEnd:r,lambda:s}=i;return fo.Point.linear(o,r,s)}derivativeAt(e,t){const i=this.calculateSegment(e,t);if(!i)return;const{segmentStart:o,segmentEnd:r}=i;return{x:r.x-o.x,y:r.y-o.y}}calculateSegment(e,t){if(t<0||t>1)return;const i=this.route(e);if(i.length<2)return;const o=[];let r=0;for(let f=0;f<i.length-1;++f)o[f]=fo.Point.euclideanDistance(i[f],i[f+1]),r+=o[f];let s=0;const a=t*r;for(let f=0;f<i.length-1;++f){const h=s+o[f];if(o[f]>1e-8&&h>=a){const g=Math.max(0,a-s)/o[f];return{segmentStart:i[f],segmentEnd:i[f+1],lambda:g}}s=h}return{segmentEnd:i.pop(),segmentStart:i.pop(),lambda:1}}addHandle(e,t,i,o){const r=new ci.SRoutingHandleImpl;return r.kind=t,r.pointIndex=o,r.type=i,t==="target"&&e.id===ci.edgeInProgressID&&(r.id=ci.edgeInProgressTargetHandleID),e.add(r),r}getHandlePosition(e,t,i){switch(i.kind){case"source":return e.source instanceof ci.SDanglingAnchorImpl?e.source.position:t[0];case"target":return e.target instanceof ci.SDanglingAnchorImpl?e.target.position:t[t.length-1];default:const o=this.getInnerHandlePosition(e,t,i);if(o!==void 0)return o;if(i.pointIndex>=0&&i.pointIndex<e.routingPoints.length)return e.routingPoints[i.pointIndex]}}findRouteSegment(e,t,i){const o=a=>a.pointIndex!==void 0?a.pointIndex:a.kind==="target"?e.routingPoints.length:-2;let r,s;for(const a of t){const f=o(a);f<=i&&(r===void 0||f>o(r))&&(r=a),f>i&&(s===void 0||f<o(s))&&(s=a)}return{start:r,end:s}}getTranslatedAnchor(e,t,i,o,r=0){const s=(0,A2.translatePoint)(t,i,e.parent),a=this.getAnchorComputer(e),f=.5*e.strokeWidth,h=a.getAnchor(e,s,r+f);return(0,A2.translatePoint)(h,e.parent,o.parent)}getAnchorComputer(e){return this.anchorRegistry.get(this.kind,e.anchorKind)}applyHandleMoves(e,t){const i=t.slice();t.forEach(o=>{const r=o.handle;if(r.kind==="source"&&!(e.source instanceof ci.SDanglingAnchorImpl)){const s=new ci.SDanglingAnchorImpl;s.id=e.id+"_dangling-source",s.original=e.source,s.position=o.toPosition,r.root.add(s),r.danglingAnchor=s,e.sourceId=s.id}else if(r.kind==="target"&&!(e.target instanceof ci.SDanglingAnchorImpl)){const s=new ci.SDanglingAnchorImpl;s.id=e.id+"_dangling-target",s.original=e.target,s.position=o.toPosition,r.root.add(s),r.danglingAnchor=s,e.targetId=s.id}r.danglingAnchor&&(r.danglingAnchor.position=o.toPosition,i.splice(i.indexOf(o),1))}),i.length>0&&this.applyInnerHandleMoves(e,i),this.cleanupRoutingPoints(e,e.routingPoints,!0,!0)}cleanupRoutingPoints(e,t,i,o){const r=new R2(e.source,e.parent,"source"),s=new R2(e.target,e.parent,"target");this.resetRoutingPointsOnReconnect(e,t,i,r,s)}resetRoutingPointsOnReconnect(e,t,i,o,r){if(t.length===0||e.source instanceof ci.SDanglingAnchorImpl||e.target instanceof ci.SDanglingAnchorImpl){const s=this.getOptions(e),a=this.calculateDefaultCorners(e,o,r,s);if(t.splice(0,t.length,...a),i){let f=-2;e.children.forEach(h=>{h instanceof ci.SRoutingHandleImpl&&(h.kind==="target"?h.pointIndex=t.length:h.kind==="line"&&h.pointIndex>=t.length?e.remove(h):f=Math.max(h.pointIndex,f))});for(let h=f;h<t.length-1;++h)this.addHandle(e,"manhattan-50%","volatile-routing-point",h)}return!0}return!1}applyReconnect(e,t,i){let o=!1;if(t){const r=e.root.index.getById(t);r instanceof b$.SConnectableElementImpl&&(e.sourceId=r.id,o=!0)}if(i){const r=e.root.index.getById(i);r instanceof b$.SConnectableElementImpl&&(e.targetId=r.id,o=!0)}if(o){if(e.index.remove(e),e.id===ci.edgeInProgressID){const r=h=>`${e.sourceId}_to_${e.targetId}_${h}`;let s=0,a=r(s);for(;e.index.getById(a)!==void 0;)a=r(++s);e.id=a;const f=e.children.find(h=>h.id===ci.edgeInProgressTargetHandleID);f instanceof ci.SRoutingHandleImpl&&(e.remove(f),f.danglingAnchor&&f.danglingAnchor.parent.remove(f.danglingAnchor))}e.index.add(e),this.getSelfEdgeIndex(e)>-1&&(e.routingPoints=[],this.cleanupRoutingPoints(e,e.routingPoints,!0,!0))}}takeSnapshot(e){return{routingPoints:e.routingPoints.slice(),routingHandles:e.children.filter(t=>t instanceof ci.SRoutingHandleImpl).map(t=>t),routedPoints:this.route(e),router:this,source:e.source,target:e.target}}applySnapshot(e,t){e.routingPoints=t.routingPoints,e.removeAll(i=>i instanceof ci.SRoutingHandleImpl),e.routerKind=t.router.kind,t.routingHandles.forEach(i=>e.add(i)),t.source&&(e.sourceId=t.source.id),t.target&&(e.targetId=t.target.id),e.root.index.remove(e),e.root.index.add(e)}calculateDefaultCorners(e,t,i,o){const r=this.getSelfEdgeIndex(e);if(r>=0){const s=o.standardDistance,a=o.selfEdgeOffset*Math.min(t.bounds.width,t.bounds.height);switch(r%4){case 0:return[{x:t.get(Et.RIGHT).x+s,y:t.get(Et.RIGHT).y+a},{x:t.get(Et.RIGHT).x+s,y:t.get(Et.BOTTOM).y+s},{x:t.get(Et.BOTTOM).x+a,y:t.get(Et.BOTTOM).y+s}];case 1:return[{x:t.get(Et.BOTTOM).x-a,y:t.get(Et.BOTTOM).y+s},{x:t.get(Et.LEFT).x-s,y:t.get(Et.BOTTOM).y+s},{x:t.get(Et.LEFT).x-s,y:t.get(Et.LEFT).y+a}];case 2:return[{x:t.get(Et.LEFT).x-s,y:t.get(Et.LEFT).y-a},{x:t.get(Et.LEFT).x-s,y:t.get(Et.TOP).y-s},{x:t.get(Et.TOP).x-a,y:t.get(Et.TOP).y-s}];case 3:return[{x:t.get(Et.TOP).x+a,y:t.get(Et.TOP).y-s},{x:t.get(Et.RIGHT).x+s,y:t.get(Et.TOP).y-s},{x:t.get(Et.RIGHT).x+s,y:t.get(Et.RIGHT).y-a}]}}return[]}getSelfEdgeIndex(e){return!e.source||e.source!==e.target?-1:e.source.outgoingEdges.filter(t=>t.target===e.source).indexOf(e)}commitRoute(e,t){const i=[];for(let o=1;o<t.length-1;++o)i.push({x:t[o].x,y:t[o].y});e.routingPoints=i}};Qo.AbstractEdgeRouter=fC;JG([(0,eU.inject)(y$.AnchorComputerRegistry),ple("design:type",y$.AnchorComputerRegistry)],fC.prototype,"anchorRegistry",void 0);Qo.AbstractEdgeRouter=fC=JG([(0,eU.injectable)()],fC);var tU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},mle=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},M2;Object.defineProperty(Kc,"__esModule",{value:!0});Kc.PolylineEdgeRouter=void 0;const nU=F,jh=De,S$=an,E$=Ra,gle=Qo;let W_=M2=class extends gle.AbstractEdgeRouter{get kind(){return M2.KIND}getOptions(e){return{minimalPointDistance:2,removeAngleThreshold:.1,standardDistance:20,selfEdgeOffset:.25}}route(e){const t=e.source,i=e.target;if(t===void 0||i===void 0)return[];let o,r;const s=this.getOptions(e),a=e.routingPoints.length>0?e.routingPoints:[];this.cleanupRoutingPoints(e,a,!1,!1);const f=a!==void 0?a.length:0;if(f===0){const g=jh.Bounds.center(i.bounds);o=this.getTranslatedAnchor(t,g,i.parent,e,e.sourceAnchorCorrection);const y=jh.Bounds.center(t.bounds);r=this.getTranslatedAnchor(i,y,t.parent,e,e.targetAnchorCorrection)}else{const g=a[0];o=this.getTranslatedAnchor(t,g,e.parent,e,e.sourceAnchorCorrection);const y=a[f-1];r=this.getTranslatedAnchor(i,y,e.parent,e,e.targetAnchorCorrection)}const h=[];h.push({kind:"source",x:o.x,y:o.y});for(let g=0;g<f;g++){const y=a[g];(g>0&&g<f-1||g===0&&jh.Point.maxDistance(o,y)>=s.minimalPointDistance+(e.sourceAnchorCorrection||0)||g===f-1&&jh.Point.maxDistance(y,r)>=s.minimalPointDistance+(e.targetAnchorCorrection||0))&&h.push({kind:"linear",x:y.x,y:y.y,pointIndex:g})}return h.push({kind:"target",x:r.x,y:r.y}),this.filterEditModeHandles(h,e,s)}filterEditModeHandles(e,t,i){if(t.children.length===0)return e;let o=0;for(;o<e.length;){const r=e[o];if(r.pointIndex!==void 0){const s=t.children.find(a=>a instanceof S$.SRoutingHandleImpl&&a.kind==="junction"&&a.pointIndex===r.pointIndex);if(s!==void 0&&s.editMode&&o>0&&o<e.length-1){const a=e[o-1],f=e[o+1],h={x:a.x-r.x,y:a.y-r.y},g={x:f.x-r.x,y:f.y-r.y},y=(0,jh.angleBetweenPoints)(h,g);if(Math.abs(Math.PI-y)<i.removeAngleThreshold){e.splice(o,1);continue}}}o++}return e}createRoutingHandles(e){const t=e.routingPoints.length;this.addHandle(e,"source","routing-point",-2),this.addHandle(e,"line","volatile-routing-point",-1);for(let i=0;i<t;i++)this.addHandle(e,"junction","routing-point",i),this.addHandle(e,"line","volatile-routing-point",i);this.addHandle(e,"target","routing-point",t)}getInnerHandlePosition(e,t,i){if(i.kind==="line"){const{start:o,end:r}=this.findRouteSegment(e,t,i.pointIndex);if(o!==void 0&&r!==void 0)return(0,jh.centerOfLine)(o,r)}}applyInnerHandleMoves(e,t){t.forEach(i=>{const o=i.handle,r=e.routingPoints;let s=o.pointIndex;o.kind==="line"&&(o.kind="junction",o.type="routing-point",r.splice(s+1,0,i.fromPosition||r[Math.max(s,0)]),e.children.forEach(a=>{a instanceof S$.SRoutingHandleImpl&&(a===o||a.pointIndex>s)&&a.pointIndex++}),this.addHandle(e,"line","volatile-routing-point",s),s++,this.addHandle(e,"line","volatile-routing-point",s)),s>=0&&s<r.length&&(r[s]=i.toPosition)})}};Kc.PolylineEdgeRouter=W_;W_.KIND="polyline";tU([(0,nU.inject)(E$.AnchorComputerRegistry),mle("design:type",E$.AnchorComputerRegistry)],W_.prototype,"anchorRegistry",void 0);Kc.PolylineEdgeRouter=W_=M2=tU([(0,nU.injectable)()],W_);var iU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},oU=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},vle=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(vi,"__esModule",{value:!0});vi.EdgeRouting=vi.EdgeRouterRegistry=void 0;const hC=F,_le=ke,rU=me,yle=rn,ble=pn,Sle=an,Ele=Kc;function Cle(n){return n.routeAll!==void 0}let pC=class extends ble.InstanceRegistry{constructor(e){super(),e.forEach(t=>this.register(t.kind,t))}get defaultKind(){return Ele.PolylineEdgeRouter.KIND}get(e){return super.get(e||this.defaultKind)}routeAllChildren(e){const t=this.doRouteAllChildren(e);for(const i of this.postProcessors)i.apply(t,e);return t}doRouteAllChildren(e){const t=new sU,i=new Map,o=[e];for(;o.length>0;){const r=o.shift();for(const s of r.children){if(s instanceof Sle.SRoutableElementImpl){const a=s.routerKind||this.defaultKind;i.has(a)?i.get(a).push(s):i.set(a,[s])}s instanceof _le.SParentElementImpl&&o.push(s)}}return i.forEach((r,s)=>{const a=this.get(s);if(Cle(a))t.setAll(a.routeAll(r,e));else for(const f of r)t.set(f.id,this.route(f))}),t}route(e,t){const i=(0,yle.findArgValue)(t,"edgeRouting");if(i){const r=i.get(e.id);if(r)return r}return this.get(e.routerKind).route(e)}};vi.EdgeRouterRegistry=pC;iU([(0,hC.multiInject)(rU.TYPES.IEdgeRoutePostprocessor),(0,hC.optional)(),oU("design:type",Array)],pC.prototype,"postProcessors",void 0);vi.EdgeRouterRegistry=pC=iU([(0,hC.injectable)(),vle(0,(0,hC.multiInject)(rU.TYPES.IEdgeRouter)),oU("design:paramtypes",[Array])],pC);class sU{constructor(){this.routesMap=new Map}set(e,t){this.routesMap.set(e,t)}setAll(e){e.routes.forEach((t,i)=>this.set(i,t))}get(e){return this.routesMap.get(e)}get routes(){return this.routesMap}}vi.EdgeRouting=sU;var o7=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},aU=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(jf,"__esModule",{value:!0});jf.EdgeLayoutPostprocessor=void 0;const r7=F,di=De,Ple=ke,wle=ft,Ale=Sn,fE=$t,oD=Bf,C$=vi,Rle=me;let Z_=class{decorate(e,t){var i,o;if((0,oD.isEdgeLayoutable)(t)&&t.parent instanceof Ale.SEdgeImpl&&t.bounds!==di.Bounds.EMPTY){const r=t.bounds,s=(0,oD.checkEdgePlacement)(t),a=this.getEdgePlacement(t),f=t.parent,h=Math.min(1,Math.max(0,a.position)),g=this.edgeRouterRegistry.get(f.routerKind),y=g.pointAt(f,h);let S="";const P=`translate(${((i=y==null?void 0:y.x)!==null&&i!==void 0?i:0)+r.x}, ${((o=y==null?void 0:y.y)!==null&&o!==void 0?o:0)+r.y})`;if(s){if(y){let w;if(a.moveMode&&a.moveMode!=="edge")w=g.derivativeAt(f,h),a.moveMode==="free"?S+=P:S+=`translate(${y.x}, ${y.y})`;else{const C=g.findOrthogonalIntersection(f,di.Point.add(y,r));C&&(w=C.derivative,S+=`translate(${C.point.x}, ${C.point.y})`)}if(w){const C=(0,di.toDegrees)(Math.atan2(w.y,w.x));if(a.rotate){let E=C;Math.abs(C)>90&&(C<0?E+=180:C>0&&(E-=180)),S+=` rotate(${E})`;const D=this.getRotatedAlignment(t,a,E!==C);S+=` translate(${D.x}, ${D.y})`}else{const E=this.getAlignment(t,a,C);S+=` translate(${E.x}, ${E.y})`}}}}else S+=P;(0,wle.setAttr)(e,"transform",S)}return e}getRotatedAlignment(e,t,i){let o=(0,fE.isAlignable)(e)?e.alignment.x:0,r=(0,fE.isAlignable)(e)?e.alignment.y:0;const s=e.bounds;if(t.side==="on")return{x:o-.5*s.height,y:r-.5*s.height};if(i)switch(t.position<.3333333?o-=s.width+t.offset:t.position<.6666666?o-=.5*s.width:o+=t.offset,t.side){case"left":case"bottom":r-=t.offset+s.height;break;case"right":case"top":r+=t.offset}else switch(t.position<.3333333?o+=t.offset:t.position<.6666666?o-=.5*s.width:o-=s.width+t.offset,t.side){case"right":case"bottom":r+=-t.offset-s.height;break;case"left":case"top":r+=t.offset}return{x:o,y:r}}getEdgePlacement(e){let t=e;const i=[];for(;t!==void 0;){const o=t.edgePlacement;if(o!==void 0&&i.push(o),t instanceof Ple.SChildElementImpl)t=t.parent;else break}return i.reverse().reduce((o,r)=>Object.assign(Object.assign({},o),r),oD.DEFAULT_EDGE_PLACEMENT)}getAlignment(e,t,i){const o=e.bounds,r=(0,fE.isAlignable)(e)?e.alignment.x-o.width:0,s=(0,fE.isAlignable)(e)?e.alignment.y-o.height:0;if(t.side==="on")return{x:r+.5*o.width,y:s+.5*o.height};const a=this.getQuadrant(i),f={x:t.offset,y:s+.5*o.height},h={x:t.offset,y:s+o.height+t.offset},g={x:-o.width-t.offset,y:s+o.height+t.offset},y={x:-o.width-t.offset,y:s+.5*o.height},S={x:-o.width-t.offset,y:s-t.offset},P={x:t.offset,y:s-t.offset};switch(t.side){case"left":switch(a.orientation){case"west":return di.Point.linear(h,g,a.position);case"north":return di.Point.linear(g,S,a.position);case"east":return di.Point.linear(S,P,a.position);case"south":return di.Point.linear(P,h,a.position)}break;case"right":switch(a.orientation){case"west":return di.Point.linear(S,P,a.position);case"north":return di.Point.linear(P,h,a.position);case"east":return di.Point.linear(h,g,a.position);case"south":return di.Point.linear(g,S,a.position)}break;case"top":switch(a.orientation){case"west":return di.Point.linear(S,P,a.position);case"north":return this.linearFlip(P,f,y,S,a.position);case"east":return di.Point.linear(S,P,a.position);case"south":return this.linearFlip(P,f,y,S,a.position)}break;case"bottom":switch(a.orientation){case"west":return di.Point.linear(h,g,a.position);case"north":return this.linearFlip(g,y,f,h,a.position);case"east":return di.Point.linear(h,g,a.position);case"south":return this.linearFlip(g,y,f,h,a.position)}break}return{x:0,y:0}}getQuadrant(e){return Math.abs(e)>135?{orientation:"west",position:(e>0?e-135:e+225)/90}:e<-45?{orientation:"north",position:(e+135)/90}:e<45?{orientation:"east",position:(e+45)/90}:{orientation:"south",position:(e-45)/90}}linearFlip(e,t,i,o,r){return r<.5?di.Point.linear(e,t,2*r):di.Point.linear(i,o,2*r-1)}postUpdate(){}};jf.EdgeLayoutPostprocessor=Z_;o7([(0,r7.inject)(C$.EdgeRouterRegistry),aU("design:type",C$.EdgeRouterRegistry)],Z_.prototype,"edgeRouterRegistry",void 0);o7([(0,r7.inject)(Rle.TYPES.ILogger),aU("design:type",Object)],Z_.prototype,"logger",void 0);jf.EdgeLayoutPostprocessor=Z_=o7([(0,r7.injectable)()],Z_);Object.defineProperty(Kl,"__esModule",{value:!0});const Mle=F,P$=me,rD=jf,Ile=new Mle.ContainerModule(n=>{n(rD.EdgeLayoutPostprocessor).toSelf().inSingletonScope(),n(P$.TYPES.IVNodePostprocessor).toService(rD.EdgeLayoutPostprocessor),n(P$.TYPES.HiddenVNodePostprocessor).toService(rD.EdgeLayoutPostprocessor)});Kl.default=Ile;var R0={},Dle=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Tle=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Ole=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(R0,"__esModule",{value:!0});R0.CreateElementCommand=void 0;const w$=F,Lle=se,Nle=Ve,jle=ke,Ble=me;let mC=class extends Nle.Command{constructor(e){super(),this.action=e}execute(e){const t=e.root.index.getById(this.action.containerId);return t instanceof jle.SParentElementImpl&&(this.container=t,this.newElement=e.modelFactory.createElement(this.action.elementSchema),this.container.add(this.newElement)),e.root}undo(e){return this.container.remove(this.newElement),e.root}redo(e){return this.container.add(this.newElement),e.root}};R0.CreateElementCommand=mC;mC.KIND=Lle.CreateElementAction.KIND;R0.CreateElementCommand=mC=Dle([(0,w$.injectable)(),Ole(0,(0,w$.inject)(Ble.TYPES.Action)),Tle("design:paramtypes",[Object])],mC);var s7={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isCreatingOnDrag=n.creatingOnDragFeature=void 0,n.creatingOnDragFeature=Symbol("creatingOnDragFeature");function e(t){return t.hasFeature(n.creatingOnDragFeature)&&t.createAction!==void 0}n.isCreatingOnDrag=e})(s7);var ea={},zn={},M0=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(zn,"__esModule",{value:!0});zn.EmptyGroupView=zn.DiamondNodeView=zn.RectangularNodeView=zn.CircularNodeView=zn.SvgViewportView=void 0;const lc=ei,zp=Sn,a7=xc,$le=Jn,I0=F;let I2=class{render(e,t,i){const o=`scale(${e.zoom}) translate(${-e.scroll.x},${-e.scroll.y})`;return(0,lc.svg)("svg",null,(0,lc.svg)("g",{transform:o},t.renderChildren(e)))}};zn.SvgViewportView=I2;zn.SvgViewportView=I2=M0([(0,I0.injectable)()],I2);let D2=class extends a7.ShapeView{render(e,t,i){if(!this.isVisible(e,t))return;const o=this.getRadius(e);return(0,lc.svg)("g",null,(0,lc.svg)("circle",{"class-sprotty-node":e instanceof zp.SNodeImpl,"class-sprotty-port":e instanceof zp.SPortImpl,"class-mouseover":e.hoverFeedback,"class-selected":e.selected,r:o,cx:o,cy:o}),t.renderChildren(e))}getRadius(e){const t=Math.min(e.size.width,e.size.height);return t>0?t/2:0}};zn.CircularNodeView=D2;zn.CircularNodeView=D2=M0([(0,I0.injectable)()],D2);let T2=class extends a7.ShapeView{render(e,t,i){if(this.isVisible(e,t))return(0,lc.svg)("g",null,(0,lc.svg)("rect",{"class-sprotty-node":e instanceof zp.SNodeImpl,"class-sprotty-port":e instanceof zp.SPortImpl,"class-mouseover":e.hoverFeedback,"class-selected":e.selected,x:"0",y:"0",width:Math.max(e.size.width,0),height:Math.max(e.size.height,0)}),t.renderChildren(e))}};zn.RectangularNodeView=T2;zn.RectangularNodeView=T2=M0([(0,I0.injectable)()],T2);let O2=class extends a7.ShapeView{render(e,t,i){if(!this.isVisible(e,t))return;const o=new $le.Diamond({height:Math.max(e.size.height,0),width:Math.max(e.size.width,0),x:0,y:0}),r=`${hE(o.topPoint)} ${hE(o.rightPoint)} ${hE(o.bottomPoint)} ${hE(o.leftPoint)}`;return(0,lc.svg)("g",null,(0,lc.svg)("polygon",{"class-sprotty-node":e instanceof zp.SNodeImpl,"class-sprotty-port":e instanceof zp.SPortImpl,"class-mouseover":e.hoverFeedback,"class-selected":e.selected,points:r}),t.renderChildren(e))}};zn.DiamondNodeView=O2;zn.DiamondNodeView=O2=M0([(0,I0.injectable)()],O2);function hE(n){return`${n.x},${n.y}`}let L2=class{render(e,t){return(0,lc.svg)("g",null)}};zn.EmptyGroupView=L2;zn.EmptyGroupView=L2=M0([(0,I0.injectable)()],L2);var _n={},kle=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Fle=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},xle=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(_n,"__esModule",{value:!0});_n.getEditableLabel=_n.EditLabelKeyListener=_n.EditLabelMouseListener=_n.ApplyLabelEditCommand=_n.ResolvedLabelEdit=_n.isApplyLabelEditAction=_n.isEditLabelAction=_n.EditLabelAction=void 0;const Hle=F,gC=se,Kle=Ve,Vle=me,zle=Ut,Gle=gi,Ule=qt,Yle=to,qle=Mo,N2=$f;var Q_;(function(n){n.KIND="EditLabel";function e(t){return{kind:n.KIND,labelId:t}}n.create=e})(Q_||(_n.EditLabelAction=Q_={}));function Wle(n){return(0,gC.isAction)(n)&&n.kind===Q_.KIND&&"labelId"in n}_n.isEditLabelAction=Wle;function Zle(n){return(0,gC.isAction)(n)&&n.kind===gC.ApplyLabelEditAction.KIND&&"labelId"in n&&"text"in n}_n.isApplyLabelEditAction=Zle;class Qle{}_n.ResolvedLabelEdit=Qle;let vC=class extends Kle.Command{constructor(e){super(),this.action=e}execute(e){const i=e.root.index.getById(this.action.labelId);return i&&(0,N2.isEditableLabel)(i)&&(this.resolvedLabelEdit={label:i,oldLabel:i.text,newLabel:this.action.text},i.text=this.action.text),e.root}undo(e){return this.resolvedLabelEdit&&(this.resolvedLabelEdit.label.text=this.resolvedLabelEdit.oldLabel),e.root}redo(e){return this.resolvedLabelEdit&&(this.resolvedLabelEdit.label.text=this.resolvedLabelEdit.newLabel),e.root}};_n.ApplyLabelEditCommand=vC;vC.KIND=gC.ApplyLabelEditAction.KIND;_n.ApplyLabelEditCommand=vC=kle([xle(0,(0,Hle.inject)(Vle.TYPES.Action)),Fle("design:paramtypes",[Object])],vC);class Xle extends zle.MouseListener{doubleClick(e,t){const i=c7(e);return i?[Q_.create(i.id)]:[]}}_n.EditLabelMouseListener=Xle;class Jle extends Gle.KeyListener{keyDown(e,t){if((0,Ule.matchesKeystroke)(t,"F2")){const i=(0,qle.toArray)(e.index.all().filter(o=>(0,Yle.isSelectable)(o)&&o.selected)).map(c7).filter(o=>o!==void 0);if(i.length===1)return[Q_.create(i[0].id)]}return[]}}_n.EditLabelKeyListener=Jle;function c7(n){if((0,N2.isEditableLabel)(n))return n;if((0,N2.isWithEditableLabel)(n)&&n.editableLabel)return n.editableLabel}_n.getEditableLabel=c7;var aa={},vs={},or={},rr={},SA=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},d7=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(rr,"__esModule",{value:!0});rr.SvgExporter=rr.ExportSvgAction=void 0;const EA=F,A$=De,efe=$t,tfe=Nu,u7=me;var j2;(function(n){n.KIND="exportSvg";function e(t,i){return{kind:n.KIND,svg:t,responseId:i}}n.create=e})(j2||(rr.ExportSvgAction=j2={}));let Gp=class{export(e,t){if(typeof document<"u"){const i=document.getElementById(this.options.hiddenDiv);if(i===null){this.log.warn(this,`Element with id ${this.options.hiddenDiv} not found. Nothing to export.`);return}const o=i.querySelector("svg");if(o===null){this.log.warn(this,`No svg element found in ${this.options.hiddenDiv} div. Nothing to export.`);return}const r=this.createSvg(o,e);this.actionDispatcher.dispatch(j2.create(r,t?t.requestId:""))}}createSvg(e,t){const i=new XMLSerializer,o=i.serializeToString(e),r=document.createElement("iframe");if(document.body.appendChild(r),!r.contentWindow)throw new Error("IFrame has no contentWindow");const s=r.contentWindow.document;s.open(),s.write(o),s.close();const a=s.querySelector("svg");a.removeAttribute("opacity"),this.copyStyles(e,a,["width","height","opacity","inline-size"]),a.setAttribute("version","1.1");const f=this.getBounds(t);a.setAttribute("viewBox",`${f.x} ${f.y} ${f.width} ${f.height}`);const h=i.serializeToString(a);return document.body.removeChild(r),h}copyStyles(e,t,i){const o=getComputedStyle(e),r=getComputedStyle(t);let s="";for(let a=0;a<o.length;a++){const f=o[a];if(i.indexOf(f)===-1){const h=o.getPropertyValue(f);r.getPropertyValue(f)!==h&&(s+=f+":"+h+";")}}s!==""&&t.setAttribute("style",s);for(let a=0;a<e.childNodes.length;++a){const f=e.childNodes[a],h=t.childNodes[a];f instanceof Element&&this.copyStyles(f,h,[])}}getBounds(e){const t=[A$.Bounds.EMPTY];return e.children.forEach(i=>{(0,efe.isBoundsAware)(i)&&t.push(i.bounds)}),t.reduce((i,o)=>A$.Bounds.combine(i,o))}};rr.SvgExporter=Gp;SA([(0,EA.inject)(u7.TYPES.ViewerOptions),d7("design:type",Object)],Gp.prototype,"options",void 0);SA([(0,EA.inject)(u7.TYPES.IActionDispatcher),d7("design:type",tfe.ActionDispatcher)],Gp.prototype,"actionDispatcher",void 0);SA([(0,EA.inject)(u7.TYPES.ILogger),d7("design:type",Object)],Gp.prototype,"log",void 0);rr.SvgExporter=Gp=SA([(0,EA.injectable)()],Gp);var CA=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cU=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(or,"__esModule",{value:!0});or.ComputedBoundsApplicator=or.ModelSource=void 0;const PA=F,nfe=se,ife=jn,dU=me,ofe=rr;let X_=class{initialize(e){e.register(nfe.RequestModelAction.KIND,this),e.register(ofe.ExportSvgAction.KIND,this)}};or.ModelSource=X_;CA([(0,PA.inject)(dU.TYPES.IActionDispatcher),cU("design:type",Object)],X_.prototype,"actionDispatcher",void 0);CA([(0,PA.inject)(dU.TYPES.ViewerOptions),cU("design:type",Object)],X_.prototype,"viewerOptions",void 0);or.ModelSource=X_=CA([(0,PA.injectable)()],X_);let B2=class{apply(e,t){const i=new ife.SModelIndex;i.add(e);for(const o of t.bounds){const r=i.getById(o.elementId);r!==void 0&&this.applyBounds(r,o.newPosition,o.newSize)}if(t.alignments!==void 0)for(const o of t.alignments){const r=i.getById(o.elementId);r!==void 0&&this.applyAlignment(r,o.newAlignment)}return i}applyAlignment(e,t){const i=e;i.alignment={x:t.x,y:t.y}}applyBounds(e,t,i){const o=e;t&&(o.position=Object.assign({},t)),o.size=Object.assign({},i)}};or.ComputedBoundsApplicator=B2;or.ComputedBoundsApplicator=B2=CA([(0,PA.injectable)()],B2);var uU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},lU=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},rfe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(vs,"__esModule",{value:!0});vs.CommitModelCommand=vs.CommitModelAction=void 0;const $2=F,sfe=Ve,fU=me,afe=or;var k2;(function(n){n.KIND="commitModel";function e(){return{kind:n.KIND}}n.create=e})(k2||(vs.CommitModelAction=k2={}));let J_=class extends sfe.SystemCommand{constructor(e){super(),this.action=e}execute(e){return this.newModel=e.modelFactory.createSchema(e.root),this.doCommit(this.newModel,e.root,!0)}doCommit(e,t,i){const o=this.modelSource.commitModel(e);return o instanceof Promise?o.then(r=>(i&&(this.originalModel=r),t)):(i&&(this.originalModel=o),t)}undo(e){return this.doCommit(this.originalModel,e.root,!1)}redo(e){return this.doCommit(this.newModel,e.root,!1)}};vs.CommitModelCommand=J_;J_.KIND=k2.KIND;uU([(0,$2.inject)(fU.TYPES.ModelSource),lU("design:type",afe.ModelSource)],J_.prototype,"modelSource",void 0);vs.CommitModelCommand=J_=uU([(0,$2.injectable)(),rfe(0,(0,$2.inject)(fU.TYPES.Action)),lU("design:paramtypes",[Object])],J_);var fc={},cfe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},dfe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(fc,"__esModule",{value:!0});fc.ZoomMouseListener=fc.getZoom=void 0;const ufe=F,lfe=se,R$=De,hU=yt,ffe=me,hfe=Ut,pfe=sn,pU=Rs,mfe=Jn;function gfe(n){let e=1;const t=(0,hU.findParentByFeature)(n,pU.isViewport);return t&&(e=t.zoom),e}fc.getZoom=gfe;class mU extends hfe.MouseListener{wheel(e,t){const i=(0,hU.findParentByFeature)(e,pU.isViewport);if(!i)return[];const o=this.isScrollMode(t)?this.processScroll(i,t):this.processZoom(i,e,t);return o?[lfe.SetViewportAction.create(i.id,o,{animate:!1})]:[]}isScrollMode(e){return e.altKey}processScroll(e,t){return{scroll:{x:e.scroll.x+t.deltaX,y:e.scroll.y+t.deltaY},zoom:e.zoom}}processZoom(e,t,i){const o=this.getZoomFactor(i);if(o>1&&(0,R$.almostEquals)(e.zoom,this.viewerOptions.zoomLimits.max)||o<1&&(0,R$.almostEquals)(e.zoom,this.viewerOptions.zoomLimits.min))return;const r=(0,mfe.limit)(e.zoom*o,this.viewerOptions.zoomLimits),s=this.getViewportOffset(t.root,i),a=1/r-1/e.zoom;return{scroll:{x:e.scroll.x-a*s.x,y:e.scroll.y-a*s.y},zoom:r}}getViewportOffset(e,t){const i=e.canvasBounds,o=(0,pfe.getWindowScroll)();return{x:t.clientX+o.x-i.x,y:t.clientY+o.y-i.y}}getZoomFactor(e){return e.deltaMode===e.DOM_DELTA_PAGE?Math.exp(-e.deltaY*.5):e.deltaMode===e.DOM_DELTA_LINE?Math.exp(-e.deltaY*.05):Math.exp(-e.deltaY*.005)}}fc.ZoomMouseListener=mU;cfe([(0,ufe.inject)(ffe.TYPES.ViewerOptions),dfe("design:type",Object)],mU.prototype,"viewerOptions",void 0);var Ff=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},D0=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},F2;Object.defineProperty(aa,"__esModule",{value:!0});aa.EditLabelUI=aa.EditLabelActionHandler=void 0;const hc=F,vfe=se,T0=me,_fe=sa,yfe=Co,bfe=Aa,Sfe=vs,M$=qt,Efe=$t,I$=fc,Cfe=_n,Pfe=$f;let x2=class{handle(e){if((0,Cfe.isEditLabelAction)(e))return yfe.SetUIExtensionVisibilityAction.create({extensionId:ca.ID,visible:!0,contextElementsId:[e.labelId]})}};aa.EditLabelActionHandler=x2;aa.EditLabelActionHandler=x2=Ff([(0,hc.injectable)()],x2);let ca=F2=class extends _fe.AbstractUIExtension{constructor(){super(...arguments),this.validationTimeout=void 0,this.isActive=!1,this.blockApplyEditOnInvalidInput=!0,this.isCurrentLabelValid=!0}id(){return F2.ID}containerClass(){return"label-edit"}get labelId(){return this.label?this.label.id:"unknown"}initializeContents(e){e.style.position="absolute",this.inputElement=document.createElement("input"),this.textAreaElement=document.createElement("textarea"),[this.inputElement,this.textAreaElement].forEach(t=>{t.onkeydown=i=>this.applyLabelEditOnEvent(i,"Enter"),this.configureAndAdd(t,e)})}configureAndAdd(e,t){e.style.visibility="hidden",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.addEventListener("keydown",i=>this.hideIfEscapeEvent(i)),e.addEventListener("keyup",i=>this.validateLabelIfContentChange(i,e.value)),e.addEventListener("blur",()=>window.setTimeout(()=>this.applyLabelEdit(),200)),t.appendChild(e)}get editControl(){return this.label&&this.label.isMultiLine?this.textAreaElement:this.inputElement}hideIfEscapeEvent(e){(0,M$.matchesKeystroke)(e,"Escape")&&this.hide()}applyLabelEditOnEvent(e,t,...i){(0,M$.matchesKeystroke)(e,t||"Enter",...i)&&(e.preventDefault(),this.applyLabelEdit())}validateLabelIfContentChange(e,t){(this.previousLabelContent===void 0||this.previousLabelContent!==t)&&(this.previousLabelContent=t,this.performLabelValidation(e,this.editControl.value))}async applyLabelEdit(){var e;if(this.isActive){if(((e=this.label)===null||e===void 0?void 0:e.text)===this.editControl.value){this.hide();return}if(this.blockApplyEditOnInvalidInput&&(await this.validateLabel(this.editControl.value)).severity==="error"){this.editControl.focus();return}this.actionDispatcherProvider().then(t=>t.dispatchAll([vfe.ApplyLabelEditAction.create(this.labelId,this.editControl.value),Sfe.CommitModelAction.create()])).catch(t=>this.logger.error(this,"No action dispatcher available to execute apply label edit action",t)),this.hide()}}performLabelValidation(e,t){this.validationTimeout&&window.clearTimeout(this.validationTimeout),this.validationTimeout=window.setTimeout(()=>this.validateLabel(t),200)}async validateLabel(e){if(this.labelValidator&&this.label)try{const t=await this.labelValidator.validate(e,this.label);return this.isCurrentLabelValid=t.severity!=="error",this.showValidationResult(t),t}catch(t){this.logger.error(this,"Error validating edited label",t)}return this.isCurrentLabelValid=!0,{severity:"ok",message:void 0}}showValidationResult(e){this.clearValidationResult(),this.validationDecorator&&this.validationDecorator.decorate(this.editControl,e)}clearValidationResult(){this.validationDecorator&&this.validationDecorator.dispose(this.editControl)}show(e,...t){!wfe(t,e)||this.isActive||(super.show(e,...t),this.isActive=!0)}hide(){this.editControl.style.visibility="hidden",super.hide(),this.clearValidationResult(),this.isActive=!1,this.isCurrentLabelValid=!0,this.previousLabelContent=void 0,this.labelElement&&(this.labelElement.style.visibility="visible")}onBeforeShow(e,t,...i){this.label=gU(i,t)[0],this.previousLabelContent=this.label.text,this.setPosition(e),this.applyTextContents(),this.applyFontStyling(),this.editControl.style.visibility="visible",this.editControl.focus()}setPosition(e){let t=0,i=0,o=100,r=20;if(this.label){const s=(0,I$.getZoom)(this.label),a=(0,Efe.getAbsoluteClientBounds)(this.label,this.domHelper,this.viewerOptions);t=a.x+(this.label.editControlPositionCorrection?this.label.editControlPositionCorrection.x:0)*s,i=a.y+(this.label.editControlPositionCorrection?this.label.editControlPositionCorrection.y:0)*s,r=(this.label.editControlDimension?this.label.editControlDimension.height:r)*s,o=(this.label.editControlDimension?this.label.editControlDimension.width:o)*s}e.style.left=`${t}px`,e.style.top=`${i}px`,e.style.width=`${o}px`,this.editControl.style.width=`${o}px`,e.style.height=`${r}px`,this.editControl.style.height=`${r}px`}applyTextContents(){this.label&&(this.editControl.value=this.label.text,this.editControl instanceof HTMLTextAreaElement?(this.editControl.selectionStart=0,this.editControl.selectionEnd=0,this.editControl.scrollTop=0,this.editControl.scrollLeft=0):this.editControl.setSelectionRange(0,this.editControl.value.length))}applyFontStyling(){if(this.label&&(this.labelElement=document.getElementById(this.domHelper.createUniqueDOMElementId(this.label)),this.labelElement)){this.labelElement.style.visibility="hidden";const e=window.getComputedStyle(this.labelElement);this.editControl.style.font=e.font,this.editControl.style.fontStyle=e.fontStyle,this.editControl.style.fontFamily=e.fontFamily,this.editControl.style.fontSize=Afe(e.fontSize,(0,I$.getZoom)(this.label)),this.editControl.style.fontWeight=e.fontWeight,this.editControl.style.lineHeight=e.lineHeight}}};aa.EditLabelUI=ca;ca.ID="editLabelUi";Ff([(0,hc.inject)(T0.TYPES.IActionDispatcherProvider),D0("design:type",Function)],ca.prototype,"actionDispatcherProvider",void 0);Ff([(0,hc.inject)(T0.TYPES.ViewerOptions),D0("design:type",Object)],ca.prototype,"viewerOptions",void 0);Ff([(0,hc.inject)(T0.TYPES.DOMHelper),D0("design:type",bfe.DOMHelper)],ca.prototype,"domHelper",void 0);Ff([(0,hc.inject)(T0.TYPES.IEditLabelValidator),(0,hc.optional)(),D0("design:type",Object)],ca.prototype,"labelValidator",void 0);Ff([(0,hc.inject)(T0.TYPES.IEditLabelValidationDecorator),(0,hc.optional)(),D0("design:type",Object)],ca.prototype,"validationDecorator",void 0);aa.EditLabelUI=ca=F2=Ff([(0,hc.injectable)()],ca);function wfe(n,e){return gU(n,e).length===1}function gU(n,e){return n.map(t=>e.index.getById(t)).filter(Pfe.isEditableLabel)}function Afe(n,e){return n.replace(/\d+(\.\d+)?/,t=>String(Number.parseInt(t,10)*e))}var _s={},vU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},_U=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Rfe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(_s,"__esModule",{value:!0});_s.SwitchEditModeCommand=_s.SwitchEditModeAction=void 0;const H2=F,Mfe=Ve,Ife=ke,Dfe=me,Yr=an,D$=vi,T$=$f;var K2;(function(n){n.KIND="switchEditMode";function e(t){var i,o;return{kind:n.KIND,elementsToActivate:(i=t.elementsToActivate)!==null&&i!==void 0?i:[],elementsToDeactivate:(o=t.elementsToDeactivate)!==null&&o!==void 0?o:[]}}n.create=e})(K2||(_s.SwitchEditModeAction=K2={}));let ey=class extends Mfe.Command{constructor(e){super(),this.action=e,this.elementsToActivate=[],this.elementsToDeactivate=[],this.handlesToRemove=[]}execute(e){const t=e.root.index;return this.action.elementsToActivate.forEach(i=>{const o=t.getById(i);o!==void 0&&this.elementsToActivate.push(o)}),this.action.elementsToDeactivate.forEach(i=>{const o=t.getById(i);if(o!==void 0&&this.elementsToDeactivate.push(o),o instanceof Yr.SRoutingHandleImpl&&o.parent instanceof Yr.SRoutableElementImpl){const r=o.parent;this.shouldRemoveHandle(o,r)&&(this.handlesToRemove.push({handle:o,parent:r}),this.elementsToDeactivate.push(r),this.elementsToActivate.push(r))}}),this.doExecute(e)}doExecute(e){return this.handlesToRemove.forEach(t=>{t.point=t.parent.routingPoints.splice(t.handle.pointIndex,1)[0]}),this.elementsToDeactivate.forEach(t=>{t instanceof Yr.SRoutableElementImpl?t.removeAll(i=>i instanceof Yr.SRoutingHandleImpl):t instanceof Yr.SRoutingHandleImpl&&(t.editMode=!1,t.danglingAnchor&&t.parent instanceof Yr.SRoutableElementImpl&&t.danglingAnchor.original&&(t.parent.source===t.danglingAnchor?t.parent.sourceId=t.danglingAnchor.original.id:t.parent.target===t.danglingAnchor&&(t.parent.targetId=t.danglingAnchor.original.id),t.danglingAnchor.parent.remove(t.danglingAnchor),t.danglingAnchor=void 0))}),this.elementsToActivate.forEach(t=>{(0,T$.canEditRouting)(t)&&t instanceof Ife.SParentElementImpl?this.edgeRouterRegistry.get(t.routerKind).createRoutingHandles(t):t instanceof Yr.SRoutingHandleImpl&&(t.editMode=!0)}),e.root}shouldRemoveHandle(e,t){return e.kind==="junction"?this.edgeRouterRegistry.route(t).find(o=>o.pointIndex===e.pointIndex)===void 0:!1}undo(e){return this.handlesToRemove.forEach(t=>{t.point!==void 0&&t.parent.routingPoints.splice(t.handle.pointIndex,0,t.point)}),this.elementsToActivate.forEach(t=>{t instanceof Yr.SRoutableElementImpl?t.removeAll(i=>i instanceof Yr.SRoutingHandleImpl):t instanceof Yr.SRoutingHandleImpl&&(t.editMode=!1)}),this.elementsToDeactivate.forEach(t=>{(0,T$.canEditRouting)(t)?this.edgeRouterRegistry.get(t.routerKind).createRoutingHandles(t):t instanceof Yr.SRoutingHandleImpl&&(t.editMode=!0)}),e.root}redo(e){return this.doExecute(e)}};_s.SwitchEditModeCommand=ey;ey.KIND=K2.KIND;vU([(0,H2.inject)(D$.EdgeRouterRegistry),_U("design:type",D$.EdgeRouterRegistry)],ey.prototype,"edgeRouterRegistry",void 0);_s.SwitchEditModeCommand=ey=vU([(0,H2.injectable)(),Rfe(0,(0,H2.inject)(Dfe.TYPES.Action)),_U("design:paramtypes",[Object])],ey);var xf={},yU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},bU=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Tfe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(xf,"__esModule",{value:!0});xf.ReconnectCommand=void 0;const V2=F,Ofe=se,Lfe=Ve,Nfe=me,jfe=an,O$=vi;let ty=class extends Lfe.Command{constructor(e){super(),this.action=e}execute(e){return this.doExecute(e),e.root}doExecute(e){const i=e.root.index.getById(this.action.routableId);if(i instanceof jfe.SRoutableElementImpl){const o=this.edgeRouterRegistry.get(i.routerKind),r=o.takeSnapshot(i);o.applyReconnect(i,this.action.newSourceId,this.action.newTargetId);const s=o.takeSnapshot(i);this.memento={edge:i,before:r,after:s}}}undo(e){return this.memento&&this.edgeRouterRegistry.get(this.memento.edge.routerKind).applySnapshot(this.memento.edge,this.memento.before),e.root}redo(e){return this.memento&&this.edgeRouterRegistry.get(this.memento.edge.routerKind).applySnapshot(this.memento.edge,this.memento.after),e.root}};xf.ReconnectCommand=ty;ty.KIND=Ofe.ReconnectAction.KIND;yU([(0,V2.inject)(O$.EdgeRouterRegistry),bU("design:type",O$.EdgeRouterRegistry)],ty.prototype,"edgeRouterRegistry",void 0);xf.ReconnectCommand=ty=yU([(0,V2.injectable)(),Tfe(0,(0,V2.inject)(Nfe.TYPES.Action)),bU("design:paramtypes",[Object])],ty);Object.defineProperty(ea,"__esModule",{value:!0});ea.labelEditUiModule=ea.labelEditModule=ea.edgeEditModule=void 0;const l7=F,z2=me,a3=wn,Bfe=qo,$fe=rn,kfe=an,Ffe=zn,xfe=Lf,sp=_n,sD=aa,Hfe=_s,Kfe=xf;ea.edgeEditModule=new l7.ContainerModule((n,e,t)=>{const i={bind:n,isBound:t};(0,a3.configureCommand)(i,Hfe.SwitchEditModeCommand),(0,a3.configureCommand)(i,Kfe.ReconnectCommand),(0,a3.configureCommand)(i,xfe.DeleteElementCommand),(0,$fe.configureModelElement)(i,"dangling-anchor",kfe.SDanglingAnchorImpl,Ffe.EmptyGroupView)});ea.labelEditModule=new l7.ContainerModule((n,e,t)=>{n(sp.EditLabelMouseListener).toSelf().inSingletonScope(),n(z2.TYPES.MouseListener).toService(sp.EditLabelMouseListener),n(sp.EditLabelKeyListener).toSelf().inSingletonScope(),n(z2.TYPES.KeyListener).toService(sp.EditLabelKeyListener),(0,a3.configureCommand)({bind:n,isBound:t},sp.ApplyLabelEditCommand)});ea.labelEditUiModule=new l7.ContainerModule((n,e,t)=>{const i={bind:n,isBound:t};(0,Bfe.configureActionHandler)(i,sp.EditLabelAction.KIND,sD.EditLabelActionHandler),n(sD.EditLabelUI).toSelf().inSingletonScope(),n(z2.TYPES.IUIExtension).toService(sD.EditLabelUI)});var Hf={},O0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isExpandable=n.expandFeature=void 0,n.expandFeature=Symbol("expandFeature");function e(t){return t.hasFeature(n.expandFeature)&&"expanded"in t}n.isExpandable=e})(O0);var Vfe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Hf,"__esModule",{value:!0});Hf.ExpandButtonHandler=void 0;const zfe=F,Gfe=se,Ufe=yt,Yfe=O0;let _C=class{buttonPressed(e){const t=(0,Ufe.findParentByFeature)(e,Yfe.isExpandable);return t!==void 0?[Gfe.CollapseExpandAction.create({expandIds:t.expanded?[]:[t.id],collapseIds:t.expanded?[t.id]:[]})]:[]}};Hf.ExpandButtonHandler=_C;_C.TYPE="button:expand";Hf.ExpandButtonHandler=_C=Vfe([(0,zfe.injectable)()],_C);var pg={},qfe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(pg,"__esModule",{value:!0});pg.ExpandButtonView=void 0;const aD=ei,Wfe=O0,Zfe=yt,Qfe=F;let G2=class{render(e,t){const i=(0,Zfe.findParentByFeature)(e,Wfe.isExpandable),o=i!==void 0&&i.expanded?"M 1,5 L 8,12 L 15,5 Z":"M 1,8 L 8,15 L 8,1 Z";return(0,aD.svg)("g",{"class-sprotty-button":"{true}","class-enabled":"{button.enabled}"},(0,aD.svg)("rect",{x:0,y:0,width:16,height:16,opacity:0}),(0,aD.svg)("path",{d:o}))}};pg.ExpandButtonView=G2;pg.ExpandButtonView=G2=qfe([(0,Qfe.injectable)()],G2);var qi={},wA=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},SU=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Xfe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(qi,"__esModule",{value:!0});qi.ExportSvgPostprocessor=qi.ExportSvgCommand=qi.RequestExportSvgAction=qi.ExportSvgKeyListener=void 0;const AA=F,Jfe=se,ehe=Ve,the=to,nhe=ke,ihe=gi,ohe=qt,L$=P0,rhe=rr,she=Rs,ahe=$u,EU=me;let U2=class extends ihe.KeyListener{keyDown(e,t){return(0,ohe.matchesKeystroke)(t,"KeyE","ctrlCmd","shift")?[ny.create()]:[]}};qi.ExportSvgKeyListener=U2;qi.ExportSvgKeyListener=U2=wA([(0,AA.injectable)()],U2);var ny;(function(n){n.KIND="requestExportSvg";function e(){return{kind:n.KIND,requestId:(0,Jfe.generateRequestId)()}}n.create=e})(ny||(qi.RequestExportSvgAction=ny={}));let yC=class extends ehe.HiddenCommand{constructor(e){super(),this.action=e}execute(e){if((0,L$.isExportable)(e.root)){const t=e.modelFactory.createRoot(e.root);if((0,L$.isExportable)(t))return(0,she.isViewport)(t)&&(t.zoom=1,t.scroll={x:0,y:0}),t.index.all().forEach(i=>{(0,the.isSelectable)(i)&&i.selected&&(i.selected=!1),(0,ahe.isHoverable)(i)&&i.hoverFeedback&&(i.hoverFeedback=!1)}),{model:t,modelChanged:!0,cause:this.action}}return{model:e.root,modelChanged:!1}}};qi.ExportSvgCommand=yC;yC.KIND=ny.KIND;qi.ExportSvgCommand=yC=wA([Xfe(0,(0,AA.inject)(EU.TYPES.Action)),SU("design:paramtypes",[Object])],yC);let bC=class{decorate(e,t){return t instanceof nhe.SModelRootImpl&&(this.root=t),e}postUpdate(e){this.root&&e!==void 0&&e.kind===ny.KIND&&this.svgExporter.export(this.root,e)}};qi.ExportSvgPostprocessor=bC;wA([(0,AA.inject)(EU.TYPES.SvgExporter),SU("design:type",rhe.SvgExporter)],bC.prototype,"svgExporter",void 0);qi.ExportSvgPostprocessor=bC=wA([(0,AA.injectable)()],bC);var da={},che=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(da,"__esModule",{value:!0});da.ElementFader=da.FadeAnimation=void 0;const dhe=F,uhe=Or,lhe=ke,fhe=ft,hhe=Of;class phe extends uhe.Animation{constructor(e,t,i,o=!1){super(i),this.model=e,this.elementFades=t,this.removeAfterFadeOut=o}tween(e,t){for(const i of this.elementFades){const o=i.element;i.type==="in"?o.opacity=e:i.type==="out"&&(o.opacity=1-e,e===1&&this.removeAfterFadeOut&&o instanceof lhe.SChildElementImpl&&o.parent.remove(o))}return this.model}}da.FadeAnimation=phe;let Y2=class{decorate(e,t){return(0,hhe.isFadeable)(t)&&t.opacity!==1&&(0,fhe.setAttr)(e,"opacity",t.opacity),e}postUpdate(){}};da.ElementFader=Y2;da.ElementFader=Y2=che([(0,dhe.injectable)()],Y2);var fn={},ku=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},L0=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},CU=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(fn,"__esModule",{value:!0});fn.ClosePopupActionHandler=fn.HoverKeyListener=fn.PopupHoverMouseListener=fn.HoverMouseListener=fn.AbstractHoverMouseListener=fn.SetPopupModelCommand=fn.HoverFeedbackCommand=void 0;const ua=F,Hs=se,mhe=De,ghe=qt,N0=me,N$=ke,vhe=Ut,PU=Ve,jl=$n,_he=gi,fv=yt,yhe=$t,ap=$u;let SC=class extends PU.SystemCommand{constructor(e){super(),this.action=e}execute(e){const i=e.root.index.getById(this.action.mouseoverElement);return i&&(0,ap.isHoverable)(i)&&(i.hoverFeedback=this.action.mouseIsOver),this.redo(e)}undo(e){return e.root}redo(e){return e.root}};fn.HoverFeedbackCommand=SC;SC.KIND=Hs.HoverFeedbackAction.KIND;fn.HoverFeedbackCommand=SC=ku([(0,ua.injectable)(),CU(0,(0,ua.inject)(N0.TYPES.Action)),L0("design:paramtypes",[Object])],SC);let iy=class extends PU.PopupCommand{constructor(e){super(),this.action=e}execute(e){return this.oldRoot=e.root,this.newRoot=e.modelFactory.createRoot(this.action.newRoot),this.newRoot}undo(e){return this.oldRoot}redo(e){return this.newRoot}};fn.SetPopupModelCommand=iy;iy.KIND=Hs.SetPopupModelAction.KIND;fn.SetPopupModelCommand=iy=ku([(0,ua.injectable)(),CU(0,(0,ua.inject)(N0.TYPES.Action)),L0("design:paramtypes",[Object])],iy);class j0 extends vhe.MouseListener{mouseDown(e,t){return this.mouseIsDown=!0,[]}mouseUp(e,t){return this.mouseIsDown=!1,[]}stopMouseOutTimer(){this.state.mouseOutTimer!==void 0&&(window.clearTimeout(this.state.mouseOutTimer),this.state.mouseOutTimer=void 0)}startMouseOutTimer(){return this.stopMouseOutTimer(),new Promise(e=>{this.state.mouseOutTimer=window.setTimeout(()=>{this.state.popupOpen=!1,this.state.previousPopupElement=void 0,e(Hs.SetPopupModelAction.create({type:jl.EMPTY_ROOT.type,id:jl.EMPTY_ROOT.id}))},this.options.popupCloseDelay)})}stopMouseOverTimer(){this.state.mouseOverTimer!==void 0&&(window.clearTimeout(this.state.mouseOverTimer),this.state.mouseOverTimer=void 0)}}fn.AbstractHoverMouseListener=j0;ku([(0,ua.inject)(N0.TYPES.ViewerOptions),L0("design:type",Object)],j0.prototype,"options",void 0);ku([(0,ua.inject)(N0.TYPES.HoverState),L0("design:type",Object)],j0.prototype,"state",void 0);let EC=class extends j0{computePopupBounds(e,t){let i={x:-5,y:20};const o=(0,yhe.getAbsoluteBounds)(e),r=e.root.canvasBounds,s=mhe.Bounds.translate(o,r),a=s.x+s.width-t.x,f=s.y+s.height-t.y;f<=a&&this.allowSidePosition(e,"below",f)?i={x:-5,y:Math.round(f+5)}:a<=f&&this.allowSidePosition(e,"right",a)&&(i={x:Math.round(a+5),y:-5});let h=t.x+i.x;const g=r.x+r.width;h>g&&(h=g);let y=t.y+i.y;const S=r.y+r.height;return y>S&&(y=S),{x:h,y,width:-1,height:-1}}allowSidePosition(e,t,i){return!(e instanceof N$.SModelRootImpl)&&i<=150}startMouseOverTimer(e,t){return this.stopMouseOverTimer(),new Promise(i=>{this.state.mouseOverTimer=window.setTimeout(()=>{const o=this.computePopupBounds(e,{x:t.pageX,y:t.pageY});i(Hs.RequestPopupModelAction.create({elementId:e.id,bounds:o})),this.state.popupOpen=!0,this.state.previousPopupElement=e},this.options.popupOpenDelay)})}mouseOver(e,t){const i=[];if(!this.mouseIsDown){const o=(0,fv.findParent)(e,ap.hasPopupFeature);this.state.popupOpen&&(o===void 0||this.state.previousPopupElement!==void 0&&this.state.previousPopupElement.id!==o.id)?i.push(this.startMouseOutTimer()):(this.stopMouseOverTimer(),this.stopMouseOutTimer()),o!==void 0&&(this.state.previousPopupElement===void 0||this.state.previousPopupElement.id!==o.id)&&i.push(this.startMouseOverTimer(o,t)),this.lastHoverFeedbackElementId&&(i.push(Hs.HoverFeedbackAction.create({mouseoverElement:this.lastHoverFeedbackElementId,mouseIsOver:!1})),this.lastHoverFeedbackElementId=void 0);const r=(0,fv.findParentByFeature)(e,ap.isHoverable);r!==void 0&&(i.push(Hs.HoverFeedbackAction.create({mouseoverElement:r.id,mouseIsOver:!0})),this.lastHoverFeedbackElementId=r.id)}return i}mouseOut(e,t){const i=[];if(!this.mouseIsDown){const o=this.getElementFromEventPosition(t);if(!this.isSprottyPopup(o)){if(this.state.popupOpen){const s=(0,fv.findParent)(e,ap.hasPopupFeature);this.state.previousPopupElement!==void 0&&s!==void 0&&this.state.previousPopupElement.id===s.id&&i.push(this.startMouseOutTimer())}this.stopMouseOverTimer();const r=(0,fv.findParentByFeature)(e,ap.isHoverable);r!==void 0&&(i.push(Hs.HoverFeedbackAction.create({mouseoverElement:r.id,mouseIsOver:!1})),this.lastHoverFeedbackElementId&&this.lastHoverFeedbackElementId!==r.id&&i.push(Hs.HoverFeedbackAction.create({mouseoverElement:this.lastHoverFeedbackElementId,mouseIsOver:!1})),this.lastHoverFeedbackElementId=void 0)}}return i}getElementFromEventPosition(e){return document.elementFromPoint(e.x,e.y)}isSprottyPopup(e){return e?e.id===this.options.popupDiv||!!e.parentElement&&this.isSprottyPopup(e.parentElement):!1}mouseMove(e,t){const i=[];if(!this.mouseIsDown){this.state.previousPopupElement!==void 0&&this.closeOnMouseMove(this.state.previousPopupElement,t)&&i.push(this.startMouseOutTimer());const o=(0,fv.findParent)(e,ap.hasPopupFeature);o!==void 0&&(this.state.previousPopupElement===void 0||this.state.previousPopupElement.id!==o.id)&&i.push(this.startMouseOverTimer(o,t))}return i}closeOnMouseMove(e,t){return e instanceof N$.SModelRootImpl}};fn.HoverMouseListener=EC;ku([(0,ua.inject)(N0.TYPES.ViewerOptions),L0("design:type",Object)],EC.prototype,"options",void 0);fn.HoverMouseListener=EC=ku([(0,ua.injectable)()],EC);let q2=class extends j0{mouseOut(e,t){return[this.startMouseOutTimer()]}mouseOver(e,t){return this.stopMouseOutTimer(),this.stopMouseOverTimer(),[]}};fn.PopupHoverMouseListener=q2;fn.PopupHoverMouseListener=q2=ku([(0,ua.injectable)()],q2);class bhe extends _he.KeyListener{keyDown(e,t){return(0,ghe.matchesKeystroke)(t,"Escape")?[Hs.SetPopupModelAction.create({type:jl.EMPTY_ROOT.type,id:jl.EMPTY_ROOT.id})]:[]}}fn.HoverKeyListener=bhe;let W2=class{constructor(){this.popupOpen=!1}handle(e){if(e.kind===iy.KIND)this.popupOpen=e.newRoot.type!==jl.EMPTY_ROOT.type;else if(this.popupOpen)return Hs.SetPopupModelAction.create({id:jl.EMPTY_ROOT.id,type:jl.EMPTY_ROOT.type})}};fn.ClosePopupActionHandler=W2;fn.ClosePopupActionHandler=W2=ku([(0,ua.injectable)()],W2);var B0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SIssue=n.SIssueMarker=n.SIssueMarkerImpl=n.SDecoration=n.isDecoration=n.decorationFeature=void 0;const e=$t,t=$u;n.decorationFeature=Symbol("decorationFeature");function i(a){return a.hasFeature(n.decorationFeature)}n.isDecoration=i;class o extends e.SShapeElementImpl{}n.SDecoration=o,o.DEFAULT_FEATURES=[n.decorationFeature,e.boundsFeature,t.hoverFeedbackFeature,t.popupFeature];class r extends o{}n.SIssueMarkerImpl=r,n.SIssueMarker=r;class s{}n.SIssue=s})(B0);var Kf={},She=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Kf,"__esModule",{value:!0});Kf.IssueMarkerView=void 0;const cD=ei,Ehe=ft,Che=F;let Z2=class{render(e,t){const i=.008928571428571428,o=`scale(${i}, ${i})`,r=this.getMaxSeverity(e),s=(0,cD.svg)("g",{"class-sprotty-issue":!0},(0,cD.svg)("g",{transform:o},(0,cD.svg)("path",{d:this.getPath(r)})));return(0,Ehe.setClass)(s,"sprotty-"+r,!0),s}getMaxSeverity(e){let t="info";for(const i of e.issues.map(o=>o.severity))(i==="error"||i==="warning"&&t==="info")&&(t=i);return t}getPath(e){switch(e){case"error":case"warning":return"M768 128q209 0 385.5 103t279.5 279.5 103 385.5-103 385.5-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103zm128 1247v-190q0-14-9-23.5t-22-9.5h-192q-13 0-23 10t-10 23v190q0 13 10 23t23 10h192q13 0 22-9.5t9-23.5zm-2-344l18-621q0-12-10-18-10-8-24-8h-220q-14 0-24 8-10 6-10 18l17 621q0 10 10 17.5t24 7.5h185q14 0 23.5-7.5t10.5-17.5z";case"info":return"M1024 1376v-160q0-14-9-23t-23-9h-96v-512q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v160q0 14 9 23t23 9h96v320h-96q-14 0-23 9t-9 23v160q0 14 9 23t23 9h448q14 0 23-9t9-23zm-128-896v-160q0-14-9-23t-23-9h-192q-14 0-23 9t-9 23v160q0 14 9 23t23 9h192q14 0 23-9t9-23zm640 416q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"}}};Kf.IssueMarkerView=Z2;Kf.IssueMarkerView=Z2=She([(0,Che.injectable)()],Z2);var Vf={},wU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Phe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Vf,"__esModule",{value:!0});Vf.DecorationPlacer=void 0;const AU=F,whe=ke,Ahe=B0,Rhe=ft,j$=$t,Mhe=an,B$=vi,$$=kr;let CC=class{decorate(e,t){if((0,Ahe.isDecoration)(t)){const i=this.getPosition(t),o="translate("+i.x+", "+i.y+")";(0,Rhe.setAttr)(e,"transform",o)}return e}getPosition(e){if(e instanceof whe.SChildElementImpl&&e.parent instanceof Mhe.SRoutableElementImpl){const t=this.edgeRouterRegistry.route(e.parent);if(t.length>1){const i=Math.floor(.5*(t.length-1)),o=(0,j$.isSizeable)(e)?{x:-.5*e.bounds.width,y:-.5*e.bounds.width}:$$.Point.ORIGIN;return{x:.5*(t[i].x+t[i+1].x)+o.x,y:.5*(t[i].y+t[i+1].y)+o.y}}}return(0,j$.isSizeable)(e)?{x:-.666*e.bounds.width,y:-.666*e.bounds.height}:$$.Point.ORIGIN}postUpdate(){}};Vf.DecorationPlacer=CC;wU([(0,AU.inject)(B$.EdgeRouterRegistry),Phe("design:type",B$.EdgeRouterRegistry)],CC.prototype,"edgeRouterRegistry",void 0);Vf.DecorationPlacer=CC=wU([(0,AU.injectable)()],CC);var Zn={};class Ihe{constructor(e=[],t=Dhe){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:i}=this,o=t[e];for(;e>0;){const r=e-1>>1,s=t[r];if(i(o,s)>=0)break;t[e]=s,e=r}t[e]=o}_down(e){const{data:t,compare:i}=this,o=this.length>>1,r=t[e];for(;e<o;){let s=(e<<1)+1,a=t[s];const f=s+1;if(f<this.length&&i(t[f],a)<0&&(s=f,a=t[f]),i(a,r)>=0)break;t[e]=a,e=s}t[e]=r}}function Dhe(n,e){return n<e?-1:n>e?1:0}const The=Object.freeze(Object.defineProperty({__proto__:null,default:Ihe},Symbol.toStringTag,{value:"Module"})),RU=R6(The);var Ln={},Ohe=l&&l.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ln,"__esModule",{value:!0});Ln.intersectionOfSegments=Ln.getSegmentIndex=Ln.checkWhichSegmentHasRightEndpointFirst=Ln.runSweep=Ln.Segment=Ln.SweepEvent=Ln.checkWhichEventIsLeft=Ln.addRoute=void 0;const Lhe=Ohe(RU),k$=Jn;function Nhe(n,e,t){if(e.length<1)return;let i=e[0],o;for(let r=0;r<e.length-1;r++){o=e[r+1];const s=new Q2(n,i,r),a=new Q2(n,o,r+1);s.otherEvent=a,a.otherEvent=s,MU(s,a)>0?(a.isLeftEndpoint=!0,s.isLeftEndpoint=!1):(s.isLeftEndpoint=!0,a.isLeftEndpoint=!1),t.push(s),t.push(a),i=o}}Ln.addRoute=Nhe;function MU(n,e){return n.point.x>e.point.x?1:n.point.x<e.point.x?-1:n.point.y!==e.point.y?n.point.y>e.point.y?1:-1:1}Ln.checkWhichEventIsLeft=MU;class Q2{constructor(e,t,i){this.edgeId=e,this.point=t,this.segmentIndex=i}}Ln.SweepEvent=Q2;class IU{constructor(e){this.leftSweepEvent=e,this.rightSweepEvent=e.otherEvent}}Ln.Segment=IU;function jhe(n){const e=[],t=new Lhe.default([],DU);for(;n.length;){const i=n.pop();if(i!=null&&i.isLeftEndpoint){const o=new IU(i);for(let r=0;r<t.data.length;r++){const s=t.data[r],a=TU(o,s);a&&e.push({routable1:i.edgeId,routable2:s.leftSweepEvent.edgeId,segmentIndex1:X2(o),segmentIndex2:X2(s),intersectionPoint:a})}t.push(o)}else(i==null?void 0:i.isLeftEndpoint)===!1&&t.pop()}return e}Ln.runSweep=jhe;function DU(n,e){return n.rightSweepEvent.point.x>e.rightSweepEvent.point.x?1:n.rightSweepEvent.point.x<e.rightSweepEvent.point.x?-1:n.rightSweepEvent.point.y!==e.rightSweepEvent.point.y?n.rightSweepEvent.point.y<e.rightSweepEvent.point.y?1:-1:1}Ln.checkWhichSegmentHasRightEndpointFirst=DU;function X2(n){return Math.min(n.leftSweepEvent.segmentIndex,n.rightSweepEvent.segmentIndex)}Ln.getSegmentIndex=X2;function TU(n,e){if(n.leftSweepEvent.edgeId===e.leftSweepEvent.edgeId)return;const t=new k$.PointToPointLine(n.leftSweepEvent.point,n.rightSweepEvent.point),i=new k$.PointToPointLine(e.leftSweepEvent.point,e.rightSweepEvent.point);return t.intersection(i)}Ln.intersectionOfSegments=TU;var Bhe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},$he=l&&l.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Zn,"__esModule",{value:!0});Zn.IntersectionFinder=Zn.BY_DESCENDING_X_THEN_DESCENDING_Y=Zn.BY_X_THEN_DESCENDING_Y=Zn.BY_DESCENDING_X_THEN_Y=Zn.BY_X_THEN_Y=Zn.isIntersectingRoutedPoint=void 0;const khe=F,Fhe=$he(RU),dD=Ln;function OU(n){return n!==void 0&&"intersections"in n&&"kind"in n}Zn.isIntersectingRoutedPoint=OU;const xhe=(n,e)=>n.intersectionPoint.x===e.intersectionPoint.x?n.intersectionPoint.y-e.intersectionPoint.y:n.intersectionPoint.x-e.intersectionPoint.x;Zn.BY_X_THEN_Y=xhe;const Hhe=(n,e)=>n.intersectionPoint.x===e.intersectionPoint.x?n.intersectionPoint.y-e.intersectionPoint.y:e.intersectionPoint.x-n.intersectionPoint.x;Zn.BY_DESCENDING_X_THEN_Y=Hhe;const Khe=(n,e)=>n.intersectionPoint.x===e.intersectionPoint.x?e.intersectionPoint.y-n.intersectionPoint.y:n.intersectionPoint.x-e.intersectionPoint.x;Zn.BY_X_THEN_DESCENDING_Y=Khe;const Vhe=(n,e)=>n.intersectionPoint.x===e.intersectionPoint.x?e.intersectionPoint.y-n.intersectionPoint.y:e.intersectionPoint.x-n.intersectionPoint.x;Zn.BY_DESCENDING_X_THEN_DESCENDING_Y=Vhe;let J2=class{apply(e){const t=this.find(e);this.addToRouting(t,e)}find(e){const t=new Fhe.default(void 0,dD.checkWhichEventIsLeft);return e.routes.forEach((i,o)=>{this.isSupportedRoute(i)&&(0,dD.addRoute)(o,i,t)}),(0,dD.runSweep)(t)}isSupportedRoute(e){return e.find(t=>t.kind!=="source"&&t.kind!=="target"&&t.kind!=="linear")===void 0}addToRouting(e,t){for(const i of e){const o=t.get(i.routable1),r=t.get(i.routable2);this.addIntersectionToRoutedPoint(i,o,i.segmentIndex1),this.addIntersectionToRoutedPoint(i,r,i.segmentIndex2)}}addIntersectionToRoutedPoint(e,t,i){if(t&&t.length>i){const o=t[i+1];if(OU(o))o.intersections.push(e);else{const r=Object.assign(Object.assign({},o),{intersections:[e]});t[i+1]=r}}}};Zn.IntersectionFinder=J2;Zn.IntersectionFinder=J2=Bhe([(0,khe.injectable)()],J2);var zf={},zhe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(zf,"__esModule",{value:!0});zf.JunctionFinder=void 0;const Ghe=F,Uhe=Sn;let e8=class{constructor(){this.edgesMap=new Map,this.sourcesMap=new Map,this.targetsMap=new Map}apply(e,t){this.findJunctions(e,t)}findJunctions(e,t){Array.from(t.index.all().filter(o=>o instanceof Uhe.SEdgeImpl)).forEach(o=>{this.edgesMap.set(o.id,o);const r=this.sourcesMap.get(o.sourceId);r?r.add(o.id):this.sourcesMap.set(o.sourceId,new Set([o.id]));const s=this.targetsMap.get(o.targetId);s?s.add(o.id):this.targetsMap.set(o.targetId,new Set([o.id]))}),e.routes.forEach((o,r)=>{const s=this.edgesMap.get(r);s&&(this.findJunctionPointsWithSameSource(s,o,e),this.findJunctionPointsWithSameTarget(s,o,e))})}findJunctionPointsWithSameSource(e,t,i){const o=this.sourcesMap.get(e.sourceId);if(!o)return;const s=Array.from(o).filter(a=>a!==e.id).map(a=>i.get(a)).filter(a=>a!==void 0);for(const a of s){const f=this.getJunctionIndex(t,a);f===-1||f===0||this.setJunctionPoints(t,a,f)}}findJunctionPointsWithSameTarget(e,t,i){const o=this.targetsMap.get(e.targetId);if(!o)return;const s=Array.from(o).filter(a=>a!==e.id).map(a=>i.get(a)).filter(a=>a!==void 0);t.reverse();for(const a of s){a.reverse();const f=this.getJunctionIndex(t,a);f===-1||f===0||(this.setJunctionPoints(t,a,f),a.reverse())}t.reverse()}setJunctionPoints(e,t,i){const o=this.getSegmentDirection(e[i-1],e[i]),r=this.getSegmentDirection(t[i-1],t[i]);if(o!==r)this.setPreviousPointAsJunction(e,t,i);else if(o==="left"||o==="right"){if(e[i].y!==t[i].y){this.setPreviousPointAsJunction(e,t,i);return}e[i].isJunction=o==="left"?e[i].x>t[i].x:e[i].x<t[i].x,t[i].isJunction=o==="left"?t[i].x>e[i].x:t[i].x<e[i].x}else{if(e[i].x!==t[i].x){this.setPreviousPointAsJunction(e,t,i);return}e[i].isJunction=o==="up"?e[i].y>t[i].y:e[i].y<t[i].y,t[i].isJunction=o==="up"?t[i].y>e[i].y:t[i].y<e[i].y}}setPreviousPointAsJunction(e,t,i){e[i-1].isJunction=!0,t[i-1].isJunction=!0}getSegmentDirection(e,t){const i=t.x-e.x,o=t.y-e.y;let r="horizontal";return Math.abs(i)<Math.abs(o)&&(r="vertical"),r==="horizontal"?i>0?"right":"left":o>0?"down":"up"}getJunctionIndex(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i].x!==t[i].x||e[i].y!==t[i].y)return i;i++}return-1}};zf.JunctionFinder=e8;zf.JunctionFinder=e8=zhe([(0,Ghe.injectable)()],e8);var Xn={},$0=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},RA=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Yhe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}},c3;Object.defineProperty(Xn,"__esModule",{value:!0});Xn.LocationPostprocessor=Xn.MoveMouseListener=Xn.MorphEdgesAnimation=Xn.MoveAnimation=Xn.MoveCommand=void 0;const pc=F,wd=De,_d=se,l_=Or,qhe=Ve,Bl=ke,f_=yt,LU=me,Whe=Ut,Zhe=ft,Qhe=Sn,Xhe=vs,NU=$t,F$=s7,pE=_s,Jhe=xf,Tn=an,PC=vi,epe=Bf,jU=to,tpe=Rs,gp=Hc;let oy=c3=class extends qhe.MergeableCommand{constructor(e){super(),this.action=e,this.resolvedMoves=new Map,this.edgeMementi=[],this.stoppableCommandKey=c3.KIND}stopExecution(){this.animation&&(this.animation.stop(),this.animation=void 0)}execute(e){const t=e.root.index,i=new Map,o=new Map;return this.action.moves.forEach(r=>{const s=t.getById(r.elementId);if(s instanceof Tn.SRoutingHandleImpl&&this.edgeRouterRegistry){const a=s.parent;if(a instanceof Tn.SRoutableElementImpl){const f=this.resolveHandleMove(s,a,r);if(f){let h=i.get(a);h||(h=[],i.set(a,h)),h.push(f)}}}else if(s&&(0,gp.isLocateable)(s)){const a=this.resolveElementMove(s,r);if(a&&(this.resolvedMoves.set(a.element.id,a),this.edgeRouterRegistry)){const f=g=>{t.getAttachedElements(g).forEach(y=>{if(y instanceof Tn.SRoutableElementImpl&&!this.isChildOfMovedElements(y)){const S=o.get(y),P=wd.Point.subtract(a.toPosition,a.fromPosition),w=S?wd.Point.linear(S,P,.5):P;o.set(y,w)}})},h=g=>{(0,Bl.isParent)(g)&&g.children.forEach(y=>{y instanceof Bl.SModelElementImpl&&(y instanceof Tn.SConnectableElementImpl&&f(y),h(y))})};h(s),f(s)}}}),this.doMove(i,o),this.action.animate?(this.undoMove(),(this.animation=new l_.CompoundAnimation(e.root,e,[new d3(e.root,this.resolvedMoves,e,!1),new u3(e.root,this.edgeMementi,e,!1)])).start()):e.root}resolveHandleMove(e,t,i){let o=i.fromPosition;if(!o){const r=this.edgeRouterRegistry.get(t.routerKind);o=r.getHandlePosition(t,r.route(t),e)}if(o)return{handle:e,fromPosition:o,toPosition:i.toPosition}}resolveElementMove(e,t){const i=t.fromPosition||{x:e.position.x,y:e.position.y};return{element:e,fromPosition:i,toPosition:t.toPosition}}doMove(e,t){this.resolvedMoves.forEach(i=>{i.element.position=i.toPosition}),e.forEach((i,o)=>{const r=this.edgeRouterRegistry.get(o.routerKind),s=r.takeSnapshot(o);r.applyHandleMoves(o,i);const a=r.takeSnapshot(o);this.edgeMementi.push({edge:o,before:s,after:a})}),t.forEach((i,o)=>{if(!e.get(o)){const r=this.edgeRouterRegistry.get(o.routerKind),s=r.takeSnapshot(o);if(this.isAttachedEdge(o))o.routingPoints=o.routingPoints.map(f=>wd.Point.add(f,i));else{const f=(0,jU.isSelectable)(o)&&o.selected;r.cleanupRoutingPoints(o,o.routingPoints,f,this.action.finished)}const a=r.takeSnapshot(o);this.edgeMementi.push({edge:o,before:s,after:a})}})}isChildOfMovedElements(e){const t=e.parent;return Array.from(this.resolvedMoves.values()).map(i=>i.element.id).includes(t.id)?!0:t instanceof Bl.SChildElementImpl?this.isChildOfMovedElements(t):!1}isAttachedEdge(e){const t=e.source,i=e.target,o=r=>!!this.resolvedMoves.get(r.id)||this.isChildOfMovedElements(r);return!!(t&&i&&o(t)&&o(i))}undoMove(){this.resolvedMoves.forEach(e=>{e.element.position=e.fromPosition}),this.edgeMementi.forEach(e=>{this.edgeRouterRegistry.get(e.edge.routerKind).applySnapshot(e.edge,e.before)})}undo(e){return new l_.CompoundAnimation(e.root,e,[new d3(e.root,this.resolvedMoves,e,!0),new u3(e.root,this.edgeMementi,e,!0)]).start()}redo(e){return new l_.CompoundAnimation(e.root,e,[new d3(e.root,this.resolvedMoves,e,!1),new u3(e.root,this.edgeMementi,e,!1)]).start()}merge(e,t){if(!this.action.animate&&e instanceof c3)return e.resolvedMoves.forEach((i,o)=>{const r=this.resolvedMoves.get(o);r?r.toPosition=i.toPosition:this.resolvedMoves.set(o,i)}),e.edgeMementi.forEach(i=>{const o=this.edgeMementi.find(r=>r.edge.id===i.edge.id);o?o.after=i.after:this.edgeMementi.push(i)}),!0;if(e instanceof Jhe.ReconnectCommand){const i=e.memento;if(i){const o=this.edgeMementi.find(r=>r.edge.id===i.edge.id);o?o.after=i.after:this.edgeMementi.push(i)}return!0}return!1}};Xn.MoveCommand=oy;oy.KIND=_d.MoveAction.KIND;$0([(0,pc.inject)(PC.EdgeRouterRegistry),(0,pc.optional)(),RA("design:type",PC.EdgeRouterRegistry)],oy.prototype,"edgeRouterRegistry",void 0);Xn.MoveCommand=oy=c3=$0([(0,pc.injectable)(),Yhe(0,(0,pc.inject)(LU.TYPES.Action)),RA("design:paramtypes",[Object])],oy);class d3 extends l_.Animation{constructor(e,t,i,o=!1){super(i),this.model=e,this.elementMoves=t,this.reverse=o}tween(e){return this.elementMoves.forEach(t=>{this.reverse?t.element.position={x:(1-e)*t.toPosition.x+e*t.fromPosition.x,y:(1-e)*t.toPosition.y+e*t.fromPosition.y}:t.element.position={x:(1-e)*t.fromPosition.x+e*t.toPosition.x,y:(1-e)*t.fromPosition.y+e*t.toPosition.y}}),this.model}}Xn.MoveAnimation=d3;class u3 extends l_.Animation{constructor(e,t,i,o=!1){super(i),this.model=e,this.reverse=o,this.expanded=[],t.forEach(r=>{const s=this.reverse?r.after:r.before,a=this.reverse?r.before:r.after,f=s.routedPoints,h=a.routedPoints,g=Math.max(f.length,h.length);this.expanded.push({startExpandedRoute:this.growToSize(f,g),endExpandedRoute:this.growToSize(h,g),memento:r})})}midPoint(e){const t=e.edge,i=e.edge.source,o=e.edge.target;return wd.Point.linear((0,f_.translatePoint)(wd.Bounds.center(i.bounds),i.parent,t.parent),(0,f_.translatePoint)(wd.Bounds.center(o.bounds),o.parent,t.parent),.5)}start(){return this.expanded.forEach(e=>{e.memento.edge.removeAll(t=>t instanceof Tn.SRoutingHandleImpl)}),super.start()}tween(e){return e===1?this.expanded.forEach(t=>{const i=t.memento;this.reverse?i.before.router.applySnapshot(i.edge,i.before):i.after.router.applySnapshot(i.edge,i.after)}):this.expanded.forEach(t=>{const i=[];for(let s=1;s<t.startExpandedRoute.length-1;++s)i.push(wd.Point.linear(t.startExpandedRoute[s],t.endExpandedRoute[s],e));const o=e<.5?t.memento.before:t.memento.after,r=Object.assign(Object.assign({},o),{routingPoints:i,routingHandles:[]});o.router.applySnapshot(t.memento.edge,r)}),this.model}growToSize(e,t){const i=t-e.length;if(i<=0)return e;const o=[];o.push(e[0]);const r=1/(i+1),s=1/(e.length-1);let a=1;for(let f=1;f<e.length;++f){const h=s*f;let g=0;for(;h>(a+g)*r;)++g;a+=g;for(let y=0;y<g;++y){const S=wd.Point.linear(e[f-1],e[f],(y+1)/(g+1));o.push(S)}o.push(e[f])}return o}}Xn.MorphEdgesAnimation=u3;class f7 extends Whe.MouseListener{constructor(){super(...arguments),this.hasDragged=!1,this.elementId2startPos=new Map}mouseDown(e,t){if(t.button===0){const i=(0,f_.findParentByFeature)(e,gp.isMoveable),o=e instanceof Tn.SRoutingHandleImpl;if(i!==void 0||o||(0,F$.isCreatingOnDrag)(e)?this.startDragPosition={x:t.pageX,y:t.pageY}:this.startDragPosition=void 0,this.hasDragged=!1,(0,F$.isCreatingOnDrag)(e))return this.startCreatingOnDrag(e,t);if(o)return this.activateRoutingHandle(e,t)}return[]}startCreatingOnDrag(e,t){const i=[];return i.push(_d.SelectAllAction.create({select:!1})),i.push(e.createAction(Tn.edgeInProgressID)),i.push(_d.SelectAction.create({selectedElementsIDs:[Tn.edgeInProgressID]})),i.push(pE.SwitchEditModeAction.create({elementsToActivate:[Tn.edgeInProgressID]})),i.push(_d.SelectAction.create({selectedElementsIDs:[Tn.edgeInProgressTargetHandleID]})),i.push(pE.SwitchEditModeAction.create({elementsToActivate:[Tn.edgeInProgressTargetHandleID]})),i}activateRoutingHandle(e,t){return[pE.SwitchEditModeAction.create({elementsToActivate:[e.id]})]}mouseMove(e,t){const i=[];if(t.buttons===0)this.mouseUp(e,t);else if(this.startDragPosition){this.elementId2startPos.size===0&&this.collectStartPositions(e.root),this.hasDragged=!0;const o=this.getElementMoves(e,t,!1);o&&i.push(o)}return i}collectStartPositions(e){const t=new Set(e.index.all().filter(i=>(0,jU.isSelectable)(i)&&i.selected));t.forEach(i=>{if(!this.isChildOfSelected(t,i)){if((0,gp.isMoveable)(i))this.elementId2startPos.set(i.id,i.position);else if(i instanceof Tn.SRoutingHandleImpl){const o=this.getHandlePosition(i);o&&this.elementId2startPos.set(i.id,o)}}})}isChildOfSelected(e,t){for(;t instanceof Bl.SChildElementImpl;)if(t=t.parent,(0,gp.isMoveable)(t)&&e.has(t))return!0;return!1}getElementMoves(e,t,i){if(!this.startDragPosition)return;const o=[],r=(0,f_.findParentByFeature)(e,tpe.isViewport),s=r?r.zoom:1,a={x:(t.pageX-this.startDragPosition.x)/s,y:(t.pageY-this.startDragPosition.y)/s};if(this.elementId2startPos.forEach((f,h)=>{const g=e.root.index.getById(h);if(g){const y=this.createElementMove(g,f,a,t);y&&o.push(y)}}),o.length>0)return _d.MoveAction.create(o,{animate:!1,finished:i})}createElementMove(e,t,i,o){const r=this.snap({x:t.x+i.x,y:t.y+i.y},e,!o.shiftKey);if((0,gp.isMoveable)(e))return{elementId:e.id,elementType:e.type,fromPosition:{x:e.position.x,y:e.position.y},toPosition:r};if(e instanceof Tn.SRoutingHandleImpl){const s=this.getHandlePosition(e);if(s!==void 0)return{elementId:e.id,elementType:e.type,fromPosition:s,toPosition:r}}}snap(e,t,i){return i&&this.snapper?this.snapper.snap(e,t):e}getHandlePosition(e){if(this.edgeRouterRegistry){const t=e.parent;if(!(t instanceof Tn.SRoutableElementImpl))return;const i=this.edgeRouterRegistry.get(t.routerKind),o=i.route(t);return i.getHandlePosition(t,o,e)}}mouseEnter(e,t){return e instanceof Bl.SModelRootImpl&&t.buttons===0&&!this.startDragPosition&&this.mouseUp(e,t),[]}mouseUp(e,t){const i=[];if(this.startDragPosition){const o=this.getElementMoves(e,t,!0);o&&i.push(o),e.root.index.all().forEach(r=>{r instanceof Tn.SRoutingHandleImpl&&i.push(...this.deactivateRoutingHandle(r,e,t))})}if(!i.some(o=>o.kind===_d.ReconnectAction.KIND)){const o=e.root.index.getById(Tn.edgeInProgressID);o instanceof Bl.SChildElementImpl&&i.push(this.deleteEdgeInProgress(o))}return this.hasDragged&&i.push(Xhe.CommitModelAction.create()),this.hasDragged=!1,this.startDragPosition=void 0,this.elementId2startPos.clear(),i}deactivateRoutingHandle(e,t,i){const o=[],r=e.parent;if(r instanceof Tn.SRoutableElementImpl&&e.danglingAnchor){const s=this.getHandlePosition(e);if(s){const a=(0,f_.translatePoint)(s,e.parent,e.root),f=(0,NU.findChildrenAtPosition)(t.root,a).find(h=>(0,Tn.isConnectable)(h)&&h.canConnect(r,e.kind));f&&this.hasDragged&&o.push(_d.ReconnectAction.create({routableId:e.parent.id,newSourceId:e.kind==="source"?f.id:r.sourceId,newTargetId:e.kind==="target"?f.id:r.targetId}))}}return e.editMode&&o.push(pE.SwitchEditModeAction.create({elementsToDeactivate:[e.id]})),o}deleteEdgeInProgress(e){const t=[];return t.push(Tn.edgeInProgressID),e.children.forEach(i=>{i instanceof Tn.SRoutingHandleImpl&&i.danglingAnchor&&t.push(i.danglingAnchor.id)}),_d.DeleteElementAction.create(t)}decorate(e,t){return e}}Xn.MoveMouseListener=f7;$0([(0,pc.inject)(PC.EdgeRouterRegistry),(0,pc.optional)(),RA("design:type",PC.EdgeRouterRegistry)],f7.prototype,"edgeRouterRegistry",void 0);$0([(0,pc.inject)(LU.TYPES.ISnapper),(0,pc.optional)(),RA("design:type",Object)],f7.prototype,"snapper",void 0);let t8=class{decorate(e,t){if((0,epe.isEdgeLayoutable)(t)&&t.parent instanceof Qhe.SEdgeImpl)return e;let i="";if((0,gp.isLocateable)(t)&&t instanceof Bl.SChildElementImpl&&t.parent!==void 0){const o=t.position;(o.x!==0||o.y!==0)&&(i="translate("+o.x+", "+o.y+")")}if((0,NU.isAlignable)(t)){const o=t.alignment;(o.x!==0||o.y!==0)&&(i.length>0&&(i+=" "),i+="translate("+o.x+", "+o.y+")")}return i.length>0&&(0,Zhe.setAttr)(e,"transform",i),e}postUpdate(){}};Xn.LocationPostprocessor=t8;Xn.LocationPostprocessor=t8=$0([(0,pc.injectable)()],t8);var mg={},npe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(mg,"__esModule",{value:!0});mg.CenterGridSnapper=void 0;const ipe=F,ope=$t;let n8=class{get gridX(){return 10}get gridY(){return 10}snap(e,t){return t&&(0,ope.isBoundsAware)(t)?{x:Math.round((e.x+.5*t.bounds.width)/this.gridX)*this.gridX-.5*t.bounds.width,y:Math.round((e.y+.5*t.bounds.height)/this.gridY)*this.gridY-.5*t.bounds.height}:{x:Math.round(e.x/this.gridX)*this.gridX,y:Math.round(e.y/this.gridY)*this.gridY}}};mg.CenterGridSnapper=n8;mg.CenterGridSnapper=n8=npe([(0,ipe.injectable)()],n8);var gg={},MA={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isOpenable=n.openFeature=void 0,n.openFeature=Symbol("openFeature");function e(t){return t.hasFeature(n.openFeature)}n.isOpenable=e})(MA);Object.defineProperty(gg,"__esModule",{value:!0});gg.OpenMouseListener=void 0;const rpe=se,spe=Ut,ape=yt,cpe=MA;class dpe extends spe.MouseListener{doubleClick(e,t){const i=(0,ape.findParentByFeature)(e,cpe.isOpenable);return i!==void 0?[rpe.OpenAction.create(i.id)]:[]}}gg.OpenMouseListener=dpe;var Uo={};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.getModelBounds=Uo.getProjectedBounds=Uo.getProjections=Uo.isProjectable=void 0;const upe=De,lpe=Xi,x$=yt,wC=$t;function BU(n){return(0,lpe.hasOwnProperty)(n,"projectionCssClasses")}Uo.isProjectable=BU;function $U(n){let e;for(const t of n.children){if(BU(t)&&t.projectionCssClasses.length>0){const i=kU(t);if(i){const o={elementId:t.id,projectedBounds:i,cssClasses:t.projectionCssClasses};e?e.push(o):e=[o]}}if(t.children.length>0){const i=$U(t);i&&(e?e.push(...i):e=i)}}return e}Uo.getProjections=$U;function kU(n){const e=n.parent;if(n.projectedBounds){let t=n.projectedBounds;return(0,wC.isBoundsAware)(e)&&(t=(0,x$.transformToRootBounds)(e,t)),t}else if((0,wC.isBoundsAware)(n)){let t=n.bounds;return t=(0,x$.transformToRootBounds)(e,t),t}}Uo.getProjectedBounds=kU;const mE=1e9;function fpe(n){let e=mE,t=mE,i=-mE,o=-mE;const r=(0,wC.isBoundsAware)(n)?n.bounds:void 0;if(r&&upe.Dimension.isValid(r))e=r.x,t=r.y,i=e+r.width,o=t+r.height;else for(const s of n.children)if((0,wC.isBoundsAware)(s)){const a=s.bounds;e=Math.min(e,a.x),t=Math.min(t,a.y),i=Math.max(i,a.x+a.width),o=Math.max(o,a.y+a.height)}if(e=Math.min(e,n.scroll.x),t=Math.min(t,n.scroll.y),i=Math.max(i,n.scroll.x+n.canvasBounds.width/n.zoom),o=Math.max(o,n.scroll.y+n.canvasBounds.height/n.zoom),e<i&&t<o)return{x:e,y:t,width:i-e,height:o-t}}Uo.getModelBounds=fpe;var vg={},hpe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(vg,"__esModule",{value:!0});vg.ProjectedViewportView=void 0;const gE=ei,ppe=F,H$=dg,K$=ft,V$=Uo;let i8=class{render(e,t,i){const o=(0,gE.html)("div",{"class-sprotty-root":!0},this.renderSvg(e,t,i),this.renderProjections(e,t,i));return(0,K$.setAttr)(o,"tabindex",0),o}renderSvg(e,t,i){const o=`scale(${e.zoom}) translate(${-e.scroll.x},${-e.scroll.y})`,r="http://www.w3.org/2000/svg";return(0,H$.h)("svg",{ns:r},(0,H$.h)("g",{ns:r,attrs:{transform:o}},t.renderChildren(e)))}renderProjections(e,t,i){var o;if(e.zoom<=0)return[];const r=(0,V$.getModelBounds)(e);if(!r)return[];const s=(o=(0,V$.getProjections)(e))!==null&&o!==void 0?o:[];return[this.renderProjectionBar(s,e,r,"vertical"),this.renderProjectionBar(s,e,r,"horizontal")]}renderProjectionBar(e,t,i,o){const r={modelBounds:i,orientation:o};return r.factor=o==="horizontal"?t.canvasBounds.width/i.width:t.canvasBounds.height/i.height,r.zoomedFactor=r.factor/t.zoom,(0,gE.html)("div",{"class-sprotty-projection-bar":!0,"class-horizontal":o==="horizontal","class-vertical":o==="vertical"},this.renderViewport(t,r),e.map(s=>this.renderProjection(s,t,r)))}renderViewport(e,t){let i,o;t.orientation==="horizontal"?(i=e.canvasBounds.width,o=(e.scroll.x-t.modelBounds.x)*t.factor):(i=e.canvasBounds.height,o=(e.scroll.y-t.modelBounds.y)*t.factor);let r=i*t.zoomedFactor;o<0?(r+=o,o=0):o>i&&(o=i),r<0?r=0:o+r>i&&(r=i-o);const s=t.orientation==="horizontal"?{left:`${o}px`,width:`${r}px`}:{top:`${o}px`,height:`${r}px`};return(0,gE.html)("div",{"class-sprotty-viewport":!0,style:s})}renderProjection(e,t,i){let o,r,s;i.orientation==="horizontal"?(o=t.canvasBounds.width,r=(e.projectedBounds.x-i.modelBounds.x)*i.factor,s=e.projectedBounds.width*i.factor):(o=t.canvasBounds.height,r=(e.projectedBounds.y-i.modelBounds.y)*i.factor,s=e.projectedBounds.height*i.factor),r<0?(s+=r,r=0):r>o&&(r=o),s<0?s=0:r+s>o&&(s=o-r);const a=i.orientation==="horizontal"?{left:`${r}px`,width:`${s}px`}:{top:`${r}px`,height:`${s}px`},f=(0,gE.html)("div",{id:`${i.orientation}-projection:${e.elementId}`,"class-sprotty-projection":!0,style:a});return e.cssClasses.forEach(h=>(0,K$.setClass)(f,h,!0)),f}};vg.ProjectedViewportView=i8;vg.ProjectedViewportView=i8=hpe([(0,ppe.injectable)()],i8);var Xo={},Po={},h7=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Po,"__esModule",{value:!0});Po.DiamondAnchor=Po.RectangleAnchor=Po.EllipseAnchor=void 0;const p7=Ra,uD=Jn,m7=F,g7=Kc,Cp=De;let o8=class{get kind(){return g7.PolylineEdgeRouter.KIND+":"+p7.ELLIPTIC_ANCHOR_KIND}getAnchor(e,t,i=0){const o=e.bounds,r=Cp.Bounds.center(o),s=r.x-t.x,a=r.y-t.y,f=Math.sqrt(s*s+a*a),h=s/f||0,g=a/f||0;return{x:r.x-h*(.5*o.width+i),y:r.y-g*(.5*o.height+i)}}};Po.EllipseAnchor=o8;Po.EllipseAnchor=o8=h7([(0,m7.injectable)()],o8);let r8=class{get kind(){return g7.PolylineEdgeRouter.KIND+":"+p7.RECTANGULAR_ANCHOR_KIND}getAnchor(e,t,i=0){const o=e.bounds,r=Cp.Bounds.center(o),s=new mpe(r,t);if(!(0,Cp.almostEquals)(r.y,t.y)){const a=this.getXIntersection(o.y,r,t);a>=o.x&&a<=o.x+o.width&&s.addCandidate(a,o.y-i);const f=this.getXIntersection(o.y+o.height,r,t);f>=o.x&&f<=o.x+o.width&&s.addCandidate(f,o.y+o.height+i)}if(!(0,Cp.almostEquals)(r.x,t.x)){const a=this.getYIntersection(o.x,r,t);a>=o.y&&a<=o.y+o.height&&s.addCandidate(o.x-i,a);const f=this.getYIntersection(o.x+o.width,r,t);f>=o.y&&f<=o.y+o.height&&s.addCandidate(o.x+o.width+i,f)}return s.best}getXIntersection(e,t,i){const o=(e-t.y)/(i.y-t.y);return(i.x-t.x)*o+t.x}getYIntersection(e,t,i){const o=(e-t.x)/(i.x-t.x);return(i.y-t.y)*o+t.y}};Po.RectangleAnchor=r8;Po.RectangleAnchor=r8=h7([(0,m7.injectable)()],r8);class mpe{constructor(e,t){this.centerPoint=e,this.refPoint=t,this.currentDist=-1}addCandidate(e,t){const i=this.refPoint.x-e,o=this.refPoint.y-t,r=i*i+o*o;(this.currentDist<0||r<this.currentDist)&&(this.currentBest={x:e,y:t},this.currentDist=r)}get best(){return this.currentBest===void 0?this.centerPoint:this.currentBest}}let s8=class{get kind(){return g7.PolylineEdgeRouter.KIND+":"+p7.DIAMOND_ANCHOR_KIND}getAnchor(e,t,i){const o=e.bounds,r=new uD.PointToPointLine(Cp.Bounds.center(o),t),s=new uD.Diamond(o).closestSideLine(t),a=(0,uD.intersection)(s,r);return Cp.Point.shiftTowards(a,t,i)}};Po.DiamondAnchor=s8;Po.DiamondAnchor=s8=h7([(0,m7.injectable)()],s8);var Wi={},FU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},gpe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},z$=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}},Uv;Object.defineProperty(Wi,"__esModule",{value:!0});Wi.AddRemoveBezierSegmentCommand=Wi.AddRemoveBezierSegmentAction=Wi.BezierMouseListener=Wi.BezierEdgeRouter=void 0;const l3=F,G$=De,Sd=an,U$=vi,vpe=Qo,_pe=Ut,ype=Ve,bpe=me;let Up=Uv=class extends vpe.AbstractEdgeRouter{get kind(){return Uv.KIND}route(e){if(!e.source||!e.target)return[];const t=e.routingPoints.length,i=e.source,o=e.target,r=[];if(r.push({kind:"source",x:0,y:0}),t===0){const[g,y]=this.createDefaultBezierHandles(i.position,o.position);r.push({kind:"bezier-control-after",x:g.x,y:g.y,pointIndex:0}),r.push({kind:"bezier-control-before",x:y.x,y:y.y,pointIndex:1}),e.routingPoints.push(g),e.routingPoints.push(y)}else if(t>=2)for(let g=0;g<t;g++){const y=e.routingPoints[g];g%3===0&&r.push({kind:"bezier-control-after",x:y.x,y:y.y,pointIndex:g}),(g+1)%3===0?r.push({kind:"bezier-junction",x:y.x,y:y.y,pointIndex:g}):(g+2)%3===0&&r.push({kind:"bezier-control-before",x:y.x,y:y.y,pointIndex:g})}r.push({kind:"target",x:0,y:0});const s=t>2?e.routingPoints[2]:o.position,a=t>2?e.routingPoints[e.routingPoints.length-3]:i.position,f=this.getTranslatedAnchor(i,s,o.parent,e,e.sourceAnchorCorrection),h=this.getTranslatedAnchor(o,a,i.parent,e,e.targetAnchorCorrection);return r[0]={kind:"source",x:f.x,y:f.y},r[r.length-1]={kind:"target",x:h.x,y:h.y},r}createDefaultBezierHandles(e,t){const i={x:e.x-Uv.DEFAULT_BEZIER_HANDLE_OFFSET,y:e.y},o={x:t.x+Uv.DEFAULT_BEZIER_HANDLE_OFFSET,y:t.y};return[i,o]}createRoutingHandles(e){this.route(e),this.rebuildHandles(e)}rebuildHandles(e){this.addHandle(e,"source","routing-point",-2),this.addHandle(e,"bezier-control-after","bezier-routing-point",0),this.addHandle(e,"bezier-add","bezier-create-routing-point",0);const t=e.routingPoints.length;if(t>2)for(let i=1;i<t-1;i+=3)this.addHandle(e,"bezier-control-before","bezier-routing-point",i),this.addHandle(e,"bezier-add","bezier-create-routing-point",i+1),this.addHandle(e,"bezier-junction","routing-point",i+1),this.addHandle(e,"bezier-remove","bezier-remove-routing-point",i+1),this.addHandle(e,"bezier-control-after","bezier-routing-point",i+2),this.moveBezierControlPair(e.routingPoints[i],i,e);this.addHandle(e,"bezier-control-before","bezier-routing-point",t-1),this.addHandle(e,"target","routing-point",-1)}getInnerHandlePosition(e,t,i){if(i.kind==="bezier-control-before"||i.kind==="bezier-junction"||i.kind==="bezier-control-after")for(let o=0;o<t.length;o++){const r=t[o];if(r.pointIndex===i.pointIndex&&r.kind===i.kind)return r}else if(i.kind==="bezier-add"){const o=this.findBezierControl(e,t,i.pointIndex);return{x:o.x,y:o.y+12.5}}else if(i.kind==="bezier-remove"){const o=this.findBezierControl(e,t,i.pointIndex);return{x:o.x,y:o.y-12.5}}}findBezierControl(e,t,i){let o={x:t[0].x,y:t[0].y};if(i>0){for(const r of t)if(r.pointIndex!==void 0&&r.pointIndex===i&&r.kind==="bezier-junction"){o={x:r.x,y:r.y};break}}return o}applyHandleMoves(e,t){t.forEach(i=>{const o=i.handle;let r={x:0,y:0},s,a,f;const h=i.toPosition;switch(o.kind){case"bezier-control-before":case"bezier-control-after":this.moveBezierControlPair(h,i.handle.pointIndex,e);break;case"bezier-junction":const g=o.pointIndex;g>=0&&g<e.routingPoints.length&&(f=g-1,r=e.routingPoints[g],s=e.routingPoints[f],a=this.calcRelativeMove(r,h,s),e.routingPoints[g]=h,this.moveBezierControlPair(a,f,e));break;case"source":if(f=0,s=e.routingPoints[f],e.source instanceof Sd.SDanglingAnchorImpl)o.danglingAnchor&&(r=o.danglingAnchor.position,o.danglingAnchor.position=h);else{const y=new Sd.SDanglingAnchorImpl;y.id=e.id+"_dangling-source",y.original=e.source,y.position=i.toPosition,o.root.add(y),o.danglingAnchor=y,e.sourceId=y.id,e.source&&(r=e.source.position)}a=this.calcRelativeMove(r,h,s),this.moveBezierControlPair(a,f,e);break;case"target":if(f=e.routingPoints.length-1,s=e.routingPoints[f],e.target instanceof Sd.SDanglingAnchorImpl)o.danglingAnchor&&(r=o.danglingAnchor.position,o.danglingAnchor.position=h);else{const y=new Sd.SDanglingAnchorImpl;y.id=e.id+"_dangling-target",y.original=e.target,y.position=h,o.root.add(y),o.danglingAnchor=y,e.targetId=y.id,e.target&&(r=e.target.position)}a=this.calcRelativeMove(r,h,s),this.moveBezierControlPair(a,f,e);break}})}applyInnerHandleMoves(e,t){}getOptions(e){return{minimalPointDistance:2,standardDistance:.1,selfEdgeOffset:20}}calcRelativeMove(e,t,i){return{x:i.x-(e.x-t.x),y:i.y-(e.y-t.y)}}createNewBezierSegment(e,t){const i=t.routingPoints;let o,r,s;i.length===2?(r=i[e<0?0:e],s=i[i.length-1],o=(0,G$.centerOfLine)(r,s)):(r=i[e],s=i[e+2],o=(0,G$.centerOfLine)(r,s));const[a,f]=this.createDefaultBezierHandles(o,o);i.splice(e+1,0,a),i.splice(e+2,0,o),i.splice(e+3,0,f),this.moveBezierControlPair(a,e+1,t),t.removeAll(h=>h instanceof Sd.SRoutingHandleImpl),this.rebuildHandles(t)}removeBezierSegment(e,t){t.routingPoints.splice(e-1,3),t.removeAll(o=>o instanceof Sd.SRoutingHandleImpl),this.rebuildHandles(t)}moveBezierControlPair(e,t,i){if(t>=0&&t<i.routingPoints.length){const o=t-1,r=t+1;o<0||r===i.routingPoints.length?i.routingPoints[t]=e:t%3===0?this.setBezierMirror(i,e,t,!1):(t+2)%3===0&&this.setBezierMirror(i,e,t,!0)}}setBezierMirror(e,t,i,o){e.routingPoints[i]=t;const r=e.routingPoints[o?i+1:i-1];e.routingPoints[o?i+2:i-2]={x:r.x-(t.x-r.x),y:r.y-(t.y-r.y)}}};Wi.BezierEdgeRouter=Up;Up.KIND="bezier";Up.DEFAULT_BEZIER_HANDLE_OFFSET=25;Wi.BezierEdgeRouter=Up=Uv=FU([(0,l3.injectable)()],Up);class Spe extends _pe.MouseListener{mouseDown(e,t){const i=[];return e instanceof Sd.SRoutingHandleImpl&&(e.kind==="bezier-add"||e.kind==="bezier-remove")&&(e.type==="bezier-create-routing-point"?i.push(ry.create("add",e.id)):e.type==="bezier-remove-routing-point"&&i.push(ry.create("remove",e.id))),i}}Wi.BezierMouseListener=Spe;var ry;(function(n){n.KIND="addRemoveBezierSegment";function e(t,i){return{kind:n.KIND,actionTask:t,targetId:i}}n.create=e})(ry||(Wi.AddRemoveBezierSegmentAction=ry={}));let AC=class extends ype.Command{constructor(e,t){super(),this.action=e,this.edgeRouterRegistry=t}execute(e){const i=e.root.index.getById(this.action.targetId);if(this.edgeRouterRegistry&&i instanceof Sd.SRoutingHandleImpl){const o=this.edgeRouterRegistry.get(i.parent.routerKind);if(o instanceof Up){const r=o;for(const s of e.root.children)if(s.id===i.parent.id){this.action.actionTask==="add"?r.createNewBezierSegment(i.pointIndex,s):this.action.actionTask==="remove"&&r.removeBezierSegment(i.pointIndex,s);break}}}return e.root}undo(e){throw new Error("Method not implemented.")}redo(e){throw new Error("Method not implemented.")}};Wi.AddRemoveBezierSegmentCommand=AC;AC.KIND=ry.KIND;Wi.AddRemoveBezierSegmentCommand=AC=FU([(0,l3.injectable)(),z$(0,(0,l3.inject)(bpe.TYPES.Action)),z$(1,(0,l3.inject)(U$.EdgeRouterRegistry)),gpe("design:paramtypes",[Object,U$.EdgeRouterRegistry])],AC);var v7=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Xo,"__esModule",{value:!0});Xo.BezierDiamondAnchor=Xo.BezierRectangleAnchor=Xo.BezierEllipseAnchor=void 0;const _7=Ra,y7=F,b7=Po,S7=Wi;let a8=class extends b7.EllipseAnchor{get kind(){return S7.BezierEdgeRouter.KIND+":"+_7.ELLIPTIC_ANCHOR_KIND}};Xo.BezierEllipseAnchor=a8;Xo.BezierEllipseAnchor=a8=v7([(0,y7.injectable)()],a8);let c8=class extends b7.RectangleAnchor{get kind(){return S7.BezierEdgeRouter.KIND+":"+_7.RECTANGULAR_ANCHOR_KIND}};Xo.BezierRectangleAnchor=c8;Xo.BezierRectangleAnchor=c8=v7([(0,y7.injectable)()],c8);let d8=class extends b7.DiamondAnchor{get kind(){return S7.BezierEdgeRouter.KIND+":"+_7.DIAMOND_ANCHOR_KIND}};Xo.BezierDiamondAnchor=d8;Xo.BezierDiamondAnchor=d8=v7([(0,y7.injectable)()],d8);var Jo={},Gf={};Object.defineProperty(Gf,"__esModule",{value:!0});Gf.ManhattanEdgeRouter=void 0;const un=De,Y$=yt,de=Qo,lD=an;class IA extends de.AbstractEdgeRouter{get kind(){return IA.KIND}getOptions(e){return{standardDistance:20,minimalPointDistance:3,selfEdgeOffset:.25}}route(e){if(!e.source||!e.target)return[];const t=this.createRoutedCorners(e),i=t[0]||(0,Y$.translatePoint)(un.Bounds.center(e.target.bounds),e.target.parent,e.parent),o=this.getTranslatedAnchor(e.source,i,e.parent,e,e.sourceAnchorCorrection),r=t[t.length-1]||(0,Y$.translatePoint)(un.Bounds.center(e.source.bounds),e.source.parent,e.parent),s=this.getTranslatedAnchor(e.target,r,e.parent,e,e.targetAnchorCorrection);if(!o||!s)return[];const a=[];return a.push(Object.assign({kind:"source"},o)),t.forEach(f=>a.push(f)),a.push(Object.assign({kind:"target"},s)),a}createRoutedCorners(e){const t=new de.DefaultAnchors(e.source,e.parent,"source"),i=new de.DefaultAnchors(e.target,e.parent,"target");if(e.routingPoints.length>0){const s=e.routingPoints.slice();if(this.cleanupRoutingPoints(e,s,!1,!0),s.length>0)return s.map((a,f)=>Object.assign({kind:"linear",pointIndex:f},a))}const o=this.getOptions(e);return this.calculateDefaultCorners(e,t,i,o).map(s=>Object.assign({kind:"linear"},s))}createRoutingHandles(e){const t=this.route(e);if(this.commitRoute(e,t),t.length>0){this.addHandle(e,"source","routing-point",-2);for(let i=0;i<t.length-1;++i)this.addHandle(e,"manhattan-50%","volatile-routing-point",i-1);this.addHandle(e,"target","routing-point",t.length-2)}}getInnerHandlePosition(e,t,i){const o=this.getFraction(i.kind);if(o!==void 0){const{start:r,end:s}=this.findRouteSegment(e,t,i.pointIndex);if(r!==void 0&&s!==void 0)return un.Point.linear(r,s,o)}}getFraction(e){switch(e){case"manhattan-50%":return .5;default:return}}applyInnerHandleMoves(e,t){const i=this.route(e),o=e.routingPoints,r=this.getOptions(e).minimalPointDistance;t.forEach(s=>{const a=s.handle,f=a.pointIndex,h=this.correctX(o,f,s.toPosition.x,r),g=this.correctY(o,f,s.toPosition.y,r);switch(a.kind){case"manhattan-50%":f<0?o.length===0?(o.push({x:h,y:g}),a.pointIndex=0):(0,un.almostEquals)(i[0].x,i[1].x)?this.alignX(o,0,h):this.alignY(o,0,g):f<o.length-1?(0,un.almostEquals)(o[f].x,o[f+1].x)?(this.alignX(o,f,h),this.alignX(o,f+1,h)):(this.alignY(o,f,g),this.alignY(o,f+1,g)):(0,un.almostEquals)(i[i.length-2].x,i[i.length-1].x)?this.alignX(o,o.length-1,h):this.alignY(o,o.length-1,g);break}})}correctX(e,t,i,o){return t>0&&Math.abs(i-e[t-1].x)<o?e[t-1].x:t<e.length-2&&Math.abs(i-e[t+2].x)<o?e[t+2].x:i}alignX(e,t,i){t>=0&&t<e.length&&(e[t]={x:i,y:e[t].y})}correctY(e,t,i,o){return t>0&&Math.abs(i-e[t-1].y)<o?e[t-1].y:t<e.length-2&&Math.abs(i-e[t+2].y)<o?e[t+2].y:i}alignY(e,t,i){t>=0&&t<e.length&&(e[t]={x:e[t].x,y:i})}cleanupRoutingPoints(e,t,i,o){const r=new de.DefaultAnchors(e.source,e.parent,"source"),s=new de.DefaultAnchors(e.target,e.parent,"target");if(!this.resetRoutingPointsOnReconnect(e,t,i,r,s)){for(let a=0;a<t.length&&un.Bounds.includes(r.bounds,t[a]);++a)t.splice(0,1),i&&this.removeHandle(e,-1);for(let a=t.length-1;a>=0&&un.Bounds.includes(s.bounds,t[a]);--a)t.splice(a,1),i&&this.removeHandle(e,a);if(t.length>=2){const a=this.getOptions(e);for(let f=t.length-2;f>=0;--f)un.Point.manhattanDistance(t[f],t[f+1])<a.minimalPointDistance&&(t.splice(f,2),--f,i&&(this.removeHandle(e,f-1),this.removeHandle(e,f)))}o&&(this.addAdditionalCorner(e,t,r,s,i),this.addAdditionalCorner(e,t,s,r,i),this.manhattanify(e,t))}}removeHandle(e,t){const i=[];e.children.forEach(o=>{o instanceof lD.SRoutingHandleImpl&&(o.pointIndex>t?--o.pointIndex:o.pointIndex===t&&i.push(o))}),i.forEach(o=>e.remove(o))}addAdditionalCorner(e,t,i,o,r){if(t.length===0)return;const s=i.kind==="source"?t[0]:t[t.length-1],a=i.kind==="source"?0:t.length,f=a-(i.kind==="source"?1:0);let h;if(t.length>1)h=a===0?(0,un.almostEquals)(t[0].x,t[1].x):(0,un.almostEquals)(t[t.length-1].x,t[t.length-2].x);else{const g=o.getNearestSide(s);h=g===de.Side.TOP||g===de.Side.BOTTOM}if(h){if(s.y<i.get(de.Side.TOP).y||s.y>i.get(de.Side.BOTTOM).y){const g={x:i.get(de.Side.TOP).x,y:s.y};t.splice(a,0,g),r&&(e.children.forEach(y=>{y instanceof lD.SRoutingHandleImpl&&y.pointIndex>=f&&++y.pointIndex}),this.addHandle(e,"manhattan-50%","volatile-routing-point",f))}}else if(s.x<i.get(de.Side.LEFT).x||s.x>i.get(de.Side.RIGHT).x){const g={x:s.x,y:i.get(de.Side.LEFT).y};t.splice(a,0,g),r&&(e.children.forEach(y=>{y instanceof lD.SRoutingHandleImpl&&y.pointIndex>=f&&++y.pointIndex}),this.addHandle(e,"manhattan-50%","volatile-routing-point",f))}}manhattanify(e,t){for(let i=1;i<t.length;++i){const o=Math.abs(t[i-1].x-t[i].x)<1,r=Math.abs(t[i-1].y-t[i].y)<1;!o&&!r&&(t.splice(i,0,{x:t[i-1].x,y:t[i].y}),++i)}}calculateDefaultCorners(e,t,i,o){const r=super.calculateDefaultCorners(e,t,i,o);if(r.length>0)return r;const s=this.getBestConnectionAnchors(e,t,i,o),a=s.source,f=s.target,h=[],g=t.get(a);let y=i.get(f);switch(a){case de.Side.RIGHT:switch(f){case de.Side.BOTTOM:h.push({x:y.x,y:g.y});break;case de.Side.TOP:h.push({x:y.x,y:g.y});break;case de.Side.RIGHT:h.push({x:Math.max(g.x,y.x)+1.5*o.standardDistance,y:g.y}),h.push({x:Math.max(g.x,y.x)+1.5*o.standardDistance,y:y.y});break;case de.Side.LEFT:y.y!==g.y&&(h.push({x:(g.x+y.x)/2,y:g.y}),h.push({x:(g.x+y.x)/2,y:y.y}));break}break;case de.Side.LEFT:switch(f){case de.Side.BOTTOM:h.push({x:y.x,y:g.y});break;case de.Side.TOP:h.push({x:y.x,y:g.y});break;default:y=i.get(de.Side.RIGHT),y.y!==g.y&&(h.push({x:(g.x+y.x)/2,y:g.y}),h.push({x:(g.x+y.x)/2,y:y.y}));break}break;case de.Side.TOP:switch(f){case de.Side.RIGHT:y.x-g.x>0?(h.push({x:g.x,y:g.y-o.standardDistance}),h.push({x:y.x+1.5*o.standardDistance,y:g.y-o.standardDistance}),h.push({x:y.x+1.5*o.standardDistance,y:y.y})):h.push({x:g.x,y:y.y});break;case de.Side.LEFT:y.x-g.x<0?(h.push({x:g.x,y:g.y-o.standardDistance}),h.push({x:y.x-1.5*o.standardDistance,y:g.y-o.standardDistance}),h.push({x:y.x-1.5*o.standardDistance,y:y.y})):h.push({x:g.x,y:y.y});break;case de.Side.TOP:h.push({x:g.x,y:Math.min(g.y,y.y)-1.5*o.standardDistance}),h.push({x:y.x,y:Math.min(g.y,y.y)-1.5*o.standardDistance});break;case de.Side.BOTTOM:y.x!==g.x&&(h.push({x:g.x,y:(g.y+y.y)/2}),h.push({x:y.x,y:(g.y+y.y)/2}));break}break;case de.Side.BOTTOM:switch(f){case de.Side.RIGHT:y.x-g.x>0?(h.push({x:g.x,y:g.y+o.standardDistance}),h.push({x:y.x+1.5*o.standardDistance,y:g.y+o.standardDistance}),h.push({x:y.x+1.5*o.standardDistance,y:y.y})):h.push({x:g.x,y:y.y});break;case de.Side.LEFT:y.x-g.x<0?(h.push({x:g.x,y:g.y+o.standardDistance}),h.push({x:y.x-1.5*o.standardDistance,y:g.y+o.standardDistance}),h.push({x:y.x-1.5*o.standardDistance,y:y.y})):h.push({x:g.x,y:y.y});break;default:y=i.get(de.Side.TOP),y.x!==g.x&&(h.push({x:g.x,y:(g.y+y.y)/2}),h.push({x:y.x,y:(g.y+y.y)/2}));break}break}return h}getBestConnectionAnchors(e,t,i,o){let r=t.get(de.Side.RIGHT),s=i.get(de.Side.LEFT);if(s.x-r.x>o.standardDistance)return{source:de.Side.RIGHT,target:de.Side.LEFT};if(r=t.get(de.Side.LEFT),s=i.get(de.Side.RIGHT),r.x-s.x>o.standardDistance)return{source:de.Side.LEFT,target:de.Side.RIGHT};if(r=t.get(de.Side.TOP),s=i.get(de.Side.BOTTOM),r.y-s.y>o.standardDistance)return{source:de.Side.TOP,target:de.Side.BOTTOM};if(r=t.get(de.Side.BOTTOM),s=i.get(de.Side.TOP),s.y-r.y>o.standardDistance)return{source:de.Side.BOTTOM,target:de.Side.TOP};if(r=t.get(de.Side.RIGHT),s=i.get(de.Side.TOP),s.x-r.x>.5*o.standardDistance&&s.y-r.y>o.standardDistance)return{source:de.Side.RIGHT,target:de.Side.TOP};if(s=i.get(de.Side.BOTTOM),s.x-r.x>.5*o.standardDistance&&r.y-s.y>o.standardDistance)return{source:de.Side.RIGHT,target:de.Side.BOTTOM};if(r=t.get(de.Side.LEFT),s=i.get(de.Side.BOTTOM),r.x-s.x>.5*o.standardDistance&&r.y-s.y>o.standardDistance)return{source:de.Side.LEFT,target:de.Side.BOTTOM};if(s=i.get(de.Side.TOP),r.x-s.x>.5*o.standardDistance&&s.y-r.y>o.standardDistance)return{source:de.Side.LEFT,target:de.Side.TOP};if(r=t.get(de.Side.TOP),s=i.get(de.Side.RIGHT),r.y-s.y>.5*o.standardDistance&&r.x-s.x>o.standardDistance)return{source:de.Side.TOP,target:de.Side.RIGHT};if(s=i.get(de.Side.LEFT),r.y-s.y>.5*o.standardDistance&&s.x-r.x>o.standardDistance)return{source:de.Side.TOP,target:de.Side.LEFT};if(r=t.get(de.Side.BOTTOM),s=i.get(de.Side.RIGHT),s.y-r.y>.5*o.standardDistance&&r.x-s.x>o.standardDistance)return{source:de.Side.BOTTOM,target:de.Side.RIGHT};if(s=i.get(de.Side.LEFT),s.y-r.y>.5*o.standardDistance&&s.x-r.x>o.standardDistance)return{source:de.Side.BOTTOM,target:de.Side.LEFT};if(r=t.get(de.Side.TOP),s=i.get(de.Side.TOP),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)){if(r.y-s.y<0){if(Math.abs(r.x-s.x)>(t.bounds.width+o.standardDistance)/2)return{source:de.Side.TOP,target:de.Side.TOP}}else if(Math.abs(r.x-s.x)>i.bounds.width/2)return{source:de.Side.TOP,target:de.Side.TOP}}if(r=t.get(de.Side.RIGHT),s=i.get(de.Side.RIGHT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)){if(r.x-s.x>0){if(Math.abs(r.y-s.y)>(t.bounds.height+o.standardDistance)/2)return{source:de.Side.RIGHT,target:de.Side.RIGHT}}else if(Math.abs(r.y-s.y)>i.bounds.height/2)return{source:de.Side.RIGHT,target:de.Side.RIGHT}}return r=t.get(de.Side.TOP),s=i.get(de.Side.RIGHT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)?{source:de.Side.TOP,target:de.Side.RIGHT}:(s=i.get(de.Side.LEFT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)?{source:de.Side.TOP,target:de.Side.LEFT}:(r=t.get(de.Side.BOTTOM),s=i.get(de.Side.RIGHT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)?{source:de.Side.BOTTOM,target:de.Side.RIGHT}:(s=i.get(de.Side.LEFT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)?{source:de.Side.BOTTOM,target:de.Side.LEFT}:{source:de.Side.RIGHT,target:de.Side.BOTTOM})))}}Gf.ManhattanEdgeRouter=IA;IA.KIND="manhattan";var E7=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},u8,l8,f8;Object.defineProperty(Jo,"__esModule",{value:!0});Jo.ManhattanEllipticAnchor=Jo.ManhattanDiamondAnchor=Jo.ManhattanRectangularAnchor=void 0;const RC=De,$o=Jn,C7=Ra,P7=Gf,w7=F;let MC=u8=class{get kind(){return u8.KIND}getAnchor(e,t,i){const o=e.bounds;if(o.width<=0||o.height<=0)return o;const r={x:o.x-i,y:o.y-i,width:o.width+2*i,height:o.height+2*i};return t.x>=r.x&&r.x+r.width>=t.x?t.y<r.y+.5*r.height?{x:t.x,y:r.y}:{x:t.x,y:r.y+r.height}:t.y>=r.y&&r.y+r.height>=t.y?t.x<r.x+.5*r.width?{x:r.x,y:t.y}:{x:r.x+r.width,y:t.y}:RC.Bounds.center(r)}};Jo.ManhattanRectangularAnchor=MC;MC.KIND=P7.ManhattanEdgeRouter.KIND+":"+C7.RECTANGULAR_ANCHOR_KIND;Jo.ManhattanRectangularAnchor=MC=u8=E7([(0,w7.injectable)()],MC);let IC=l8=class{get kind(){return l8.KIND}getAnchor(e,t,i=0){const o=e.bounds;if(o.width<=0||o.height<=0)return o;const r={x:o.x-i,y:o.y-i,width:o.width+2*i,height:o.height+2*i},s=RC.Bounds.center(r);let a,f;return t.x>=r.x&&t.x<=r.x+r.width?r.x+.5*r.width>=t.x?(f=new $o.PointToPointLine(t,{x:t.x,y:s.y}),t.y<s.y?a=new $o.PointToPointLine({x:r.x,y:s.y},{x:s.x,y:r.y}):a=new $o.PointToPointLine({x:r.x,y:s.y},{x:s.x,y:r.y+r.height})):(f=new $o.PointToPointLine(t,{x:t.x,y:s.y}),t.y<s.y?a=new $o.PointToPointLine({x:r.x+r.width,y:s.y},{x:s.x,y:r.y}):a=new $o.PointToPointLine({x:r.x+r.width,y:s.y},{x:s.x,y:r.y+r.height})):t.y>=r.y&&t.y<=r.y+r.height&&(r.y+.5*r.height>=t.y?(f=new $o.PointToPointLine(t,{x:s.x,y:t.y}),t.x<s.x?a=new $o.PointToPointLine({x:r.x,y:s.y},{x:s.x,y:r.y}):a=new $o.PointToPointLine({x:r.x+r.width,y:s.y},{x:s.x,y:r.y})):(f=new $o.PointToPointLine(t,{x:s.x,y:t.y}),t.x<s.x?a=new $o.PointToPointLine({x:r.x,y:s.y},{x:s.x,y:r.y+r.height}):a=new $o.PointToPointLine({x:r.x+r.width,y:s.y},{x:s.x,y:r.y+r.height}))),f&&a?(0,$o.intersection)(a,f):s}};Jo.ManhattanDiamondAnchor=IC;IC.KIND=P7.ManhattanEdgeRouter.KIND+":"+C7.DIAMOND_ANCHOR_KIND;Jo.ManhattanDiamondAnchor=IC=l8=E7([(0,w7.injectable)()],IC);let DC=f8=class{get kind(){return f8.KIND}getAnchor(e,t,i=0){const o=e.bounds;if(o.width<=0||o.height<=0)return o;const r={x:o.x-i,y:o.y-i,width:o.width+2*i,height:o.height+2*i},s=RC.Bounds.center(r),a=RC.Point.subtract(t,s);let f=s.x,h=s.y;if(t.x>=r.x&&r.x+r.width>=t.x){f+=a.x;const g=.5*r.height*Math.sqrt(1-a.x*a.x/(.25*r.width*r.width));a.y<0?h-=g:h+=g}else if(t.y>=r.y&&r.y+r.height>=t.y){h+=a.y;const g=.5*r.width*Math.sqrt(1-a.y*a.y/(.25*r.height*r.height));a.x<0?f-=g:f+=g}return{x:f,y:h}}};Jo.ManhattanEllipticAnchor=DC;DC.KIND=P7.ManhattanEdgeRouter.KIND+":"+C7.ELLIPTIC_ANCHOR_KIND;Jo.ManhattanEllipticAnchor=DC=f8=E7([(0,w7.injectable)()],DC);var Uf={},Epe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Uf,"__esModule",{value:!0});Uf.RoutableView=void 0;const Cpe=F,Ppe=an;let h8=class{isVisible(e,t,i){if(i.targetKind==="hidden"||t.length===0)return!0;const o=(0,Ppe.getAbsoluteRouteBounds)(e,t),r=e.root.canvasBounds;return o.x<=r.width&&o.x+o.width>=0&&o.y<=r.height&&o.y+o.height>=0}};Uf.RoutableView=h8;Uf.RoutableView=h8=Epe([(0,Cpe.injectable)()],h8);var fi={},_g={},xU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},wpe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(_g,"__esModule",{value:!0});_g.ModelRequestCommand=void 0;const HU=F,Ape=me,Rpe=Ve;let TC=class extends Rpe.SystemCommand{execute(e){const t=this.retrieveResult(e);return this.actionDispatcher.dispatch(t),{model:e.root,modelChanged:!1}}undo(e){return{model:e.root,modelChanged:!1}}redo(e){return{model:e.root,modelChanged:!1}}};_g.ModelRequestCommand=TC;xU([(0,HU.inject)(Ape.TYPES.IActionDispatcher),wpe("design:type",Object)],TC.prototype,"actionDispatcher",void 0);_g.ModelRequestCommand=TC=xU([(0,HU.injectable)()],TC);var mc={},Mpe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Ipe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(mc,"__esModule",{value:!0});mc.findViewportScrollbar=mc.ScrollMouseListener=void 0;const Dpe=F,fD=se,Bh=De,Tpe=ke,Ope=Ut,hv=yt,vE=Rs,Lpe=Hc,Npe=an,jpe=Uo,Bpe=sn,$pe=me;class KU extends Ope.MouseListener{constructor(){super(...arguments),this.scrollbarMouseDownDelay=200}mouseDown(e,t){if((0,hv.findParentByFeature)(e,Lpe.isMoveable)===void 0&&!(e instanceof Npe.SRoutingHandleImpl)){const o=(0,hv.findParentByFeature)(e,vE.isViewport);if(o){if(this.lastScrollPosition={x:t.pageX,y:t.pageY},this.scrollbar=this.getScrollbar(t),this.scrollbar)return window.clearTimeout(this.scrollbarMouseDownTimeout),this.moveScrollBar(o,t,this.scrollbar,!0).map(r=>new Promise(s=>{this.scrollbarMouseDownTimeout=window.setTimeout(()=>s(r),this.scrollbarMouseDownDelay)}))}else this.lastScrollPosition=void 0,this.scrollbar=void 0}return[]}mouseMove(e,t){if(t.buttons===0)return this.mouseUp(e,t);if(this.scrollbar){window.clearTimeout(this.scrollbarMouseDownTimeout);const i=(0,hv.findParentByFeature)(e,vE.isViewport);if(i)return this.moveScrollBar(i,t,this.scrollbar)}if(this.lastScrollPosition){const i=(0,hv.findParentByFeature)(e,vE.isViewport);if(i)return this.dragCanvas(i,t,this.lastScrollPosition)}return[]}mouseEnter(e,t){return e instanceof Tpe.SModelRootImpl&&t.buttons===0&&this.mouseUp(e,t),[]}mouseUp(e,t){return this.lastScrollPosition=void 0,this.scrollbar=void 0,[]}doubleClick(e,t){if((0,hv.findParentByFeature)(e,vE.isViewport)){const o=this.getScrollbar(t);if(o){window.clearTimeout(this.scrollbarMouseDownTimeout);const r=this.findClickTarget(o,t);let s;if(r&&r.id.startsWith("horizontal-projection:")?s=r.id.substring(22):r&&r.id.startsWith("vertical-projection:")&&(s=r.id.substring(20)),s)return[fD.CenterAction.create([s],{animate:!0,retainZoom:!0})]}}return[]}dragCanvas(e,t,i){let o=(t.pageX-i.x)/e.zoom;(o>0&&(0,Bh.almostEquals)(e.scroll.x,this.viewerOptions.horizontalScrollLimits.min)||o<0&&(0,Bh.almostEquals)(e.scroll.x,this.viewerOptions.horizontalScrollLimits.max-e.canvasBounds.width/e.zoom))&&(o=0);let r=(t.pageY-i.y)/e.zoom;if((r>0&&(0,Bh.almostEquals)(e.scroll.y,this.viewerOptions.verticalScrollLimits.min)||r<0&&(0,Bh.almostEquals)(e.scroll.y,this.viewerOptions.verticalScrollLimits.max-e.canvasBounds.height/e.zoom))&&(r=0),o===0&&r===0)return[];const s={scroll:{x:e.scroll.x-o,y:e.scroll.y-r},zoom:e.zoom};return this.lastScrollPosition={x:t.pageX,y:t.pageY},[fD.SetViewportAction.create(e.id,s,{animate:!1})]}moveScrollBar(e,t,i,o=!1){const r=(0,jpe.getModelBounds)(e);if(!r||e.zoom<=0)return[];const s=i.getBoundingClientRect();let a;if(this.getScrollbarOrientation(i)==="horizontal"){if(s.width<=0)return[];const f=e.canvasBounds.width/(e.zoom*r.width)*s.width;let h=t.clientX-s.x-f/2;if(h<0?h=0:h>s.width-f&&(h=s.width-f),a={x:r.x+h/s.width*r.width,y:e.scroll.y},a.x<this.viewerOptions.horizontalScrollLimits.min?a.x=this.viewerOptions.horizontalScrollLimits.min:a.x>this.viewerOptions.horizontalScrollLimits.max-e.canvasBounds.width/e.zoom&&(a.x=this.viewerOptions.horizontalScrollLimits.max-e.canvasBounds.width/e.zoom),(0,Bh.almostEquals)(a.x,e.scroll.x))return[]}else{if(s.height<=0)return[];const f=e.canvasBounds.height/(e.zoom*r.height)*s.height;let h=t.clientY-s.y-f/2;if(h<0?h=0:h>s.height-f&&(h=s.height-f),a={x:e.scroll.x,y:r.y+h/s.height*r.height},a.y<this.viewerOptions.verticalScrollLimits.min?a.y=this.viewerOptions.verticalScrollLimits.min:a.y>this.viewerOptions.verticalScrollLimits.max-e.canvasBounds.height/e.zoom&&(a.y=this.viewerOptions.verticalScrollLimits.max-e.canvasBounds.height/e.zoom),(0,Bh.almostEquals)(a.y,e.scroll.y))return[]}return[fD.SetViewportAction.create(e.id,{scroll:a,zoom:e.zoom},{animate:o})]}getScrollbar(e){return VU(e)}getScrollbarOrientation(e){return e.classList.contains("horizontal")?"horizontal":"vertical"}findClickTarget(e,t){const i=Array.from(e.children).filter(o=>o.id&&o.classList.contains("sprotty-projection")&&(0,Bpe.hitsMouseEvent)(o,t));if(i.length>0)return i[i.length-1]}}mc.ScrollMouseListener=KU;Mpe([(0,Dpe.inject)($pe.TYPES.ViewerOptions),Ipe("design:type",Object)],KU.prototype,"viewerOptions",void 0);function VU(n){let e=n.target;for(;e;){if(e.classList&&e.classList.contains("sprotty-projection-bar"))return e;e=e.parentElement}}mc.findViewportScrollbar=VU;var DA=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},TA=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},A7=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(fi,"__esModule",{value:!0});fi.SelectKeyboardListener=fi.GetSelectionCommand=fi.SelectMouseListener=fi.SelectAllCommand=fi.SelectCommand=void 0;const iu=F,Ks=se,zU=Ve,kpe=_g,h_=ke,hD=yt,R7=me,Fpe=gi,xpe=Ut,Hpe=ft,q$=sn,GU=Mo,Kpe=qt,W$=ps,Vpe=lg,_E=_s,zpe=an,yE=an,Gpe=mc,tc=to;let OC=class extends zU.Command{constructor(e){super(),this.action=e,this.selected=[],this.deselected=[]}execute(e){const t=e.root;return this.action.selectedElementsIDs.forEach(i=>{const o=t.index.getById(i);o instanceof h_.SChildElementImpl&&(0,tc.isSelectable)(o)&&this.selected.push(o)}),this.action.deselectedElementsIDs.forEach(i=>{const o=t.index.getById(i);o instanceof h_.SChildElementImpl&&(0,tc.isSelectable)(o)&&this.deselected.push(o)}),this.redo(e)}undo(e){for(const t of this.selected)t.selected=!1;for(const t of this.deselected)t.selected=!0;return e.root}redo(e){for(const t of this.deselected)t.selected=!1;for(const t of this.selected)t.selected=!0;return e.root}};fi.SelectCommand=OC;OC.KIND=Ks.SelectAction.KIND;fi.SelectCommand=OC=DA([(0,iu.injectable)(),A7(0,(0,iu.inject)(R7.TYPES.Action)),TA("design:paramtypes",[Object])],OC);let LC=class extends zU.Command{constructor(e){super(),this.action=e,this.previousSelection={}}execute(e){return this.selectAll(e.root,this.action.select),e.root}selectAll(e,t){(0,tc.isSelectable)(e)&&(this.previousSelection[e.id]=e.selected,e.selected=t);for(const i of e.children)this.selectAll(i,t)}undo(e){const t=e.root.index;return Object.keys(this.previousSelection).forEach(i=>{const o=t.getById(i);o!==void 0&&(0,tc.isSelectable)(o)&&(o.selected=this.previousSelection[i])}),e.root}redo(e){return this.selectAll(e.root,this.action.select),e.root}};fi.SelectAllCommand=LC;LC.KIND=Ks.SelectAllAction.KIND;fi.SelectAllCommand=LC=DA([(0,iu.injectable)(),A7(0,(0,iu.inject)(R7.TYPES.Action)),TA("design:paramtypes",[Object])],LC);class UU extends xpe.MouseListener{constructor(){super(...arguments),this.wasSelected=!1,this.hasDragged=!1,this.isMouseDown=!1}mouseDown(e,t){if(t.button!==0)return[];this.isMouseDown=!0;const i=this.handleButton(e,t);if(i)return i;const o=(0,hD.findParentByFeature)(e,tc.isSelectable);if((o!==void 0||e instanceof h_.SModelRootImpl)&&(this.hasDragged=!1),o!==void 0){let r=[];if((0,q$.isCtrlOrCmd)(t)||(r=this.collectElementsToDeselect(e,o)),o.selected){if((0,q$.isCtrlOrCmd)(t))return this.wasSelected=!1,this.handleDeselectTarget(o,t);this.wasSelected=!0}else return this.wasSelected=!1,this.handleSelectTarget(o,r,t)}return[]}collectElementsToDeselect(e,t){return(0,GU.toArray)(e.root.index.all().filter(i=>(0,tc.isSelectable)(i)&&i.selected&&!(t instanceof zpe.SRoutingHandleImpl&&i===t.parent)))}handleButton(e,t){if(this.buttonHandlerRegistry!==void 0&&e instanceof Vpe.SButtonImpl&&e.enabled){const i=this.buttonHandlerRegistry.get(e.type);if(i!==void 0)return i.buttonPressed(e)}}handleSelectTarget(e,t,i){const o=[];o.push(Ks.SelectAction.create({selectedElementsIDs:[e.id],deselectedElementsIDs:t.map(s=>s.id)})),o.push(Ks.BringToFrontAction.create([e.id]));const r=t.filter(s=>s instanceof yE.SRoutableElementImpl).map(s=>s.id);return e instanceof yE.SRoutableElementImpl?o.push(_E.SwitchEditModeAction.create({elementsToActivate:[e.id],elementsToDeactivate:r})):r.length>0&&o.push(_E.SwitchEditModeAction.create({elementsToDeactivate:r})),o}handleDeselectTarget(e,t){const i=[];return i.push(Ks.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:[e.id]})),e instanceof yE.SRoutableElementImpl&&i.push(_E.SwitchEditModeAction.create({elementsToDeactivate:[e.id]})),i}handleDeselectAll(e,t){const i=[];i.push(Ks.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:e.map(r=>r.id)}));const o=e.filter(r=>r instanceof yE.SRoutableElementImpl).map(r=>r.id);return o.length>0&&i.push(_E.SwitchEditModeAction.create({elementsToDeactivate:o})),i}mouseMove(e,t){return this.hasDragged=this.isMouseDown,[]}mouseUp(e,t){if(t.button===0&&!this.hasDragged){const i=(0,hD.findParentByFeature)(e,tc.isSelectable);if(i!==void 0){if(this.wasSelected)return[Ks.SelectAction.create({selectedElementsIDs:[i.id],deselectedElementsIDs:[]})]}else if(e instanceof h_.SModelRootImpl&&!(0,Gpe.findViewportScrollbar)(t)||!(e instanceof h_.SModelRootImpl))return this.handleDeselectAll(this.collectElementsToDeselect(e,void 0),t)}return this.isMouseDown=!1,this.hasDragged=!1,[]}decorate(e,t){const i=(0,hD.findParentByFeature)(t,tc.isSelectable);return i!==void 0&&(0,Hpe.setClass)(e,"selected",i.selected),e}}fi.SelectMouseListener=UU;DA([(0,iu.inject)(W$.ButtonHandlerRegistry),(0,iu.optional)(),TA("design:type",W$.ButtonHandlerRegistry)],UU.prototype,"buttonHandlerRegistry",void 0);let NC=class extends kpe.ModelRequestCommand{constructor(e){super(),this.action=e,this.previousSelection={}}retrieveResult(e){const t=e.root.index.all().filter(i=>(0,tc.isSelectable)(i)&&i.selected).map(i=>i.id);return Ks.SelectionResult.create((0,GU.toArray)(t),this.action.requestId)}};fi.GetSelectionCommand=NC;NC.KIND=Ks.GetSelectionAction.KIND;fi.GetSelectionCommand=NC=DA([(0,iu.injectable)(),A7(0,(0,iu.inject)(R7.TYPES.Action)),TA("design:paramtypes",[Object])],NC);class Upe extends Fpe.KeyListener{keyDown(e,t){return(0,Kpe.matchesKeystroke)(t,"KeyA","ctrlCmd")?[Ks.SelectAllAction.create()]:[]}}fi.SelectKeyboardListener=Upe;var k0={};Object.defineProperty(k0,"__esModule",{value:!0});k0.UndoRedoKeyListener=void 0;const Z$=se,pD=qt,Ype=gi,qpe=sn;class Wpe extends Ype.KeyListener{keyDown(e,t){return(0,pD.matchesKeystroke)(t,"KeyZ","ctrlCmd")?[Z$.UndoAction.create()]:(0,pD.matchesKeystroke)(t,"KeyZ","ctrlCmd","shift")||!(0,qpe.isMac)()&&(0,pD.matchesKeystroke)(t,"KeyY","ctrlCmd")?[Z$.RedoAction.create()]:[]}}k0.UndoRedoKeyListener=Wpe;var ss={};Object.defineProperty(ss,"__esModule",{value:!0});ss.applyMatches=ss.ModelMatcher=ss.forEachMatch=void 0;const p8=ke,Zpe=kr;function Qpe(n,e){Object.keys(n).forEach(t=>e(t,n[t]))}ss.forEachMatch=Qpe;class Xpe{match(e,t){const i={};return this.matchLeft(e,i),this.matchRight(t,i),i}matchLeft(e,t,i){let o=t[e.id];if(o!==void 0?(o.left=e,o.leftParentId=i):(o={left:e,leftParentId:i},t[e.id]=o),(0,p8.isParent)(e))for(const r of e.children)this.matchLeft(r,t,e.id)}matchRight(e,t,i){let o=t[e.id];if(o!==void 0?(o.right=e,o.rightParentId=i):(o={right:e,rightParentId:i},t[e.id]=o),(0,p8.isParent)(e))for(const r of e.children)this.matchRight(r,t,e.id)}}ss.ModelMatcher=Xpe;function Jpe(n,e,t){n instanceof p8.SModelRootImpl?t=n.index:t===void 0&&(t=new Zpe.SModelIndex,t.add(n));for(const i of e){let o=!1;if(i.left!==void 0&&i.leftParentId!==void 0){const r=t.getById(i.leftParentId);if(r!==void 0&&r.children!==void 0){const s=r.children.indexOf(i.left);s>=0&&(i.right!==void 0&&i.leftParentId===i.rightParentId?(r.children.splice(s,1,i.right),o=!0):r.children.splice(s,1)),t.remove(i.left)}}if(!o&&i.right!==void 0&&i.rightParentId!==void 0){const r=t.getById(i.rightParentId);r!==void 0&&(r.children===void 0&&(r.children=[]),r.children.push(i.right))}}}ss.applyMatches=Jpe;var Fu={},OA={};Object.defineProperty(OA,"__esModule",{value:!0});OA.ResizeAnimation=void 0;const eme=Or;class tme extends eme.Animation{constructor(e,t,i,o=!1){super(i),this.model=e,this.elementResizes=t,this.reverse=o}tween(e){return this.elementResizes.forEach(t=>{const i=t.element,o=this.reverse?{width:(1-e)*t.toDimension.width+e*t.fromDimension.width,height:(1-e)*t.toDimension.height+e*t.fromDimension.height}:{width:(1-e)*t.fromDimension.width+e*t.toDimension.width,height:(1-e)*t.fromDimension.height+e*t.toDimension.height};i.bounds={x:i.bounds.x,y:i.bounds.y,width:o.width,height:o.height}}),this.model}}OA.ResizeAnimation=tme;var YU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},qU=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},nme=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Fu,"__esModule",{value:!0});Fu.UpdateModelCommand=void 0;const jC=F,ime=se,$h=De,Q$=Or,ome=Ve,rme=da,kh=ke,X$=Xn,J$=Of,ek=Hc,tk=$t,nk=kf,ik=to,ok=ss,sme=OA,ame=me,rk=Rs,sk=vi,ak=an,cme=yt;let sy=class extends ome.Command{constructor(e){super(),this.action=e}execute(e){let t;return this.action.newRoot!==void 0?t=e.modelFactory.createRoot(this.action.newRoot):(t=e.modelFactory.createRoot(e.root),this.action.matches!==void 0&&this.applyMatches(t,this.action.matches,e)),this.oldRoot=e.root,this.newRoot=t,this.performUpdate(this.oldRoot,this.newRoot,e)}performUpdate(e,t,i){if((this.action.animate===void 0||this.action.animate)&&e.id===t.id){let o;this.action.matches===void 0?o=new ok.ModelMatcher().match(e,t):o=this.convertToMatchResult(this.action.matches,e,t);const r=this.computeAnimation(t,o,i);return r instanceof Q$.Animation?r.start():r}else return e.type===t.type&&$h.Dimension.isValid(e.canvasBounds)&&(t.canvasBounds=e.canvasBounds),(0,rk.isViewport)(e)&&(0,rk.isViewport)(t)&&(t.zoom=e.zoom,t.scroll=e.scroll),t}applyMatches(e,t,i){const o=e.index;for(const r of t)if(r.left!==void 0){const s=o.getById(r.left.id);s instanceof kh.SChildElementImpl&&s.parent.remove(s)}for(const r of t)if(r.right!==void 0){const s=i.modelFactory.createElement(r.right);let a;r.rightParentId!==void 0&&(a=o.getById(r.rightParentId)),a instanceof kh.SParentElementImpl?a.add(s):e.add(s)}}convertToMatchResult(e,t,i){const o={};for(const r of e){const s={};let a;r.left!==void 0&&(a=r.left.id,s.left=t.index.getById(a),s.leftParentId=r.leftParentId),r.right!==void 0&&(a=r.right.id,s.right=i.index.getById(a),s.rightParentId=r.rightParentId),a!==void 0&&(o[a]=s)}return o}computeAnimation(e,t,i){const o={fades:[]};(0,ok.forEachMatch)(t,(s,a)=>{if(a.left!==void 0&&a.right!==void 0)this.updateElement(a.left,a.right,o);else if(a.right!==void 0){const f=a.right;(0,J$.isFadeable)(f)&&(f.opacity=0,o.fades.push({element:f,type:"in"}))}else if(a.left instanceof kh.SChildElementImpl){const f=a.left;if((0,J$.isFadeable)(f)&&a.leftParentId!==void 0&&!(0,cme.containsSome)(e,f)){const h=e.index.getById(a.leftParentId);if(h instanceof kh.SParentElementImpl){const g=i.modelFactory.createElement(f);h.add(g),o.fades.push({element:g,type:"out"})}}}});const r=this.createAnimations(o,e,i);return r.length>=2?new Q$.CompoundAnimation(e,i,r):r.length===1?r[0]:e}updateElement(e,t,i){if((0,ek.isLocateable)(e)&&(0,ek.isLocateable)(t)){const o=e.position,r=t.position;(!(0,$h.almostEquals)(o.x,r.x)||!(0,$h.almostEquals)(o.y,r.y))&&(i.moves===void 0&&(i.moves=[]),i.moves.push({element:t,fromPosition:o,toPosition:r}),t.position=o)}(0,tk.isSizeable)(e)&&(0,tk.isSizeable)(t)&&($h.Dimension.isValid(t.bounds)?(!(0,$h.almostEquals)(e.bounds.width,t.bounds.width)||!(0,$h.almostEquals)(e.bounds.height,t.bounds.height))&&(i.resizes===void 0&&(i.resizes=[]),i.resizes.push({element:t,fromDimension:{width:e.bounds.width,height:e.bounds.height},toDimension:{width:t.bounds.width,height:t.bounds.height}})):t.bounds={x:t.bounds.x,y:t.bounds.y,width:e.bounds.width,height:e.bounds.height}),e instanceof ak.SRoutableElementImpl&&t instanceof ak.SRoutableElementImpl&&this.edgeRouterRegistry&&(i.edgeMementi===void 0&&(i.edgeMementi=[]),i.edgeMementi.push({edge:t,before:this.takeSnapshot(e),after:this.takeSnapshot(t)})),(0,ik.isSelectable)(e)&&(0,ik.isSelectable)(t)&&(t.selected=e.selected),e instanceof kh.SModelRootImpl&&t instanceof kh.SModelRootImpl&&(t.canvasBounds=e.canvasBounds),e instanceof nk.ViewportRootElementImpl&&t instanceof nk.ViewportRootElementImpl&&(t.scroll=e.scroll,t.zoom=e.zoom)}takeSnapshot(e){return this.edgeRouterRegistry.get(e.routerKind).takeSnapshot(e)}createAnimations(e,t,i){const o=[];if(e.fades.length>0&&o.push(new rme.FadeAnimation(t,e.fades,i,!0)),e.moves!==void 0&&e.moves.length>0){const r=new Map;for(const s of e.moves)r.set(s.element.id,s);o.push(new X$.MoveAnimation(t,r,i,!1))}if(e.resizes!==void 0&&e.resizes.length>0){const r=new Map;for(const s of e.resizes)r.set(s.element.id,s);o.push(new sme.ResizeAnimation(t,r,i,!1))}return e.edgeMementi!==void 0&&e.edgeMementi.length>0&&o.push(new X$.MorphEdgesAnimation(t,e.edgeMementi,i,!1)),o}undo(e){return this.performUpdate(this.newRoot,this.oldRoot,e)}redo(e){return this.performUpdate(this.oldRoot,this.newRoot,e)}};Fu.UpdateModelCommand=sy;sy.KIND=ime.UpdateModelAction.KIND;YU([(0,jC.inject)(sk.EdgeRouterRegistry),(0,jC.optional)(),qU("design:type",sk.EdgeRouterRegistry)],sy.prototype,"edgeRouterRegistry",void 0);Fu.UpdateModelCommand=sy=YU([(0,jC.injectable)(),nme(0,(0,jC.inject)(ame.TYPES.Action)),qU("design:paramtypes",[Object])],sy);var Oi={},wo={},M7=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},I7=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},WU=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}},m8;Object.defineProperty(wo,"__esModule",{value:!0});wo.ViewportAnimation=wo.GetViewportCommand=wo.SetViewportCommand=void 0;const BC=F,D7=se,dme=De,ume=Ve,lme=Or,f3=Rs,T7=me,fme=_g;let ay=m8=class extends ume.MergeableCommand{constructor(e){super(),this.action=e,this.newViewport=e.newViewport}execute(e){const t=e.root,i=t.index.getById(this.action.elementId);if(i&&(0,f3.isViewport)(i)){this.element=i,this.oldViewport={scroll:this.element.scroll,zoom:this.element.zoom};const{zoomLimits:o,horizontalScrollLimits:r,verticalScrollLimits:s}=this.viewerOptions;return this.newViewport=(0,f3.limitViewport)(this.newViewport,t.canvasBounds,r,s,o),this.setViewport(i,this.oldViewport,this.newViewport,e)}return e.root}setViewport(e,t,i,o){if(e&&(0,f3.isViewport)(e)){if(this.action.animate)return new ZU(e,t,i,o).start();e.scroll=i.scroll,e.zoom=i.zoom}return o.root}undo(e){return this.setViewport(this.element,this.newViewport,this.oldViewport,e)}redo(e){return this.setViewport(this.element,this.oldViewport,this.newViewport,e)}merge(e,t){return!this.action.animate&&e instanceof m8&&this.element===e.element?(this.newViewport=e.newViewport,!0):!1}};wo.SetViewportCommand=ay;ay.KIND=D7.SetViewportAction.KIND;M7([(0,BC.inject)(T7.TYPES.ViewerOptions),I7("design:type",Object)],ay.prototype,"viewerOptions",void 0);wo.SetViewportCommand=ay=m8=M7([(0,BC.injectable)(),WU(0,(0,BC.inject)(T7.TYPES.Action)),I7("design:paramtypes",[Object])],ay);let $C=class extends fme.ModelRequestCommand{constructor(e){super(),this.action=e}retrieveResult(e){const t=e.root;let i;return(0,f3.isViewport)(t)?i={scroll:t.scroll,zoom:t.zoom}:i={scroll:dme.Point.ORIGIN,zoom:1},D7.ViewportResult.create(i,t.canvasBounds,this.action.requestId)}};wo.GetViewportCommand=$C;$C.KIND=D7.GetViewportAction.KIND;wo.GetViewportCommand=$C=M7([WU(0,(0,BC.inject)(T7.TYPES.Action)),I7("design:paramtypes",[Object])],$C);class ZU extends lme.Animation{constructor(e,t,i,o){super(o),this.element=e,this.oldViewport=t,this.newViewport=i,this.context=o,this.zoomFactor=Math.log(i.zoom/t.zoom)}tween(e,t){return this.element.scroll={x:(1-e)*this.oldViewport.scroll.x+e*this.newViewport.scroll.x,y:(1-e)*this.oldViewport.scroll.y+e*this.newViewport.scroll.y},this.element.zoom=this.oldViewport.zoom*Math.exp(e*this.zoomFactor),t.root}}wo.ViewportAnimation=ZU;var LA=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},NA=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},QU=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.CenterKeyboardListener=Oi.FitToScreenCommand=Oi.CenterCommand=Oi.BoundsAwareViewportCommand=void 0;const kC=se,Ja=De,ck=qt,hme=ke,pme=Ve,mme=gi,mD=$t,gme=to,dk=wo,Yv=Rs,jA=F,O7=me;let Yp=class extends pme.Command{constructor(e){super(),this.animate=e}initialize(e){if(!(0,Yv.isViewport)(e))return;this.oldViewport={scroll:e.scroll,zoom:e.zoom};const t=[];if(this.getElementIds().forEach(i=>{const o=e.index.getById(i);o&&(0,mD.isBoundsAware)(o)&&t.push(this.boundsInViewport(o,o.bounds,e))}),t.length===0&&e.index.all().forEach(i=>{(0,gme.isSelectable)(i)&&i.selected&&(0,mD.isBoundsAware)(i)&&t.push(this.boundsInViewport(i,i.bounds,e))}),t.length===0&&e.index.all().forEach(i=>{(0,mD.isBoundsAware)(i)&&t.push(this.boundsInViewport(i,i.bounds,e))}),t.length!==0){const i=t.reduce((o,r)=>Ja.Bounds.combine(o,r));if(Ja.Dimension.isValid(i)){const o=this.getNewViewport(i,e);if(o){const{zoomLimits:r,horizontalScrollLimits:s,verticalScrollLimits:a}=this.viewerOptions;this.newViewport=(0,Yv.limitViewport)(o,e.canvasBounds,s,a,r)}}}}boundsInViewport(e,t,i){return e instanceof hme.SChildElementImpl&&e.parent!==i?this.boundsInViewport(e.parent,e.parent.localToParent(t),i):t}execute(e){return this.initialize(e.root),this.redo(e)}undo(e){const t=e.root;if((0,Yv.isViewport)(t)&&this.newViewport!==void 0&&!this.equal(this.newViewport,this.oldViewport)){if(this.animate)return new dk.ViewportAnimation(t,this.newViewport,this.oldViewport,e).start();t.scroll=this.oldViewport.scroll,t.zoom=this.oldViewport.zoom}return t}redo(e){const t=e.root;if((0,Yv.isViewport)(t)&&this.newViewport!==void 0&&!this.equal(this.newViewport,this.oldViewport)){if(this.animate)return new dk.ViewportAnimation(t,this.oldViewport,this.newViewport,e).start();t.scroll=this.newViewport.scroll,t.zoom=this.newViewport.zoom}return t}equal(e,t){return(0,Ja.almostEquals)(e.zoom,t.zoom)&&(0,Ja.almostEquals)(e.scroll.x,t.scroll.x)&&(0,Ja.almostEquals)(e.scroll.y,t.scroll.y)}};Oi.BoundsAwareViewportCommand=Yp;LA([(0,jA.inject)(O7.TYPES.ViewerOptions),NA("design:type",Object)],Yp.prototype,"viewerOptions",void 0);Oi.BoundsAwareViewportCommand=Yp=LA([(0,jA.injectable)(),NA("design:paramtypes",[Boolean])],Yp);let FC=class extends Yp{constructor(e){super(e.animate),this.action=e}getElementIds(){return this.action.elementIds}getNewViewport(e,t){if(!Ja.Dimension.isValid(t.canvasBounds))return;let i=1;this.action.retainZoom&&(0,Yv.isViewport)(t)?i=t.zoom:this.action.zoomScale&&(i=this.action.zoomScale);const o=Ja.Bounds.center(e);return{scroll:{x:o.x-.5*t.canvasBounds.width/i,y:o.y-.5*t.canvasBounds.height/i},zoom:i}}};Oi.CenterCommand=FC;FC.KIND=kC.CenterAction.KIND;Oi.CenterCommand=FC=LA([QU(0,(0,jA.inject)(O7.TYPES.Action)),NA("design:paramtypes",[Object])],FC);let xC=class extends Yp{constructor(e){super(e.animate),this.action=e}getElementIds(){return this.action.elementIds}getNewViewport(e,t){if(!Ja.Dimension.isValid(t.canvasBounds))return;const i=Ja.Bounds.center(e),o=this.action.padding===void 0?0:2*this.action.padding;let r=Math.min(t.canvasBounds.width/(e.width+o),t.canvasBounds.height/(e.height+o));return this.action.maxZoom!==void 0&&(r=Math.min(r,this.action.maxZoom)),r===1/0&&(r=1),{scroll:{x:i.x-.5*t.canvasBounds.width/r,y:i.y-.5*t.canvasBounds.height/r},zoom:r}}};Oi.FitToScreenCommand=xC;xC.KIND=kC.FitToScreenAction.KIND;Oi.FitToScreenCommand=xC=LA([QU(0,(0,jA.inject)(O7.TYPES.Action)),NA("design:paramtypes",[Object])],xC);class vme extends mme.KeyListener{keyDown(e,t){return(0,ck.matchesKeystroke)(t,"KeyC","ctrlCmd","shift")?[kC.CenterAction.create([])]:(0,ck.matchesKeystroke)(t,"KeyF","ctrlCmd","shift")?[kC.FitToScreenAction.create([])]:[]}}Oi.CenterKeyboardListener=vme;var Yf={},_me=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},yme=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},bme=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Yf,"__esModule",{value:!0});Yf.BringToFrontCommand=void 0;const uk=F,Sme=se,Eme=me,lk=ke,Cme=Ve,fk=an;let HC=class extends Cme.Command{constructor(e){super(),this.action=e,this.selected=[]}execute(e){const t=e.root;return this.action.elementIDs.forEach(i=>{const o=t.index.getById(i);o instanceof fk.SRoutableElementImpl&&(o.source&&this.addToSelection(o.source),o.target&&this.addToSelection(o.target)),o instanceof lk.SChildElementImpl&&this.addToSelection(o),this.includeConnectedEdges(o)}),this.redo(e)}includeConnectedEdges(e){if(e instanceof fk.SConnectableElementImpl&&(e.incomingEdges.forEach(t=>this.addToSelection(t)),e.outgoingEdges.forEach(t=>this.addToSelection(t))),e instanceof lk.SParentElementImpl)for(const t of e.children)this.includeConnectedEdges(t)}addToSelection(e){this.selected.push({element:e,index:e.parent.children.indexOf(e)})}undo(e){for(let t=this.selected.length-1;t>=0;t--){const i=this.selected[t],o=i.element;o.parent.move(o,i.index)}return e.root}redo(e){for(let t=0;t<this.selected.length;t++)this.bringToFront(this.selected[t]);return e.root}bringToFront(e){const t=e.element,i=t.parent.children.length;t.parent.move(t,i-1)}};Yf.BringToFrontCommand=HC;HC.KIND=Sme.BringToFrontAction.KIND;Yf.BringToFrontCommand=HC=_me([(0,uk.injectable)(),bme(0,(0,uk.inject)(Eme.TYPES.Action)),yme("design:paramtypes",[Object])],HC);var BA={};Object.defineProperty(BA,"__esModule",{value:!0});const Pme=F,gD=me,hk=hs,pk=mA,pv=Yi,mk=wn,gk=Tf,vk=Df,_k=ug,wme=new Pme.ContainerModule((n,e,t)=>{(0,mk.configureCommand)({bind:n,isBound:t},hk.SetBoundsCommand),(0,mk.configureCommand)({bind:n,isBound:t},hk.RequestBoundsCommand),n(pk.HiddenBoundsUpdater).toSelf().inSingletonScope(),n(gD.TYPES.HiddenVNodePostprocessor).toService(pk.HiddenBoundsUpdater),n(gD.TYPES.Layouter).to(pv.Layouter).inSingletonScope(),n(gD.TYPES.LayoutRegistry).to(pv.LayoutRegistry).inSingletonScope(),(0,pv.configureLayout)({bind:n,isBound:t},vk.VBoxLayouter.KIND,vk.VBoxLayouter),(0,pv.configureLayout)({bind:n,isBound:t},gk.HBoxLayouter.KIND,gk.HBoxLayouter),(0,pv.configureLayout)({bind:n,isBound:t},_k.StackLayouter.KIND,_k.StackLayouter)});BA.default=wme;var F0={};Object.defineProperty(F0,"__esModule",{value:!0});const Ame=F,Rme=ps,Mme=new Ame.ContainerModule(n=>{n(Rme.ButtonHandlerRegistry).toSelf().inSingletonScope()});F0.default=Mme;var $A={};Object.defineProperty($A,"__esModule",{value:!0});const Ime=F,vD=me,yk=ms,bE=uc,Dme=new Ime.ContainerModule(n=>{n(bE.CommandPalette).toSelf().inSingletonScope(),n(vD.TYPES.IUIExtension).toService(bE.CommandPalette),n(bE.CommandPaletteKeyListener).toSelf().inSingletonScope(),n(vD.TYPES.KeyListener).toService(bE.CommandPaletteKeyListener),n(yk.CommandPaletteActionProviderRegistry).toSelf().inSingletonScope(),n(vD.TYPES.ICommandPaletteActionProviderRegistry).toService(yk.CommandPaletteActionProviderRegistry)});$A.default=Dme;var kA={};Object.defineProperty(kA,"__esModule",{value:!0});const Tme=F,Ome=gs,bk=Nf,mv=me,Lme=new Tme.ContainerModule(n=>{n(mv.TYPES.IContextMenuServiceProvider).toProvider(e=>()=>new Promise((t,i)=>{e.container.isBound(mv.TYPES.IContextMenuService)?t(e.container.get(mv.TYPES.IContextMenuService)):i()})),n(bk.ContextMenuMouseListener).toSelf().inSingletonScope(),n(mv.TYPES.MouseListener).toService(bk.ContextMenuMouseListener),n(mv.TYPES.IContextMenuProviderRegistry).to(Ome.ContextMenuProviderRegistry)});kA.default=Lme;var FA={};Object.defineProperty(FA,"__esModule",{value:!0});const Nme=rn,jme=F,Bme=B0,$me=Kf,kme=me,Sk=Vf,Fme=new jme.ContainerModule((n,e,t)=>{(0,Nme.configureModelElement)({bind:n,isBound:t},"marker",Bme.SIssueMarkerImpl,$me.IssueMarkerView),n(Sk.DecorationPlacer).toSelf().inSingletonScope(),n(kme.TYPES.IVNodePostprocessor).toService(Sk.DecorationPlacer)});FA.default=Fme;var xA={};Object.defineProperty(xA,"__esModule",{value:!0});const xme=F,Hme=me,Ek=Zn,Kme=new xme.ContainerModule(n=>{n(Ek.IntersectionFinder).toSelf().inSingletonScope(),n(Hme.TYPES.IEdgeRoutePostprocessor).toService(Ek.IntersectionFinder)});xA.default=Kme;var HA={},x0={},XU=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Vme=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(x0,"__esModule",{value:!0});x0.JunctionPostProcessor=void 0;const JU=F,zme=me;let KC=class{decorate(e,t){return e}postUpdate(e){const t=this.viewerOptions.baseDiv,i=document.querySelector(`#${t} > svg > g`);if(i){const o=Array.from(document.querySelectorAll("g.sprotty-junction"));o.forEach(r=>{r.remove()}),i.append(...o)}}};x0.JunctionPostProcessor=KC;XU([(0,JU.inject)(zme.TYPES.ViewerOptions),Vme("design:type",Object)],KC.prototype,"viewerOptions",void 0);x0.JunctionPostProcessor=KC=XU([(0,JU.injectable)()],KC);Object.defineProperty(HA,"__esModule",{value:!0});const Gme=F,Ck=me,Pk=zf,wk=x0,Ume=new Gme.ContainerModule(n=>{n(Pk.JunctionFinder).toSelf().inSingletonScope(),n(Ck.TYPES.IEdgeRoutePostprocessor).toService(Pk.JunctionFinder),n(wk.JunctionPostProcessor).toSelf().inSingletonScope(),n(Ck.TYPES.IVNodePostprocessor).toService(wk.JunctionPostProcessor)});HA.default=Ume;var H0={};Object.defineProperty(H0,"__esModule",{value:!0});const Yme=F,qme=ps,Ak=Hf,Wme=new Yme.ContainerModule((n,e,t)=>{(0,qme.configureButtonHandler)({bind:n,isBound:t},Ak.ExpandButtonHandler.TYPE,Ak.ExpandButtonHandler)});H0.default=Wme;var KA={};Object.defineProperty(KA,"__esModule",{value:!0});const Zme=F,_D=me,gv=qi,Qme=rr,Xme=wn,Jme=new Zme.ContainerModule((n,e,t)=>{n(gv.ExportSvgKeyListener).toSelf().inSingletonScope(),n(_D.TYPES.KeyListener).toService(gv.ExportSvgKeyListener),n(gv.ExportSvgPostprocessor).toSelf().inSingletonScope(),n(_D.TYPES.HiddenVNodePostprocessor).toService(gv.ExportSvgPostprocessor),(0,Xme.configureCommand)({bind:n,isBound:t},gv.ExportSvgCommand),n(_D.TYPES.SvgExporter).to(Qme.SvgExporter).inSingletonScope()});KA.default=Jme;var K0={};Object.defineProperty(K0,"__esModule",{value:!0});const ege=F,tge=me,Rk=da,nge=new ege.ContainerModule(n=>{n(Rk.ElementFader).toSelf().inSingletonScope(),n(tge.TYPES.IVNodePostprocessor).toService(Rk.ElementFader)});K0.default=nge;var VA={},yg={},eY=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ige=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(yg,"__esModule",{value:!0});yg.PopupPositionUpdater=void 0;const tY=F,oge=me;let VC=class{decorate(e,t){return e}postUpdate(){const e=document.getElementById(this.options.popupDiv);if(e!==null&&typeof window<"u"){const t=e.getBoundingClientRect();window.innerHeight<t.height+t.top&&(e.style.top=window.pageYOffset+window.innerHeight-t.height-5+"px"),window.innerWidth<t.left+t.width&&(e.style.left=window.pageXOffset+window.innerWidth-t.width-5+"px"),t.left<0&&(e.style.left="0px"),t.top<0&&(e.style.top="0px")}}};yg.PopupPositionUpdater=VC;eY([(0,tY.inject)(oge.TYPES.ViewerOptions),ige("design:type",Object)],VC.prototype,"options",void 0);yg.PopupPositionUpdater=VC=eY([(0,tY.injectable)()],VC);Object.defineProperty(VA,"__esModule",{value:!0});const rge=F,vv=me,xi=fn,Mk=yg,Ik=wn,_v=qo,Dk=Oi,sge=wo,age=Xn,cge=new rge.ContainerModule((n,e,t)=>{n(Mk.PopupPositionUpdater).toSelf().inSingletonScope(),n(vv.TYPES.PopupVNodePostprocessor).toService(Mk.PopupPositionUpdater),n(xi.HoverMouseListener).toSelf().inSingletonScope(),n(vv.TYPES.MouseListener).toService(xi.HoverMouseListener),n(xi.PopupHoverMouseListener).toSelf().inSingletonScope(),n(vv.TYPES.PopupMouseListener).toService(xi.PopupHoverMouseListener),n(xi.HoverKeyListener).toSelf().inSingletonScope(),n(vv.TYPES.KeyListener).toService(xi.HoverKeyListener),n(vv.TYPES.HoverState).toConstantValue({mouseOverTimer:void 0,mouseOutTimer:void 0,popupOpen:!1,previousPopupElement:void 0}),n(xi.ClosePopupActionHandler).toSelf().inSingletonScope();const i={bind:n,isBound:t};(0,Ik.configureCommand)(i,xi.HoverFeedbackCommand),(0,Ik.configureCommand)(i,xi.SetPopupModelCommand),(0,_v.configureActionHandler)(i,xi.SetPopupModelCommand.KIND,xi.ClosePopupActionHandler),(0,_v.configureActionHandler)(i,Dk.FitToScreenCommand.KIND,xi.ClosePopupActionHandler),(0,_v.configureActionHandler)(i,Dk.CenterCommand.KIND,xi.ClosePopupActionHandler),(0,_v.configureActionHandler)(i,sge.SetViewportCommand.KIND,xi.ClosePopupActionHandler),(0,_v.configureActionHandler)(i,age.MoveCommand.KIND,xi.ClosePopupActionHandler)});VA.default=cge;var V0={};Object.defineProperty(V0,"__esModule",{value:!0});const dge=F,yD=me,Fh=Xn,uge=wn,lge=new dge.ContainerModule((n,e,t)=>{n(Fh.MoveMouseListener).toSelf().inSingletonScope(),n(yD.TYPES.MouseListener).toService(Fh.MoveMouseListener),(0,uge.configureCommand)({bind:n,isBound:t},Fh.MoveCommand),n(Fh.LocationPostprocessor).toSelf().inSingletonScope(),n(yD.TYPES.IVNodePostprocessor).toService(Fh.LocationPostprocessor),n(yD.TYPES.HiddenVNodePostprocessor).toService(Fh.LocationPostprocessor)});V0.default=lge;var z0={};Object.defineProperty(z0,"__esModule",{value:!0});const fge=F,hge=me,Tk=gg,pge=new fge.ContainerModule(n=>{n(Tk.OpenMouseListener).toSelf().inSingletonScope(),n(hge.TYPES.MouseListener).toService(Tk.OpenMouseListener)});z0.default=pge;var zA={};Object.defineProperty(zA,"__esModule",{value:!0});const mge=F,_r=me,Ok=Gf,Lk=Kc,xh=Jo,Hh=Po,gge=Ra,vge=vi,bD=Wi,Kh=Xo,_ge=wn,yge=new mge.ContainerModule((n,e,t)=>{n(vge.EdgeRouterRegistry).toSelf().inSingletonScope(),n(gge.AnchorComputerRegistry).toSelf().inSingletonScope(),n(Ok.ManhattanEdgeRouter).toSelf().inSingletonScope(),n(_r.TYPES.IEdgeRouter).toService(Ok.ManhattanEdgeRouter),n(xh.ManhattanEllipticAnchor).toSelf().inSingletonScope(),n(_r.TYPES.IAnchorComputer).toService(xh.ManhattanEllipticAnchor),n(xh.ManhattanRectangularAnchor).toSelf().inSingletonScope(),n(_r.TYPES.IAnchorComputer).toService(xh.ManhattanRectangularAnchor),n(xh.ManhattanDiamondAnchor).toSelf().inSingletonScope(),n(_r.TYPES.IAnchorComputer).toService(xh.ManhattanDiamondAnchor),n(Lk.PolylineEdgeRouter).toSelf().inSingletonScope(),n(_r.TYPES.IEdgeRouter).toService(Lk.PolylineEdgeRouter),n(Hh.EllipseAnchor).toSelf().inSingletonScope(),n(_r.TYPES.IAnchorComputer).toService(Hh.EllipseAnchor),n(Hh.RectangleAnchor).toSelf().inSingletonScope(),n(_r.TYPES.IAnchorComputer).toService(Hh.RectangleAnchor),n(Hh.DiamondAnchor).toSelf().inSingletonScope(),n(_r.TYPES.IAnchorComputer).toService(Hh.DiamondAnchor),n(bD.BezierEdgeRouter).toSelf().inSingletonScope(),n(_r.TYPES.IEdgeRouter).toService(bD.BezierEdgeRouter),n(Kh.BezierEllipseAnchor).toSelf().inSingletonScope(),n(_r.TYPES.IAnchorComputer).toService(Kh.BezierEllipseAnchor),n(Kh.BezierRectangleAnchor).toSelf().inSingletonScope(),n(_r.TYPES.IAnchorComputer).toService(Kh.BezierRectangleAnchor),n(Kh.BezierDiamondAnchor).toSelf().inSingletonScope(),n(_r.TYPES.IAnchorComputer).toService(Kh.BezierDiamondAnchor),(0,_ge.configureCommand)({bind:n,isBound:t},bD.AddRemoveBezierSegmentCommand)});zA.default=yge;var GA={};Object.defineProperty(GA,"__esModule",{value:!0});const bge=F,Nk=me,el=fi,SD=wn,Sge=new bge.ContainerModule((n,e,t)=>{(0,SD.configureCommand)({bind:n,isBound:t},el.SelectCommand),(0,SD.configureCommand)({bind:n,isBound:t},el.SelectAllCommand),(0,SD.configureCommand)({bind:n,isBound:t},el.GetSelectionCommand),n(el.SelectKeyboardListener).toSelf().inSingletonScope(),n(Nk.TYPES.KeyListener).toService(el.SelectKeyboardListener),n(el.SelectMouseListener).toSelf().inSingletonScope(),n(Nk.TYPES.MouseListener).toService(el.SelectMouseListener)});GA.default=Sge;var UA={};Object.defineProperty(UA,"__esModule",{value:!0});const Ege=F,Cge=me,jk=k0,Pge=new Ege.ContainerModule(n=>{n(jk.UndoRedoKeyListener).toSelf().inSingletonScope(),n(Cge.TYPES.KeyListener).toService(jk.UndoRedoKeyListener)});UA.default=Pge;var G0={};Object.defineProperty(G0,"__esModule",{value:!0});const wge=F,Age=wn,Rge=Fu,Mge=new wge.ContainerModule((n,e,t)=>{(0,Age.configureCommand)({bind:n,isBound:t},Rge.UpdateModelCommand)});G0.default=Mge;var YA={};Object.defineProperty(YA,"__esModule",{value:!0});const Ige=F,ED=me,SE=Oi,Bk=wo,$k=mc,kk=fc,EE=wn,Dge=new Ige.ContainerModule((n,e,t)=>{(0,EE.configureCommand)({bind:n,isBound:t},SE.CenterCommand),(0,EE.configureCommand)({bind:n,isBound:t},SE.FitToScreenCommand),(0,EE.configureCommand)({bind:n,isBound:t},Bk.SetViewportCommand),(0,EE.configureCommand)({bind:n,isBound:t},Bk.GetViewportCommand),n(SE.CenterKeyboardListener).toSelf().inSingletonScope(),n(ED.TYPES.KeyListener).toService(SE.CenterKeyboardListener),n($k.ScrollMouseListener).toSelf().inSingletonScope(),n(kk.ZoomMouseListener).toSelf().inSingletonScope(),n(ED.TYPES.MouseListener).toService($k.ScrollMouseListener),n(ED.TYPES.MouseListener).toService(kk.ZoomMouseListener)});YA.default=Dge;var U0={};Object.defineProperty(U0,"__esModule",{value:!0});const Tge=F,Oge=wn,Lge=Yf,Nge=new Tge.ContainerModule((n,e,t)=>{(0,Oge.configureCommand)({bind:n,isBound:t},Lge.BringToFrontCommand)});U0.default=Nge;var gt={},Io=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},qA=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(gt,"__esModule",{value:!0});gt.SBezierControlHandleView=gt.SBezierCreateHandleView=gt.SCompartmentView=gt.SLabelView=gt.SRoutingHandleView=gt.BezierCurveEdgeView=gt.PolylineEdgeViewWithGapsOnIntersections=gt.JumpingPolylineEdgeView=gt.PolylineEdgeView=gt.SGraphView=void 0;const Do=F,vp=De,nY=jn,Y0=ft,jge=xc,yv=Zn,Bge=Bf,WA=an,ou=vi,iY=Uf,Gt=ei,$ge=Jn;let zC=class{render(e,t){const i=this.edgeRouterRegistry.routeAllChildren(e),o=`scale(${e.zoom}) translate(${-e.scroll.x},${-e.scroll.y})`;return(0,Gt.svg)("svg",{"class-sprotty-graph":!0},(0,Gt.svg)("g",{transform:o},t.renderChildren(e,{edgeRouting:i})))}};gt.SGraphView=zC;Io([(0,Do.inject)(ou.EdgeRouterRegistry),qA("design:type",ou.EdgeRouterRegistry)],zC.prototype,"edgeRouterRegistry",void 0);gt.SGraphView=zC=Io([(0,Do.injectable)()],zC);let cy=class extends iY.RoutableView{render(e,t,i){const o=this.edgeRouterRegistry.route(e,i);return o.length===0?this.renderDanglingEdge("Cannot compute route",e,t):this.isVisible(e,o,t)?(0,Gt.svg)("g",{"class-sprotty-edge":!0,"class-mouseover":e.hoverFeedback},this.renderLine(e,o,t,i),this.renderAdditionals(e,o,t),this.renderJunctionPoints(e,o,t,i),t.renderChildren(e,{route:o})):e.children.length===0?void 0:(0,Gt.svg)("g",null,t.renderChildren(e,{route:o}))}renderJunctionPoints(e,t,i,o){const s=[];for(let a=1;a<t.length;a++)t[a].isJunction&&s.push((0,Gt.svg)("circle",{cx:t[a].x,cy:t[a].y,r:5}));if(s.length>0)return(0,Gt.svg)("g",{"class-sprotty-junction":!0},s)}renderLine(e,t,i,o){const r=t[0];let s=`M ${r.x},${r.y}`;for(let a=1;a<t.length;a++){const f=t[a];s+=` L ${f.x},${f.y}`}return(0,Gt.svg)("path",{d:s})}renderAdditionals(e,t,i){return[]}renderDanglingEdge(e,t,i){return(0,Gt.svg)("text",{"class-sprotty-edge-dangling":!0,title:e},"?")}};gt.PolylineEdgeView=cy;Io([(0,Do.inject)(ou.EdgeRouterRegistry),qA("design:type",ou.EdgeRouterRegistry)],cy.prototype,"edgeRouterRegistry",void 0);gt.PolylineEdgeView=cy=Io([(0,Do.injectable)()],cy);let GC=class extends cy{constructor(){super(...arguments),this.jumpOffsetBefore=5,this.jumpOffsetAfter=5,this.skipOffsetBefore=3,this.skipOffsetAfter=2}renderLine(e,t,i,o){let r="";for(let s=0;s<t.length;s++){const a=t[s];s===0&&(r=`M ${a.x},${a.y}`),(0,yv.isIntersectingRoutedPoint)(a)&&(r+=this.intersectionPath(e,t,a,o)),s!==0&&(r+=` L ${a.x},${a.y}`)}return(0,Gt.svg)("path",{d:r})}intersectionPath(e,t,i,o){if(i.intersections.length<1)return"";const r=this.getLineSegment(e,i.intersections[0],o,t),s=this.getIntersectionsSortedBySegmentDirection(r,i);let a="";for(const f of s){const h=this.getOtherLineSegment(e,f,o);if(h===void 0)continue;const g=this.getLineSegment(e,f,o,t),y=f.intersectionPoint;this.shouldDrawLineJumpOnIntersection(g,h)?a+=this.createJumpPath(y,g):this.shouldDrawLineGapOnIntersection(g,h)&&(a+=this.createGapPath(y,g))}return a}getIntersectionsSortedBySegmentDirection(e,t){switch(e.direction){case"north":case"north-east":return t.intersections.sort(yv.BY_X_THEN_DESCENDING_Y);case"south":case"south-east":case"east":return t.intersections.sort(yv.BY_X_THEN_Y);case"south-west":case"west":return t.intersections.sort(yv.BY_DESCENDING_X_THEN_Y);case"north-west":return t.intersections.sort(yv.BY_DESCENDING_X_THEN_DESCENDING_Y)}}shouldDrawLineJumpOnIntersection(e,t){return Math.abs(e.slopeOrMax)<Math.abs(t.slopeOrMax)}shouldDrawLineGapOnIntersection(e,t){return!this.shouldDrawLineJumpOnIntersection(e,t)}getLineSegment(e,t,i,o){const r=o||this.edgeRouterRegistry.route(e,i),s=t.routable1===e.id?t.segmentIndex1:t.segmentIndex2;return new $ge.PointToPointLine(r[s],r[s+1])}getOtherLineSegment(e,t,i){const o=t.routable1===e.id?t.routable2:t.routable1,r=e.index.getById(o);if(r instanceof WA.SRoutableElementImpl)return this.getLineSegment(r,t,i)}createJumpPath(e,t){const i=vp.Point.shiftTowards(e,t.p1,this.jumpOffsetBefore),o=vp.Point.shiftTowards(e,t.p2,this.jumpOffsetAfter),r=t.p1.x<t.p2.x?1:0;return` L ${i.x},${i.y} A 1,1 0,0 ${r} ${o.x},${o.y}`}createGapPath(e,t){let i,o;e.y<t.p1.y?(i=-this.skipOffsetBefore,o=this.jumpOffsetAfter+this.skipOffsetAfter):(i=this.jumpOffsetBefore+this.skipOffsetAfter,o=-this.skipOffsetBefore);const r=vp.Point.shiftTowards(e,t.p1,i),s=vp.Point.shiftTowards(e,t.p2,o);return` L ${r.x},${r.y} M ${s.x},${s.y}`}};gt.JumpingPolylineEdgeView=GC;gt.JumpingPolylineEdgeView=GC=Io([(0,Do.injectable)()],GC);let g8=class extends GC{constructor(){super(...arguments),this.skipOffsetBefore=3,this.skipOffsetAfter=3}shouldDrawLineJumpOnIntersection(e,t){return!1}shouldDrawLineGapOnIntersection(e,t){return Math.abs(e.slopeOrMax)>=Math.abs(t.slopeOrMax)}createGapPath(e,t){const i=vp.Point.shiftTowards(e,t.p1,this.skipOffsetBefore),o=vp.Point.shiftTowards(e,t.p2,this.skipOffsetAfter);return` L ${i.x},${i.y} M ${o.x},${o.y}`}};gt.PolylineEdgeViewWithGapsOnIntersections=g8;gt.PolylineEdgeViewWithGapsOnIntersections=g8=Io([(0,Do.injectable)()],g8);let UC=class extends iY.RoutableView{render(e,t,i){const o=this.edgeRouterRegistry.route(e,i);return o.length===0?this.renderDanglingEdge("Cannot compute route",e,t):this.isVisible(e,o,t)?(0,Gt.svg)("g",{"class-sprotty-edge":!0,"class-mouseover":e.hoverFeedback},this.renderLine(e,o,t,i),this.renderAdditionals(e,o,t),t.renderChildren(e,{route:o})):e.children.length===0?void 0:(0,Gt.svg)("g",null,t.renderChildren(e,{route:o}))}renderLine(e,t,i,o){let r="";if(t.length>=4){r+=this.buildMainSegment(t);const s=t.length-4;if(s>0&&s%3===0)for(let a=4;a<t.length;a+=3)r+=this.addSpline(t,a)}return(0,Gt.svg)("path",{d:r})}buildMainSegment(e){const t=e[0],i=e[1],o=e[2],r=e[3];return`M${t.x},${t.y} C${i.x},${i.y} ${o.x},${o.y} ${r.x},${r.y}`}addSpline(e,t){const i=e[t+1],o=e[t+2];return` S${i.x},${i.y} ${o.x},${o.y}`}renderAdditionals(e,t,i){return[]}renderDanglingEdge(e,t,i){return(0,Gt.svg)("text",{"class-sprotty-edge-dangling":!0,title:e},"?")}};gt.BezierCurveEdgeView=UC;Io([(0,Do.inject)(ou.EdgeRouterRegistry),qA("design:type",ou.EdgeRouterRegistry)],UC.prototype,"edgeRouterRegistry",void 0);gt.BezierCurveEdgeView=UC=Io([(0,Do.injectable)()],UC);let qp=class{constructor(){this.minimalPointDistance=10}render(e,t,i){if(i&&i.route&&e.parent instanceof WA.SRoutableElementImpl){const o=this.edgeRouterRegistry.get(e.parent.routerKind),r=i.route===void 0?this.edgeRouterRegistry.route(e.parent,i):i.route,s=o.getHandlePosition(e.parent,r,e);if(s!==void 0){const a=(0,Gt.svg)("circle",{"class-sprotty-routing-handle":!0,"class-selected":e.selected,"class-mouseover":e.hoverFeedback,cx:s.x,cy:s.y,r:this.getRadius()});return(0,Y0.setAttr)(a,"data-kind",e.kind),a}}return(0,Gt.svg)("g",null)}getRadius(){return 7}};gt.SRoutingHandleView=qp;Io([(0,Do.inject)(ou.EdgeRouterRegistry),qA("design:type",ou.EdgeRouterRegistry)],qp.prototype,"edgeRouterRegistry",void 0);gt.SRoutingHandleView=qp=Io([(0,Do.injectable)()],qp);let v8=class extends jge.ShapeView{render(e,t){if(!(0,Bge.isEdgeLayoutable)(e)&&!this.isVisible(e,t))return;const i=(0,Gt.svg)("text",{"class-sprotty-label":!0},e.text),o=(0,nY.getSubType)(e);return o&&(0,Y0.setAttr)(i,"class",o),i}};gt.SLabelView=v8;gt.SLabelView=v8=Io([(0,Do.injectable)()],v8);let _8=class{render(e,t,i){const o=`translate(${e.bounds.x}, ${e.bounds.y})`,r=(0,Gt.svg)("g",{transform:o,"class-sprotty-comp":"{true}"},t.renderChildren(e)),s=(0,nY.getSubType)(e);return s&&(0,Y0.setAttr)(r,"class",s),r}};gt.SCompartmentView=_8;gt.SCompartmentView=_8=Io([(0,Do.injectable)()],_8);let y8=class extends qp{render(e,t,i){if(i){const o=i.route;if(o&&e.parent instanceof WA.SRoutableElementImpl){const s=this.edgeRouterRegistry.get(e.parent.routerKind).getHandlePosition(e.parent,o,e);if(s!==void 0){const a="translate("+s.x+", "+s.y+")",f=-5.5,h=5.5,g=e.kind==="bezier-add"?"+":"-",y=(0,Gt.svg)("g",{transform:a,"class-sprotty-routing-handle":!0,"class-selected":e.selected,"class-mouseover":e.hoverFeedback},(0,Gt.svg)("circle",{r:this.getRadius()}),(0,Gt.svg)("text",{x:f,y:h,"attrs-text-align":"middle","style-font-family":"monospace","style-pointer-events":"none","style-fill":"white"},g));return(0,Y0.setAttr)(y,"data-kind",e.kind),y}}}return(0,Gt.svg)("g",null)}};gt.SBezierCreateHandleView=y8;gt.SBezierCreateHandleView=y8=Io([(0,Do.injectable)()],y8);let b8=class extends qp{render(e,t,i){if(i){const o=i.route;if(o&&e.parent instanceof WA.SRoutableElementImpl){const s=this.edgeRouterRegistry.get(e.parent.routerKind).getHandlePosition(e.parent,o,e);if(s!==void 0){let a;for(let h=0;h<o.length;h++){const g=o[h];if(g.kind===s.kind&&g.pointIndex===s.pointIndex){e.kind==="bezier-control-before"?a=o[h+1]:a=o[h-1];break}}let f;if(a){const h=`M ${s.x}, ${s.y} L ${a.x}, ${a.y}`;f=(0,Gt.svg)("g",{"class-sprotty-routing-handle":!0,"class-selected":e.selected,"class-mouseover":e.hoverFeedback},(0,Gt.svg)("path",{d:h,stroke:"grey","style-stroke-width":"2px"}),(0,Gt.svg)("circle",{cx:s.x,cy:s.y,r:this.getRadius()}))}else f=(0,Gt.svg)("circle",{"class-sprotty-routing-handle":!0,"class-selected":e.selected,"class-mouseover":e.hoverFeedback,cx:s.x,cy:s.y,r:this.getRadius()});return(0,Y0.setAttr)(f,"data-kind",e.kind),f}}}return(0,Gt.svg)("g",null)}};gt.SBezierControlHandleView=b8;gt.SBezierControlHandleView=b8=Io([(0,Do.injectable)()],b8);var q0={},W0={};Object.defineProperty(W0,"__esModule",{value:!0});const kge=F,Fge=wn,CE=me,xge=vs,Hge=or,Kge=new kge.ContainerModule((n,e,t)=>{n(CE.TYPES.ModelSourceProvider).toProvider(i=>()=>new Promise(o=>{o(i.container.get(CE.TYPES.ModelSource))})),(0,Fge.configureCommand)({bind:n,isBound:t},xge.CommitModelCommand),n(CE.TYPES.IActionHandlerInitializer).toService(CE.TYPES.ModelSource),n(Hge.ComputedBoundsApplicator).toSelf().inSingletonScope()});W0.default=Kge;var kn=l&&l.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(q0,"__esModule",{value:!0});q0.loadDefaultModules=void 0;const Vge=kn(_0),zge=kn(W0),Gge=kn(BA),Uge=kn(F0),Yge=kn($A),qge=kn(kA),Wge=kn(FA),Zge=kn(Kl),CD=ea,Qge=kn(H0),Xge=kn(KA),Jge=kn(K0),e1e=kn(VA),t1e=kn(V0),n1e=kn(z0),i1e=kn(zA),o1e=kn(GA),r1e=kn(UA),s1e=kn(G0),a1e=kn(YA),c1e=kn(U0);function d1e(n,e){const t=[Vge.default,zge.default,Gge.default,Uge.default,Yge.default,qge.default,Wge.default,CD.edgeEditModule,Zge.default,Qge.default,Xge.default,Jge.default,e1e.default,CD.labelEditModule,CD.labelEditUiModule,t1e.default,n1e.default,i1e.default,o1e.default,r1e.default,s1e.default,a1e.default,c1e.default];if(e&&e.exclude)for(const i of e.exclude){const o=t.indexOf(i);o>=0&&t.splice(o,1)}n.load(...t)}q0.loadDefaultModules=d1e;var gc={},L7={};Object.defineProperty(L7,"__esModule",{value:!0});const h3=dg;function u1e(n){const e={},t=(s,a)=>{if(a!=="style"&&a!=="class"){const f=m1e(n[a]);s?s[a]=f:s={[a]:f}}return s},i=Object.keys(n).reduce(t,null);i&&(e.attrs=i);const o=l1e(n);o&&(e.style=o);const r=f1e(n);return r&&(e.class=r),e}function l1e(n){const e=(t,i)=>{const o=i.split(":"),r=h1e(o[0].trim());if(r){const s=o[1].replace("!important","").trim();t?t[r]=s:t={[r]:s}}return t};try{return n.style.split(";").reduce(e,null)}catch{return null}}function f1e(n){const e=(t,i)=>(i=i.trim(),i&&(t?t[i]=!0:t={[i]:!0}),t);try{return n.class.split(" ").reduce(e,null)}catch{return null}}function h1e(n){return n=n.replace(/-(\w)/g,function(i,o){return o.toUpperCase()}),`${n.charAt(0).toLowerCase()}${n.substring(1)}`}const p1e=new RegExp("&[a-z0-9#]+;","gi");let Vh=null;function m1e(n){return Vh||(Vh=document.createElement("div")),n.replace(p1e,e=>Vh===null?"":(Vh.innerHTML=e,Vh.textContent===null?"":Vh.textContent))}function g1e(n,e){let t=n,i=null;const o=[],r=s=>{const a=s.firstChild;a!==null&&(i=s),t=a};for(e(t,i),r(t);;){for(;t;)o.push(t),e(t,i),r(t);const s=o.pop();if(t=s||null,!o.length)break;if(i=o[o.length-1],t){const a=t.nextSibling;a==null&&(i=o[o.length-1]),t=a}}}let p_=null;const PD=new Map;let p3=!1;function v1e(n,e){let t;switch(e!==null&&(t=PD.get(e)),n==null?void 0:n.nodeType){case 1:{if(t===void 0)return;t.children=t.children?t.children:[];const i=t.children,o=n.attributes,r={};for(let a=0;a<o.length;a++){const f=o.item(a);f&&(r[f.name]=f.value)}const s=(0,h3.h)(n.nodeName,u1e(r));i.push(s),PD.set(n,s);break}case 3:{const i=n.textContent;if(i!==null&&t!==void 0){t.children=t.children?t.children:[];const o=t.children,r=o.length>0?o[o.length-1]:null;!p3&&typeof r!="string"&&r!==null&&r.sel===void 0?r.text=r.text+i:o.push((0,h3.vnode)(void 0,void 0,void 0,i,void 0)),p3=!1}break}case 8:{p3=!0;break}case 9:{p_=(0,h3.vnode)(void 0,void 0,[],void 0,void 0),PD.set(n,p_);break}}}function _1e(n){const e=n==null?void 0:n.children;return typeof e>"u"?null:e.length===1&&typeof e[0]!="string"?e[0]:null}function y1e(n){var e,t;const i=new window.DOMParser;if(i===void 0||n===void 0||n==="")return null;const o=i.parseFromString(n,"application/xml");if(((e=o==null?void 0:o.firstChild)===null||e===void 0?void 0:e.nodeName)==="parsererror"){const r=`${(t=o==null?void 0:o.firstChild)===null||t===void 0?void 0:t.textContent}`;return(0,h3.h)("parsererror",[r])}return p3=!1,p_=null,g1e(o,v1e),p_===null?null:_1e(p_)}var oY=L7.default=y1e,Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.ForeignObjectElement=Mt.ForeignObjectElementImpl=Mt.ShapedPreRenderedElement=Mt.ShapedPreRenderedElementImpl=Mt.PreRenderedElement=Mt.PreRenderedElementImpl=Mt.HtmlRoot=Mt.HtmlRootImpl=Mt.RectangularPort=Mt.CircularPort=Mt.DiamondNode=Mt.RectangularNode=Mt.CircularNode=void 0;const m_=De,rY=ke,S8=$t,b1e=Hc,S1e=to,Z0=Sn,Q0=Ra;class E1e extends Z0.SNodeImpl{get anchorKind(){return Q0.ELLIPTIC_ANCHOR_KIND}}Mt.CircularNode=E1e;class C1e extends Z0.SNodeImpl{get anchorKind(){return Q0.RECTANGULAR_ANCHOR_KIND}}Mt.RectangularNode=C1e;class P1e extends Z0.SNodeImpl{get anchorKind(){return Q0.DIAMOND_ANCHOR_KIND}}Mt.DiamondNode=P1e;class w1e extends Z0.SPortImpl{get anchorKind(){return Q0.ELLIPTIC_ANCHOR_KIND}}Mt.CircularPort=w1e;class A1e extends Z0.SPortImpl{get anchorKind(){return Q0.RECTANGULAR_ANCHOR_KIND}}Mt.RectangularPort=A1e;class sY extends rY.SModelRootImpl{constructor(){super(...arguments),this.classes=[]}}Mt.HtmlRootImpl=sY;Mt.HtmlRoot=sY;class N7 extends rY.SChildElementImpl{}Mt.PreRenderedElementImpl=N7;Mt.PreRenderedElement=N7;class ZA extends N7{constructor(){super(...arguments),this.position=m_.Point.ORIGIN,this.size=m_.Dimension.EMPTY,this.selected=!1,this.alignment=m_.Point.ORIGIN}get bounds(){return{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}}set bounds(e){this.position={x:e.x,y:e.y},this.size={width:e.width,height:e.height}}}Mt.ShapedPreRenderedElementImpl=ZA;ZA.DEFAULT_FEATURES=[b1e.moveFeature,S8.boundsFeature,S1e.selectFeature,S8.alignFeature];Mt.ShapedPreRenderedElement=ZA;class aY extends ZA{get bounds(){return m_.Dimension.isValid(this.size)?{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}:(0,S8.isBoundsAware)(this.parent)?{x:this.position.x,y:this.position.y,width:this.parent.bounds.width,height:this.parent.bounds.height}:m_.Bounds.EMPTY}}Mt.ForeignObjectElementImpl=aY;Mt.ForeignObjectElement=aY;var cY=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},R1e=l&&l.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(gc,"__esModule",{value:!0});gc.ForeignObjectView=gc.PreRenderedView=void 0;const Fk=ei,dY=F,uY=R1e(L7),E8=ft,M1e=xc,I1e=Mt;let C8=class extends M1e.ShapeView{render(e,t){if(e instanceof I1e.ShapedPreRenderedElementImpl&&!this.isVisible(e,t))return;const i=(0,uY.default)(e.code);if(i!==null)return this.correctNamespace(i),i}correctNamespace(e){(e.sel==="svg"||e.sel==="g")&&(0,E8.setNamespace)(e,"http://www.w3.org/2000/svg")}};gc.PreRenderedView=C8;gc.PreRenderedView=C8=cY([(0,dY.injectable)()],C8);let P8=class{render(e,t){const i=(0,uY.default)(e.code);if(i===null)return;const o=(0,Fk.svg)("g",null,(0,Fk.svg)("foreignObject",{requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility",height:e.bounds.height,width:e.bounds.width,x:0,y:0},i),t.renderChildren(e));return(0,E8.setAttr)(o,"class",e.type),(0,E8.setNamespace)(i,e.namespace),o}};gc.ForeignObjectView=P8;gc.ForeignObjectView=P8=cY([(0,dY.injectable)()],P8);var bg={},D1e=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(bg,"__esModule",{value:!0});bg.HtmlRootView=void 0;const T1e=ei,O1e=F,L1e=ft;let w8=class{render(e,t){const i=(0,T1e.html)("div",null,t.renderChildren(e));for(const o of e.classes)(0,L1e.setClass)(i,o,!0);return i}};bg.HtmlRootView=w8;bg.HtmlRootView=w8=D1e([(0,O1e.injectable)()],w8);var ru={},lY={exports:{}};(function(n,e){(function(t,i){i()})(l,function(){function t(h,g){return typeof g>"u"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function i(h,g,y){var S=new XMLHttpRequest;S.open("GET",h),S.responseType="blob",S.onload=function(){f(S.response,g,y)},S.onerror=function(){console.error("could not download file")},S.send()}function o(h){var g=new XMLHttpRequest;g.open("HEAD",h,!1);try{g.send()}catch{}return 200<=g.status&&299>=g.status}function r(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(g)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof l=="object"&&l.global===l?l:void 0,a=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),f=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(h,g,y){var S=s.URL||s.webkitURL,P=document.createElement("a");g=g||h.name||"download",P.download=g,P.rel="noopener",typeof h=="string"?(P.href=h,P.origin===location.origin?r(P):o(P.href)?i(h,g,y):r(P,P.target="_blank")):(P.href=S.createObjectURL(h),setTimeout(function(){S.revokeObjectURL(P.href)},4e4),setTimeout(function(){r(P)},0))}:"msSaveOrOpenBlob"in navigator?function(h,g,y){if(g=g||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(t(h,y),g);else if(o(h))i(h,g,y);else{var S=document.createElement("a");S.href=h,S.target="_blank",setTimeout(function(){r(S)})}}:function(h,g,y,S){if(S=S||open("","_blank"),S&&(S.document.title=S.document.body.innerText="downloading..."),typeof h=="string")return i(h,g,y);var P=h.type==="application/octet-stream",w=/constructor/i.test(s.HTMLElement)||s.safari,C=/CriOS\/[\d]+/.test(navigator.userAgent);if((C||P&&w||a)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var U=E.result;U=C?U:U.replace(/^data:[^;]*;/,"data:attachment/file;"),S?S.location.href=U:location=U,S=null},E.readAsDataURL(h)}else{var D=s.URL||s.webkitURL,j=D.createObjectURL(h);S?S.location=j:location.href=j,S=null,setTimeout(function(){D.revokeObjectURL(j)},4e4)}});s.saveAs=f.saveAs=f,n.exports=f})})(lY);var j7=lY.exports,B7=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},fY=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(ru,"__esModule",{value:!0});ru.DiagramServerProxy=ru.ServerStatusAction=void 0;const N1e=j7,$7=F,js=se,xk=ju,j1e=me,wD=hs,B1e=rr,Hk=Fu,A8=or;class Wp{constructor(){this.kind=Wp.KIND}}ru.ServerStatusAction=Wp;Wp.KIND="serverStatus";const Kk="__receivedFromServer";let dy=class extends A8.ModelSource{constructor(){super(...arguments),this.currentRoot={type:"NONE",id:"ROOT"}}get model(){return this.currentRoot}initialize(e){super.initialize(e),e.register(js.ComputedBoundsAction.KIND,this),e.register(wD.RequestBoundsCommand.KIND,this),e.register(js.RequestPopupModelAction.KIND,this),e.register(js.CollapseExpandAction.KIND,this),e.register(js.CollapseExpandAllAction.KIND,this),e.register(js.OpenAction.KIND,this),e.register(Wp.KIND,this),this.clientId||(this.clientId=this.viewerOptions.baseDiv)}handle(e){this.handleLocally(e)&&this.forwardToServer(e)}forwardToServer(e){const t={clientId:this.clientId,action:e};this.logger.log(this,"sending",t),this.sendMessage(t)}messageReceived(e){const t=typeof e=="string"?JSON.parse(e):e;(0,js.isActionMessage)(t)&&t.action?(!t.clientId||t.clientId===this.clientId)&&(t.action[Kk]=!0,this.logger.log(this,"receiving",t),this.actionDispatcher.dispatch(t.action).then(()=>{this.storeNewModel(t.action)})):this.logger.error(this,"received data is not an action message",t)}handleLocally(e){switch(this.storeNewModel(e),e.kind){case js.ComputedBoundsAction.KIND:return this.handleComputedBounds(e);case js.RequestModelAction.KIND:return this.handleRequestModel(e);case wD.RequestBoundsCommand.KIND:return!1;case B1e.ExportSvgAction.KIND:return this.handleExportSvgAction(e);case Wp.KIND:return this.handleServerStateAction(e)}return!e[Kk]}storeNewModel(e){if(e.kind===xk.SetModelCommand.KIND||e.kind===Hk.UpdateModelCommand.KIND||e.kind===wD.RequestBoundsCommand.KIND){const t=e.newRoot;t&&(this.currentRoot=t,(e.kind===xk.SetModelCommand.KIND||e.kind===Hk.UpdateModelCommand.KIND)&&(this.lastSubmittedModelType=t.type))}}handleRequestModel(e){const t=Object.assign({needsClientLayout:this.viewerOptions.needsClientLayout,needsServerLayout:this.viewerOptions.needsServerLayout},e.options),i=Object.assign(Object.assign({},e),{options:t});return this.forwardToServer(i),!1}handleComputedBounds(e){if(this.viewerOptions.needsServerLayout)return!0;{const t=this.currentRoot;return this.computedBoundsApplicator.apply(t,e),t.type===this.lastSubmittedModelType?this.actionDispatcher.dispatch(js.UpdateModelAction.create(t)):this.actionDispatcher.dispatch(js.SetModelAction.create(t)),this.lastSubmittedModelType=t.type,!1}}handleExportSvgAction(e){const t=new Blob([e.svg],{type:"text/plain;charset=utf-8"});return(0,N1e.saveAs)(t,"diagram.svg"),!1}handleServerStateAction(e){return!1}commitModel(e){const t=this.currentRoot;return this.currentRoot=e,t}};ru.DiagramServerProxy=dy;B7([(0,$7.inject)(j1e.TYPES.ILogger),fY("design:type",Object)],dy.prototype,"logger",void 0);B7([(0,$7.inject)(A8.ComputedBoundsApplicator),fY("design:type",A8.ComputedBoundsApplicator)],dy.prototype,"computedBoundsApplicator",void 0);ru.DiagramServerProxy=dy=B7([(0,$7.injectable)()],dy);var X0={},J0=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},QA=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(X0,"__esModule",{value:!0});X0.LocalModelSource=void 0;const $1e=j7,Vl=F,qr=se,Vk=kr,zk=jn,k7=me,k1e=$n,F1e=rr,x1e=ss,R8=or;let zl=class extends R8.ModelSource{constructor(){super(...arguments),this.currentRoot=k1e.EMPTY_ROOT}get model(){return this.currentRoot}set model(e){this.setModel(e)}initialize(e){super.initialize(e),e.register(qr.ComputedBoundsAction.KIND,this),e.register(qr.RequestPopupModelAction.KIND,this)}setModel(e){return this.currentRoot=e,this.submitModel(e,!1)}commitModel(e){const t=this.currentRoot;return this.currentRoot=e,t}updateModel(e){return e===void 0?this.submitModel(this.currentRoot,!0):(this.currentRoot=e,this.submitModel(e,!0))}async getSelection(){const e=await this.actionDispatcher.request(Vk.GetSelectionAction.create()),t=[];return this.gatherSelectedElements(this.currentRoot,new Set(e.selectedElementsIDs),t),t}gatherSelectedElements(e,t,i){if(t.has(e.id)&&i.push(e),e.children)for(const o of e.children)this.gatherSelectedElements(o,t,i)}async getViewport(){const e=await this.actionDispatcher.request(Vk.GetViewportAction.create());return{scroll:e.viewport.scroll,zoom:e.viewport.zoom,canvasBounds:e.canvasBounds}}async submitModel(e,t,i){if(this.viewerOptions.needsClientLayout){const o=await this.actionDispatcher.request(qr.RequestBoundsAction.create(e)),r=this.computedBoundsApplicator.apply(this.currentRoot,o);await this.doSubmitModel(e,!0,i,r)}else await this.doSubmitModel(e,t,i)}async doSubmitModel(e,t,i,o){if(this.layoutEngine!==void 0)try{const s=this.layoutEngine.layout(e,o);s instanceof Promise?e=await s:s!==void 0&&(e=s)}catch(s){this.logger.error(this,s.toString(),s.stack)}const r=this.lastSubmittedModelType;if(this.lastSubmittedModelType=e.type,i&&i.kind===qr.RequestModelAction.KIND&&i.requestId){const s=i;await this.actionDispatcher.dispatch(qr.SetModelAction.create(e,s.requestId))}else if(t&&e.type===r){const s=Array.isArray(t)?t:e;await this.actionDispatcher.dispatch(qr.UpdateModelAction.create(s,{animate:!0,cause:i}))}else await this.actionDispatcher.dispatch(qr.SetModelAction.create(e))}applyMatches(e){const t=this.currentRoot;return(0,x1e.applyMatches)(t,e),this.submitModel(t,e)}addElements(e){const t=[];for(const i of e){const o=i;typeof o.element=="object"&&typeof o.parentId=="string"?t.push({right:o.element,rightParentId:o.parentId}):typeof o.id=="string"&&t.push({right:o,rightParentId:this.currentRoot.id})}return this.applyMatches(t)}removeElements(e){const t=[],i=new zk.SModelIndex;i.add(this.currentRoot);for(const o of e){const r=o;if(r.elementId!==void 0&&r.parentId!==void 0){const s=i.getById(r.elementId);s!==void 0&&t.push({left:s,leftParentId:r.parentId})}else{const s=i.getById(r);s!==void 0&&t.push({left:s,leftParentId:this.currentRoot.id})}}return this.applyMatches(t)}handle(e){switch(e.kind){case qr.RequestModelAction.KIND:this.handleRequestModel(e);break;case qr.ComputedBoundsAction.KIND:this.computedBoundsApplicator.apply(this.currentRoot,e);break;case qr.RequestPopupModelAction.KIND:this.handleRequestPopupModel(e);break;case F1e.ExportSvgAction.KIND:this.handleExportSvgAction(e);break}}handleRequestModel(e){this.submitModel(this.currentRoot,!1,e)}handleRequestPopupModel(e){if(this.popupModelProvider!==void 0){const t=(0,zk.findElement)(this.currentRoot,e.elementId),i=this.popupModelProvider.getPopupModel(e,t);i!==void 0&&(i.canvasBounds=e.bounds,this.actionDispatcher.dispatch(qr.SetPopupModelAction.create(i,e.requestId)))}}handleExportSvgAction(e){const t=new Blob([e.svg],{type:"text/plain;charset=utf-8"});(0,$1e.saveAs)(t,"diagram.svg")}};X0.LocalModelSource=zl;J0([(0,Vl.inject)(k7.TYPES.ILogger),QA("design:type",Object)],zl.prototype,"logger",void 0);J0([(0,Vl.inject)(R8.ComputedBoundsApplicator),QA("design:type",R8.ComputedBoundsApplicator)],zl.prototype,"computedBoundsApplicator",void 0);J0([(0,Vl.inject)(k7.TYPES.IPopupModelProvider),(0,Vl.optional)(),QA("design:type",Object)],zl.prototype,"popupModelProvider",void 0);J0([(0,Vl.inject)(k7.TYPES.IModelLayoutEngine),(0,Vl.optional)(),QA("design:type",Object)],zl.prototype,"layoutEngine",void 0);X0.LocalModelSource=zl=J0([(0,Vl.injectable)()],zl);var Sg={},F7=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},hY=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Sg,"__esModule",{value:!0});Sg.ForwardingLogger=void 0;const x7=F,H1e=se,fd=Wo,pY=me;let uy=class{error(e,t,...i){this.logLevel>=fd.LogLevel.error&&this.forward(e,t,fd.LogLevel.error,i)}warn(e,t,...i){this.logLevel>=fd.LogLevel.warn&&this.forward(e,t,fd.LogLevel.warn,i)}info(e,t,...i){this.logLevel>=fd.LogLevel.info&&this.forward(e,t,fd.LogLevel.info,i)}log(e,t,...i){if(this.logLevel>=fd.LogLevel.log)try{const o=typeof e=="object"?e.constructor.name:String(e);console.log.apply(e,[o+": "+t,...i])}catch{}}forward(e,t,i,o){const r=new Date,s=H1e.LoggingAction.create({message:t,severity:fd.LogLevel[i],time:r.toLocaleTimeString(),caller:typeof e=="object"?e.constructor.name:String(e),params:o.map(a=>JSON.stringify(a))});this.modelSourceProvider().then(a=>{try{a.handle(s)}catch(f){try{console.log.apply(e,[t,s,f])}catch{}}})}};Sg.ForwardingLogger=uy;F7([(0,x7.inject)(pY.TYPES.ModelSourceProvider),hY("design:type",Function)],uy.prototype,"modelSourceProvider",void 0);F7([(0,x7.inject)(pY.TYPES.LogLevel),hY("design:type",Number)],uy.prototype,"logLevel",void 0);Sg.ForwardingLogger=uy=F7([(0,x7.injectable)()],uy);var eb={},K1e=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(eb,"__esModule",{value:!0});eb.WebSocketDiagramServerProxy=void 0;const V1e=F,z1e=ru;let M8=class extends z1e.DiagramServerProxy{listen(e){e.addEventListener("message",t=>{this.messageReceived(t.data)}),e.addEventListener("error",t=>{this.logger.error(this,"error event received",t)}),this.webSocket=e}disconnect(){this.webSocket&&(this.webSocket.close(),this.webSocket=void 0)}sendMessage(e){if(this.webSocket)this.webSocket.send(JSON.stringify(e));else throw new Error("WebSocket is not connected")}};eb.WebSocketDiagramServerProxy=M8;eb.WebSocketDiagramServerProxy=M8=K1e([(0,V1e.injectable)()],M8);var oc={};Object.defineProperty(oc,"__esModule",{value:!0});oc.ColorMap=oc.toSVG=oc.rgb=void 0;function G1e(n,e,t){return{red:n,green:e,blue:t}}oc.rgb=G1e;function U1e(n){return"rgb("+n.red+","+n.green+","+n.blue+")"}oc.toSVG=U1e;class Y1e{constructor(e){this.stops=e}getColor(e){e=Math.max(0,Math.min(.99999999,e));const t=Math.floor(e*this.stops.length);return this.stops[t]}}oc.ColorMap=Y1e;(function(n){var e=l&&l.__createBinding||(Object.create?function(T,$,Q,K){K===void 0&&(K=Q);var Z=Object.getOwnPropertyDescriptor($,Q);(!Z||("get"in Z?!$.__esModule:Z.writable||Z.configurable))&&(Z={enumerable:!0,get:function(){return $[Q]}}),Object.defineProperty(T,K,Z)}:function(T,$,Q,K){K===void 0&&(K=Q),T[K]=$[Q]}),t=l&&l.__exportStar||function(T,$){for(var Q in T)Q!=="default"&&!Object.prototype.hasOwnProperty.call($,Q)&&e($,T,Q)},i=l&&l.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(n,"__esModule",{value:!0}),n.modelSourceModule=n.zorderModule=n.viewportModule=n.updateModule=n.undoRedoModule=n.selectModule=n.routingModule=n.openModule=n.moveModule=n.hoverModule=n.fadeModule=n.exportModule=n.expandModule=n.edgeLayoutModule=n.edgeJunctionModule=n.edgeIntersectionModule=n.decorationModule=n.contextMenuModule=n.commandPaletteModule=n.buttonModule=n.boundsModule=n.defaultModule=void 0,t(Jd,n),t(Nu,n),t(qo,n),t(Pf,n),t(Pa,n),t(Or,n),t(rg,n),t(Ve,n),t(wn,n),t(aA,n),t(wf,n),t(Eo,n),t(ju,n),t($n,n),t(yt,n),t(ke,n),t(Co,n),t(sa,n),t(gi,n),t(Ut,n),t(dc,n),t(rn,n),t(Mf,n),t(fA,n),t(Qn,n),t(If,n),t(ft,n),t(me,n);const o=i(_0);n.defaultModule=o.default,t(hs,n),t(mA,n),t(Yi,n),t($t,n),t(Df,n),t(Tf,n),t(ug,n),t(xc,n),t(ps,n),t(lg,n),t(ms,n),t(uc,n),t(bA,n),t(gs,n),t(Nf,n),t(Kl,n),t(jf,n),t(Bf,n),t(R0,n),t(s7,n),t(ea,n),t(Lf,n),t(_n,n),t(aa,n),t(_s,n),t($f,n),t(xf,n),t(Hf,n),t(O0,n),t(pg,n),t(qi,n),t(P0,n),t(rr,n),t(da,n),t(Of,n),t(fn,n),t($u,n),t(B0,n),t(Kf,n),t(Vf,n),t(Zn,n),t(Ln,n),t(zf,n),t(Hc,n),t(Xn,n),t(mg,n),t(vA,n),t(gg,n),t(MA,n),t(Uo,n),t(vg,n),t(Ra,n),t(Qo,n),t(Xo,n),t(Wi,n),t(Jo,n),t(Gf,n),t(an,n),t(Po,n),t(Kc,n),t(vi,n),t(Uf,n),t(to,n),t(fi,n),t(k0,n),t(ss,n),t(Fu,n),t(Oi,n),t(Rs,n),t(mc,n),t(kf,n),t(wo,n),t(fc,n),t(Yf,n);const r=i(BA);n.boundsModule=r.default;const s=i(F0);n.buttonModule=s.default;const a=i($A);n.commandPaletteModule=a.default;const f=i(kA);n.contextMenuModule=f.default;const h=i(FA);n.decorationModule=h.default;const g=i(xA);n.edgeIntersectionModule=g.default;const y=i(HA);n.edgeJunctionModule=y.default;const S=i(Kl);n.edgeLayoutModule=S.default;const P=i(H0);n.expandModule=P.default;const w=i(KA);n.exportModule=w.default;const C=i(K0);n.fadeModule=C.default;const E=i(VA);n.hoverModule=E.default;const D=i(V0);n.moveModule=D.default;const j=i(z0);n.openModule=j.default;const U=i(zA);n.routingModule=U.default;const p=i(GA);n.selectModule=p.default;const b=i(UA);n.undoRedoModule=b.default;const v=i(G0);n.updateModule=v.default;const R=i(YA);n.viewportModule=R.default;const O=i(U0);n.zorderModule=O.default,t(Sn,n),t(gt,n),t(q0,n),t(gc,n),t(bg,n),t(ei,n),t(Mt,n),t(zn,n),t(vs,n),t(ru,n),t(X0,n),t(Sg,n),t(or,n),t(eb,n);const N=i(W0);n.modelSourceModule=N.default,t(sn,n),t(_A,n),t(oc,n),t(Jn,n),t(wa,n),t(Wo,n),t(pn,n)})(tA);var mY=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Xd,"__esModule",{value:!0});Xd.MouseListener=Xd.KeyListener=void 0;const gY=F,vY=tA;let I8=class extends vY.KeyListener{keyDown(e,t){return[]}keyUp(e,t){return[]}};Xd.KeyListener=I8;Xd.KeyListener=I8=mY([(0,gY.injectable)()],I8);let D8=class extends vY.MouseListener{mouseOver(e,t){return[]}mouseOut(e,t){return[]}mouseEnter(e,t){return[]}mouseLeave(e,t){return[]}mouseDown(e,t){return[]}mouseMove(e,t){return[]}mouseUp(e,t){return[]}wheel(e,t){return[]}doubleClick(e,t){return[]}contextMenu(e,t){return[]}dragOver(e,t){return[]}drop(e,t){return[]}decorate(e,t){return e}};Xd.MouseListener=D8;Xd.MouseListener=D8=mY([(0,gY.injectable)()],D8);var jt={},H7={},Zp={},lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.arrayOf=lt.partition=lt.isArrayMatching=lt.isStringArray=lt.isArrayOfPrimitive=lt.isArrayOfClass=lt.isArrayOfType=lt.distinctAdd=lt.asArray=lt.flatPush=lt.remove=lt.pluck=lt.last=lt.first=void 0;function q1e(n,e){return e?n.filter((t,i)=>i<e):n[0]}lt.first=q1e;function W1e(n,e){return e?n.filter((t,i)=>n.length-i<=e):n[n.length-1]}lt.last=W1e;function Z1e(n,e){return n.map(t=>t[e])}lt.pluck=Z1e;function Q1e(n,...e){e.forEach(t=>{const i=n.indexOf(t);i>=0&&n.splice(i,1)})}lt.remove=Q1e;function X1e(n,e){e.forEach(t=>Array.isArray(t)?n.push(...t):n.push(t))}lt.flatPush=X1e;function J1e(n){return Array.isArray(n)?n:[n]}lt.asArray=J1e;function eve(n,...e){e.forEach(t=>{n.includes(t)||n.push(t)})}lt.distinctAdd=eve;function tve(n,e,t=!1){return XA(n,i=>e(i),t)}lt.isArrayOfType=tve;function nve(n,e,t=!1){return XA(n,i=>i instanceof e,t)}lt.isArrayOfClass=nve;function _Y(n,e,t=!1){return XA(n,i=>typeof i===e,t)}lt.isArrayOfPrimitive=_Y;function ive(n,e=!1){return _Y(n,"string",e)}lt.isStringArray=ive;function XA(n,e,t=!1){return Array.isArray(n)&&n.every(e)&&(t||n.length>0)}lt.isArrayMatching=XA;function ove(n,e){const t=[],i=[];return n.forEach(o=>{e(o)?t.push(o):i.push(o)}),{match:t,rest:i}}lt.partition=ove;function rve(...n){return n.filter(e=>e!==void 0)}lt.arrayOf=rve;var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.hasArrayProp=Oe.hasFunctionProp=Oe.hasObjectProp=Oe.hasNumberProp=Oe.hasBooleanProp=Oe.hasStringProp=Oe.call=Oe.toTypeGuard=Oe.typeGuardOr=Oe.typeGuard=Oe.AnyObject=void 0;var T8;(function(n){function e(t){return t!==null&&typeof t=="object"}n.is=e})(T8||(Oe.AnyObject=T8={}));function sve(n,e){return t=>n(t)&&e(t)}Oe.typeGuard=sve;function ave(n,e){return t=>n(t)||e(t)}Oe.typeGuardOr=ave;function cve(n){return e=>e instanceof n}Oe.toTypeGuard=cve;function dve(n,...e){return typeof n=="function"?n(...e):n}Oe.call=dve;function uve(n,e,t=!1){const i=n[e];return i!==void 0?typeof i=="string":t}Oe.hasStringProp=uve;function lve(n,e,t=!1){const i=n[e];return i!==void 0?typeof i=="boolean":t}Oe.hasBooleanProp=lve;function fve(n,e,t=!1){const i=n[e];return i!==void 0?typeof i=="number":t}Oe.hasNumberProp=fve;function hve(n,e,t=!1){const i=n[e];return i!==void 0?T8.is(i):t}Oe.hasObjectProp=hve;function pve(n,e,t=!1){const i=n[e];return i!==void 0?typeof i=="function":t}Oe.hasFunctionProp=pve;function mve(n,e,t=!1){const i=n[e];return i!==void 0?Array.isArray(i):t}Oe.hasArrayProp=mve;var tb={};Object.defineProperty(tb,"__esModule",{value:!0});tb.FeatureModule=void 0;const gve=F,vve=lt;class JA extends gve.ContainerModule{constructor(e,t={}){var i;super((o,r,s,...a)=>{this.configure(o,s)&&(e(o,r,s,...a),this.debugLog(`Loading of feature module with id '${this.featureId.toString()}' completed`))}),this.featureId=(i=t.featureId)!==null&&i!==void 0?i:this.createFeatureId(),this.requires=t.requires}createFeatureId(){return Symbol(this.id)}configure(e,t){if(this.debugLog(`Trying to load feature module with id '${this.featureId.toString()}'`),this.isLoaded({isBound:t})){const i=`Could not load feature module. Another module with id '${this.featureId.toString()}' is already loaded`;throw this.debugLog(i),new Error(i)}return this.checkRequirements(t)?(this.debugLog(`Requirements are met, continue loading of feature module with id '${this.featureId.toString()}'`),e(this.featureId).toConstantValue(this.featureId),!0):!1}debugLog(e,...t){JA.DEBUG_LOG_ENABLED&&console.log(e,...t)}checkRequirements(e){var t;const i=(0,vve.asArray)((t=this.requires)!==null&&t!==void 0?t:[]);if(i.length===0)return!0;const o=i.filter(r=>!r.isLoaded({isBound:e}));return o.length>0?(this.debugLog(`Could not load feature module. Required modules are not loaded. Feature ids: ${o.map(r=>r.featureId.toString()).join(", ")}`),!1):!0}isLoaded(e){return e.isBound(this.featureId)}}tb.FeatureModule=JA;JA.DEBUG_LOG_ENABLED=!1;Object.defineProperty(Zp,"__esModule",{value:!0});Zp.resolveContainerConfiguration=Zp.initializeContainer=void 0;const tl=lt,Gk=Oe,Uk=tb;function _ve(n,...e){const t=yY(...e);return n.load(...t),n}Zp.initializeContainer=_ve;function yY(...n){const e=[];n.forEach(o=>{yve(o)?(0,tl.distinctAdd)(e,o):(o.remove&&(0,tl.remove)(e,...(0,tl.asArray)(o.remove)),o.add&&(0,tl.distinctAdd)(e,...(0,tl.asArray)(o.add)),o.replace&&(0,tl.asArray)(o.replace).forEach(r=>{const s=e.findIndex(a=>a instanceof Uk.FeatureModule&&a.featureId===r.featureId);s>=0?e[s]=r:(console.warn(`Could not find module to replace with feature id ${r.featureId.toString()}.Adding replacement module to the end of the resolved configurations.`),(0,tl.distinctAdd)(e,r))}))});const t=new Set,i=[];if(e.forEach(o=>{o instanceof Uk.FeatureModule&&(t.has(o.featureId)?i.push(o):t.add(o.featureId))}),i.length>0){const o=i.map(r=>r.featureId.toString()).join(", ");throw new Error(`Could not resolve container configuration. Non-unique feature ids found in container configuration: ${o}`)}return e}Zp.resolveContainerConfiguration=yY;function yve(n){return(0,Gk.hasNumberProp)(n,"id")&&(0,Gk.hasFunctionProp)(n,"registry")}var Fd={};Object.defineProperty(Fd,"__esModule",{value:!0});Fd.bindAsService=Fd.lazyBind=Fd.bindOrRebind=void 0;function bve(n,e){return n.isBound(e)?n.rebind(e):n.bind(e)}Fd.bindOrRebind=bve;function Sve(n,e){if(!n.isBound(e))return n.bind(e)}Fd.lazyBind=Sve;function Eve(n,e,t){const i=typeof n=="object"?n.bind.bind(n):n;i(t).toSelf().inSingletonScope(),i(e).toService(t)}Fd.bindAsService=Eve;var bY={},Ee={};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.STACK_OVERFLOW=Ee.CIRCULAR_DEPENDENCY_IN_FACTORY=Ee.ON_DEACTIVATION_ERROR=Ee.PRE_DESTROY_ERROR=Ee.POST_CONSTRUCT_ERROR=Ee.ASYNC_UNBIND_REQUIRED=Ee.MULTIPLE_POST_CONSTRUCT_METHODS=Ee.MULTIPLE_PRE_DESTROY_METHODS=Ee.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Ee.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Ee.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Ee.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Ee.ARGUMENTS_LENGTH_MISMATCH=Ee.INVALID_DECORATOR_OPERATION=Ee.INVALID_TO_SELF_VALUE=Ee.LAZY_IN_SYNC=Ee.INVALID_FUNCTION_BINDING=Ee.INVALID_MIDDLEWARE_RETURN=Ee.NO_MORE_SNAPSHOTS_AVAILABLE=Ee.INVALID_BINDING_TYPE=Ee.NOT_IMPLEMENTED=Ee.CIRCULAR_DEPENDENCY=Ee.UNDEFINED_INJECT_ANNOTATION=Ee.MISSING_INJECT_ANNOTATION=Ee.MISSING_INJECTABLE_ANNOTATION=Ee.NOT_REGISTERED=Ee.CANNOT_UNBIND=Ee.AMBIGUOUS_MATCH=Ee.KEY_NOT_FOUND=Ee.NULL_ARGUMENT=Ee.DUPLICATED_METADATA=Ee.DUPLICATED_INJECTABLE_DECORATOR=void 0;Ee.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.";Ee.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:";Ee.NULL_ARGUMENT="NULL argument";Ee.KEY_NOT_FOUND="Key Not Found";Ee.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:";Ee.CANNOT_UNBIND="Could not unbind serviceIdentifier:";Ee.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";Ee.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:";Ee.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var Cve=function(n){return"@inject called with undefined this could mean that the class "+n+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation."};Ee.UNDEFINED_INJECT_ANNOTATION=Cve;Ee.CIRCULAR_DEPENDENCY="Circular dependency found:";Ee.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.";Ee.INVALID_BINDING_TYPE="Invalid binding type:";Ee.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.";Ee.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!";Ee.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";var Pve=function(n){return"You are attempting to construct '"+n+`' in a synchronous way
 but it has asynchronous dependencies.`};Ee.LAZY_IN_SYNC=Pve;Ee.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier";Ee.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var wve=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return"The number of constructor arguments in the derived class "+(n[0]+" must be >= than the number of constructor arguments of its base class.")};Ee.ARGUMENTS_LENGTH_MISMATCH=wve;Ee.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.";Ee.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE='Invalid Container option. Default scope must be a string ("singleton" or "transient").';Ee.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean";Ee.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean";Ee.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class";Ee.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";Ee.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";var Ave=function(n,e){return"@postConstruct error in class "+n+": "+e};Ee.POST_CONSTRUCT_ERROR=Ave;var Rve=function(n,e){return"@preDestroy error in class "+n+": "+e};Ee.PRE_DESTROY_ERROR=Rve;var Mve=function(n,e){return"onDeactivation() error in class "+n+": "+e};Ee.ON_DEACTIVATION_ERROR=Mve;var Ive=function(n,e){return"It looks like there is a circular dependency in one of the '"+n+"' bindings. Please investigate bindings with "+("service identifier '"+e+"'.")};Ee.CIRCULAR_DEPENDENCY_IN_FACTORY=Ive;Ee.STACK_OVERFLOW="Maximum call stack size exceeded";(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.bindLazyInjector=n.DefaultLazyInjector=n.LazyInjector=void 0;const e=F,t=Ee;n.LazyInjector=Symbol("LazyInjector");class i{constructor(s){this.container=s,this.cache=new Map}get(s){const a=this.getOptional(s);if(a===void 0)throw new Error(t.NOT_REGISTERED+(0,e.getServiceIdentifierAsString)(s));return a}getOptional(s){if(this.cache.has(s))return this.cache.get(s);const a=this.container.isBound(s)?this.container.get(s):void 0;return this.cache.set(s,a),a}getAll(s){if(this.cache.has(s))return this.cache.get(s);const a=this.container.isBound(s)?this.container.getAll(s):[];return this.cache.set(s,a),a}}n.DefaultLazyInjector=i;function o(r){(typeof r=="object"?r.bind.bind(r):r)(n.LazyInjector).toDynamicValue(a=>new i(a.container))}n.bindLazyInjector=o})(bY);(function(n){var e=l&&l.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=l&&l.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(Zp,n),t(tb,n),t(Fd,n),t(bY,n)})(H7);Object.defineProperty(jt,"__esModule",{value:!0});jt.sprottyDefaultModule=jt.edgeJunctionModule=jt.zorderModule=jt.updateModule=jt.openModule=jt.moveModule=jt.modelSourceModule=jt.fadeModule=jt.expandModule=jt.edgeLayoutModule=jt.edgeIntersectionModule=jt.edgeEditModule=jt.buttonModule=void 0;const Fr=H7,Dve=_0;jt.sprottyDefaultModule=Dve.default;const Tve=F0,Ove=xA,Lve=HA,Nve=Kl,jve=ea,Bve=H0,$ve=K0,kve=V0,Fve=z0,xve=G0,Hve=U0,Kve=W0;jt.buttonModule=new Fr.FeatureModule(Tve.default.registry,{featureId:Symbol("button")});jt.edgeEditModule=new Fr.FeatureModule(jve.edgeEditModule.registry,{featureId:Symbol("edgeEdit")});jt.edgeIntersectionModule=new Fr.FeatureModule(Ove.default.registry,{featureId:Symbol("edgeIntersection")});jt.edgeLayoutModule=new Fr.FeatureModule(Nve.default.registry,{featureId:Symbol("edgeLayout")});jt.expandModule=new Fr.FeatureModule(Bve.default.registry,{featureId:Symbol("expand")});jt.fadeModule=new Fr.FeatureModule($ve.default.registry,{featureId:Symbol("fade")});jt.modelSourceModule=new Fr.FeatureModule(Kve.default.registry,{featureId:Symbol("modelSource")});jt.moveModule=new Fr.FeatureModule(kve.default.registry,{featureId:Symbol("move")});jt.openModule=new Fr.FeatureModule(Fve.default.registry,{featureId:Symbol("open")});jt.updateModule=new Fr.FeatureModule(xve.default.registry,{featureId:Symbol("update")});jt.zorderModule=new Fr.FeatureModule(Hve.default.registry,{featureId:Symbol("zorder")});jt.edgeJunctionModule=new Fr.FeatureModule(Lve.default.registry,{featureId:Symbol("edgeJunction")});var SY={},ct={},at={};Object.defineProperty(at,"__esModule",{value:!0});at.CompoundOperation=at.Operation=at.RejectAction=at.ResponseAction=at.RequestAction=at.ActionMessage=at.Action=void 0;const Vve=se,su=Oe;var Gl;(function(n){function e(i){return su.AnyObject.is(i)&&(0,su.hasStringProp)(i,"kind")}n.is=e;function t(i,o){return n.is(i)&&i.kind===o}n.hasKind=t})(Gl||(at.Action=Gl={}));var Yk;(function(n){function e(t,i){const o=i??Gl.is;return su.AnyObject.is(t)&&(0,su.hasStringProp)(t,"clientId")&&"action"in t&&o(t.action)}n.is=e})(Yk||(at.ActionMessage=Yk={}));var qk;(function(n){function e(o){return Gl.is(o)&&(0,su.hasStringProp)(o,"requestId")}n.is=e;function t(o,r){return n.is(o)&&o.kind===r}n.hasKind=t;function i(){return Vve.generateRequestId()}n.generateRequestId=i})(qk||(at.RequestAction=qk={}));var Wk;(function(n){function e(i){return Gl.is(i)&&(0,su.hasStringProp)(i,"responseId")}n.is=e;function t(i){return n.is(i)&&i.responseId!==""}n.hasValidResponseId=t})(Wk||(at.ResponseAction=Wk={}));var Zk;(function(n){n.KIND="rejectRequest";function e(i){return Gl.hasKind(i,n.KIND)&&(0,su.hasStringProp)(i,"message")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",message:i,...o}}n.create=t})(Zk||(at.RejectAction=Zk={}));var O8;(function(n){function e(i){return Gl.is(i)&&"isOperation"in i&&i.isOperation===!0}n.is=e;function t(i,o){return n.is(i)&&i.kind===o}n.hasKind=t})(O8||(at.Operation=O8={}));var Qk;(function(n){n.KIND="compound";function e(i){return O8.hasKind(i,n.KIND)&&(0,su.hasArrayProp)(i,"operationList")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,operationList:i,...o}}n.create=t})(Qk||(at.CompoundOperation=Qk={}));var Sr={};Object.defineProperty(Sr,"__esModule",{value:!0});Sr.EndProgressAction=Sr.UpdateProgressAction=Sr.StartProgressAction=Sr.MessageAction=Sr.StatusAction=void 0;const au=Oe,nb=at;var Xk;(function(n){n.KIND="status";function e(i){return nb.Action.hasKind(i,n.KIND)&&(0,au.hasStringProp)(i,"severity")&&(0,au.hasStringProp)(i,"message")}n.is=e;function t(i,o={}){return{kind:n.KIND,severity:"INFO",message:i,...o}}n.create=t})(Xk||(Sr.StatusAction=Xk={}));var Jk;(function(n){n.KIND="message";function e(i){return nb.Action.hasKind(i,n.KIND)&&(0,au.hasStringProp)(i,"message")&&(0,au.hasStringProp)(i,"severity")}n.is=e;function t(i,o={}){return{kind:n.KIND,message:i,severity:"INFO",...o}}n.create=t})(Jk||(Sr.MessageAction=Jk={}));var eF;(function(n){n.KIND="startProgress";function e(i){return nb.Action.hasKind(i,n.KIND)&&(0,au.hasStringProp)(i,"progressId")&&(0,au.hasStringProp)(i,"title")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(eF||(Sr.StartProgressAction=eF={}));var tF;(function(n){n.KIND="updateProgress";function e(i){return nb.Action.hasKind(i,n.KIND)&&(0,au.hasStringProp)(i,"progressId")}n.is=e;function t(i,o={}){return{kind:n.KIND,progressId:i,...o}}n.create=t})(tF||(Sr.UpdateProgressAction=tF={}));var nF;(function(n){n.KIND="endProgress";function e(i){return nb.Action.hasKind(i,n.KIND)&&(0,au.hasStringProp)(i,"progressId")}n.is=e;function t(i,o){return{kind:n.KIND,progressId:i,message:o}}n.create=t})(nF||(Sr.EndProgressAction=nF={}));var zs={};Object.defineProperty(zs,"__esModule",{value:!0});zs.PasteOperation=zs.CutOperation=zs.SetClipboardDataAction=zs.RequestClipboardDataAction=void 0;const ly=Oe,eR=at;var iF;(function(n){n.KIND="requestClipboardData";function e(i){return eR.RequestAction.hasKind(i,n.KIND)&&(0,ly.hasObjectProp)(i,"editorContext")}n.is=e;function t(i,o={}){return{kind:n.KIND,requestId:"",editorContext:i,...o}}n.create=t})(iF||(zs.RequestClipboardDataAction=iF={}));var oF;(function(n){n.KIND="setClipboardData";function e(i){return eR.Action.hasKind(i,n.KIND)&&(0,ly.hasObjectProp)(i,"clipboardData")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",clipboardData:i,...o}}n.create=t})(oF||(zs.SetClipboardDataAction=oF={}));var rF;(function(n){n.KIND="cut";function e(i){return eR.Operation.hasKind(i,n.KIND)&&(0,ly.hasObjectProp)(i,"editorContext")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,editorContext:i,...o}}n.create=t})(rF||(zs.CutOperation=rF={}));var sF;(function(n){n.KIND="paste";function e(i){return eR.Operation.hasKind(i,n.KIND)&&(0,ly.hasObjectProp)(i,"clipboardData")&&(0,ly.hasObjectProp)(i,"editorContext")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(sF||(zs.PasteOperation=sF={}));var Qp={};Object.defineProperty(Qp,"__esModule",{value:!0});Qp.SetContextActions=Qp.RequestContextActions=void 0;const L8=Oe,EY=at;var aF;(function(n){n.KIND="requestContextActions";function e(i){return EY.RequestAction.hasKind(i,n.KIND)&&(0,L8.hasStringProp)(i,"contextId")&&(0,L8.hasObjectProp)(i,"editorContext")}n.is=e;function t(i){return{kind:n.KIND,requestId:"",...i}}n.create=t})(aF||(Qp.RequestContextActions=aF={}));var cF;(function(n){n.KIND="setContextActions";function e(i){return EY.Action.hasKind(i,n.KIND)&&(0,L8.hasArrayProp)(i,"actions")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",actions:i,...o}}n.create=t})(cF||(Qp.SetContextActions=cF={}));var Xp={};Object.defineProperty(Xp,"__esModule",{value:!0});Xp.ChangeRoutingPointsOperation=Xp.ReconnectEdgeOperation=void 0;const m3=Oe,CY=at;var dF;(function(n){n.KIND="reconnectEdge";function e(i){return CY.Operation.hasKind(i,n.KIND)&&(0,m3.hasStringProp)(i,"edgeElementId")&&(0,m3.hasStringProp)(i,"sourceElementId")&&(0,m3.hasStringProp)(i,"targetElementId")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(dF||(Xp.ReconnectEdgeOperation=dF={}));var uF;(function(n){n.KIND="changeRoutingPoints";function e(i){return CY.Operation.hasKind(i,n.KIND)&&(0,m3.hasArrayProp)(i,"newRoutingPoints")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,newRoutingPoints:i,...o}}n.create=t})(uF||(Xp.ChangeRoutingPointsOperation=uF={}));var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.DeleteElementOperation=Gs.CreateEdgeOperation=Gs.CreateNodeOperation=Gs.CreateOperation=void 0;const YC=Oe,PY=at;var qC;(function(n){function e(i){return PY.Operation.is(i)&&(0,YC.hasStringProp)(i,"elementTypeId")}n.is=e;function t(i,o){return n.is(i)&&i.kind===o}n.hasKind=t})(qC||(Gs.CreateOperation=qC={}));var lF;(function(n){n.KIND="createNode";function e(i){return qC.hasKind(i,n.KIND)}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,elementTypeId:i,...o}}n.create=t})(lF||(Gs.CreateNodeOperation=lF={}));var fF;(function(n){n.KIND="createEdge";function e(i){return qC.hasKind(i,n.KIND)&&(0,YC.hasStringProp)(i,"sourceElementId")&&(0,YC.hasStringProp)(i,"targetElementId")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(fF||(Gs.CreateEdgeOperation=fF={}));var hF;(function(n){n.KIND="deleteElement";function e(i){return PY.Operation.hasKind(i,n.KIND)&&(0,YC.hasArrayProp)(i,"elementIds")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,elementIds:i,...o}}n.create=t})(hF||(Gs.DeleteElementOperation=hF={}));var Jp={};Object.defineProperty(Jp,"__esModule",{value:!0});Jp.SetPopupModelAction=Jp.RequestPopupModelAction=void 0;const N8=Oe,wY=at;var pF;(function(n){n.KIND="requestPopupModel";function e(i){return wY.RequestAction.hasKind(i,n.KIND)&&(0,N8.hasStringProp)(i,"elementId")&&(0,N8.hasObjectProp)(i,"bounds")}n.is=e;function t(i){return{kind:n.KIND,requestId:"",...i}}n.create=t})(pF||(Jp.RequestPopupModelAction=pF={}));var mF;(function(n){n.KIND="setPopupModel";function e(i){return wY.Action.hasKind(i,n.KIND)&&(0,N8.hasObjectProp)(i,"newRoot")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",newRoot:i,...o}}n.create=t})(mF||(Jp.SetPopupModelAction=mF={}));var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0});Ii.NavigateToExternalTargetAction=Ii.SetResolvedNavigationTargetAction=Ii.ResolveNavigationTargetAction=Ii.NavigateToTargetAction=Ii.SetNavigationTargetsAction=Ii.RequestNavigationTargetsAction=Ii.NavigationTarget=void 0;const vc=Oe,Eg=at;var gF;(function(n){function e(f){return vc.AnyObject.is(f)&&(0,vc.hasStringProp)(f,"uri")}n.is=e,n.ELEMENT_IDS="elementIds",n.ELEMENT_IDS_SEPARATOR="&",n.TEXT_LINE="line",n.TEXT_COLUMN="column";function t(f){return f.args!==void 0&&Object.keys(f.args).length>0}n.hasArguments=t;function i(f,h,g){f.args||(f.args={}),f.args[h]=g}n.addArgument=i;function o(f){var h;return!((h=f==null?void 0:f.args)===null||h===void 0)&&h[n.ELEMENT_IDS]?f.args[n.ELEMENT_IDS].toString().split(n.ELEMENT_IDS_SEPARATOR):[]}n.getElementIds=o;function r(f,...h){return f.args===void 0&&(f.args={}),f.args[n.ELEMENT_IDS]=h.join(n.ELEMENT_IDS_SEPARATOR)}n.setElementIds=r;function s(f,h){h&&(f.args===void 0&&(f.args={}),f.args[n.TEXT_LINE]=h.line,f.args[n.TEXT_COLUMN]=h.character)}n.setTextPosition=s;function a(f){if(!(!f.args||!f.args[n.TEXT_LINE]||!f.args[n.TEXT_COLUMN]))return{line:Number(f.args[n.TEXT_LINE]),character:Number(f.args[n.TEXT_COLUMN])}}n.getTextPosition=a})(gF||(Ii.NavigationTarget=gF={}));var vF;(function(n){n.KIND="requestNavigationTargets";function e(i){return Eg.RequestAction.hasKind(i,n.KIND)&&(0,vc.hasStringProp)(i,"targetTypeId")&&(0,vc.hasObjectProp)(i,"editorContext")}n.is=e;function t(i){return{kind:n.KIND,requestId:"",...i}}n.create=t})(vF||(Ii.RequestNavigationTargetsAction=vF={}));var _F;(function(n){n.KIND="setNavigationTargets";function e(i){return Eg.Action.hasKind(i,n.KIND)&&(0,vc.hasArrayProp)(i,"targets")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",targets:i,...o}}n.create=t})(_F||(Ii.SetNavigationTargetsAction=_F={}));var yF;(function(n){n.KIND="navigateToTarget";function e(i){return Eg.Action.hasKind(i,n.KIND)&&(0,vc.hasObjectProp)(i,"target")}n.is=e;function t(i){return{kind:n.KIND,target:i}}n.create=t})(yF||(Ii.NavigateToTargetAction=yF={}));var bF;(function(n){n.KIND="resolveNavigationTarget";function e(i){return Eg.RequestAction.hasKind(i,n.KIND)&&(0,vc.hasObjectProp)(i,"navigationTarget")}n.is=e;function t(i,o={}){return{kind:n.KIND,requestId:"",navigationTarget:i,...o}}n.create=t})(bF||(Ii.ResolveNavigationTargetAction=bF={}));var SF;(function(n){n.KIND="setResolvedNavigationTarget";function e(i){return Eg.Action.hasKind(i,n.KIND)&&(0,vc.hasArrayProp)(i,"elementIds")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",elementIds:i,...o}}n.create=t})(SF||(Ii.SetResolvedNavigationTargetAction=SF={}));var EF;(function(n){n.KIND="navigateToExternalTarget";function e(i){return Eg.Action.hasKind(i,n.KIND)&&(0,vc.hasObjectProp)(i,"target")}n.is=e;function t(i){return{kind:n.KIND,target:i}}n.create=t})(EF||(Ii.NavigateToExternalTargetAction=EF={}));var em={};Object.defineProperty(em,"__esModule",{value:!0});em.SelectAllAction=em.SelectAction=void 0;const zve=lt,j8=Oe,AY=at;var CF;(function(n){n.KIND="elementSelected";function e(s){return AY.Action.hasKind(s,n.KIND)&&(0,j8.hasArrayProp)(s,"selectedElementsIDs")&&(0,j8.hasArrayProp)(s,"deselectedElementsIDs")}n.is=e;function t(s={}){var a,f;const h=(a=s.deselectedElementsIDs)!==null&&a!==void 0?a:[];return{kind:n.KIND,selectedElementsIDs:(f=s.selectedElementsIDs)!==null&&f!==void 0?f:[],deselectedElementsIDs:(0,zve.isStringArray)(h,!0)?h:[],deselectAll:typeof h=="boolean"?h:!1}}n.create=t;function i(s){return t({selectedElementsIDs:s})}n.addSelection=i;function o(s){return t({deselectedElementsIDs:s})}n.removeSelection=o;function r(s){return t({selectedElementsIDs:s,deselectedElementsIDs:!0})}n.setSelection=r})(CF||(em.SelectAction=CF={}));var PF;(function(n){n.KIND="allSelected";function e(i){return AY.Action.hasKind(i,n.KIND)&&(0,j8.hasBooleanProp)(i,"select")}n.is=e;function t(i=!0){return{kind:n.KIND,select:i}}n.create=t})(PF||(em.SelectAllAction=PF={}));var Us={};Object.defineProperty(Us,"__esModule",{value:!0});Us.ValidationStatus=Us.ApplyLabelEditOperation=Us.SetEditValidationResultAction=Us.RequestEditValidationAction=void 0;const Pp=Oe,K7=at;var wF;(function(n){n.KIND="requestEditValidation";function e(i){return K7.RequestAction.hasKind(i,n.KIND)&&(0,Pp.hasStringProp)(i,"contextId")&&(0,Pp.hasStringProp)(i,"modelElementId")&&(0,Pp.hasStringProp)(i,"text")}n.is=e;function t(i){return{kind:n.KIND,requestId:"",...i}}n.create=t})(wF||(Us.RequestEditValidationAction=wF={}));var AF;(function(n){n.KIND="setEditValidationResult";function e(i){return K7.Action.hasKind(i,n.KIND)&&(0,Pp.hasObjectProp)(i,"status")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",status:i,...o}}n.create=t})(AF||(Us.SetEditValidationResultAction=AF={}));var RF;(function(n){n.KIND="applyLabelEdit";function e(i){return K7.Operation.hasKind(i,n.KIND)&&(0,Pp.hasStringProp)(i,"labelId")&&(0,Pp.hasStringProp)(i,"text")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(RF||(Us.ApplyLabelEditOperation=RF={}));var MF;(function(n){let e;(function(r){r[r.FATAL=0]="FATAL",r[r.ERROR=1]="ERROR",r[r.WARNING=2]="WARNING",r[r.INFO=3]="INFO",r[r.OK=4]="OK",r[r.NONE=5]="NONE"})(e=n.Severity||(n.Severity={})),n.NONE={severity:e.NONE,message:"",error:{code:-1,message:"",data:{}}};function t(r){return r.severity===e.OK||r.severity===e.INFO||r.severity===e.NONE}n.isOk=t;function i(r){return r.severity===e.WARNING}n.isWarning=i;function o(r){return r.severity===e.ERROR||r.severity===e.FATAL}n.isError=o})(MF||(Us.ValidationStatus=MF={}));var Ys={};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.CheckEdgeResultAction=Ys.RequestCheckEdgeAction=Ys.SetTypeHintsAction=Ys.RequestTypeHintsAction=void 0;const nc=Oe,tR=at;var IF;(function(n){n.KIND="requestTypeHints";function e(i){return tR.RequestAction.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,requestId:"",...i}}n.create=t})(IF||(Ys.RequestTypeHintsAction=IF={}));var DF;(function(n){n.KIND="setTypeHints";function e(i){return tR.Action.hasKind(i,n.KIND)&&(0,nc.hasArrayProp)(i,"shapeHints")&&(0,nc.hasArrayProp)(i,"edgeHints")}n.is=e;function t(i){return{kind:n.KIND,responseId:"",...i}}n.create=t})(DF||(Ys.SetTypeHintsAction=DF={}));var TF;(function(n){n.KIND="requestCheckEdge";function e(i){return tR.Action.hasKind(i,n.KIND)&&(0,nc.hasStringProp)(i,"edgeType")&&(0,nc.hasStringProp)(i,"sourceElementId")&&(0,nc.hasStringProp)(i,"targetElementId",!0)}n.is=e;function t(i){var o;return{kind:n.KIND,edgeType:i.edgeType,sourceElementId:OF(i.sourceElement),targetElementId:i.targetElement?OF(i.targetElement):void 0,requestId:(o=i.requestId)!==null&&o!==void 0?o:""}}n.create=t})(TF||(Ys.RequestCheckEdgeAction=TF={}));function OF(n){return typeof n=="string"?n:n.id}var LF;(function(n){n.KIND="checkEdgeTargetResult";function e(i){return tR.Action.hasKind(i,n.KIND)&&(0,nc.hasBooleanProp)(i,"isValid")&&(0,nc.hasStringProp)(i,"edgeType")&&(0,nc.hasStringProp)(i,"sourceElementId")&&(0,nc.hasStringProp)(i,"targetElementId",!0)}n.is=e;function t(i){return{kind:n.KIND,responseId:"",...i}}n.create=t})(LF||(Ys.CheckEdgeResultAction=LF={}));var Er={};Object.defineProperty(Er,"__esModule",{value:!0});Er.DeleteMarkersAction=Er.SetMarkersAction=Er.RequestMarkersAction=Er.MarkersReason=Er.MarkerKind=void 0;const V7=Oe,z7=at;var NF;(function(n){n.INFO="info",n.WARNING="warning",n.ERROR="error"})(NF||(Er.MarkerKind=NF={}));var WC;(function(n){n.BATCH="batch",n.LIVE="live"})(WC||(Er.MarkersReason=WC={}));var jF;(function(n){n.KIND="requestMarkers";function e(i){return z7.RequestAction.hasKind(i,n.KIND)&&(0,V7.hasArrayProp)(i,"elementsIDs")}n.is=e;function t(i,o={}){return{kind:n.KIND,requestId:"",elementsIDs:i,reason:WC.BATCH,...o}}n.create=t})(jF||(Er.RequestMarkersAction=jF={}));var BF;(function(n){n.KIND="setMarkers";function e(i){return z7.Action.hasKind(i,n.KIND)&&(0,V7.hasArrayProp)(i,"markers")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",markers:i,reason:WC.BATCH,...o}}n.create=t})(BF||(Er.SetMarkersAction=BF={}));var $F;(function(n){n.KIND="deleteMarkers";function e(i){return z7.Action.hasKind(i,n.KIND)&&(0,V7.hasArrayProp)(i,"markers")}n.is=e;function t(i){return{kind:n.KIND,markers:i}}n.create=t})($F||(Er.DeleteMarkersAction=$F={}));var qs={};Object.defineProperty(qs,"__esModule",{value:!0});qs.SourceModelChangedAction=qs.UpdateModelAction=qs.SetModelAction=qs.RequestModelAction=void 0;const G7=Oe,nR=at;var kF;(function(n){n.KIND="requestModel";function e(i){return nR.RequestAction.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,requestId:"",...i}}n.create=t})(kF||(qs.RequestModelAction=kF={}));var FF;(function(n){n.KIND="setModel";function e(i){return nR.Action.hasKind(i,n.KIND)&&(0,G7.hasObjectProp)(i,"newRoot")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",newRoot:i,...o}}n.create=t})(FF||(qs.SetModelAction=FF={}));var xF;(function(n){n.KIND="updateModel";function e(i){return nR.Action.hasKind(i,n.KIND)&&(0,G7.hasObjectProp)(i,"newRoot")}n.is=e;function t(i,o={}){return{kind:n.KIND,newRoot:i,animate:!0,...o}}n.create=t})(xF||(qs.UpdateModelAction=xF={}));var HF;(function(n){n.KIND="sourceModelChanged";function e(i){return nR.Action.hasKind(i,n.KIND)&&(0,G7.hasStringProp)(i,"sourceModelName")}n.is=e;function t(i){return{kind:n.KIND,sourceModelName:i}}n.create=t})(HF||(qs.SourceModelChangedAction=HF={}));var tm={};Object.defineProperty(tm,"__esModule",{value:!0});tm.EditMode=tm.SetEditModeAction=void 0;const Gve=Oe,Uve=at;var KF;(function(n){n.KIND="setEditMode";function e(i){return Uve.Action.hasKind(i,n.KIND)&&(0,Gve.hasStringProp)(i,"editMode")}n.is=e;function t(i){return{kind:n.KIND,editMode:i}}n.create=t})(KF||(tm.SetEditModeAction=KF={}));var VF;(function(n){n.READONLY="readonly",n.EDITABLE="editable"})(VF||(tm.EditMode=VF={}));var xd={};Object.defineProperty(xd,"__esModule",{value:!0});xd.LayoutOperation=xd.ComputedBoundsAction=xd.RequestBoundsAction=void 0;const U7=Oe,Y7=at;var zF;(function(n){n.KIND="requestBounds";function e(i){return Y7.RequestAction.hasKind(i,n.KIND)&&(0,U7.hasObjectProp)(i,"newRoot")}n.is=e;function t(i,o={}){return{kind:n.KIND,requestId:"",newRoot:i,...o}}n.create=t})(zF||(xd.RequestBoundsAction=zF={}));var GF;(function(n){n.KIND="computedBounds";function e(i){return Y7.Action.hasKind(i,n.KIND)&&(0,U7.hasArrayProp)(i,"bounds")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",bounds:i,...o}}n.create=t})(GF||(xd.ComputedBoundsAction=GF={}));var UF;(function(n){n.KIND="layout";function e(i){return Y7.Action.hasKind(i,n.KIND)&&(0,U7.hasArrayProp)(i,"elementIds")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,elementIds:i,...o}}n.create=t})(UF||(xd.LayoutOperation=UF={}));var Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.ExportSvgAction=Ws.RequestExportSvgAction=Ws.SetDirtyStateAction=Ws.SaveModelAction=void 0;const RY=Oe,iR=at;var YF;(function(n){n.KIND="saveModel";function e(i){return iR.Action.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,...i}}n.create=t})(YF||(Ws.SaveModelAction=YF={}));var qF;(function(n){n.KIND="setDirtyState";function e(i){return iR.Action.hasKind(i,n.KIND)&&(0,RY.hasBooleanProp)(i,"isDirty")}n.is=e;function t(i,o={}){return{kind:n.KIND,isDirty:i,...o}}n.create=t})(qF||(Ws.SetDirtyStateAction=qF={}));var WF;(function(n){n.KIND="requestExportSvg";function e(i){return iR.RequestAction.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,requestId:"",...i}}n.create=t})(WF||(Ws.RequestExportSvgAction=WF={}));var ZF;(function(n){n.KIND="exportSvg";function e(i){return iR.Action.hasKind(i,n.KIND)&&(0,RY.hasStringProp)(i,"svg")}n.is=e;function t(i,o={}){return{kind:n.KIND,svg:i,responseId:"",...o}}n.create=t})(ZF||(Ws.ExportSvgAction=ZF={}));var nm={};Object.defineProperty(nm,"__esModule",{value:!0});nm.ChangeContainerOperation=nm.ChangeBoundsOperation=void 0;const B8=Oe,MY=at;var QF;(function(n){n.KIND="changeBounds";function e(i){return MY.Operation.hasKind(i,n.KIND)&&(0,B8.hasArrayProp)(i,"newBounds")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,newBounds:i}}n.create=t})(QF||(nm.ChangeBoundsOperation=QF={}));var XF;(function(n){n.KIND="changeContainer";function e(i){return MY.Operation.hasKind(i,n.KIND)&&(0,B8.hasStringProp)(i,"elementId")&&(0,B8.hasStringProp)(i,"targetContainerId")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(XF||(nm.ChangeContainerOperation=XF={}));var Ul={};Object.defineProperty(Ul,"__esModule",{value:!0});Ul.TriggerEdgeCreationAction=Ul.TriggerNodeCreationAction=void 0;const IY=Oe,DY=at;var JF;(function(n){n.KIND="triggerNodeCreation";function e(i){return DY.Action.hasKind(i,n.KIND)&&(0,IY.hasStringProp)(i,"elementTypeId")}n.is=e;function t(i,o){return{kind:n.KIND,elementTypeId:i,...o}}n.create=t})(JF||(Ul.TriggerNodeCreationAction=JF={}));var ex;(function(n){n.KIND="triggerEdgeCreation";function e(i){return DY.Action.hasKind(i,n.KIND)&&(0,IY.hasStringProp)(i,"elementTypeId")}n.is=e;function t(i,o={}){return{kind:n.KIND,elementTypeId:i,...o}}n.create=t})(ex||(Ul.TriggerEdgeCreationAction=ex={}));var Zs={};Object.defineProperty(Zs,"__esModule",{value:!0});Zs.MenuItem=Zs.PaletteItem=Zs.LabeledAction=Zs.EditorContext=void 0;const Hd=Oe,tx=Ul;var nx;(function(n){function e(t){return Hd.AnyObject.is(t)&&(0,Hd.hasArrayProp)(t,"selectedElementIds")}n.is=e})(nx||(Zs.EditorContext=nx={}));var ZC;(function(n){function e(i){return Hd.AnyObject.is(i)&&(0,Hd.hasStringProp)(i,"label")&&(0,Hd.hasArrayProp)(i,"actions")}n.is=e;function t(i){return Array.isArray(i)?i:n.is(i)?i.actions:[i]}n.toActionArray=t})(ZC||(Zs.LabeledAction=ZC={}));var ix;(function(n){function e(o){return ZC.is(o)&&(0,Hd.hasStringProp)(o,"id")&&(0,Hd.hasStringProp)(o,"sortString")}n.is=e;function t(o){if(o){const r=o.actions.filter(s=>i(s)).map(s=>s);return r.length>0?r[0]:void 0}}n.getTriggerAction=t;function i(o){return tx.TriggerNodeCreationAction.is(o)||tx.TriggerEdgeCreationAction.is(o)}n.isTriggerElementCreationAction=i})(ix||(Zs.PaletteItem=ix={}));var ox;(function(n){function e(t){return ZC.is(t)&&(0,Hd.hasStringProp)(t,"id")}n.is=e})(ox||(Zs.MenuItem=ox={}));var im={};Object.defineProperty(im,"__esModule",{value:!0});im.RedoAction=im.UndoAction=void 0;const TY=at;var rx;(function(n){n.KIND="glspUndo";function e(i){return TY.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(rx||(im.UndoAction=rx={}));var sx;(function(n){n.KIND="glspRedo";function e(i){return TY.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(sx||(im.RedoAction=sx={}));var om={};Object.defineProperty(om,"__esModule",{value:!0});om.FitToScreenAction=om.CenterAction=void 0;const QC=Oe,OY=at;var ax;(function(n){n.KIND="center";function e(i){return OY.Action.hasKind(i,n.KIND)&&(0,QC.hasBooleanProp)(i,"animate")&&(0,QC.hasBooleanProp)(i,"retainZoom")}n.is=e;function t(i,o={}){return{kind:n.KIND,animate:!0,retainZoom:!1,elementIds:i,...o}}n.create=t})(ax||(om.CenterAction=ax={}));var cx;(function(n){n.KIND="fit";function e(i){return OY.Action.hasKind(i,n.KIND)&&(0,QC.hasArrayProp)(i,"elementIds")&&(0,QC.hasBooleanProp)(i,"animate")}n.is=e;function t(i,o={}){return{kind:n.KIND,animate:!0,elementIds:i,...o}}n.create=t})(cx||(om.FitToScreenAction=cx={}));var LY={},Cg={},q7={},XC={},Ie={},Nn={};Object.defineProperty(Nn,"__esModule",{value:!0});Nn.stringArray=Nn.array=Nn.func=Nn.error=Nn.number=Nn.string=Nn.boolean=void 0;function Yve(n){return n===!0||n===!1}Nn.boolean=Yve;function NY(n){return typeof n=="string"||n instanceof String}Nn.string=NY;function qve(n){return typeof n=="number"||n instanceof Number}Nn.number=qve;function Wve(n){return n instanceof Error}Nn.error=Wve;function Zve(n){return typeof n=="function"}Nn.func=Zve;function jY(n){return Array.isArray(n)}Nn.array=jY;function Qve(n){return jY(n)&&n.every(e=>NY(e))}Nn.stringArray=Qve;Object.defineProperty(Ie,"__esModule",{value:!0});Ie.Message=Ie.NotificationType9=Ie.NotificationType8=Ie.NotificationType7=Ie.NotificationType6=Ie.NotificationType5=Ie.NotificationType4=Ie.NotificationType3=Ie.NotificationType2=Ie.NotificationType1=Ie.NotificationType0=Ie.NotificationType=Ie.RequestType9=Ie.RequestType8=Ie.RequestType7=Ie.RequestType6=Ie.RequestType5=Ie.RequestType4=Ie.RequestType3=Ie.RequestType2=Ie.RequestType1=Ie.RequestType=Ie.RequestType0=Ie.AbstractMessageSignature=Ie.ParameterStructures=Ie.ResponseError=Ie.ErrorCodes=void 0;const gl=Nn;var $8;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})($8||(Ie.ErrorCodes=$8={}));class W7 extends Error{constructor(e,t,i){super(t),this.code=gl.number(e)?e:$8.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,W7.prototype)}toJson(){const e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}}Ie.ResponseError=W7;class Ni{constructor(e){this.kind=e}static is(e){return e===Ni.auto||e===Ni.byName||e===Ni.byPosition}toString(){return this.kind}}Ie.ParameterStructures=Ni;Ni.auto=new Ni("auto");Ni.byPosition=new Ni("byPosition");Ni.byName=new Ni("byName");class mn{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return Ni.auto}}Ie.AbstractMessageSignature=mn;class Xve extends mn{constructor(e){super(e,0)}}Ie.RequestType0=Xve;class Jve extends mn{constructor(e,t=Ni.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Ie.RequestType=Jve;class e_e extends mn{constructor(e,t=Ni.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Ie.RequestType1=e_e;class t_e extends mn{constructor(e){super(e,2)}}Ie.RequestType2=t_e;class n_e extends mn{constructor(e){super(e,3)}}Ie.RequestType3=n_e;class i_e extends mn{constructor(e){super(e,4)}}Ie.RequestType4=i_e;class o_e extends mn{constructor(e){super(e,5)}}Ie.RequestType5=o_e;class r_e extends mn{constructor(e){super(e,6)}}Ie.RequestType6=r_e;class s_e extends mn{constructor(e){super(e,7)}}Ie.RequestType7=s_e;class a_e extends mn{constructor(e){super(e,8)}}Ie.RequestType8=a_e;class c_e extends mn{constructor(e){super(e,9)}}Ie.RequestType9=c_e;class d_e extends mn{constructor(e,t=Ni.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Ie.NotificationType=d_e;class u_e extends mn{constructor(e){super(e,0)}}Ie.NotificationType0=u_e;class l_e extends mn{constructor(e,t=Ni.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Ie.NotificationType1=l_e;class f_e extends mn{constructor(e){super(e,2)}}Ie.NotificationType2=f_e;class h_e extends mn{constructor(e){super(e,3)}}Ie.NotificationType3=h_e;class p_e extends mn{constructor(e){super(e,4)}}Ie.NotificationType4=p_e;class m_e extends mn{constructor(e){super(e,5)}}Ie.NotificationType5=m_e;class g_e extends mn{constructor(e){super(e,6)}}Ie.NotificationType6=g_e;class v_e extends mn{constructor(e){super(e,7)}}Ie.NotificationType7=v_e;class __e extends mn{constructor(e){super(e,8)}}Ie.NotificationType8=__e;class y_e extends mn{constructor(e){super(e,9)}}Ie.NotificationType9=y_e;var dx;(function(n){function e(o){const r=o;return r&&gl.string(r.method)&&(gl.string(r.id)||gl.number(r.id))}n.isRequest=e;function t(o){const r=o;return r&&gl.string(r.method)&&o.id===void 0}n.isNotification=t;function i(o){const r=o;return r&&(r.result!==void 0||!!r.error)&&(gl.string(r.id)||gl.number(r.id)||r.id===null)}n.isResponse=i})(dx||(Ie.Message=dx={}));var rc={},ux;Object.defineProperty(rc,"__esModule",{value:!0});rc.LRUCache=rc.LinkedMap=rc.Touch=void 0;var Mi;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Mi||(rc.Touch=Mi={}));class BY{constructor(){this[ux]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Mi.None){const i=this._map.get(e);if(i)return t!==Mi.None&&this.touch(i,t),i.value}set(e,t,i=Mi.None){let o=this._map.get(e);if(o)o.value=t,i!==Mi.None&&this.touch(o,i);else{switch(o={key:e,value:t,next:void 0,previous:void 0},i){case Mi.None:this.addItemLast(o);break;case Mi.First:this.addItemFirst(o);break;case Mi.Last:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let o=this._head;for(;o;){if(t?e.bind(t)(o.value,o.key,this):e(o.value,o.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const o={value:t.key,done:!1};return t=t.next,o}else return{value:void 0,done:!0}}};return i}values(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const o={value:t.value,done:!1};return t=t.next,o}else return{value:void 0,done:!0}}};return i}entries(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const o={value:[t.key,t.value],done:!1};return t=t.next,o}else return{value:void 0,done:!0}}};return i}[(ux=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Mi.First&&t!==Mi.Last)){if(t===Mi.First){if(e===this._head)return;const i=e.next,o=e.previous;e===this._tail?(o.next=void 0,this._tail=o):(i.previous=o,o.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Mi.Last){if(e===this._tail)return;const i=e.next,o=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=o,o.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}rc.LinkedMap=BY;class b_e extends BY{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Mi.AsNew){return super.get(e,t)}peek(e){return super.get(e,Mi.None)}set(e,t){return super.set(e,t,Mi.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}rc.LRUCache=b_e;var oR={};Object.defineProperty(oR,"__esModule",{value:!0});oR.Disposable=void 0;var lx;(function(n){function e(t){return{dispose:t}}n.create=e})(lx||(oR.Disposable=lx={}));var la={},Vc={};Object.defineProperty(Vc,"__esModule",{value:!0});let k8;function F8(){if(k8===void 0)throw new Error("No runtime abstraction layer installed");return k8}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");k8=t}n.install=e})(F8||(F8={}));Vc.default=F8;Object.defineProperty(la,"__esModule",{value:!0});la.Emitter=la.Event=void 0;const S_e=Vc;var fx;(function(n){const e={dispose(){}};n.None=function(){return e}})(fx||(la.Event=fx={}));class E_e{add(e,t=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(i)&&i.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let i=!1;for(let o=0,r=this._callbacks.length;o<r;o++)if(this._callbacks[o]===e)if(this._contexts[o]===t){this._callbacks.splice(o,1),this._contexts.splice(o,1);return}else i=!0;if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],i=this._callbacks.slice(0),o=this._contexts.slice(0);for(let r=0,s=i.length;r<s;r++)try{t.push(i[r].apply(o[r],e))}catch(a){(0,S_e.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}let $Y=class kY{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,i)=>{this._callbacks||(this._callbacks=new E_e),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const o={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),o.dispose=kY._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(i)&&i.push(o),o}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};la.Emitter=$Y;$Y._noop=function(){};var cu={};Object.defineProperty(cu,"__esModule",{value:!0});cu.CancellationTokenSource=cu.CancellationToken=void 0;const C_e=Vc,P_e=Nn,x8=la;var JC;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:x8.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:x8.Event.None});function e(t){const i=t;return i&&(i===n.None||i===n.Cancelled||P_e.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}n.is=e})(JC||(cu.CancellationToken=JC={}));const w_e=Object.freeze(function(n,e){const t=(0,C_e.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}});class hx{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?w_e:(this._emitter||(this._emitter=new x8.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class A_e{get token(){return this._token||(this._token=new hx),this._token}cancel(){this._token?this._token.cancel():this._token=JC.Cancelled}dispose(){this._token?this._token instanceof hx&&this._token.dispose():this._token=JC.None}}cu.CancellationTokenSource=A_e;var rm={};Object.defineProperty(rm,"__esModule",{value:!0});rm.SharedArrayReceiverStrategy=rm.SharedArraySenderStrategy=void 0;const R_e=cu;var fy;(function(n){n.Continue=0,n.Cancelled=1})(fy||(fy={}));class M_e{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;const t=new SharedArrayBuffer(4),i=new Int32Array(t,0,1);i[0]=fy.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const i=this.buffers.get(t);if(i===void 0)return;const o=new Int32Array(i,0,1);Atomics.store(o,0,fy.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}}rm.SharedArraySenderStrategy=M_e;class I_e{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===fy.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class D_e{constructor(e){this.token=new I_e(e)}cancel(){}dispose(){}}class T_e{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return t===void 0?new R_e.CancellationTokenSource:new D_e(t)}}rm.SharedArrayReceiverStrategy=T_e;var Kd={},ib={};Object.defineProperty(ib,"__esModule",{value:!0});ib.Semaphore=void 0;const O_e=Vc;class L_e{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,i)=>{this._waiting.push({thunk:e,resolve:t,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,O_e.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then(i=>{this._active--,e.resolve(i),this.runNext()},i=>{this._active--,e.reject(i),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}ib.Semaphore=L_e;Object.defineProperty(Kd,"__esModule",{value:!0});Kd.ReadableStreamMessageReader=Kd.AbstractMessageReader=Kd.MessageReader=void 0;const H8=Vc,cp=Nn,AD=la,N_e=ib;var px;(function(n){function e(t){let i=t;return i&&cp.func(i.listen)&&cp.func(i.dispose)&&cp.func(i.onError)&&cp.func(i.onClose)&&cp.func(i.onPartialMessage)}n.is=e})(px||(Kd.MessageReader=px={}));class FY{constructor(){this.errorEmitter=new AD.Emitter,this.closeEmitter=new AD.Emitter,this.partialMessageEmitter=new AD.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${cp.string(e.message)?e.message:"unknown"}`)}}Kd.AbstractMessageReader=FY;var K8;(function(n){function e(t){let i,o;const r=new Map;let s;const a=new Map;if(t===void 0||typeof t=="string")i=t??"utf-8";else{if(i=t.charset??"utf-8",t.contentDecoder!==void 0&&(o=t.contentDecoder,r.set(o.name,o)),t.contentDecoders!==void 0)for(const f of t.contentDecoders)r.set(f.name,f);if(t.contentTypeDecoder!==void 0&&(s=t.contentTypeDecoder,a.set(s.name,s)),t.contentTypeDecoders!==void 0)for(const f of t.contentTypeDecoders)a.set(f.name,f)}return s===void 0&&(s=(0,H8.default)().applicationJson.decoder,a.set(s.name,s)),{charset:i,contentDecoder:o,contentDecoders:r,contentTypeDecoder:s,contentTypeDecoders:a}}n.fromOptions=e})(K8||(K8={}));class j_e extends FY{constructor(e,t){super(),this.readable=e,this.options=K8.fromOptions(t),this.buffer=(0,H8.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new N_e.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData(i=>{this.onData(i)});return this.readable.onError(i=>this.fireError(i)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){const i=this.buffer.tryReadHeaders(!0);if(!i)return;const o=i.get("content-length");if(!o){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(i))}`));return}const r=parseInt(o);if(isNaN(r)){this.fireError(new Error(`Content-Length value must be a number. Got ${o}`));return}this.nextMessageLength=r}const t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const i=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,o=await this.options.contentTypeDecoder.decode(i,this.options);this.callback(o)}).catch(i=>{this.fireError(i)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,H8.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}Kd.ReadableStreamMessageReader=j_e;var Vd={};Object.defineProperty(Vd,"__esModule",{value:!0});Vd.WriteableStreamMessageWriter=Vd.AbstractMessageWriter=Vd.MessageWriter=void 0;const mx=Vc,qv=Nn,B_e=ib,gx=la,$_e="Content-Length: ",vx=`\r
`;var _x;(function(n){function e(t){let i=t;return i&&qv.func(i.dispose)&&qv.func(i.onClose)&&qv.func(i.onError)&&qv.func(i.write)}n.is=e})(_x||(Vd.MessageWriter=_x={}));class xY{constructor(){this.errorEmitter=new gx.Emitter,this.closeEmitter=new gx.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,i){this.errorEmitter.fire([this.asError(e),t,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${qv.string(e.message)?e.message:"unknown"}`)}}Vd.AbstractMessageWriter=xY;var V8;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,mx.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,mx.default)().applicationJson.encoder}}n.fromOptions=e})(V8||(V8={}));class k_e extends xY{constructor(e,t){super(),this.writable=e,this.options=V8.fromOptions(t),this.errorCount=0,this.writeSemaphore=new B_e.Semaphore(1),this.writable.onError(i=>this.fireError(i)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(i=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(i):i).then(i=>{const o=[];return o.push($_e,i.byteLength.toString(),vx),o.push(vx),this.doWrite(e,o,i)},i=>{throw this.fireError(i),i}))}async doWrite(e,t,i){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(i)}catch(o){return this.handleError(o,e),Promise.reject(o)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}Vd.WriteableStreamMessageWriter=k_e;var rR={};Object.defineProperty(rR,"__esModule",{value:!0});rR.AbstractMessageBuffer=void 0;const F_e=13,x_e=10,H_e=`\r
`;class K_e{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,i=0,o=0,r=0;e:for(;i<this._chunks.length;){const h=this._chunks[i];for(o=0;o<h.length;){switch(h[o]){case F_e:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case x_e:switch(t){case 1:t=2;break;case 3:t=4,o++;break e;default:t=0}break;default:t=0}o++}r+=h.byteLength,i++}if(t!==4)return;const s=this._read(r+o),a=new Map,f=this.toString(s,"ascii").split(H_e);if(f.length<2)return a;for(let h=0;h<f.length-2;h++){const g=f[h],y=g.indexOf(":");if(y===-1)throw new Error(`Message header must separate key and value using ':'
${g}`);const S=g.substr(0,y),P=g.substr(y+1).trim();a.set(e?S.toLowerCase():S,P)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const r=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(r)}if(this._chunks[0].byteLength>e){const r=this._chunks[0],s=this.asNative(r,e);return this._chunks[0]=r.slice(e),this._totalLength-=e,s}const t=this.allocNative(e);let i=0,o=0;for(;e>0;){const r=this._chunks[o];if(r.byteLength>e){const s=r.slice(0,e);t.set(s,i),i+=e,this._chunks[o]=r.slice(e),this._totalLength-=e,e-=e}else t.set(r,i),i+=r.byteLength,this._chunks.shift(),this._totalLength-=r.byteLength,e-=r.byteLength}return t}}rR.AbstractMessageBuffer=K_e;var HY={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.ConnectionOptions=n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.RequestCancellationReceiverStrategy=n.IdCancellationReceiverStrategy=n.ConnectionStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=n.NullLogger=n.ProgressType=n.ProgressToken=void 0;const e=Vc,t=Nn,i=Ie,o=rc,r=la,s=cu;var a;(function(K){K.type=new i.NotificationType("$/cancelRequest")})(a||(a={}));var f;(function(K){function Z(H){return typeof H=="string"||typeof H=="number"}K.is=Z})(f||(n.ProgressToken=f={}));var h;(function(K){K.type=new i.NotificationType("$/progress")})(h||(h={}));class g{constructor(){}}n.ProgressType=g;var y;(function(K){function Z(H){return t.func(H)}K.is=Z})(y||(y={})),n.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var S;(function(K){K[K.Off=0]="Off",K[K.Messages=1]="Messages",K[K.Compact=2]="Compact",K[K.Verbose=3]="Verbose"})(S||(n.Trace=S={}));var P;(function(K){K.Off="off",K.Messages="messages",K.Compact="compact",K.Verbose="verbose"})(P||(n.TraceValues=P={})),function(K){function Z(M){if(!t.string(M))return K.Off;switch(M=M.toLowerCase(),M){case"off":return K.Off;case"messages":return K.Messages;case"compact":return K.Compact;case"verbose":return K.Verbose;default:return K.Off}}K.fromString=Z;function H(M){switch(M){case K.Off:return"off";case K.Messages:return"messages";case K.Compact:return"compact";case K.Verbose:return"verbose";default:return"off"}}K.toString=H}(S||(n.Trace=S={}));var w;(function(K){K.Text="text",K.JSON="json"})(w||(n.TraceFormat=w={})),function(K){function Z(H){return t.string(H)?(H=H.toLowerCase(),H==="json"?K.JSON:K.Text):K.Text}K.fromString=Z}(w||(n.TraceFormat=w={}));var C;(function(K){K.type=new i.NotificationType("$/setTrace")})(C||(n.SetTraceNotification=C={}));var E;(function(K){K.type=new i.NotificationType("$/logTrace")})(E||(n.LogTraceNotification=E={}));var D;(function(K){K[K.Closed=1]="Closed",K[K.Disposed=2]="Disposed",K[K.AlreadyListening=3]="AlreadyListening"})(D||(n.ConnectionErrors=D={}));class j extends Error{constructor(Z,H){super(H),this.code=Z,Object.setPrototypeOf(this,j.prototype)}}n.ConnectionError=j;var U;(function(K){function Z(H){const M=H;return M&&t.func(M.cancelUndispatched)}K.is=Z})(U||(n.ConnectionStrategy=U={}));var p;(function(K){function Z(H){const M=H;return M&&(M.kind===void 0||M.kind==="id")&&t.func(M.createCancellationTokenSource)&&(M.dispose===void 0||t.func(M.dispose))}K.is=Z})(p||(n.IdCancellationReceiverStrategy=p={}));var b;(function(K){function Z(H){const M=H;return M&&M.kind==="request"&&t.func(M.createCancellationTokenSource)&&(M.dispose===void 0||t.func(M.dispose))}K.is=Z})(b||(n.RequestCancellationReceiverStrategy=b={}));var v;(function(K){K.Message=Object.freeze({createCancellationTokenSource(H){return new s.CancellationTokenSource}});function Z(H){return p.is(H)||b.is(H)}K.is=Z})(v||(n.CancellationReceiverStrategy=v={}));var R;(function(K){K.Message=Object.freeze({sendCancellation(H,M){return H.sendNotification(a.type,{id:M})},cleanup(H){}});function Z(H){const M=H;return M&&t.func(M.sendCancellation)&&t.func(M.cleanup)}K.is=Z})(R||(n.CancellationSenderStrategy=R={}));var O;(function(K){K.Message=Object.freeze({receiver:v.Message,sender:R.Message});function Z(H){const M=H;return M&&v.is(M.receiver)&&R.is(M.sender)}K.is=Z})(O||(n.CancellationStrategy=O={}));var N;(function(K){function Z(H){const M=H;return M&&t.func(M.handleMessage)}K.is=Z})(N||(n.MessageStrategy=N={}));var T;(function(K){function Z(H){const M=H;return M&&(O.is(M.cancellationStrategy)||U.is(M.connectionStrategy)||N.is(M.messageStrategy))}K.is=Z})(T||(n.ConnectionOptions=T={}));var $;(function(K){K[K.New=1]="New",K[K.Listening=2]="Listening",K[K.Closed=3]="Closed",K[K.Disposed=4]="Disposed"})($||($={}));function Q(K,Z,H,M){const Y=H!==void 0?H:n.NullLogger;let te=0,ue=0,Re=0;const ae="2.0";let ot;const Ft=new Map;let et;const ht=new Map,wt=new Map;let Ot,vt=new o.LinkedMap,At=new Map,yi=new Set,Wt=new Map,Ze=S.Off,ii=w.Text,he,Ne=$.New;const en=new r.Emitter,xt=new r.Emitter,Rn=new r.Emitter,gn=new r.Emitter,oi=new r.Emitter,_t=M&&M.cancellationStrategy?M.cancellationStrategy:O.Message;function Zt(V){if(V===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+V.toString()}function bi(V){return V===null?"res-unknown-"+(++Re).toString():"res-"+V.toString()}function X(){return"not-"+(++ue).toString()}function ne(V,oe){i.Message.isRequest(oe)?V.set(Zt(oe.id),oe):i.Message.isResponse(oe)?V.set(bi(oe.id),oe):V.set(X(),oe)}function fe(V){}function ge(){return Ne===$.Listening}function Pe(){return Ne===$.Closed}function Qt(){return Ne===$.Disposed}function Fe(){(Ne===$.New||Ne===$.Listening)&&(Ne=$.Closed,xt.fire(void 0))}function xe(V){en.fire([V,void 0,void 0])}function Te(V){en.fire(V)}K.onClose(Fe),K.onError(xe),Z.onClose(Fe),Z.onError(Te);function Qe(){Ot||vt.size===0||(Ot=(0,e.default)().timer.setImmediate(()=>{Ot=void 0,io()}))}function Xe(V){i.Message.isRequest(V)?K1(V):i.Message.isNotification(V)?IM(V):i.Message.isResponse(V)?MM(V):DM(V)}function io(){if(vt.size===0)return;const V=vt.shift();try{const oe=M==null?void 0:M.messageStrategy;N.is(oe)?oe.handleMessage(V,Xe):Xe(V)}finally{Qe()}}const Xc=V=>{try{if(i.Message.isNotification(V)&&V.method===a.type.method){const oe=V.params.id,pe=Zt(oe),Ce=vt.get(pe);if(i.Message.isRequest(Ce)){const Dt=M==null?void 0:M.connectionStrategy,Nt=Dt&&Dt.cancelUndispatched?Dt.cancelUndispatched(Ce,fe):void 0;if(Nt&&(Nt.error!==void 0||Nt.result!==void 0)){vt.delete(pe),Wt.delete(oe),Nt.id=Ce.id,gh(Nt,V.method,Date.now()),Z.write(Nt).catch(()=>Y.error("Sending response for canceled message failed."));return}}const Lt=Wt.get(oe);if(Lt!==void 0){Lt.cancel(),V1(V);return}else yi.add(oe)}ne(vt,V)}finally{Qe()}};function K1(V){if(Qt())return;function oe(dt,Xt,bt){const tn={jsonrpc:ae,id:V.id};dt instanceof i.ResponseError?tn.error=dt.toJson():tn.result=dt===void 0?null:dt,gh(tn,Xt,bt),Z.write(tn).catch(()=>Y.error("Sending response failed."))}function pe(dt,Xt,bt){const tn={jsonrpc:ae,id:V.id,error:dt.toJson()};gh(tn,Xt,bt),Z.write(tn).catch(()=>Y.error("Sending response failed."))}function Ce(dt,Xt,bt){dt===void 0&&(dt=null);const tn={jsonrpc:ae,id:V.id,result:dt};gh(tn,Xt,bt),Z.write(tn).catch(()=>Y.error("Sending response failed."))}OM(V);const Lt=Ft.get(V.method);let Dt,Nt;Lt&&(Dt=Lt.type,Nt=Lt.handler);const cn=Date.now();if(Nt||ot){const dt=V.id??String(Date.now()),Xt=p.is(_t.receiver)?_t.receiver.createCancellationTokenSource(dt):_t.receiver.createCancellationTokenSource(V);V.id!==null&&yi.has(V.id)&&Xt.cancel(),V.id!==null&&Wt.set(dt,Xt);try{let bt;if(Nt)if(V.params===void 0){if(Dt!==void 0&&Dt.numberOfParams!==0){pe(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${V.method} defines ${Dt.numberOfParams} params but received none.`),V.method,cn);return}bt=Nt(Xt.token)}else if(Array.isArray(V.params)){if(Dt!==void 0&&Dt.parameterStructures===i.ParameterStructures.byName){pe(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${V.method} defines parameters by name but received parameters by position`),V.method,cn);return}bt=Nt(...V.params,Xt.token)}else{if(Dt!==void 0&&Dt.parameterStructures===i.ParameterStructures.byPosition){pe(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${V.method} defines parameters by position but received parameters by name`),V.method,cn);return}bt=Nt(V.params,Xt.token)}else ot&&(bt=ot(V.method,V.params,Xt.token));const tn=bt;bt?tn.then?tn.then(ri=>{Wt.delete(dt),oe(ri,V.method,cn)},ri=>{Wt.delete(dt),ri instanceof i.ResponseError?pe(ri,V.method,cn):ri&&t.string(ri.message)?pe(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${V.method} failed with message: ${ri.message}`),V.method,cn):pe(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${V.method} failed unexpectedly without providing any details.`),V.method,cn)}):(Wt.delete(dt),oe(bt,V.method,cn)):(Wt.delete(dt),Ce(bt,V.method,cn))}catch(bt){Wt.delete(dt),bt instanceof i.ResponseError?oe(bt,V.method,cn):bt&&t.string(bt.message)?pe(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${V.method} failed with message: ${bt.message}`),V.method,cn):pe(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${V.method} failed unexpectedly without providing any details.`),V.method,cn)}}else pe(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${V.method}`),V.method,cn)}function MM(V){if(!Qt())if(V.id===null)V.error?Y.error(`Received response message without id: Error is: 
${JSON.stringify(V.error,void 0,4)}`):Y.error("Received response message without id. No further error information provided.");else{const oe=V.id,pe=At.get(oe);if(_S(V,pe),pe!==void 0){At.delete(oe);try{if(V.error){const Ce=V.error;pe.reject(new i.ResponseError(Ce.code,Ce.message,Ce.data))}else if(V.result!==void 0)pe.resolve(V.result);else throw new Error("Should never happen.")}catch(Ce){Ce.message?Y.error(`Response handler '${pe.method}' failed with message: ${Ce.message}`):Y.error(`Response handler '${pe.method}' failed unexpectedly.`)}}}}function IM(V){if(Qt())return;let oe,pe;if(V.method===a.type.method){const Ce=V.params.id;yi.delete(Ce),V1(V);return}else{const Ce=ht.get(V.method);Ce&&(pe=Ce.handler,oe=Ce.type)}if(pe||et)try{if(V1(V),pe)if(V.params===void 0)oe!==void 0&&oe.numberOfParams!==0&&oe.parameterStructures!==i.ParameterStructures.byName&&Y.error(`Notification ${V.method} defines ${oe.numberOfParams} params but received none.`),pe();else if(Array.isArray(V.params)){const Ce=V.params;V.method===h.type.method&&Ce.length===2&&f.is(Ce[0])?pe({token:Ce[0],value:Ce[1]}):(oe!==void 0&&(oe.parameterStructures===i.ParameterStructures.byName&&Y.error(`Notification ${V.method} defines parameters by name but received parameters by position`),oe.numberOfParams!==V.params.length&&Y.error(`Notification ${V.method} defines ${oe.numberOfParams} params but received ${Ce.length} arguments`)),pe(...Ce))}else oe!==void 0&&oe.parameterStructures===i.ParameterStructures.byPosition&&Y.error(`Notification ${V.method} defines parameters by position but received parameters by name`),pe(V.params);else et&&et(V.method,V.params)}catch(Ce){Ce.message?Y.error(`Notification handler '${V.method}' failed with message: ${Ce.message}`):Y.error(`Notification handler '${V.method}' failed unexpectedly.`)}else Rn.fire(V)}function DM(V){if(!V){Y.error("Received empty message.");return}Y.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(V,null,4)}`);const oe=V;if(t.string(oe.id)||t.number(oe.id)){const pe=oe.id,Ce=At.get(pe);Ce&&Ce.reject(new Error("The received response has neither a result nor an error property."))}}function Kr(V){if(V!=null)switch(Ze){case S.Verbose:return JSON.stringify(V,null,4);case S.Compact:return JSON.stringify(V);default:return}}function vS(V){if(!(Ze===S.Off||!he))if(ii===w.Text){let oe;(Ze===S.Verbose||Ze===S.Compact)&&V.params&&(oe=`Params: ${Kr(V.params)}

`),he.log(`Sending request '${V.method} - (${V.id})'.`,oe)}else Jc("send-request",V)}function TM(V){if(!(Ze===S.Off||!he))if(ii===w.Text){let oe;(Ze===S.Verbose||Ze===S.Compact)&&(V.params?oe=`Params: ${Kr(V.params)}

`:oe=`No parameters provided.

`),he.log(`Sending notification '${V.method}'.`,oe)}else Jc("send-notification",V)}function gh(V,oe,pe){if(!(Ze===S.Off||!he))if(ii===w.Text){let Ce;(Ze===S.Verbose||Ze===S.Compact)&&(V.error&&V.error.data?Ce=`Error data: ${Kr(V.error.data)}

`:V.result?Ce=`Result: ${Kr(V.result)}

`:V.error===void 0&&(Ce=`No result returned.

`)),he.log(`Sending response '${oe} - (${V.id})'. Processing request took ${Date.now()-pe}ms`,Ce)}else Jc("send-response",V)}function OM(V){if(!(Ze===S.Off||!he))if(ii===w.Text){let oe;(Ze===S.Verbose||Ze===S.Compact)&&V.params&&(oe=`Params: ${Kr(V.params)}

`),he.log(`Received request '${V.method} - (${V.id})'.`,oe)}else Jc("receive-request",V)}function V1(V){if(!(Ze===S.Off||!he||V.method===E.type.method))if(ii===w.Text){let oe;(Ze===S.Verbose||Ze===S.Compact)&&(V.params?oe=`Params: ${Kr(V.params)}

`:oe=`No parameters provided.

`),he.log(`Received notification '${V.method}'.`,oe)}else Jc("receive-notification",V)}function _S(V,oe){if(!(Ze===S.Off||!he))if(ii===w.Text){let pe;if((Ze===S.Verbose||Ze===S.Compact)&&(V.error&&V.error.data?pe=`Error data: ${Kr(V.error.data)}

`:V.result?pe=`Result: ${Kr(V.result)}

`:V.error===void 0&&(pe=`No result returned.

`)),oe){const Ce=V.error?` Request failed: ${V.error.message} (${V.error.code}).`:"";he.log(`Received response '${oe.method} - (${V.id})' in ${Date.now()-oe.timerStart}ms.${Ce}`,pe)}else he.log(`Received response ${V.id} without active response promise.`,pe)}else Jc("receive-response",V)}function Jc(V,oe){if(!he||Ze===S.Off)return;const pe={isLSPMessage:!0,type:V,message:oe,timestamp:Date.now()};he.log(pe)}function Vu(){if(Pe())throw new j(D.Closed,"Connection is closed.");if(Qt())throw new j(D.Disposed,"Connection is disposed.")}function LM(){if(ge())throw new j(D.AlreadyListening,"Connection is already listening")}function z1(){if(!ge())throw new Error("Call listen() first.")}function zu(V){return V===void 0?null:V}function vh(V){if(V!==null)return V}function yS(V){return V!=null&&!Array.isArray(V)&&typeof V=="object"}function G1(V,oe){switch(V){case i.ParameterStructures.auto:return yS(oe)?vh(oe):[zu(oe)];case i.ParameterStructures.byName:if(!yS(oe))throw new Error("Received parameters by name but param is not an object literal.");return vh(oe);case i.ParameterStructures.byPosition:return[zu(oe)];default:throw new Error(`Unknown parameter structure ${V.toString()}`)}}function bS(V,oe){let pe;const Ce=V.numberOfParams;switch(Ce){case 0:pe=void 0;break;case 1:pe=G1(V.parameterStructures,oe[0]);break;default:pe=[];for(let Lt=0;Lt<oe.length&&Lt<Ce;Lt++)pe.push(zu(oe[Lt]));if(oe.length<Ce)for(let Lt=oe.length;Lt<Ce;Lt++)pe.push(null);break}return pe}const ed={sendNotification:(V,...oe)=>{Vu();let pe,Ce;if(t.string(V)){pe=V;const Dt=oe[0];let Nt=0,cn=i.ParameterStructures.auto;i.ParameterStructures.is(Dt)&&(Nt=1,cn=Dt);let dt=oe.length;const Xt=dt-Nt;switch(Xt){case 0:Ce=void 0;break;case 1:Ce=G1(cn,oe[Nt]);break;default:if(cn===i.ParameterStructures.byName)throw new Error(`Received ${Xt} parameters for 'by Name' notification parameter structure.`);Ce=oe.slice(Nt,dt).map(bt=>zu(bt));break}}else{const Dt=oe;pe=V.method,Ce=bS(V,Dt)}const Lt={jsonrpc:ae,method:pe,params:Ce};return TM(Lt),Z.write(Lt).catch(Dt=>{throw Y.error("Sending notification failed."),Dt})},onNotification:(V,oe)=>{Vu();let pe;return t.func(V)?et=V:oe&&(t.string(V)?(pe=V,ht.set(V,{type:void 0,handler:oe})):(pe=V.method,ht.set(V.method,{type:V,handler:oe}))),{dispose:()=>{pe!==void 0?ht.delete(pe):et=void 0}}},onProgress:(V,oe,pe)=>{if(wt.has(oe))throw new Error(`Progress handler for token ${oe} already registered`);return wt.set(oe,pe),{dispose:()=>{wt.delete(oe)}}},sendProgress:(V,oe,pe)=>ed.sendNotification(h.type,{token:oe,value:pe}),onUnhandledProgress:gn.event,sendRequest:(V,...oe)=>{Vu(),z1();let pe,Ce,Lt;if(t.string(V)){pe=V;const dt=oe[0],Xt=oe[oe.length-1];let bt=0,tn=i.ParameterStructures.auto;i.ParameterStructures.is(dt)&&(bt=1,tn=dt);let ri=oe.length;s.CancellationToken.is(Xt)&&(ri=ri-1,Lt=Xt);const Bi=ri-bt;switch(Bi){case 0:Ce=void 0;break;case 1:Ce=G1(tn,oe[bt]);break;default:if(tn===i.ParameterStructures.byName)throw new Error(`Received ${Bi} parameters for 'by Name' request parameter structure.`);Ce=oe.slice(bt,ri).map(NM=>zu(NM));break}}else{const dt=oe;pe=V.method,Ce=bS(V,dt);const Xt=V.numberOfParams;Lt=s.CancellationToken.is(dt[Xt])?dt[Xt]:void 0}const Dt=te++;let Nt;Lt&&(Nt=Lt.onCancellationRequested(()=>{const dt=_t.sender.sendCancellation(ed,Dt);return dt===void 0?(Y.log(`Received no promise from cancellation strategy when cancelling id ${Dt}`),Promise.resolve()):dt.catch(()=>{Y.log(`Sending cancellation messages for id ${Dt} failed`)})}));const cn={jsonrpc:ae,id:Dt,method:pe,params:Ce};return vS(cn),typeof _t.sender.enableCancellation=="function"&&_t.sender.enableCancellation(cn),new Promise(async(dt,Xt)=>{const bt=Bi=>{dt(Bi),_t.sender.cleanup(Dt),Nt==null||Nt.dispose()},tn=Bi=>{Xt(Bi),_t.sender.cleanup(Dt),Nt==null||Nt.dispose()},ri={method:pe,timerStart:Date.now(),resolve:bt,reject:tn};try{await Z.write(cn),At.set(Dt,ri)}catch(Bi){throw Y.error("Sending request failed."),ri.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,Bi.message?Bi.message:"Unknown reason")),Bi}})},onRequest:(V,oe)=>{Vu();let pe=null;return y.is(V)?(pe=void 0,ot=V):t.string(V)?(pe=null,oe!==void 0&&(pe=V,Ft.set(V,{handler:oe,type:void 0}))):oe!==void 0&&(pe=V.method,Ft.set(V.method,{type:V,handler:oe})),{dispose:()=>{pe!==null&&(pe!==void 0?Ft.delete(pe):ot=void 0)}}},hasPendingResponse:()=>At.size>0,trace:async(V,oe,pe)=>{let Ce=!1,Lt=w.Text;pe!==void 0&&(t.boolean(pe)?Ce=pe:(Ce=pe.sendNotification||!1,Lt=pe.traceFormat||w.Text)),Ze=V,ii=Lt,Ze===S.Off?he=void 0:he=oe,Ce&&!Pe()&&!Qt()&&await ed.sendNotification(C.type,{value:S.toString(V)})},onError:en.event,onClose:xt.event,onUnhandledNotification:Rn.event,onDispose:oi.event,end:()=>{Z.end()},dispose:()=>{if(Qt())return;Ne=$.Disposed,oi.fire(void 0);const V=new i.ResponseError(i.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const oe of At.values())oe.reject(V);At=new Map,Wt=new Map,yi=new Set,vt=new o.LinkedMap,t.func(Z.dispose)&&Z.dispose(),t.func(K.dispose)&&K.dispose()},listen:()=>{Vu(),LM(),Ne=$.Listening,K.listen(Xc)},inspect:()=>{(0,e.default)().console.log("inspect")}};return ed.onNotification(E.type,V=>{if(Ze===S.Off||!he)return;const oe=Ze===S.Verbose||Ze===S.Compact;he.log(V.message,oe?V.verbose:void 0)}),ed.onNotification(h.type,V=>{const oe=wt.get(V.token);oe?oe(V.value):gn.fire(V)}),ed}n.createMessageConnection=Q})(HY);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ProgressType=n.ProgressToken=n.createMessageConnection=n.NullLogger=n.ConnectionOptions=n.ConnectionStrategy=n.AbstractMessageBuffer=n.WriteableStreamMessageWriter=n.AbstractMessageWriter=n.MessageWriter=n.ReadableStreamMessageReader=n.AbstractMessageReader=n.MessageReader=n.SharedArrayReceiverStrategy=n.SharedArraySenderStrategy=n.CancellationToken=n.CancellationTokenSource=n.Emitter=n.Event=n.Disposable=n.LRUCache=n.Touch=n.LinkedMap=n.ParameterStructures=n.NotificationType9=n.NotificationType8=n.NotificationType7=n.NotificationType6=n.NotificationType5=n.NotificationType4=n.NotificationType3=n.NotificationType2=n.NotificationType1=n.NotificationType0=n.NotificationType=n.ErrorCodes=n.ResponseError=n.RequestType9=n.RequestType8=n.RequestType7=n.RequestType6=n.RequestType5=n.RequestType4=n.RequestType3=n.RequestType2=n.RequestType1=n.RequestType0=n.RequestType=n.Message=n.RAL=void 0,n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=void 0;const e=Ie;Object.defineProperty(n,"Message",{enumerable:!0,get:function(){return e.Message}}),Object.defineProperty(n,"RequestType",{enumerable:!0,get:function(){return e.RequestType}}),Object.defineProperty(n,"RequestType0",{enumerable:!0,get:function(){return e.RequestType0}}),Object.defineProperty(n,"RequestType1",{enumerable:!0,get:function(){return e.RequestType1}}),Object.defineProperty(n,"RequestType2",{enumerable:!0,get:function(){return e.RequestType2}}),Object.defineProperty(n,"RequestType3",{enumerable:!0,get:function(){return e.RequestType3}}),Object.defineProperty(n,"RequestType4",{enumerable:!0,get:function(){return e.RequestType4}}),Object.defineProperty(n,"RequestType5",{enumerable:!0,get:function(){return e.RequestType5}}),Object.defineProperty(n,"RequestType6",{enumerable:!0,get:function(){return e.RequestType6}}),Object.defineProperty(n,"RequestType7",{enumerable:!0,get:function(){return e.RequestType7}}),Object.defineProperty(n,"RequestType8",{enumerable:!0,get:function(){return e.RequestType8}}),Object.defineProperty(n,"RequestType9",{enumerable:!0,get:function(){return e.RequestType9}}),Object.defineProperty(n,"ResponseError",{enumerable:!0,get:function(){return e.ResponseError}}),Object.defineProperty(n,"ErrorCodes",{enumerable:!0,get:function(){return e.ErrorCodes}}),Object.defineProperty(n,"NotificationType",{enumerable:!0,get:function(){return e.NotificationType}}),Object.defineProperty(n,"NotificationType0",{enumerable:!0,get:function(){return e.NotificationType0}}),Object.defineProperty(n,"NotificationType1",{enumerable:!0,get:function(){return e.NotificationType1}}),Object.defineProperty(n,"NotificationType2",{enumerable:!0,get:function(){return e.NotificationType2}}),Object.defineProperty(n,"NotificationType3",{enumerable:!0,get:function(){return e.NotificationType3}}),Object.defineProperty(n,"NotificationType4",{enumerable:!0,get:function(){return e.NotificationType4}}),Object.defineProperty(n,"NotificationType5",{enumerable:!0,get:function(){return e.NotificationType5}}),Object.defineProperty(n,"NotificationType6",{enumerable:!0,get:function(){return e.NotificationType6}}),Object.defineProperty(n,"NotificationType7",{enumerable:!0,get:function(){return e.NotificationType7}}),Object.defineProperty(n,"NotificationType8",{enumerable:!0,get:function(){return e.NotificationType8}}),Object.defineProperty(n,"NotificationType9",{enumerable:!0,get:function(){return e.NotificationType9}}),Object.defineProperty(n,"ParameterStructures",{enumerable:!0,get:function(){return e.ParameterStructures}});const t=rc;Object.defineProperty(n,"LinkedMap",{enumerable:!0,get:function(){return t.LinkedMap}}),Object.defineProperty(n,"LRUCache",{enumerable:!0,get:function(){return t.LRUCache}}),Object.defineProperty(n,"Touch",{enumerable:!0,get:function(){return t.Touch}});const i=oR;Object.defineProperty(n,"Disposable",{enumerable:!0,get:function(){return i.Disposable}});const o=la;Object.defineProperty(n,"Event",{enumerable:!0,get:function(){return o.Event}}),Object.defineProperty(n,"Emitter",{enumerable:!0,get:function(){return o.Emitter}});const r=cu;Object.defineProperty(n,"CancellationTokenSource",{enumerable:!0,get:function(){return r.CancellationTokenSource}}),Object.defineProperty(n,"CancellationToken",{enumerable:!0,get:function(){return r.CancellationToken}});const s=rm;Object.defineProperty(n,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(n,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const a=Kd;Object.defineProperty(n,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(n,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(n,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const f=Vd;Object.defineProperty(n,"MessageWriter",{enumerable:!0,get:function(){return f.MessageWriter}}),Object.defineProperty(n,"AbstractMessageWriter",{enumerable:!0,get:function(){return f.AbstractMessageWriter}}),Object.defineProperty(n,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return f.WriteableStreamMessageWriter}});const h=rR;Object.defineProperty(n,"AbstractMessageBuffer",{enumerable:!0,get:function(){return h.AbstractMessageBuffer}});const g=HY;Object.defineProperty(n,"ConnectionStrategy",{enumerable:!0,get:function(){return g.ConnectionStrategy}}),Object.defineProperty(n,"ConnectionOptions",{enumerable:!0,get:function(){return g.ConnectionOptions}}),Object.defineProperty(n,"NullLogger",{enumerable:!0,get:function(){return g.NullLogger}}),Object.defineProperty(n,"createMessageConnection",{enumerable:!0,get:function(){return g.createMessageConnection}}),Object.defineProperty(n,"ProgressToken",{enumerable:!0,get:function(){return g.ProgressToken}}),Object.defineProperty(n,"ProgressType",{enumerable:!0,get:function(){return g.ProgressType}}),Object.defineProperty(n,"Trace",{enumerable:!0,get:function(){return g.Trace}}),Object.defineProperty(n,"TraceValues",{enumerable:!0,get:function(){return g.TraceValues}}),Object.defineProperty(n,"TraceFormat",{enumerable:!0,get:function(){return g.TraceFormat}}),Object.defineProperty(n,"SetTraceNotification",{enumerable:!0,get:function(){return g.SetTraceNotification}}),Object.defineProperty(n,"LogTraceNotification",{enumerable:!0,get:function(){return g.LogTraceNotification}}),Object.defineProperty(n,"ConnectionErrors",{enumerable:!0,get:function(){return g.ConnectionErrors}}),Object.defineProperty(n,"ConnectionError",{enumerable:!0,get:function(){return g.ConnectionError}}),Object.defineProperty(n,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return g.CancellationReceiverStrategy}}),Object.defineProperty(n,"CancellationSenderStrategy",{enumerable:!0,get:function(){return g.CancellationSenderStrategy}}),Object.defineProperty(n,"CancellationStrategy",{enumerable:!0,get:function(){return g.CancellationStrategy}}),Object.defineProperty(n,"MessageStrategy",{enumerable:!0,get:function(){return g.MessageStrategy}});const y=Vc;n.RAL=y.default})(XC);Object.defineProperty(q7,"__esModule",{value:!0});const Vs=XC;class sR extends Vs.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return sR.emptyBuffer}fromString(e,t){return new TextEncoder().encode(e)}toString(e,t){return t==="ascii"?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}sR.emptyBuffer=new Uint8Array(0);class V_e{constructor(e){this.socket=e,this._onData=new Vs.Emitter,this._messageListener=t=>{t.data.arrayBuffer().then(o=>{this._onData.fire(new Uint8Array(o))},()=>{(0,Vs.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),Vs.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Vs.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Vs.Disposable.create(()=>this.socket.removeEventListener("end",e))}onData(e){return this._onData.event(e)}}class z_e{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),Vs.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),Vs.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),Vs.Disposable.create(()=>this.socket.removeEventListener("end",e))}write(e,t){if(typeof e=="string"){if(t!==void 0&&t!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const G_e=new TextEncoder,KY=Object.freeze({messageBuffer:Object.freeze({create:n=>new sR(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{if(e.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${e.charset}`);return Promise.resolve(G_e.encode(JSON.stringify(n,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{if(!(n instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(e.charset).decode(n)))}})}),stream:Object.freeze({asReadableStream:n=>new V_e(n),asWritableStream:n=>new z_e(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){const i=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(i)}},setImmediate(n,...e){const t=setTimeout(n,0,...e);return{dispose:()=>clearTimeout(t)}},setInterval(n,e,...t){const i=setInterval(n,e,...t);return{dispose:()=>clearInterval(i)}}})});function z8(){return KY}(function(n){function e(){Vs.RAL.install(KY)}n.install=e})(z8||(z8={}));q7.default=z8;(function(n){var e=l&&l.__createBinding||(Object.create?function(f,h,g,y){y===void 0&&(y=g);var S=Object.getOwnPropertyDescriptor(h,g);(!S||("get"in S?!h.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return h[g]}}),Object.defineProperty(f,y,S)}:function(f,h,g,y){y===void 0&&(y=g),f[y]=h[g]}),t=l&&l.__exportStar||function(f,h){for(var g in f)g!=="default"&&!Object.prototype.hasOwnProperty.call(h,g)&&e(h,f,g)};Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.BrowserMessageWriter=n.BrowserMessageReader=void 0,q7.default.install();const o=XC;t(XC,n);class r extends o.AbstractMessageReader{constructor(h){super(),this._onData=new o.Emitter,this._messageListener=g=>{this._onData.fire(g.data)},h.addEventListener("error",g=>this.fireError(g)),h.onmessage=this._messageListener}listen(h){return this._onData.event(h)}}n.BrowserMessageReader=r;class s extends o.AbstractMessageWriter{constructor(h){super(),this.port=h,this.errorCount=0,h.addEventListener("error",g=>this.fireError(g))}write(h){try{return this.port.postMessage(h),Promise.resolve()}catch(g){return this.handleError(g,h),Promise.reject(g)}}handleError(h,g){this.errorCount++,this.fireError(h,g,this.errorCount)}end(){}}n.BrowserMessageWriter=s;function a(f,h,g,y){return g===void 0&&(g=o.NullLogger),o.ConnectionStrategy.is(y)&&(y={connectionStrategy:y}),(0,o.createMessageConnection)(f,h,g,y)}n.createMessageConnection=a})(Cg);var Pg={};Object.defineProperty(Pg,"__esModule",{value:!0});Pg.Emitter=void 0;const U_e=Cg;class Y_e extends U_e.Emitter{constructor(e={}){super(e)}get event(){return super.event}fire(e){super.fire(e)}}Pg.Emitter=Y_e;var as={},wg={},aR={};Object.defineProperty(aR,"__esModule",{value:!0});aR.default=void 0;aR.default="ffffffff-ffff-ffff-ffff-ffffffffffff";var cR={};Object.defineProperty(cR,"__esModule",{value:!0});cR.default=void 0;cR.default="00000000-0000-0000-0000-000000000000";var qf={},Wf={},dR={};Object.defineProperty(dR,"__esModule",{value:!0});dR.default=void 0;dR.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;Object.defineProperty(Wf,"__esModule",{value:!0});Wf.default=void 0;var q_e=W_e(dR);function W_e(n){return n&&n.__esModule?n:{default:n}}function Z_e(n){return typeof n=="string"&&q_e.default.test(n)}Wf.default=Z_e;Object.defineProperty(qf,"__esModule",{value:!0});qf.default=void 0;var Q_e=X_e(Wf);function X_e(n){return n&&n.__esModule?n:{default:n}}function J_e(n){if(!(0,Q_e.default)(n))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(n.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(n.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(n.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(n.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(n.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}qf.default=J_e;var xr={};Object.defineProperty(xr,"__esModule",{value:!0});xr.default=void 0;xr.unsafeStringify=VY;var eye=tye(Wf);function tye(n){return n&&n.__esModule?n:{default:n}}var ui=[];for(var RD=0;RD<256;++RD)ui.push((RD+256).toString(16).slice(1));function VY(n,e=0){return(ui[n[e+0]]+ui[n[e+1]]+ui[n[e+2]]+ui[n[e+3]]+"-"+ui[n[e+4]]+ui[n[e+5]]+"-"+ui[n[e+6]]+ui[n[e+7]]+"-"+ui[n[e+8]]+ui[n[e+9]]+"-"+ui[n[e+10]]+ui[n[e+11]]+ui[n[e+12]]+ui[n[e+13]]+ui[n[e+14]]+ui[n[e+15]]).toLowerCase()}function nye(n,e=0){var t=VY(n,e);if(!(0,eye.default)(t))throw TypeError("Stringified UUID is invalid");return t}xr.default=nye;var ob={},rb={};Object.defineProperty(rb,"__esModule",{value:!0});rb.default=oye;var PE,iye=new Uint8Array(16);function oye(){if(!PE&&(PE=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!PE))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return PE(iye)}Object.defineProperty(ob,"__esModule",{value:!0});ob.default=void 0;var rye=aye(rb),sye=xr;function aye(n){return n&&n.__esModule?n:{default:n}}var MD,wE,ID=0,DD=0;function cye(n,e,t){var i=e&&t||0,o=e||new Array(16);n=n||{};var r=n.node,s=n.clockseq;if(n._v6||(r||(r=MD),s==null&&(s=wE)),r==null||s==null){var a=n.random||(n.rng||rye.default)();r==null&&(r=[a[0],a[1],a[2],a[3],a[4],a[5]],!MD&&!n._v6&&(r[0]|=1,MD=r)),s==null&&(s=(a[6]<<8|a[7])&16383,wE===void 0&&!n._v6&&(wE=s))}var f=n.msecs!==void 0?n.msecs:Date.now(),h=n.nsecs!==void 0?n.nsecs:DD+1,g=f-ID+(h-DD)/1e4;if(g<0&&n.clockseq===void 0&&(s=s+1&16383),(g<0||f>ID)&&n.nsecs===void 0&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ID=f,DD=h,wE=s,f+=122192928e5;var y=((f&268435455)*1e4+h)%4294967296;o[i++]=y>>>24&255,o[i++]=y>>>16&255,o[i++]=y>>>8&255,o[i++]=y&255;var S=f/4294967296*1e4&268435455;o[i++]=S>>>8&255,o[i++]=S&255,o[i++]=S>>>24&15|16,o[i++]=S>>>16&255,o[i++]=s>>>8|128,o[i++]=s&255;for(var P=0;P<6;++P)o[i+P]=r[P];return e||(0,sye.unsafeStringify)(o)}ob.default=cye;var uR={};Object.defineProperty(uR,"__esModule",{value:!0});uR.default=fye;var dye=lye(qf),uye=xr;function lye(n){return n&&n.__esModule?n:{default:n}}function fye(n){var e=typeof n=="string"?(0,dye.default)(n):n,t=hye(e);return typeof n=="string"?(0,uye.unsafeStringify)(t):t}function hye(n,e=!1){return Uint8Array.of((n[6]&15)<<4|n[7]>>4&15,(n[7]&15)<<4|(n[4]&240)>>4,(n[4]&15)<<4|(n[5]&240)>>4,(n[5]&15)<<4|(n[0]&240)>>4,(n[0]&15)<<4|(n[1]&240)>>4,(n[1]&15)<<4|(n[2]&240)>>4,96|n[2]&15,n[3],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}var lR={},du={};Object.defineProperty(du,"__esModule",{value:!0});du.URL=du.DNS=void 0;du.default=bye;var pye=xr,mye=gye(qf);function gye(n){return n&&n.__esModule?n:{default:n}}function vye(n){n=unescape(encodeURIComponent(n));for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e}var _ye=du.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",yye=du.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function bye(n,e,t){function i(o,r,s,a){var f;if(typeof o=="string"&&(o=vye(o)),typeof r=="string"&&(r=(0,mye.default)(r)),((f=r)===null||f===void 0?void 0:f.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var h=new Uint8Array(16+o.length);if(h.set(r),h.set(o,r.length),h=t(h),h[6]=h[6]&15|e,h[8]=h[8]&63|128,s){a=a||0;for(var g=0;g<16;++g)s[a+g]=h[g];return s}return(0,pye.unsafeStringify)(h)}try{i.name=n}catch{}return i.DNS=_ye,i.URL=yye,i}var fR={};Object.defineProperty(fR,"__esModule",{value:!0});fR.default=void 0;function Sye(n){if(typeof n=="string"){var e=unescape(encodeURIComponent(n));n=new Uint8Array(e.length);for(var t=0;t<e.length;++t)n[t]=e.charCodeAt(t)}return Eye(Cye(Pye(n),n.length*8))}function Eye(n){for(var e=[],t=n.length*32,i="0123456789abcdef",o=0;o<t;o+=8){var r=n[o>>5]>>>o%32&255,s=parseInt(i.charAt(r>>>4&15)+i.charAt(r&15),16);e.push(s)}return e}function zY(n){return(n+64>>>9<<4)+14+1}function Cye(n,e){n[e>>5]|=128<<e%32,n[zY(e)-1]=e;for(var t=1732584193,i=-271733879,o=-1732584194,r=271733878,s=0;s<n.length;s+=16){var a=t,f=i,h=o,g=r;t=Ci(t,i,o,r,n[s],7,-680876936),r=Ci(r,t,i,o,n[s+1],12,-389564586),o=Ci(o,r,t,i,n[s+2],17,606105819),i=Ci(i,o,r,t,n[s+3],22,-1044525330),t=Ci(t,i,o,r,n[s+4],7,-176418897),r=Ci(r,t,i,o,n[s+5],12,1200080426),o=Ci(o,r,t,i,n[s+6],17,-1473231341),i=Ci(i,o,r,t,n[s+7],22,-45705983),t=Ci(t,i,o,r,n[s+8],7,1770035416),r=Ci(r,t,i,o,n[s+9],12,-1958414417),o=Ci(o,r,t,i,n[s+10],17,-42063),i=Ci(i,o,r,t,n[s+11],22,-1990404162),t=Ci(t,i,o,r,n[s+12],7,1804603682),r=Ci(r,t,i,o,n[s+13],12,-40341101),o=Ci(o,r,t,i,n[s+14],17,-1502002290),i=Ci(i,o,r,t,n[s+15],22,1236535329),t=Pi(t,i,o,r,n[s+1],5,-165796510),r=Pi(r,t,i,o,n[s+6],9,-1069501632),o=Pi(o,r,t,i,n[s+11],14,643717713),i=Pi(i,o,r,t,n[s],20,-373897302),t=Pi(t,i,o,r,n[s+5],5,-701558691),r=Pi(r,t,i,o,n[s+10],9,38016083),o=Pi(o,r,t,i,n[s+15],14,-660478335),i=Pi(i,o,r,t,n[s+4],20,-405537848),t=Pi(t,i,o,r,n[s+9],5,568446438),r=Pi(r,t,i,o,n[s+14],9,-1019803690),o=Pi(o,r,t,i,n[s+3],14,-187363961),i=Pi(i,o,r,t,n[s+8],20,1163531501),t=Pi(t,i,o,r,n[s+13],5,-1444681467),r=Pi(r,t,i,o,n[s+2],9,-51403784),o=Pi(o,r,t,i,n[s+7],14,1735328473),i=Pi(i,o,r,t,n[s+12],20,-1926607734),t=wi(t,i,o,r,n[s+5],4,-378558),r=wi(r,t,i,o,n[s+8],11,-2022574463),o=wi(o,r,t,i,n[s+11],16,1839030562),i=wi(i,o,r,t,n[s+14],23,-35309556),t=wi(t,i,o,r,n[s+1],4,-1530992060),r=wi(r,t,i,o,n[s+4],11,1272893353),o=wi(o,r,t,i,n[s+7],16,-155497632),i=wi(i,o,r,t,n[s+10],23,-1094730640),t=wi(t,i,o,r,n[s+13],4,681279174),r=wi(r,t,i,o,n[s],11,-358537222),o=wi(o,r,t,i,n[s+3],16,-722521979),i=wi(i,o,r,t,n[s+6],23,76029189),t=wi(t,i,o,r,n[s+9],4,-640364487),r=wi(r,t,i,o,n[s+12],11,-421815835),o=wi(o,r,t,i,n[s+15],16,530742520),i=wi(i,o,r,t,n[s+2],23,-995338651),t=Ai(t,i,o,r,n[s],6,-198630844),r=Ai(r,t,i,o,n[s+7],10,1126891415),o=Ai(o,r,t,i,n[s+14],15,-1416354905),i=Ai(i,o,r,t,n[s+5],21,-57434055),t=Ai(t,i,o,r,n[s+12],6,1700485571),r=Ai(r,t,i,o,n[s+3],10,-1894986606),o=Ai(o,r,t,i,n[s+10],15,-1051523),i=Ai(i,o,r,t,n[s+1],21,-2054922799),t=Ai(t,i,o,r,n[s+8],6,1873313359),r=Ai(r,t,i,o,n[s+15],10,-30611744),o=Ai(o,r,t,i,n[s+6],15,-1560198380),i=Ai(i,o,r,t,n[s+13],21,1309151649),t=Ai(t,i,o,r,n[s+4],6,-145523070),r=Ai(r,t,i,o,n[s+11],10,-1120210379),o=Ai(o,r,t,i,n[s+2],15,718787259),i=Ai(i,o,r,t,n[s+9],21,-343485551),t=Nd(t,a),i=Nd(i,f),o=Nd(o,h),r=Nd(r,g)}return[t,i,o,r]}function Pye(n){if(n.length===0)return[];for(var e=n.length*8,t=new Uint32Array(zY(e)),i=0;i<e;i+=8)t[i>>5]|=(n[i/8]&255)<<i%32;return t}function Nd(n,e){var t=(n&65535)+(e&65535),i=(n>>16)+(e>>16)+(t>>16);return i<<16|t&65535}function wye(n,e){return n<<e|n>>>32-e}function hR(n,e,t,i,o,r){return Nd(wye(Nd(Nd(e,n),Nd(i,r)),o),t)}function Ci(n,e,t,i,o,r,s){return hR(e&t|~e&i,n,e,o,r,s)}function Pi(n,e,t,i,o,r,s){return hR(e&i|t&~i,n,e,o,r,s)}function wi(n,e,t,i,o,r,s){return hR(e^t^i,n,e,o,r,s)}function Ai(n,e,t,i,o,r,s){return hR(t^(e|~i),n,e,o,r,s)}fR.default=Sye;Object.defineProperty(lR,"__esModule",{value:!0});lR.default=void 0;var Aye=GY(du),Rye=GY(fR);function GY(n){return n&&n.__esModule?n:{default:n}}var Mye=(0,Aye.default)("v3",48,Rye.default);lR.default=Mye;var pR={},mR={};Object.defineProperty(mR,"__esModule",{value:!0});mR.default=void 0;var Iye=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);mR.default={randomUUID:Iye};Object.defineProperty(pR,"__esModule",{value:!0});pR.default=void 0;var yx=UY(mR),Dye=UY(rb),Tye=xr;function UY(n){return n&&n.__esModule?n:{default:n}}function Oye(n,e,t){if(yx.default.randomUUID&&!e&&!n)return yx.default.randomUUID();n=n||{};var i=n.random||(n.rng||Dye.default)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){t=t||0;for(var o=0;o<16;++o)e[t+o]=i[o];return e}return(0,Tye.unsafeStringify)(i)}pR.default=Oye;var gR={},vR={};Object.defineProperty(vR,"__esModule",{value:!0});vR.default=void 0;function Lye(n,e,t,i){switch(n){case 0:return e&t^~e&i;case 1:return e^t^i;case 2:return e&t^e&i^t&i;case 3:return e^t^i}}function TD(n,e){return n<<e|n>>>32-e}function Nye(n){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var i=unescape(encodeURIComponent(n));n=[];for(var o=0;o<i.length;++o)n.push(i.charCodeAt(o))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var r=n.length/4+2,s=Math.ceil(r/16),a=new Array(s),f=0;f<s;++f){for(var h=new Uint32Array(16),g=0;g<16;++g)h[g]=n[f*64+g*4]<<24|n[f*64+g*4+1]<<16|n[f*64+g*4+2]<<8|n[f*64+g*4+3];a[f]=h}a[s-1][14]=(n.length-1)*8/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=(n.length-1)*8&4294967295;for(var y=0;y<s;++y){for(var S=new Uint32Array(80),P=0;P<16;++P)S[P]=a[y][P];for(var w=16;w<80;++w)S[w]=TD(S[w-3]^S[w-8]^S[w-14]^S[w-16],1);for(var C=t[0],E=t[1],D=t[2],j=t[3],U=t[4],p=0;p<80;++p){var b=Math.floor(p/20),v=TD(C,5)+Lye(b,E,D,j)+U+e[b]+S[p]>>>0;U=j,j=D,D=TD(E,30)>>>0,E=C,C=v}t[0]=t[0]+C>>>0,t[1]=t[1]+E>>>0,t[2]=t[2]+D>>>0,t[3]=t[3]+j>>>0,t[4]=t[4]+U>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}vR.default=Nye;Object.defineProperty(gR,"__esModule",{value:!0});gR.default=void 0;var jye=YY(du),Bye=YY(vR);function YY(n){return n&&n.__esModule?n:{default:n}}var $ye=(0,jye.default)("v5",80,Bye.default);gR.default=$ye;var Z7={};Object.defineProperty(Z7,"__esModule",{value:!0});Z7.default=zye;var kye=xr,Fye=qY(ob),xye=qY(uR);function qY(n){return n&&n.__esModule?n:{default:n}}function bx(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,i)}return t}function Sx(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?bx(Object(t),!0).forEach(function(i){Hye(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):bx(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Hye(n,e,t){return(e=Kye(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kye(n){var e=Vye(n,"string");return typeof e=="symbol"?e:e+""}function Vye(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function zye(n={},e,t=0){var i=(0,Fye.default)(Sx(Sx({},n),{},{_v6:!0}),new Uint8Array(16));if(i=(0,xye.default)(i),e){for(var o=0;o<16;o++)e[t+o]=i[o];return e}return(0,kye.unsafeStringify)(i)}var Q7={};Object.defineProperty(Q7,"__esModule",{value:!0});Q7.default=qye;var Gye=Yye(qf),Uye=xr;function Yye(n){return n&&n.__esModule?n:{default:n}}function qye(n){var e=typeof n=="string"?(0,Gye.default)(n):n,t=Wye(e);return typeof n=="string"?(0,Uye.unsafeStringify)(t):t}function Wye(n){return Uint8Array.of((n[3]&15)<<4|n[4]>>4&15,(n[4]&15)<<4|(n[5]&240)>>4,(n[5]&15)<<4|n[6]&15,n[7],(n[1]&15)<<4|(n[2]&240)>>4,(n[2]&15)<<4|(n[3]&240)>>4,16|(n[0]&240)>>4,(n[0]&15)<<4|(n[1]&240)>>4,n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}var _R={};Object.defineProperty(_R,"__esModule",{value:!0});_R.default=void 0;var Zye=Xye(rb),Qye=xr;function Xye(n){return n&&n.__esModule?n:{default:n}}var Ex=null,Cx=null,Wr=0;function Jye(n,e,t){n=n||{};var i=e&&t||0,o=e||new Uint8Array(16),r=n.random||(n.rng||Zye.default)(),s=n.msecs!==void 0?n.msecs:Date.now(),a=n.seq!==void 0?n.seq:null,f=Cx,h=Ex;return s>Wr&&n.msecs===void 0&&(Wr=s,a!==null&&(f=null,h=null)),a!==null&&(a>2147483647&&(a=2147483647),f=a>>>19&4095,h=a&524287),(f===null||h===null)&&(f=r[6]&127,f=f<<8|r[7],h=r[8]&63,h=h<<8|r[9],h=h<<5|r[10]>>>3),s+1e4>Wr&&a===null?++h>524287&&(h=0,++f>4095&&(f=0,Wr++)):Wr=s,Cx=f,Ex=h,o[i++]=Wr/1099511627776&255,o[i++]=Wr/4294967296&255,o[i++]=Wr/16777216&255,o[i++]=Wr/65536&255,o[i++]=Wr/256&255,o[i++]=Wr&255,o[i++]=f>>>4&15|112,o[i++]=f&255,o[i++]=h>>>13&63|128,o[i++]=h>>>5&255,o[i++]=h<<3&255|r[10]&7,o[i++]=r[11],o[i++]=r[12],o[i++]=r[13],o[i++]=r[14],o[i++]=r[15],e||(0,Qye.unsafeStringify)(o)}_R.default=Jye;var yR={};Object.defineProperty(yR,"__esModule",{value:!0});yR.default=void 0;var e0e=t0e(Wf);function t0e(n){return n&&n.__esModule?n:{default:n}}function n0e(n){if(!(0,e0e.default)(n))throw TypeError("Invalid UUID");return parseInt(n.slice(14,15),16)}yR.default=n0e;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"MAX",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"NIL",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"v1ToV6",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"v3",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"v4",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(n,"v5",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(n,"v6",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(n,"v6ToV1",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(n,"v7",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(n,"validate",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return w.default}});var e=C(aR),t=C(cR),i=C(qf),o=C(xr),r=C(ob),s=C(uR),a=C(lR),f=C(pR),h=C(gR),g=C(Z7),y=C(Q7),S=C(_R),P=C(Wf),w=C(yR);function C(E){return E&&E.__esModule?E:{default:E}}})(wg);Object.defineProperty(as,"__esModule",{value:!0});as.GLSPClient=as.ClientState=as.ApplicationIdProvider=void 0;const i0e=wg,Px=Oe;class g_{static get(){return g_._applicationId||(g_._applicationId=i0e.v4()),g_._applicationId}}as.ApplicationIdProvider=g_;var wx;(function(n){n[n.Initial=0]="Initial",n[n.Starting=1]="Starting",n[n.StartFailed=2]="StartFailed",n[n.Running=3]="Running",n[n.Stopping=4]="Stopping",n[n.Stopped=5]="Stopped",n[n.ServerError=6]="ServerError"})(wx||(as.ClientState=wx={}));var Ax;(function(n){function e(t){return Px.AnyObject.is(t)&&(0,Px.hasStringProp)(t,"id")}n.isOptions=e,n.protocolVersion="1.0.0"})(Ax||(as.GLSPClient=Ax={}));(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseGLSPClient=n.GLOBAL_HANDLER_ID=void 0;const e=kr,t=Cg,i=lt,o=Pg,r=as;n.GLOBAL_HANDLER_ID="*";class s{get onServerInitialized(){return this.onServerInitializedEmitter.event}constructor(f){this.options=f,this.serverDeferred=new e.Deferred,this.onStartDeferred=new e.Deferred,this.onStopDeferred=new e.Deferred,this.startupTimeout=1500,this.actionMessageHandlers=new Map([[n.GLOBAL_HANDLER_ID,[]]]),this.onServerInitializedEmitter=new o.Emitter,this.state=r.ClientState.Initial,this.proxy=this.createProxy()}createProxy(){return{process:f=>{var h;const g=(h=this.actionMessageHandlers.get(f.clientId))!==null&&h!==void 0?h:this.actionMessageHandlers.get(n.GLOBAL_HANDLER_ID);if(!g){console.warn("No ActionMessageHandler is configured- Cannot process server message",f);return}g.forEach(y=>y(f))}}}configureServer(f){if(this.state===r.ClientState.Running)throw new Error("Could not configure new server. The GLSPClient is already running");this.serverDeferred.resolve(f)}start(){if(this.state===r.ClientState.Running)return this.onStartDeferred.promise;this.state=r.ClientState.Starting;const f=new Promise((h,g)=>setTimeout(()=>{g(new Error("Could not start client. No server is configured"))},this.startupTimeout));return Promise.race([this.serverDeferred.promise,f]).then(h=>{this._server=h,this.state=r.ClientState.Running,this.onStartDeferred.resolve()}).catch(h=>{this.state=r.ClientState.StartFailed,this.onStartDeferred.reject(h)}),this.onStartDeferred.promise}async initializeServer(f){return this._initializeResult||(this._initializeResult=await this.checkedServer.initialize(f),this.onServerInitializedEmitter.fire(this._initializeResult)),this._initializeResult}get initializeResult(){return this._initializeResult}initializeClientSession(f){return this.checkedServer.initializeClientSession(f)}disposeClientSession(f){return this.checkedServer.disposeClientSession(f)}shutdownServer(){this.checkedServer.shutdown()}async stop(){if(this.state===r.ClientState.Stopped||this.state===r.ClientState.Stopping)return this.onStop();this.state=r.ClientState.Stopping;try{this._server&&this._server.shutdown()}finally{this.state=r.ClientState.Stopped,this.onStopDeferred.resolve()}}sendActionMessage(f){this.checkedServer.process(f)}onActionMessage(f,h){return h?(this.actionMessageHandlers.has(h)?(0,i.distinctAdd)(this.actionMessageHandlers.get(h),f):this.actionMessageHandlers.set(h,[f]),t.Disposable.create(()=>(0,i.remove)(this.actionMessageHandlers.get(h),f))):((0,i.distinctAdd)(this.actionMessageHandlers.get(n.GLOBAL_HANDLER_ID),f),t.Disposable.create(()=>(0,i.remove)(this.actionMessageHandlers.get(n.GLOBAL_HANDLER_ID),f)))}get currentState(){return this.state}onStart(){return this.onStartDeferred.promise}onStop(){return this.onStopDeferred.promise}get id(){return this.options.id}checkState(){if(this.state!==r.ClientState.Running)throw new Error(`Client with id '${this.id}' is not in 'Running' state`)}get checkedServer(){if(this.checkState(),!this._server)throw new Error(`No server is configured for GLSPClient with id '${this.id}'`);return this._server}setStartupTimeout(f){this.startupTimeout=f}}n.BaseGLSPClient=s})(LY);var zd={};Object.defineProperty(zd,"__esModule",{value:!0});zd.GLSPClientProxy=zd.GLSPServerListener=zd.GLSPServer=void 0;zd.GLSPServer=Symbol("GLSPServer");zd.GLSPServerListener=Symbol("GLSPServerListener");zd.GLSPClientProxy=Symbol("GLSPClientProxy");var Yl={},Ag={};Object.defineProperty(Ag,"__esModule",{value:!0});Ag.JsonrpcGLSPClient=void 0;const bv=Cg,o0e=as;var Rx;(function(n){function e(i){return o0e.GLSPClient.isOptions(i)&&"connectionProvider"in i}n.isOptions=e,n.ActionMessageNotification=new bv.NotificationType("process"),n.InitializeRequest=new bv.RequestType("initialize"),n.InitializeClientSessionRequest=new bv.RequestType("initializeClientSession"),n.DisposeClientSessionRequest=new bv.RequestType("disposeClientSession"),n.ShutdownNotification=new bv.NotificationType0("shutdown"),n.ClientNotReadyMsg="JsonrpcGLSPClient is not ready yet";function t(i,...o){console.error(`[JsonrpcGLSPClient] ${i}`,o)}n.error=t})(Rx||(Ag.JsonrpcGLSPClient=Rx={}));var r0e=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Yl,"__esModule",{value:!0});Yl.JsonrpcClientProxy=Yl.BaseJsonrpcGLSPClient=void 0;const s0e=F,Mx=Pg,lo=as,Zr=Ag;class a0e{get onServerInitialized(){return this.onServerInitializedEmitter.event}get onActionMessageNotification(){return this.onActionMessageNotificationEmitter.event}constructor(e){this.onServerInitializedEmitter=new Mx.Emitter,this.onActionMessageNotificationEmitter=new Mx.Emitter,Object.assign(this,e),this.state=lo.ClientState.Initial}shutdownServer(){this.checkedConnection.sendNotification(Zr.JsonrpcGLSPClient.ShutdownNotification)}async initializeServer(e){return this._initializeResult||(this._initializeResult=await this.checkedConnection.sendRequest(Zr.JsonrpcGLSPClient.InitializeRequest,e),this.onServerInitializedEmitter.fire(this._initializeResult)),this._initializeResult}get initializeResult(){return this._initializeResult}initializeClientSession(e){return this.checkedConnection.sendRequest(Zr.JsonrpcGLSPClient.InitializeClientSessionRequest,e)}disposeClientSession(e){return this.checkedConnection.sendRequest(Zr.JsonrpcGLSPClient.DisposeClientSessionRequest,e)}onActionMessage(e,t){return this.onActionMessageNotification(i=>{(!t||i.clientId===t)&&e(i)})}sendActionMessage(e){this.checkedConnection.sendNotification(Zr.JsonrpcGLSPClient.ActionMessageNotification,e)}get checkedConnection(){if(!this.isConnectionActive())throw new Error(Zr.JsonrpcGLSPClient.ClientNotReadyMsg);return this.resolvedConnection}async start(){if(this.state!==lo.ClientState.Running)try{this.state=lo.ClientState.Starting;const e=await this.resolveConnection();e.listen(),this.resolvedConnection=e,this.state=lo.ClientState.Running}catch(e){Zr.JsonrpcGLSPClient.error("Failed to start connection to server",e),this.state=lo.ClientState.StartFailed}}stop(){return this.connectionPromise?this.state===lo.ClientState.Stopping&&this.onStop?this.onStop:(this.state=lo.ClientState.Stopping,this.onStop=this.resolveConnection().then(e=>{e.dispose(),this.state=lo.ClientState.Stopped,this.onStop=void 0,this.onActionMessageNotificationEmitter.dispose(),this.connectionPromise=void 0,this.resolvedConnection=void 0})):(this.state=lo.ClientState.Stopped,Promise.resolve())}resolveConnection(){return this.connectionPromise||(this.connectionPromise=this.doCreateConnection()),this.connectionPromise}async doCreateConnection(){const e=typeof this.connectionProvider=="function"?await this.connectionProvider():this.connectionProvider;return e.onError(t=>this.handleConnectionError(t[0],t[1],t[2])),e.onClose(()=>this.handleConnectionClosed()),e.onNotification(Zr.JsonrpcGLSPClient.ActionMessageNotification,t=>this.onActionMessageNotificationEmitter.fire(t)),e}handleConnectionError(e,t,i){Zr.JsonrpcGLSPClient.error("Connection to server is erroring. Shutting down server.",e),this.stop(),this.state=lo.ClientState.ServerError}handleConnectionClosed(){if(!(this.state===lo.ClientState.Stopping||this.state===lo.ClientState.Stopped)){try{this.resolvedConnection&&(this.resolvedConnection.dispose(),this.connectionPromise=void 0,this.resolvedConnection=void 0)}catch{}Zr.JsonrpcGLSPClient.error("Connection to server got closed. Server will not be restarted."),this.state=lo.ClientState.ServerError}}isConnectionActive(){return this.state===lo.ClientState.Running&&!!this.resolvedConnection}get currentState(){return this.state}}Yl.BaseJsonrpcGLSPClient=a0e;let G8=class{initialize(e,t=!1){this.clientConnection=e,this.enableLogging=t}process(e){var t;this.enableLogging&&console.log(`Send action '${e.action.kind}' to client '${e.clientId}'`),(t=this.clientConnection)===null||t===void 0||t.sendNotification(Zr.JsonrpcGLSPClient.ActionMessageNotification,e)}};Yl.JsonrpcClientProxy=G8;Yl.JsonrpcClientProxy=G8=r0e([(0,s0e.injectable)()],G8);var bR={};Object.defineProperty(bR,"__esModule",{value:!0});bR.configureClientConnection=void 0;const AE=Ag;function c0e(n,e){n.onRequest(AE.JsonrpcGLSPClient.InitializeRequest.method,t=>e.initialize(t)),n.onRequest(AE.JsonrpcGLSPClient.InitializeClientSessionRequest,t=>e.initializeClientSession(t)),n.onRequest(AE.JsonrpcGLSPClient.DisposeClientSessionRequest,t=>e.disposeClientSession(t)),n.onNotification(AE.JsonrpcGLSPClient.ActionMessageNotification,t=>e.process(t)),n.listen()}bR.configureClientConnection=c0e;var Go={};Object.defineProperty(Go,"__esModule",{value:!0});Go.listen=Go.createWebSocketConnection=Go.WebSocketMessageWriter=Go.WebSocketMessageReader=Go.wrap=void 0;const eP=Cg;function WY(n){return{send:e=>n.send(e),onMessage:e=>n.onmessage=t=>e(t.data),onClose:e=>n.onclose=t=>e(t.code,t.reason),onError:e=>n.onerror=t=>{"error"in t&&e(t.error)},dispose:()=>n.close()}}Go.wrap=WY;class ZY extends eP.AbstractMessageReader{constructor(e){super(),this.socket=e,this.state="initial",this.eventQueue=[],this.socket.onMessage(t=>this.handleMessage(t)),this.socket.onError(t=>this.fireError(t)),this.socket.onClose(()=>this.fireClose())}listen(e){return this.state==="initial"&&(this.state="listening",this.callback=e,this.eventQueue.forEach(t=>{t.message?this.handleMessage(t.message):t.error?this.fireError(t.error):this.fireClose()}),this.eventQueue=[]),eP.Disposable.create(()=>{this.callback=void 0,this.eventQueue=[]})}handleMessage(e){if(this.state==="initial")this.eventQueue.push({message:e});else if(this.state==="listening"){const t=JSON.parse(e);this.callback(t)}}fireError(e){this.state==="initial"?this.eventQueue.push({error:e}):this.state==="listening"&&super.fireError(e)}fireClose(){this.state==="initial"?this.eventQueue.push({}):this.state==="listening"&&super.fireClose(),this.state="closed"}}Go.WebSocketMessageReader=ZY;class QY extends eP.AbstractMessageWriter{constructor(e){super(),this.socket=e,this.errorCount=0}end(){}async write(e){try{const t=JSON.stringify(e);this.socket.send(t)}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}}Go.WebSocketMessageWriter=QY;function XY(n,e){const t=new ZY(n),i=new QY(n);return(0,eP.createMessageConnection)(t,i,e)}Go.createWebSocketConnection=XY;function d0e(n,e,t){return new Promise(i=>{n.onopen=()=>{const o=WY(n),r=XY(o,t);e==null||e(r),i(r)}})}Go.listen=d0e;var SR={},u0e=Cg;Object.defineProperty(SR,"__esModule",{value:!0});SR.GLSPWebWorkerProvider=void 0;const OD=u0e;class l0e{constructor(e){this.url=e}createWebWorker(e){return new Worker(e)}listen(e){var t,i;this.worker=this.createWebWorker(this.url);const o=(0,OD.createMessageConnection)(new OD.BrowserMessageReader(this.worker),new OD.BrowserMessageWriter(this.worker));return(t=e.logger)===null||t===void 0||t.warn("GLSPWebWorkerProvider Initializing!"),(i=e.onConnection)===null||i===void 0||i.call(e,o),o}}SR.GLSPWebWorkerProvider=l0e;var sm={};Object.defineProperty(sm,"__esModule",{value:!0});sm.GLSPWebSocketProvider=sm.GLSPConnectionHandler=void 0;const Ix=Go;sm.GLSPConnectionHandler=Symbol("GLSPConnectionHandler");class f0e{constructor(e,t){this.url=e,this.reconnectAttempts=0,this.options={reconnecting:!0,reconnectAttempts:1/0,reconnectDelay:1e3},this.options=Object.assign(this.options,t)}createWebSocket(e){return new WebSocket(e)}listen(e,t=!1){return this.webSocket=this.createWebSocket(this.url),this.webSocket.onerror=()=>{var i;(i=e.logger)===null||i===void 0||i.error("GLSPWebSocketProvider Connection to server errored. Please make sure that the server is running!"),clearInterval(this.reconnectTimer),this.webSocket.close()},new Promise(i=>{this.webSocket.onopen=()=>{var o,r,s,a;clearInterval(this.reconnectTimer);const f=(0,Ix.wrap)(this.webSocket),h=(0,Ix.createWebSocketConnection)(f,e.logger);this.webSocket.onclose=()=>{var g,y;const{reconnecting:S,reconnectAttempts:P,reconnectDelay:w}=this.options;S?this.reconnectAttempts>=P?(g=e.logger)===null||g===void 0||g.error(`GLSPWebSocketProvider WebSocket reconnect failed - maximum number reconnect attempts (${P}) was exceeded!`):this.reconnectTimer=setInterval(()=>{var C;(C=e.logger)===null||C===void 0||C.warn("GLSPWebSocketProvider reconnecting..."),this.listen(e,!0),this.reconnectAttempts++},w):(y=e.logger)===null||y===void 0||y.error("GLSPWebSocketProvider WebSocket will not reconnect - closing the connection now!")},t?((o=e.logger)===null||o===void 0||o.warn("GLSPWebSocketProvider Reconnecting!"),(r=e.onReconnect)===null||r===void 0||r.call(e,h)):((s=e.logger)===null||s===void 0||s.warn("GLSPWebSocketProvider Initializing!"),(a=e.onConnection)===null||a===void 0||a.call(e,h)),i(h)}})}}sm.GLSPWebSocketProvider=f0e;var JY={};Object.defineProperty(JY,"__esModule",{value:!0});var ER={};Object.defineProperty(ER,"__esModule",{value:!0});ER.DefaultTypes=void 0;var Dx;(function(n){n.HTML="html",n.FOREIGN_OBJECT="foreign-object",n.PRE_RENDERED="pre-rendered",n.SHAPE_PRE_RENDERED="shape-pre-rendered",n.SVG="svg",n.GRAPH="graph",n.NODE="node",n.COMPARTMENT="comp",n.COMPARTMENT_HEADER="comp:header",n.EDGE="edge",n.PORT="port",n.ROUTING_POINT="routing-point",n.VOLATILE_ROUTING_POINT=`volatile-${n.ROUTING_POINT}`,n.LABEL="label",n.BUTTON="button",n.BUTTON_EXPAND="button:expand",n.ISSUE_MARKER="marker",n.NODE_CIRCLE="node:circle",n.NODE_RECTANGLE="node:rectangle",n.NODE_DIAMOND="node:diamond"})(Dx||(ER.DefaultTypes=Dx={}));var CR={};Object.defineProperty(CR,"__esModule",{value:!0});CR.isGModelElementSchema=void 0;const Tx=Oe;function h0e(n){return typeof n=="object"&&(0,Tx.hasStringProp)(n,"type")&&(0,Tx.hasStringProp)(n,"id")}CR.isGModelElementSchema=h0e;var eq={};(function(n){var e=l&&l.__createBinding||(Object.create?function(r,s,a,f){f===void 0&&(f=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(r,f,h)}:function(r,s,a,f){f===void 0&&(f=a),r[f]=s[a]}),t=l&&l.__exportStar||function(r,s){for(var a in r)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,r,a)};Object.defineProperty(n,"__esModule",{value:!0}),n.getSubType=n.getBasicType=n.findElement=n.cloneModel=n.applyBounds=n.isZoomable=n.isScrollable=void 0;var i=Hl;Object.defineProperty(n,"isScrollable",{enumerable:!0,get:function(){return i.isScrollable}}),Object.defineProperty(n,"isZoomable",{enumerable:!0,get:function(){return i.isZoomable}}),t(Cf,n),t(De,n),t(j6,n);var o=jn;Object.defineProperty(n,"applyBounds",{enumerable:!0,get:function(){return o.applyBounds}}),Object.defineProperty(n,"cloneModel",{enumerable:!0,get:function(){return o.cloneModel}}),Object.defineProperty(n,"findElement",{enumerable:!0,get:function(){return o.findElement}}),Object.defineProperty(n,"getBasicType",{enumerable:!0,get:function(){return o.getBasicType}}),Object.defineProperty(n,"getSubType",{enumerable:!0,get:function(){return o.getSubType}})})(eq);var tq={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ViewportResult=n.SetViewportAction=n.SetBoundsAction=n.SelectionResult=n.OpenAction=n.MoveAction=n.HoverFeedbackAction=n.GetViewportAction=n.GetSelectionAction=n.CollapseExpandAllAction=n.CollapseExpandAction=n.BringToFrontAction=void 0;const e=se;Object.defineProperty(n,"BringToFrontAction",{enumerable:!0,get:function(){return e.BringToFrontAction}}),Object.defineProperty(n,"CollapseExpandAction",{enumerable:!0,get:function(){return e.CollapseExpandAction}}),Object.defineProperty(n,"CollapseExpandAllAction",{enumerable:!0,get:function(){return e.CollapseExpandAllAction}}),Object.defineProperty(n,"GetSelectionAction",{enumerable:!0,get:function(){return e.GetSelectionAction}}),Object.defineProperty(n,"GetViewportAction",{enumerable:!0,get:function(){return e.GetViewportAction}}),Object.defineProperty(n,"HoverFeedbackAction",{enumerable:!0,get:function(){return e.HoverFeedbackAction}}),Object.defineProperty(n,"MoveAction",{enumerable:!0,get:function(){return e.MoveAction}}),Object.defineProperty(n,"OpenAction",{enumerable:!0,get:function(){return e.OpenAction}}),Object.defineProperty(n,"SelectionResult",{enumerable:!0,get:function(){return e.SelectionResult}}),Object.defineProperty(n,"SetBoundsAction",{enumerable:!0,get:function(){return e.SetBoundsAction}}),Object.defineProperty(n,"SetViewportAction",{enumerable:!0,get:function(){return e.SetViewportAction}}),Object.defineProperty(n,"ViewportResult",{enumerable:!0,get:function(){return e.ViewportResult}});const t=at,i=Oe;e.CollapseExpandAction.is=o=>t.Action.hasKind(o,e.CollapseExpandAction.KIND)&&(0,i.hasArrayProp)(o,"expandIds")&&(0,i.hasArrayProp)(o,"collapseIds"),e.CollapseExpandAllAction.is=o=>t.Action.hasKind(o,e.CollapseExpandAllAction.KIND)&&(0,i.hasBooleanProp)(o,"expand"),e.GetSelectionAction.is=o=>t.RequestAction.hasKind(o,e.GetSelectionAction.KIND),e.GetViewportAction.is=o=>t.RequestAction.hasKind(o,e.GetViewportAction.KIND),e.HoverFeedbackAction.is=o=>t.Action.hasKind(o,e.HoverFeedbackAction.KIND)&&(0,i.hasStringProp)(o,"mouseoverElement")&&(0,i.hasBooleanProp)(o,"mouseIsOver"),e.MoveAction.is=o=>t.Action.hasKind(o,e.MoveAction.KIND)&&(0,i.hasArrayProp)(o,"moves")&&(0,i.hasBooleanProp)(o,"animate")&&(0,i.hasBooleanProp)(o,"finished"),e.OpenAction.is=o=>t.Action.hasKind(o,e.OpenAction.KIND)&&(0,i.hasStringProp)(o,"elementId"),e.SelectionResult.is=o=>t.Action.hasKind(o,e.SelectionResult.KIND)&&(0,i.hasArrayProp)(o,"selectedElementsIDs"),e.SetBoundsAction.is=o=>t.Action.hasKind(o,e.SetBoundsAction.KIND)&&(0,i.hasObjectProp)(o,"bounds"),e.SetViewportAction.is=o=>t.Action.hasKind(o,e.SetViewportAction.KIND)&&(0,i.hasStringProp)(o,"elementId")&&(0,i.hasObjectProp)(o,"newViewport")&&(0,i.hasBooleanProp)(o,"animate"),e.ViewportResult.is=o=>t.Action.hasKind(o,e.ViewportResult.KIND)&&(0,i.hasObjectProp)(o,"viewport")&&(0,i.hasObjectProp)(o,"canvasBounds")})(tq);var nq={},X7={},Rg={};Object.defineProperty(Rg,"__esModule",{value:!0});Rg.equalUpTo=void 0;function p0e(n,e,t=Number.EPSILON){return Math.abs(n-e)<=t}Rg.equalUpTo=p0e;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Dimension=void 0;const e=De;Object.defineProperty(n,"Dimension",{enumerable:!0,get:function(){return e.Dimension}});const t=Rg,i=Oe;e.Dimension.ZERO=Object.freeze({width:0,height:0}),e.Dimension.is=o=>i.AnyObject.is(o)&&(0,i.hasNumberProp)(o,"width")&&(0,i.hasNumberProp)(o,"height"),e.Dimension.center=o=>({x:o.width*.5,y:o.height*.5}),e.Dimension.add=(o,r)=>({width:o.width+r.width,height:o.height+r.height}),e.Dimension.subtract=(o,r)=>({width:o.width-r.width,height:o.height-r.height}),e.Dimension.multiplyMeasure=(o,r)=>({width:o.width*r,height:o.height*r}),e.Dimension.divideMeasure=(o,r)=>({width:o.width/r,height:o.height/r}),e.Dimension.map=(o,r)=>({...o,width:r(o.width,"width"),height:r(o.height,"height")}),e.Dimension.equals=(o,r,s)=>(0,t.equalUpTo)(o.width,r.width,s)&&(0,t.equalUpTo)(o.height,r.height,s),e.Dimension.fromPoint=o=>({width:o.x,height:o.y}),e.Dimension.area=o=>o.width*o.height})(X7);var PR={},Mg={},sb={};Object.defineProperty(sb,"__esModule",{value:!0});sb.Direction=void 0;sb.Direction={Left:"left",Right:"right",Up:"up",Down:"down"};Object.defineProperty(Mg,"__esModule",{value:!0});Mg.Vector=void 0;const RE=sb,LD=Oe;var Ox;(function(n){n.ZERO=Object.freeze({x:0,y:0});function e(j){return{x:Math.abs(j.x),y:Math.abs(j.y)}}n.abs=e;function t(j,U){return{x:j.x+U.x,y:j.y+U.y}}n.add=t;function i(j,U){return j.x===U.x&&j.y===U.y}n.equals=i;function o(j){return j!==void 0&&!isNaN(j.x)&&!isNaN(j.y)}n.isValid=o;function r(j){return Math.sqrt(Math.pow(j.x,2)+Math.pow(j.y,2))}n.magnitude=r;function s(j,U){return{...j,x:U(j.x,"x"),y:U(j.y,"y")}}n.map=s;function a(j){const U=r(j);return U===0||U===1?n.ZERO:{x:j.x/U,y:j.y/U}}n.normalize=a;function f(j){return n.equals(j,n.ZERO)}n.isZero=f;function h(j){return LD.AnyObject.is(j)&&(0,LD.hasNumberProp)(j,"x")&&(0,LD.hasNumberProp)(j,"y")}n.is=h;function g(j,U){return n.map(j,p=>p/U)}n.divide=g;function y(j,U){return n.map(j,p=>p*U)}n.multiply=y;function S(j,U){return{x:j.x-U.x,y:j.y-U.y}}n.subtract=S;function P(j){return{x:-j.x,y:-j.y}}n.reverse=P;function w(j){const U=[];return j.x<0?U.push(RE.Direction.Left):j.x>0&&U.push(RE.Direction.Right),j.y<0?U.push(RE.Direction.Up):j.y>0&&U.push(RE.Direction.Down),U}n.direction=w;function C(...j){return{x:Math.min(...j.map(U=>U.x)),y:Math.min(...j.map(U=>U.y))}}n.min=C;function E(...j){return{x:Math.max(...j.map(U=>U.x)),y:Math.max(...j.map(U=>U.y))}}n.max=E;function D(...j){return j.length===0?n.ZERO:{x:j.reduce((U,p)=>U+p.x,0)/j.length,y:j.reduce((U,p)=>U+p.y,0)/j.length}}n.avg=D})(Ox||(Mg.Vector=Ox={}));(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Point=void 0;const e=De;Object.defineProperty(n,"Point",{enumerable:!0,get:function(){return e.Point}});const t=Mg,i=Rg,o=Oe;e.Point.is=r=>o.AnyObject.is(r)&&(0,o.hasNumberProp)(r,"x")&&(0,o.hasNumberProp)(r,"y"),e.Point.isOrigin=r=>e.Point.equals(r,e.Point.ORIGIN),e.Point.isValid=r=>r!==void 0&&!isNaN(r.x)&&!isNaN(r.y),e.Point.abs=r=>e.Point.map(r,Math.abs),e.Point.divideScalar=(r,s)=>e.Point.map(r,a=>a/s),e.Point.multiplyScalar=(r,s)=>e.Point.map(r,a=>a*s),e.Point.map=(r,s)=>({...r,x:s(r.x,"x"),y:s(r.y,"y")}),e.Point.snapToGrid=(r,s,a)=>{if(a){const f=e.Point.subtract(r,a),h=e.Point.snapToGrid(f,s);return e.Point.add(a,h)}else return{x:Math.round(r.x/s.x)*s.x,y:Math.round(r.y/s.y)*s.y}},e.Point.vector=(r,s)=>e.Point.subtract(s,r),e.Point.move=(r,s)=>{const a=e.Point.vector(r,s),f=t.Vector.direction(a);return{from:r,to:s,vector:a,direction:f}},e.Point.moveTowards=(r,s)=>{const a=e.Point.add(r,s),f=t.Vector.direction(s);return{from:r,to:a,vector:s,direction:f}},e.Point.equals=(r,s,a)=>(0,i.equalUpTo)(r.x,s.x,a)&&(0,i.equalUpTo)(r.y,s.y,a)})(PR);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Bounds=void 0;const e=De;Object.defineProperty(n,"Bounds",{enumerable:!0,get:function(){return e.Bounds}});const t=X7,i=PR,o=Oe;e.Bounds.ZERO=Object.freeze({x:0,y:0,width:0,height:0}),e.Bounds.is=r=>o.AnyObject.is(r)&&(0,o.hasNumberProp)(r,"x")&&(0,o.hasNumberProp)(r,"y")&&(0,o.hasNumberProp)(r,"width")&&(0,o.hasNumberProp)(r,"height"),e.Bounds.isValid=r=>r!==void 0&&t.Dimension.isValid(r)&&i.Point.isValid(r),e.Bounds.encompasses=(r,s)=>e.Bounds.includes(r,e.Bounds.topLeft(s))&&e.Bounds.includes(r,e.Bounds.bottomRight(s)),e.Bounds.overlap=(r,s,a)=>{const f=e.Bounds.topLeft(r),h=e.Bounds.bottomRight(r),g=e.Bounds.topLeft(s),y=e.Bounds.bottomRight(s);return a?f.x<=y.x&&g.x<=h.x&&h.y>=g.y&&y.y>=f.y:f.x<y.x&&g.x<h.x&&h.y>g.y&&y.y>f.y},e.Bounds.equals=(r,s,a)=>i.Point.equals(r,s,a)&&t.Dimension.equals(r,s,a),e.Bounds.left=r=>r.x,e.Bounds.centerX=r=>r.x+(r.width>=0?r.width*.5:0),e.Bounds.right=r=>r.x+r.width,e.Bounds.top=r=>r.y,e.Bounds.middle=r=>r.y+(r.height>=0?r.height*.5:0),e.Bounds.centerY=e.Bounds.middle,e.Bounds.bottom=r=>r.y+r.height,e.Bounds.topLeft=r=>({x:e.Bounds.left(r),y:e.Bounds.top(r)}),e.Bounds.topCenter=r=>({x:e.Bounds.centerX(r),y:e.Bounds.top(r)}),e.Bounds.topRight=r=>({x:e.Bounds.right(r),y:e.Bounds.top(r)}),e.Bounds.middleLeft=r=>({x:e.Bounds.left(r),y:e.Bounds.middle(r)}),e.Bounds.middleCenter=r=>({x:e.Bounds.centerX(r),y:e.Bounds.middle(r)}),e.Bounds.middleRight=r=>({x:e.Bounds.right(r),y:e.Bounds.middle(r)}),e.Bounds.bottomLeft=r=>({x:e.Bounds.left(r),y:e.Bounds.bottom(r)}),e.Bounds.bottomCenter=r=>({x:e.Bounds.centerX(r),y:e.Bounds.bottom(r)}),e.Bounds.bottomRight=r=>({x:e.Bounds.right(r),y:e.Bounds.bottom(r)}),e.Bounds.isAbove=(r,s)=>e.Bounds.top(r)<=e.Bounds.top(s),e.Bounds.isBelow=(r,s)=>e.Bounds.top(r)>=e.Bounds.top(s),e.Bounds.isBefore=(r,s)=>e.Bounds.left(r)<e.Bounds.left(s),e.Bounds.isAfter=(r,s)=>e.Bounds.left(r)>=e.Bounds.left(s),e.Bounds.sortBy=(r,...s)=>s.sort((a,f)=>r(a)-r(f)),e.Bounds.from=(r,s)=>({...r,width:s.x-r.x,height:s.y-r.y}),e.Bounds.position=e.Bounds.topLeft,e.Bounds.dimension=r=>({width:r.width,height:r.height}),e.Bounds.move=e.Bounds.translate,e.Bounds.resize=(r,s)=>({...r,width:r.width+s.width,height:r.height+s.height})})(nq);var am={};Object.defineProperty(am,"__esModule",{value:!0});am.DisposableCollection=am.Disposable=void 0;const Lx=lt,Nx=Oe;var v_;(function(n){function e(o){return Nx.AnyObject.is(o)&&(0,Nx.hasFunctionProp)(o,"dispose")}n.is=e;function t(){return{dispose:()=>{}}}n.empty=t;function i(o){return{dispose:o}}n.create=i})(v_||(am.Disposable=v_={}));class m0e{constructor(...e){this.disposables=[],e.forEach(t=>this.push(t)),this.errorHandler=t=>console.error(t)}dispose(){var e,t;if(!this.disposed)try{for(;!this.disposed;)(e=this.disposables.pop())===null||e===void 0||e.dispose()}catch(i){(t=this.errorHandler)===null||t===void 0||t.call(this,i)}}get disposed(){return this.disposables.length===0}push(...e){const t=(0,Lx.isArrayOfType)(e,v_.is)?e:e.map(v_.create);return this.disposables.push(...t),v_.create(()=>(0,Lx.remove)(this.disposables,...t))}get isDisposed(){return this.disposed}clear(){this.disposables.length=0}}am.DisposableCollection=m0e;var wR={};Object.defineProperty(wR,"__esModule",{value:!0});wR.Movement=void 0;const zh=PR,ME=Mg,Sv=Oe;var jx;(function(n){n.ZERO=Object.freeze({from:zh.Point.ORIGIN,to:zh.Point.ORIGIN,vector:ME.Vector.ZERO,direction:[]});function e(r){return Sv.AnyObject.is(r)&&(0,Sv.hasObjectProp)(r,"from")&&zh.Point.is(r.from)&&(0,Sv.hasObjectProp)(r,"to")&&zh.Point.is(r.to)&&(0,Sv.hasObjectProp)(r,"vector")&&ME.Vector.is(r.to)&&(0,Sv.hasObjectProp)(r,"direction")}n.is=e;function t(r){return ME.Vector.isZero(r.vector)}n.isStationary=t;function i(r){return n.equals(r,n.ZERO)}n.isZero=i;function o(r,s){return zh.Point.equals(r.from,s.from)&&zh.Point.equals(r.to,s.to)&&ME.Vector.equals(r.vector,s.vector)}n.equals=o})(jx||(wR.Movement=jx={}));(function(n){var e=l&&l.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=l&&l.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(at,n),t(Sr,n),t(zs,n),t(Qp,n),t(Xp,n),t(Gs,n),t(Jp,n),t(Ii,n),t(em,n),t(Us,n),t(Ys,n),t(Er,n),t(qs,n),t(tm,n),t(xd,n),t(Ws,n),t(nm,n),t(Ul,n),t(Zs,n),t(im,n),t(om,n),t(LY,n),t(as,n),t(zd,n),t(Yl,n),t(Ag,n),t(bR,n),t(Go,n),t(SR,n),t(sm,n),t(JY,n),t(ER,n),t(CR,n),t(eq,n),t(tq,n),t(nq,n),t(X7,n),t(PR,n),t(lt,n),t(am,n),t(Pg,n),t(wR,n),t(sb,n),t(Mg,n),t(Rg,n),t(Oe,n)})(ct);(function(n){var e=l&&l.__createBinding||(Object.create?function(Z,H,M,Y){Y===void 0&&(Y=M);var te=Object.getOwnPropertyDescriptor(H,M);(!te||("get"in te?!H.__esModule:te.writable||te.configurable))&&(te={enumerable:!0,get:function(){return H[M]}}),Object.defineProperty(Z,Y,te)}:function(Z,H,M,Y){Y===void 0&&(Y=M),Z[Y]=H[M]}),t=l&&l.__exportStar||function(Z,H){for(var M in Z)M!=="default"&&!Object.prototype.hasOwnProperty.call(H,M)&&e(H,Z,M)};Object.defineProperty(n,"__esModule",{value:!0}),n.isFadeable=n.fadeFeature=n.SvgExporter=n.ExportSvgPostprocessor=n.ExportSvgKeyListener=n.ExportSvgCommand=n.isExpandable=n.expandFeature=n.isEdgeLayoutable=n.edgeLayoutFeature=n.checkEdgePlacement=n.DEFAULT_EDGE_PLACEMENT=n.DeleteContextMenuItemProvider=n.ContextMenuProviderRegistry=n.RevealNamedElementActionProvider=n.CommandPaletteActionProviderRegistry=n.GButton=n.configureButtonHandler=n.ButtonHandlerRegistry=n.layoutableChildFeature=n.layoutContainerFeature=n.isSizeable=n.isLayoutableChild=n.isLayoutContainer=n.isBoundsAware=n.isAlignable=n.getAbsoluteClientBounds=n.getAbsoluteBounds=n.findChildrenAtPosition=n.boundsFeature=n.alignFeature=n.GShapeElement=n.PopupMouseTool=n.MouseTool=n.MousePositionTracker=n.KeyTool=n.createFeatureSet=n.SModelRegistry=n.GModelFactory=n.EMPTY_ROOT=n.isParent=n.createRandomId=n.ModelIndexImpl=n.GParentElement=n.GModelRoot=n.GModelElement=n.GChildElement=n.onAction=n.configureActionHandler=n.ActionHandlerRegistry=void 0,n.PolylineEdgeViewWithGapsOnIntersections=n.PolylineEdgeView=n.JumpingPolylineEdgeView=n.GRoutingHandleView=n.GLabelView=n.GCompartmentView=n.GBezierCreateHandleView=n.GBezierControlHandleView=n.BezierCurveEdgeView=n.SGraphImpl=n.SEdgeImpl=n.GPort=n.GNode=n.GLabel=n.GGraphIndex=n.GCompartment=n.GViewportRootElement=n.SprottySelectCommand=n.SprottySelectAllCommand=n.SelectMouseListener=n.SelectKeyboardListener=n.GetSelectionCommand=n.selectFeature=n.isSelected=n.isSelectable=n.isConnectable=n.getRouteBounds=n.getAbsoluteRouteBounds=n.edgeInProgressTargetHandleID=n.edgeInProgressID=n.connectableFeature=n.GRoutingHandle=n.GRoutableElement=n.GDanglingAnchor=n.GConnectableElement=n.isProjectable=n.getProjections=n.getProjectedBounds=n.getModelBounds=n.moveFeature=n.isMoveable=n.isLocateable=n.isDecoration=n.decorationFeature=n.SIssueMarkerImpl=n.GDecoration=n.popupFeature=n.isHoverable=n.hoverFeedbackFeature=n.hasPopupFeature=void 0,n.SvgViewportView=n.RectangularNodeView=n.EmptyGroupView=n.RectangularPort=n.RectangularNode=n.GShapedPreRenderedElement=n.GPreRenderedElement=n.GHtmlRoot=n.GForeignObjectElement=n.DiamondNode=n.CircularPort=n.CircularNode=n.SGraphView=void 0,t(ct,n),t(H7,n),t(Nu,n);var i=qo;Object.defineProperty(n,"ActionHandlerRegistry",{enumerable:!0,get:function(){return i.ActionHandlerRegistry}}),Object.defineProperty(n,"configureActionHandler",{enumerable:!0,get:function(){return i.configureActionHandler}}),Object.defineProperty(n,"onAction",{enumerable:!0,get:function(){return i.onAction}}),t(Pf,n),t(Or,n),t(Pa,n),t(rg,n),t(Ve,n),t(wn,n),t(wf,n),t(aA,n),t(Eo,n),t(ju,n);var o=ke;Object.defineProperty(n,"GChildElement",{enumerable:!0,get:function(){return o.SChildElementImpl}}),Object.defineProperty(n,"GModelElement",{enumerable:!0,get:function(){return o.SModelElementImpl}}),Object.defineProperty(n,"GModelRoot",{enumerable:!0,get:function(){return o.SModelRootImpl}}),Object.defineProperty(n,"GParentElement",{enumerable:!0,get:function(){return o.SParentElementImpl}}),Object.defineProperty(n,"ModelIndexImpl",{enumerable:!0,get:function(){return o.ModelIndexImpl}}),Object.defineProperty(n,"createRandomId",{enumerable:!0,get:function(){return o.createRandomId}}),Object.defineProperty(n,"isParent",{enumerable:!0,get:function(){return o.isParent}});var r=$n;Object.defineProperty(n,"EMPTY_ROOT",{enumerable:!0,get:function(){return r.EMPTY_ROOT}}),Object.defineProperty(n,"GModelFactory",{enumerable:!0,get:function(){return r.SModelFactory}}),Object.defineProperty(n,"SModelRegistry",{enumerable:!0,get:function(){return r.SModelRegistry}}),Object.defineProperty(n,"createFeatureSet",{enumerable:!0,get:function(){return r.createFeatureSet}}),t(yt,n),t(sa,n),t(Co,n),t(Aa,n);var s=gi;Object.defineProperty(n,"KeyTool",{enumerable:!0,get:function(){return s.KeyTool}});var a=Ut;Object.defineProperty(n,"MousePositionTracker",{enumerable:!0,get:function(){return a.MousePositionTracker}}),Object.defineProperty(n,"MouseTool",{enumerable:!0,get:function(){return a.MouseTool}}),Object.defineProperty(n,"PopupMouseTool",{enumerable:!0,get:function(){return a.PopupMouseTool}}),t(dc,n),t(rn,n),t(Qn,n),t(Mf,n),t(fA,n),t(If,n),t(ft,n),t(Bu,n),t(hs,n),t(Tf,n),t(mA,n),t(Yi,n);var f=$t;Object.defineProperty(n,"GShapeElement",{enumerable:!0,get:function(){return f.SShapeElementImpl}}),Object.defineProperty(n,"alignFeature",{enumerable:!0,get:function(){return f.alignFeature}}),Object.defineProperty(n,"boundsFeature",{enumerable:!0,get:function(){return f.boundsFeature}}),Object.defineProperty(n,"findChildrenAtPosition",{enumerable:!0,get:function(){return f.findChildrenAtPosition}}),Object.defineProperty(n,"getAbsoluteBounds",{enumerable:!0,get:function(){return f.getAbsoluteBounds}}),Object.defineProperty(n,"getAbsoluteClientBounds",{enumerable:!0,get:function(){return f.getAbsoluteClientBounds}}),Object.defineProperty(n,"isAlignable",{enumerable:!0,get:function(){return f.isAlignable}}),Object.defineProperty(n,"isBoundsAware",{enumerable:!0,get:function(){return f.isBoundsAware}}),Object.defineProperty(n,"isLayoutContainer",{enumerable:!0,get:function(){return f.isLayoutContainer}}),Object.defineProperty(n,"isLayoutableChild",{enumerable:!0,get:function(){return f.isLayoutableChild}}),Object.defineProperty(n,"isSizeable",{enumerable:!0,get:function(){return f.isSizeable}}),Object.defineProperty(n,"layoutContainerFeature",{enumerable:!0,get:function(){return f.layoutContainerFeature}}),Object.defineProperty(n,"layoutableChildFeature",{enumerable:!0,get:function(){return f.layoutableChildFeature}}),t(Df,n),t(xc,n);var h=ps;Object.defineProperty(n,"ButtonHandlerRegistry",{enumerable:!0,get:function(){return h.ButtonHandlerRegistry}}),Object.defineProperty(n,"configureButtonHandler",{enumerable:!0,get:function(){return h.configureButtonHandler}});var g=lg;Object.defineProperty(n,"GButton",{enumerable:!0,get:function(){return g.SButtonImpl}});var y=ms;Object.defineProperty(n,"CommandPaletteActionProviderRegistry",{enumerable:!0,get:function(){return y.CommandPaletteActionProviderRegistry}}),Object.defineProperty(n,"RevealNamedElementActionProvider",{enumerable:!0,get:function(){return y.RevealNamedElementActionProvider}}),t(uc,n);var S=gs;Object.defineProperty(n,"ContextMenuProviderRegistry",{enumerable:!0,get:function(){return S.ContextMenuProviderRegistry}}),Object.defineProperty(n,"DeleteContextMenuItemProvider",{enumerable:!0,get:function(){return S.DeleteContextMenuItemProvider}}),t(Nf,n),t(Kl,n),t(jf,n);var P=Bf;Object.defineProperty(n,"DEFAULT_EDGE_PLACEMENT",{enumerable:!0,get:function(){return P.DEFAULT_EDGE_PLACEMENT}}),Object.defineProperty(n,"checkEdgePlacement",{enumerable:!0,get:function(){return P.checkEdgePlacement}}),Object.defineProperty(n,"edgeLayoutFeature",{enumerable:!0,get:function(){return P.edgeLayoutFeature}}),Object.defineProperty(n,"isEdgeLayoutable",{enumerable:!0,get:function(){return P.isEdgeLayoutable}}),t(Lf,n),t(_n,n),t(aa,n),t(_s,n),t($f,n),t(Hf,n);var w=O0;Object.defineProperty(n,"expandFeature",{enumerable:!0,get:function(){return w.expandFeature}}),Object.defineProperty(n,"isExpandable",{enumerable:!0,get:function(){return w.isExpandable}}),t(pg,n);var C=qi;Object.defineProperty(n,"ExportSvgCommand",{enumerable:!0,get:function(){return C.ExportSvgCommand}}),Object.defineProperty(n,"ExportSvgKeyListener",{enumerable:!0,get:function(){return C.ExportSvgKeyListener}}),Object.defineProperty(n,"ExportSvgPostprocessor",{enumerable:!0,get:function(){return C.ExportSvgPostprocessor}}),t(P0,n);var E=rr;Object.defineProperty(n,"SvgExporter",{enumerable:!0,get:function(){return E.SvgExporter}}),t(da,n);var D=Of;Object.defineProperty(n,"fadeFeature",{enumerable:!0,get:function(){return D.fadeFeature}}),Object.defineProperty(n,"isFadeable",{enumerable:!0,get:function(){return D.isFadeable}}),t(fn,n);var j=$u;Object.defineProperty(n,"hasPopupFeature",{enumerable:!0,get:function(){return j.hasPopupFeature}}),Object.defineProperty(n,"hoverFeedbackFeature",{enumerable:!0,get:function(){return j.hoverFeedbackFeature}}),Object.defineProperty(n,"isHoverable",{enumerable:!0,get:function(){return j.isHoverable}}),Object.defineProperty(n,"popupFeature",{enumerable:!0,get:function(){return j.popupFeature}}),t(yg,n),t(Vf,n);var U=B0;Object.defineProperty(n,"GDecoration",{enumerable:!0,get:function(){return U.SDecoration}}),Object.defineProperty(n,"SIssueMarkerImpl",{enumerable:!0,get:function(){return U.SIssueMarkerImpl}}),Object.defineProperty(n,"decorationFeature",{enumerable:!0,get:function(){return U.decorationFeature}}),Object.defineProperty(n,"isDecoration",{enumerable:!0,get:function(){return U.isDecoration}}),t(Kf,n),t(Zn,n),t(Ln,n),t(zf,n);var p=Hc;Object.defineProperty(n,"isLocateable",{enumerable:!0,get:function(){return p.isLocateable}}),Object.defineProperty(n,"isMoveable",{enumerable:!0,get:function(){return p.isMoveable}}),Object.defineProperty(n,"moveFeature",{enumerable:!0,get:function(){return p.moveFeature}}),t(Xn,n),t(mg,n),t(vA,n),t(MA,n),t(gg,n);var b=Uo;Object.defineProperty(n,"getModelBounds",{enumerable:!0,get:function(){return b.getModelBounds}}),Object.defineProperty(n,"getProjectedBounds",{enumerable:!0,get:function(){return b.getProjectedBounds}}),Object.defineProperty(n,"getProjections",{enumerable:!0,get:function(){return b.getProjections}}),Object.defineProperty(n,"isProjectable",{enumerable:!0,get:function(){return b.isProjectable}}),t(vg,n),t(Qo,n),t(Ra,n),t(Xo,n),t(Wi,n),t(Jo,n),t(Gf,n);var v=an;Object.defineProperty(n,"GConnectableElement",{enumerable:!0,get:function(){return v.SConnectableElementImpl}}),Object.defineProperty(n,"GDanglingAnchor",{enumerable:!0,get:function(){return v.SDanglingAnchorImpl}}),Object.defineProperty(n,"GRoutableElement",{enumerable:!0,get:function(){return v.SRoutableElementImpl}}),Object.defineProperty(n,"GRoutingHandle",{enumerable:!0,get:function(){return v.SRoutingHandleImpl}}),Object.defineProperty(n,"connectableFeature",{enumerable:!0,get:function(){return v.connectableFeature}}),Object.defineProperty(n,"edgeInProgressID",{enumerable:!0,get:function(){return v.edgeInProgressID}}),Object.defineProperty(n,"edgeInProgressTargetHandleID",{enumerable:!0,get:function(){return v.edgeInProgressTargetHandleID}}),Object.defineProperty(n,"getAbsoluteRouteBounds",{enumerable:!0,get:function(){return v.getAbsoluteRouteBounds}}),Object.defineProperty(n,"getRouteBounds",{enumerable:!0,get:function(){return v.getRouteBounds}}),Object.defineProperty(n,"isConnectable",{enumerable:!0,get:function(){return v.isConnectable}}),t(Po,n),t(Kc,n),t(vi,n),t(Uf,n);var R=to;Object.defineProperty(n,"isSelectable",{enumerable:!0,get:function(){return R.isSelectable}}),Object.defineProperty(n,"isSelected",{enumerable:!0,get:function(){return R.isSelected}}),Object.defineProperty(n,"selectFeature",{enumerable:!0,get:function(){return R.selectFeature}});var O=fi;Object.defineProperty(n,"GetSelectionCommand",{enumerable:!0,get:function(){return O.GetSelectionCommand}}),Object.defineProperty(n,"SelectKeyboardListener",{enumerable:!0,get:function(){return O.SelectKeyboardListener}}),Object.defineProperty(n,"SelectMouseListener",{enumerable:!0,get:function(){return O.SelectMouseListener}}),Object.defineProperty(n,"SprottySelectAllCommand",{enumerable:!0,get:function(){return O.SelectAllCommand}}),Object.defineProperty(n,"SprottySelectCommand",{enumerable:!0,get:function(){return O.SelectCommand}}),t(ss,n),t(Fu,n),t(Oi,n),t(Rs,n),t(mc,n),t(wo,n);var N=kf;Object.defineProperty(n,"GViewportRootElement",{enumerable:!0,get:function(){return N.ViewportRootElementImpl}}),t(fc,n),t(Yf,n);var T=Sn;Object.defineProperty(n,"GCompartment",{enumerable:!0,get:function(){return T.SCompartmentImpl}}),Object.defineProperty(n,"GGraphIndex",{enumerable:!0,get:function(){return T.SGraphIndex}}),Object.defineProperty(n,"GLabel",{enumerable:!0,get:function(){return T.SLabelImpl}}),Object.defineProperty(n,"GNode",{enumerable:!0,get:function(){return T.SNodeImpl}}),Object.defineProperty(n,"GPort",{enumerable:!0,get:function(){return T.SPortImpl}}),Object.defineProperty(n,"SEdgeImpl",{enumerable:!0,get:function(){return T.SEdgeImpl}}),Object.defineProperty(n,"SGraphImpl",{enumerable:!0,get:function(){return T.SGraphImpl}});var $=gt;Object.defineProperty(n,"BezierCurveEdgeView",{enumerable:!0,get:function(){return $.BezierCurveEdgeView}}),Object.defineProperty(n,"GBezierControlHandleView",{enumerable:!0,get:function(){return $.SBezierControlHandleView}}),Object.defineProperty(n,"GBezierCreateHandleView",{enumerable:!0,get:function(){return $.SBezierCreateHandleView}}),Object.defineProperty(n,"GCompartmentView",{enumerable:!0,get:function(){return $.SCompartmentView}}),Object.defineProperty(n,"GLabelView",{enumerable:!0,get:function(){return $.SLabelView}}),Object.defineProperty(n,"GRoutingHandleView",{enumerable:!0,get:function(){return $.SRoutingHandleView}}),Object.defineProperty(n,"JumpingPolylineEdgeView",{enumerable:!0,get:function(){return $.JumpingPolylineEdgeView}}),Object.defineProperty(n,"PolylineEdgeView",{enumerable:!0,get:function(){return $.PolylineEdgeView}}),Object.defineProperty(n,"PolylineEdgeViewWithGapsOnIntersections",{enumerable:!0,get:function(){return $.PolylineEdgeViewWithGapsOnIntersections}}),Object.defineProperty(n,"SGraphView",{enumerable:!0,get:function(){return $.SGraphView}}),t(gc,n),t(bg,n),t(ei,n);var Q=Mt;Object.defineProperty(n,"CircularNode",{enumerable:!0,get:function(){return Q.CircularNode}}),Object.defineProperty(n,"CircularPort",{enumerable:!0,get:function(){return Q.CircularPort}}),Object.defineProperty(n,"DiamondNode",{enumerable:!0,get:function(){return Q.DiamondNode}}),Object.defineProperty(n,"GForeignObjectElement",{enumerable:!0,get:function(){return Q.ForeignObjectElementImpl}}),Object.defineProperty(n,"GHtmlRoot",{enumerable:!0,get:function(){return Q.HtmlRootImpl}}),Object.defineProperty(n,"GPreRenderedElement",{enumerable:!0,get:function(){return Q.PreRenderedElementImpl}}),Object.defineProperty(n,"GShapedPreRenderedElement",{enumerable:!0,get:function(){return Q.ShapedPreRenderedElementImpl}}),Object.defineProperty(n,"RectangularNode",{enumerable:!0,get:function(){return Q.RectangularNode}}),Object.defineProperty(n,"RectangularPort",{enumerable:!0,get:function(){return Q.RectangularPort}}),t(q0,n);var K=zn;Object.defineProperty(n,"EmptyGroupView",{enumerable:!0,get:function(){return K.EmptyGroupView}}),Object.defineProperty(n,"RectangularNodeView",{enumerable:!0,get:function(){return K.RectangularNodeView}}),Object.defineProperty(n,"SvgViewportView",{enumerable:!0,get:function(){return K.SvgViewportView}}),t(vs,n),t(Sg,n),t(or,n),t(sn,n),t(_A,n),t(oc,n),t(Jn,n),t(wa,n),t(Mo,n),t(qt,n),t(Wo,n),t(pn,n)})(SY);var Ar={},iq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Ar,"__esModule",{value:!0});Ar.applyHiddenBoundingRect=Ar.hiddenBoundingRect=Ar.CircularNodeView=Ar.DiamondNodeView=void 0;const g0e=ct,oq=F,hy=tA;let U8=class extends hy.DiamondNodeView{render(e,t,i){return J7(e,t,super.render(e,t,i))}};Ar.DiamondNodeView=U8;Ar.DiamondNodeView=U8=iq([(0,oq.injectable)()],U8);let Y8=class extends hy.CircularNodeView{render(e,t,i){return J7(e,t,super.render(e,t,i))}};Ar.CircularNodeView=Y8;Ar.CircularNodeView=Y8=iq([(0,oq.injectable)()],Y8);function rq(n,e){return!e||e.targetKind==="hidden"?(0,hy.svg)("rect",{attrs:{[hy.ATTR_BBOX_ELEMENT]:!0},...g0e.Bounds.dimension(n.bounds),style:{fill:"transparent"}}):void 0}Ar.hiddenBoundingRect=rq;function J7(n,e,t){var i;if(t&&e.targetKind==="hidden"){const o=t.sel==="g"?t:(0,hy.svg)("g",null,t);return(i=o.children)===null||i===void 0||i.unshift(rq(n)),o}return t}Ar.applyHiddenBoundingRect=J7;var AR={};Object.defineProperty(AR,"__esModule",{value:!0});AR.TYPES=void 0;const v0e=tA,Bx=Symbol("IGModelRootListener");AR.TYPES={...v0e.TYPES,IAsyncClipboardService:Symbol("IAsyncClipboardService"),IEditorContextServiceProvider:Symbol("IEditorContextProvider"),IFeedbackActionDispatcher:Symbol("IFeedbackActionDispatcher"),IToolFactory:Symbol("Factory<Tool>"),ITypeHintProvider:Symbol("ITypeHintProvider"),IMovementRestrictor:Symbol("IMovementRestrictor"),ISelectionListener:Symbol("ISelectionListener"),ISModelRootListener:Bx,IGModelRootListener:Bx,IContextMenuProvider:Symbol("IContextMenuProvider"),ICopyPasteHandler:Symbol("ICopyPasteHandler"),ITool:Symbol("ITool"),IDefaultTool:Symbol("IDefaultTool"),IEditModeListener:Symbol("IEditModeListener"),IMarqueeBehavior:Symbol("IMarqueeBehavior"),IHelperLineManager:Symbol("IHelperLineManager"),IHelperLineOptions:Symbol("IHelperLineOptions"),IElementNavigator:Symbol("IElementNavigator"),ILocalElementNavigator:Symbol("ILocalElementNavigator"),IDiagramOptions:Symbol("IDiagramOptions"),IDiagramStartup:Symbol("IDiagramStartup"),IToolManager:Symbol("IToolManager"),Grid:Symbol("Grid")};(function(n){var e=l&&l.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=l&&l.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(Xd,n),t(jt,n),t(SY,n),t(Ar,n),t(AR,n)})(z);var Zf={},sq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},aq=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},$x=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Zf,"__esModule",{value:!0});Zf.GLSPActionHandlerRegistry=void 0;const g3=z,v3=F;let tP=class extends g3.ActionHandlerRegistry{constructor(e=[],t=[]){super(e,t),this.initialized=!1}getHandledActionKinds(){return Array.from(this.elements.keys())}initialize(){this.initialized||(this.lazyInjector.getAll(g3.TYPES.ActionHandlerRegistration).forEach(e=>this.register(e.actionKind,e.factory())),this.lazyInjector.getAll(g3.TYPES.IActionHandlerInitializer).forEach(e=>this.initializeActionHandler(e)))}};Zf.GLSPActionHandlerRegistry=tP;sq([(0,v3.inject)(g3.LazyInjector),aq("design:type",Object)],tP.prototype,"lazyInjector",void 0);Zf.GLSPActionHandlerRegistry=tP=sq([(0,v3.injectable)(),$x(0,(0,v3.optional)()),$x(1,(0,v3.optional)()),aq("design:paramtypes",[Array,Array])],tP);var Ao={},RR=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},__=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Ao,"__esModule",{value:!0});Ao.GLSPModelSource=Ao.OptionalAction=Ao.ServerAction=void 0;const $l=z,MR=F;var nP;(function(n){function e(i){return $l.Action.is(i)&&"__receivedFromServer"in i&&i.__receivedFromServer===!0}n.is=e;function t(i){i.__receivedFromServer=!0}n.mark=t})(nP||(Ao.ServerAction=nP={}));var kx;(function(n){function e(i){return $l.Action.is(i)&&"__skipErrorIfNoHandler"in i&&i.__skipErrorIfNoHandler===!0}n.is=e;function t(i){return i.__skipErrorIfNoHandler=!0,i}n.mark=t})(kx||(Ao.OptionalAction=kx={}));let cm=class extends $l.ModelSource{constructor(){super(...arguments),this.toDispose=new $l.DisposableCollection}get diagramType(){return this.options.diagramType}get sourceUri(){return this.options.sourceUri}configure(e){if(this.glspClient=e,!e.initializeResult)throw new Error("Could not configure model source. The GLSP client is not initialized yet!");const t=this.createInitializeClientSessionParameters(e.initializeResult);return this.configureServeActions(e.initializeResult),this.toDispose.push(e.onActionMessage(i=>this.messageReceived(i),this.clientId),$l.Disposable.create(()=>e.disposeClientSession(this.createDisposeClientSessionParameters()))),e.initializeClientSession(t)}createInitializeClientSessionParameters(e){const t=this.registry.getHandledActionKinds();return{clientSessionId:this.clientId,clientActionKinds:t,diagramType:this.diagramType}}createDisposeClientSessionParameters(){return{clientSessionId:this.clientId}}configureServeActions(e){const t=e.serverActions[this.diagramType];if((t==null?void 0:t.length)===0)throw new Error(`No server-handled actions could be derived from the initialize result for diagramType: ${this.diagramType}!`);t.forEach(i=>this.registry.register(i,this))}messageReceived(e){if(this.clientId!==e.clientId)return;const t=e.action;nP.mark(t),this.logger.log(this,"receiving",t),this.actionDispatcher.dispatch(t)}initialize(e){var t;this.clientId||(this.clientId=(t=this.options.clientId)!==null&&t!==void 0?t:this.viewerOptions.baseDiv),this.registry=e}handle(e){this.shouldForwardToServer(e)&&this.forwardToServer(e)}forwardToServer(e){const t={clientId:this.clientId,action:e};if(this.logger.log(this,"sending",t),this.glspClient)this.glspClient.sendActionMessage(t);else throw new Error("GLSPClient is not connected")}shouldForwardToServer(e){return!nP.is(e)}commitModel(e){return this._currentRoot=e,e}get model(){return this._currentRoot}dispose(){this.toDispose.dispose()}};Ao.GLSPModelSource=cm;RR([(0,MR.inject)($l.TYPES.ILogger),__("design:type",Object)],cm.prototype,"logger",void 0);RR([(0,MR.inject)($l.TYPES.IDiagramOptions),__("design:type",Object)],cm.prototype,"options",void 0);RR([(0,MR.preDestroy)(),__("design:type",Function),__("design:paramtypes",[]),__("design:returntype",void 0)],cm.prototype,"dispose",null);Ao.GLSPModelSource=cm=RR([(0,MR.injectable)()],cm);var ys={},cq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(ys,"__esModule",{value:!0});ys.DefaultModelInitializationConstraint=ys.ModelInitializationConstraint=void 0;const dq=F,wp=z;let iP=class{constructor(){this.completion=new wp.Deferred,this._isCompleted=!1,this.onInitializedEmitter=new wp.Emitter}get isCompleted(){return this._isCompleted}onInitialized(e){return e?this.isCompleted?(e(),wp.Disposable.empty()):this.onInitializedEmitter.event(e):this.completion.promise}setCompleted(){this.isCompleted||(this._isCompleted=!0,this.completion.resolve(),this.onInitializedEmitter.fire(),this.onInitializedEmitter.dispose())}notifyDispatched(e){this.isCompleted||this.isInitializedAfter(e)&&this.setCompleted()}};ys.ModelInitializationConstraint=iP;ys.ModelInitializationConstraint=iP=cq([(0,dq.injectable)()],iP);let q8=class extends iP{constructor(){super(...arguments),this.seenNonEmptyModelAction=!1}isInitializedAfter(e){if(this.isNonEmptyModelAction(e))this.seenNonEmptyModelAction=!0;else if(this.seenNonEmptyModelAction&&e.kind===wp.InitializeCanvasBoundsAction.KIND)return!0;return!1}isNonEmptyModelAction(e){return wp.SetModelAction.is(e)||wp.UpdateModelAction.is(e)?e.newRoot.type!=="NONE":!1}};ys.DefaultModelInitializationConstraint=q8;ys.DefaultModelInitializationConstraint=q8=cq([(0,dq.injectable)()],q8);var uq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},_0e=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.GLSPActionDispatcher=void 0;const Gh=z,lq=F,y0e=Zf,b0e=Ao,Fx=ys;let oP=class extends Gh.ActionDispatcher{constructor(){super(...arguments),this.timeouts=new Map,this.initializedConstraint=!1,this.postUpdateQueue=[]}initialize(){return this.initialized||(this.initialized=this.doInitialize()),this.initialized}async doInitialize(){const e=await this.actionHandlerRegistryProvider();this.actionHandlerRegistry=e,e instanceof y0e.GLSPActionHandlerRegistry&&e.initialize(),this.handleAction(Gh.SetModelAction.create(Gh.EMPTY_ROOT)).catch(()=>{}),this.startModelInitialization()}startModelInitialization(){this.initializedConstraint||(this.logger.log(this,"Starting model initialization mode"),this.initializationConstraint.onInitialized(()=>this.logger.log(this,"Model initialization completed")),this.initializedConstraint=!0)}onceModelInitialized(){return this.initializationConstraint.onInitialized()}hasHandler(e){return this.actionHandlerRegistry.get(e.kind).length>0}dispatchOnceModelInitialized(...e){this.initializationConstraint.onInitialized(()=>this.dispatchAll(e))}dispatchAfterNextUpdate(...e){this.postUpdateQueue.push(...e)}modelRootChanged(e){if(this.postUpdateQueue.length===0)return;const t=[...this.postUpdateQueue];this.postUpdateQueue=[],this.dispatchAll(t)}async dispatch(e){const t=await super.dispatch(e);return this.initializationConstraint.notifyDispatched(e),t}handleAction(e){if(Gh.ResponseAction.hasValidResponseId(e)){const t=this.timeouts.get(e.responseId);t!==void 0&&(clearTimeout(t),this.timeouts.delete(e.responseId)),this.requests.get(e.responseId)===void 0&&(e.responseId="")}return!this.hasHandler(e)&&b0e.OptionalAction.is(e)?Promise.resolve():super.handleAction(e)}request(e){return!e.requestId&&e.requestId===""&&(e.requestId=Gh.RequestAction.generateRequestId()),super.request(e)}requestUntil(e,t=2e3,i=!1){!e.requestId&&e.requestId===""&&(e.requestId=Gh.RequestAction.generateRequestId());const o=e.requestId,r=setTimeout(()=>{const s=this.requests.get(o);if(s!==void 0){clearTimeout(r),this.requests.delete(o);const a="Request "+o+" ("+e+") time out after "+t+"ms.";i?s.reject(a):(this.logger.info(this,a),s.resolve())}},t);return this.timeouts.set(o,r),super.request(e)}};Pt.GLSPActionDispatcher=oP;uq([(0,lq.inject)(Fx.ModelInitializationConstraint),_0e("design:type",Fx.ModelInitializationConstraint)],oP.prototype,"initializationConstraint",void 0);Pt.GLSPActionDispatcher=oP=uq([(0,lq.injectable)()],oP);var Ig={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ensureArgs=n.hasArgs=n.isArgsAware=n.argsFeature=void 0,n.argsFeature=Symbol("argsFeature");function e(o){return o!==void 0&&o.hasFeature(n.argsFeature)}n.isArgsAware=e;function t(o){return o!==void 0&&e(o)&&o.args!==void 0}n.hasArgs=t;function i(o){return e(o)?(o.args===void 0&&(o.args={}),!0):!1}n.ensureArgs=i})(Ig);var ab={};Object.defineProperty(ab,"__esModule",{value:!0});ab.AutoCompleteValue=void 0;const xx=z;var Hx;(function(n){function e(t){return xx.LabeledAction.is(t)&&(0,xx.hasStringProp)(t,"text")}n.is=e})(Hx||(ab.AutoCompleteValue=Hx={}));var uu={},ql={};Object.defineProperty(ql,"__esModule",{value:!0});ql.ValidationDecorator=ql.IValidationDecorator=void 0;const IE=z;var Kx;(function(n){n.NO_DECORATION={decorateValidationResult(e){},isValidatedOk(){return!1},invalidate(){},dispose(){}}})(Kx||(ql.IValidationDecorator=Kx={}));class S0e{constructor(e){this.containerElement=e,this.warningClasses=["warning"],this.warningIconClasses=(0,IE.codiconCSSString)("warning"),this.errorClasses=["error"],this.errorIconClasses=(0,IE.codiconCSSString)("error"),this.isValidated=!1,this.hasValidationError=!1}decorateValidationResult(e){IE.ValidationStatus.isError(e)?(this.hasValidationError=!0,this.decorateError(e.message?e.message:"Error")):IE.ValidationStatus.isWarning(e)?(this.hasValidationError=!1,this.decorateWarning(e.message?e.message:"Warning")):(this.hasValidationError=!1,this.dispose()),this.isValidated=!0}decorateError(e){this.switchCssClasses(this.containerElement,this.errorClasses);const t=this.createDecorationDiv();this.switchCssClasses(t,this.errorClasses),t.innerHTML=`<span class="${this.errorIconClasses}"></span> ${e}`,this.adjustPosition()}decorateWarning(e){this.switchCssClasses(this.containerElement,this.warningClasses);const t=this.createDecorationDiv();this.switchCssClasses(t,this.warningClasses),t.innerHTML=`<span class="${this.warningIconClasses}"></span> ${e}`,this.adjustPosition()}switchCssClasses(e,t){e.classList.remove(...this.errorClasses,...this.warningClasses),e.classList.add(...t)}createDecorationDiv(){return this.decorationDiv||(this.containerElement.classList.add("validation"),this.decorationDiv=document.createElement("div"),this.decorationDiv.style.width=`${this.decorationContainerWidth()}px`,this.decorationDiv.classList.add("validation-decorator"),this.containerElement.appendChild(this.decorationDiv)),this.decorationDiv}decorationContainerWidth(){return this.containerElement.clientWidth-5}adjustPosition(){if(this.decorationDiv){const e=this.decorationDiv.clientHeight+2;this.decorationDiv.style.top=`-${e}px`}}isValidatedOk(){return this.isValidated&&!this.hasValidationError}invalidate(){this.isValidated=!1}dispose(){this.hasValidationError=!1,this.isValidated=!1,this.decorationDiv&&this.containerElement&&this.containerElement.contains(this.decorationDiv)&&(this.containerElement.removeChild(this.decorationDiv),this.switchCssClasses(this.containerElement,[]),this.decorationDiv=void 0)}}ql.ValidationDecorator=S0e;Object.defineProperty(uu,"__esModule",{value:!0});uu.toActionArray=uu.AutoCompleteWidget=void 0;const yl=z,E0e=ab,Vx=ql,C0e=VG;class P0e{constructor(e,t,i,o=()=>{},r,s){this.autoSuggestionSettings=e,this.suggestionProvider=t,this.suggestionSubmitHandler=i,this.notifyClose=o,this.logger=r,this.options=s,this.loadingIndicatorClasses=(0,yl.codiconCSSClasses)("loading",!1,!0,["loading"]),this.validationDecorator=Vx.IValidationDecorator.NO_DECORATION}configureValidation(e,t=Vx.IValidationDecorator.NO_DECORATION){this.inputValidator=e,this.validationDecorator=t}configureTextSubmitHandler(e){this.textSubmitHandler=e}initialize(e){this.containerElement=e,this.inputElement=this.createInputElement(),this.containerElement.appendChild(this.inputElement),this.containerElement.style.position="absolute"}createInputElement(){const e=document.createElement("input");return e.style.position="absolute",e.spellcheck=!1,e.autocapitalize="false",e.autocomplete="off",e.style.width="100%",e.addEventListener("keydown",t=>this.handleKeyDown(t)),e.addEventListener("blur",()=>{this.containerElement.style.visibility!=="hidden"&&window.setTimeout(()=>this.notifyClose("blur"),200)}),e}handleKeyDown(e){if((0,yl.matchesKeystroke)(e,"Escape")){this.notifyClose("escape");return}if(!((0,yl.matchesKeystroke)(e,"Enter")&&!this.isInputElementChanged()&&this.isSuggestionAvailable())&&(this.isInputElementChanged()&&this.invalidateValidationResultAndContextActions(),!(!(0,yl.matchesKeystroke)(e,"Enter")||this.isSuggestionAvailable()))){if(!this.validationDecorator.isValidatedOk()){e.stopImmediatePropagation();return}this.textSubmitHandler&&(this.executeFromTextOnlyInput(),this.notifyClose("submission"))}}isInputElementChanged(){return this.inputElement.value!==this.previousContent}invalidateValidationResultAndContextActions(){this.contextActions=void 0,this.validationDecorator.invalidate()}open(e,...t){this.contextActions=void 0,this.autoCompleteResult=C0e(this.autocompleteSettings(e)),this.previousContent=this.inputElement.value,this.inputElement.setSelectionRange(0,this.inputElement.value.length),this.inputElement.focus()}autocompleteSettings(e){return{input:this.inputElement,emptyMsg:this.autoSuggestionSettings.noSuggestionsMessage,className:this.autoSuggestionSettings.suggestionsClass,showOnFocus:this.autoSuggestionSettings.showOnFocus,debounceWaitMs:this.autoSuggestionSettings.debounceWaitMs,minLength:-1,fetch:(t,i)=>this.updateSuggestions(i,t,e),onSelect:t=>this.onSelect(t),render:(t,i)=>this.renderSuggestions(t,i),customize:(t,i,o,r)=>{this.customizeInputElement(t,i,o,r)}}}customizeInputElement(e,t,i,o){var r;if(i.style.position="fixed",this.containerElement&&(this.containerElement.appendChild(i),this.options&&this.options.selectedSuggestionChanged)){const s=i.querySelector(".selected");if(s!=null){const a=Array.from(i.children).indexOf(s);this.options.selectedSuggestionChanged((r=this.contextActions)===null||r===void 0?void 0:r[a])}else this.options.selectedSuggestionChanged(void 0)}}updateSuggestions(e,t,i,...o){this.onLoading(),this.doUpdateSuggestions(t,i).then(r=>{var s,a;this.contextActions=this.filterActions(t,r),e(this.contextActions),(a=(s=this.options)===null||s===void 0?void 0:s.visibleSuggestionsChanged)===null||a===void 0||a.call(s,this.contextActions),this.onLoaded("success")}).catch(r=>{this.logger&&this.logger.error(this,"Failed to obtain suggestions",r),this.onLoaded("error")})}onLoading(){this.loadingIndicator&&this.containerElement.contains(this.loadingIndicator)||(this.loadingIndicator=document.createElement("span"),this.loadingIndicator.classList.add(...this.loadingIndicatorClasses),this.containerElement.appendChild(this.loadingIndicator))}doUpdateSuggestions(e,t,...i){return this.suggestionProvider.provideSuggestions(e)}onLoaded(e){this.containerElement.contains(this.loadingIndicator)&&this.containerElement.removeChild(this.loadingIndicator),this.validationDecorator.invalidate(),this.validateInputIfNoContextActions(),this.previousContent=this.inputElement.value}renderSuggestions(e,t){const i=document.createElement("div"),o=this.escapeForRegExp(t).split(" ").join("|"),r=new RegExp(o,"gi");return e.icon&&this.renderIcon(i,e.icon),i.innerHTML+=e.label.replace(r,s=>"<em>"+s+"</em>").replace(/ /g,"&nbsp;"),i}escapeForRegExp(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}renderIcon(e,t){e.innerHTML+=`<span class="icon ${t}"></span>`}filterActions(e,t){return(0,yl.toArray)(t.filter(i=>{const o=i.label.toLowerCase();return e.split(" ").every(s=>o.indexOf(s.toLowerCase())!==-1)}))}onSelect(e){E0e.AutoCompleteValue.is(e)?(this.inputElement.value=e.text,window.setTimeout(()=>this.inputElement.dispatchEvent(new Event("input")))):(this.executeFromSuggestion(e),this.notifyClose("submission"))}validateInputIfNoContextActions(){this.isNoOrExactlyOneMatchingContextAction()?this.validateInput():this.validationDecorator.dispose()}isNoOrExactlyOneMatchingContextAction(){return!this.isSuggestionAvailable()||this.contextActions&&this.contextActions.length===1&&this.inputElement.value.endsWith(this.contextActions[0].label)}isSuggestionAvailable(){return this.contextActions&&this.contextActions.length>0}validateInput(){this.inputValidator&&this.inputValidator.validate(this.inputElement.value).then(e=>this.validationDecorator.decorateValidationResult(e)).catch(e=>this.handleErrorDuringValidation(e))}handleErrorDuringValidation(e){this.logger&&this.logger.error(this,"Failed to validate input",e),this.validationDecorator.dispose()}executeFromSuggestion(e){this.suggestionSubmitHandler.executeFromSuggestion(e)}executeFromTextOnlyInput(){this.textSubmitHandler&&this.textSubmitHandler.executeFromTextOnlyInput(this.inputElement.value)}get inputField(){return this.inputElement}dispose(){this.validationDecorator.dispose(),this.autoCompleteResult&&this.autoCompleteResult.destroy()}}uu.AutoCompleteWidget=P0e;function w0e(n){return yl.LabeledAction.is(n)?n.actions:yl.Action.is(n)?[n]:[]}uu.toActionArray=w0e;var fq={};Object.defineProperty(fq,"__esModule",{value:!0});var cb={},Ms={};(function(n){var e=l&&l.__decorate||function(r,s,a,f){var h=arguments.length,g=h<3?s:f===null?f=Object.getOwnPropertyDescriptor(s,a):f,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(r,s,a,f);else for(var S=r.length-1;S>=0;S--)(y=r[S])&&(g=(h<3?y(g):h>3?y(s,a,g):y(s,a))||g);return h>3&&g&&Object.defineProperty(s,a,g),g};Object.defineProperty(n,"__esModule",{value:!0}),n.GLSPAbstractUIExtension=n.CSS_HIDDEN_EXTENSION_CLASS=n.CSS_UI_EXTENSION_CLASS=void 0;const t=z,i=F;n.CSS_UI_EXTENSION_CLASS="ui-extension",n.CSS_HIDDEN_EXTENSION_CLASS="hidden";let o=class extends t.AbstractUIExtension{get diagramContainerId(){return this.options.baseDiv}get parentContainerSelector(){return"#"+this.diagramContainerId}get containerSelector(){return"#"+this.id()}get initialized(){return!!this.containerElement}initialize(){if(this.initialized)return!0;try{this.containerElement=this.getOrCreateContainer(),this.initializeContainer(this.containerElement),this.initializeContents(this.containerElement)}catch(s){const a=s instanceof Error?s.message:`Could not retrieve container element for UI extension ${this.id}`;return this.logger.error(this,a),!1}return!0}getOrCreateContainer(){if(this.containerElement)return this.containerElement;const s=this.getContainer();if(s)return s;const a=this.getParentContainer();if(!(a!=null&&a.isConnected))throw new Error(`Could not obtain attached parent for initializing UI extension ${this.id}`);const f=this.createContainer(a);return this.insertContainerIntoParent(f,a),f}getContainer(){return document.querySelector(this.containerSelector)}createContainer(s){const a=document.createElement("div");return a.id=s.id+"_"+this.id(),a}initializeContainer(s){s.classList.add(n.CSS_UI_EXTENSION_CLASS,this.containerClass())}getParentContainer(){return document.querySelector(this.parentContainerSelector)}insertContainerIntoParent(s,a){a.insertBefore(s,a.firstChild)}setContainerVisible(s){var a,f;s?(a=this.containerElement)===null||a===void 0||a.classList.remove(n.CSS_HIDDEN_EXTENSION_CLASS):(f=this.containerElement)===null||f===void 0||f.classList.add(n.CSS_HIDDEN_EXTENSION_CLASS)}isContainerVisible(){var s;return!(!((s=this.containerElement)===null||s===void 0)&&s.classList.contains(n.CSS_HIDDEN_EXTENSION_CLASS))}toggleContainerVisible(){this.setContainerVisible(!this.isContainerVisible())}};n.GLSPAbstractUIExtension=o,n.GLSPAbstractUIExtension=o=e([(0,i.injectable)()],o)})(Ms);var A0e=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},R0e=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(cb,"__esModule",{value:!0});cb.BaseAutocompletePalette=void 0;const M0e=z,I0e=F,D0e=Pt,T0e=Ms,zx=uu;class hq extends T0e.GLSPAbstractUIExtension{constructor(){super(...arguments),this.autoSuggestionSettings={noSuggestionsMessage:"No suggestions available",suggestionsClass:"command-palette-suggestions",debounceWaitMs:50,showOnFocus:!0}}containerClass(){return"autocomplete-palette"}show(e,...t){super.show(e,...t),this.root=e,this.autocompleteWidget.open(e)}hide(){var e;(e=this.autocompleteWidget)===null||e===void 0||e.dispose(),this.root=void 0,super.hide()}initializeContents(e){e.classList.add("command-palette"),this.autocompleteWidget=new zx.AutoCompleteWidget(this.autoSuggestionSettings,{provideSuggestions:t=>this.retrieveSuggestions(this.root,t)},{executeFromSuggestion:t=>this.executeSuggestion(t)},t=>this.autocompleteHide(t),this.logger,{visibleSuggestionsChanged:t=>this.visibleSuggestionsChanged(this.root,t),selectedSuggestionChanged:t=>this.selectedSuggestionChanged(this.root,t)}),this.autocompleteWidget.initialize(e)}async visibleSuggestionsChanged(e,t){}async selectedSuggestionChanged(e,t){}autocompleteHide(e){this.hide()}executeSuggestion(e){this.actionDispatcher.dispatchAll((0,zx.toActionArray)(e))}}cb.BaseAutocompletePalette=hq;A0e([(0,I0e.inject)(M0e.TYPES.IActionDispatcher),R0e("design:type",D0e.GLSPActionDispatcher)],hq.prototype,"actionDispatcher",void 0);var Dg={},An={},zc={},Ma={};Object.defineProperty(Ma,"__esModule",{value:!0});Ma.FocusStateChangedAction=void 0;const Gx=z;var Ux;(function(n){n.KIND="focusStateChanged";function e(i){return Gx.Action.hasKind(i,n.KIND)&&(0,Gx.hasBooleanProp)(i,"hasFocus")}n.is=e;function t(i=!0){return{kind:n.KIND,hasFocus:i}}n.create=t})(Ux||(Ma.FocusStateChangedAction=Ux={}));var pq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},O0e=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(zc,"__esModule",{value:!0});zc.FocusTracker=void 0;const mq=z,gq=F,L0e=Ma;let rP=class{constructor(){this.inActiveCssClass="inactive",this._hasFocus=!0,this.onFocusChangedEmitter=new mq.Emitter}get onFocusChanged(){return this.onFocusChangedEmitter.event}get hasFocus(){return this._hasFocus}get focusElement(){return this._focusElement}get diagramElement(){return this._diagramElement}handle(e){L0e.FocusStateChangedAction.is(e)&&(this._hasFocus=e.hasFocus,this._focusElement=document.activeElement,this._diagramElement=document.getElementById(this.options.baseDiv),this._diagramElement&&(this.hasFocus?this._diagramElement.classList.contains(this.inActiveCssClass)&&this._diagramElement.classList.remove(this.inActiveCssClass):this._diagramElement.classList.add(this.inActiveCssClass),this.onFocusChangedEmitter.fire({hasFocus:this.hasFocus,focusElement:this.focusElement,diagramElement:this.diagramElement})))}};zc.FocusTracker=rP;pq([(0,gq.inject)(mq.TYPES.ViewerOptions),O0e("design:type",Object)],rP.prototype,"options",void 0);zc.FocusTracker=rP=pq([(0,gq.injectable)()],rP);var Yt={},kt={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.removeDescendants=n.isNotDescendantOfAnyElement=n.getDescendantIds=n.isVisibleOnCanvas=n.calculateDeltaBetweenPoints=n.findTopLevelElementByFeature=n.getElementTypeId=n.calcRoute=n.calcElementAndRoute=n.calcElementAndRoutingPoints=n.ROUTE_KINDS=n.ROUTING_POINT_KINDS=n.ALL_ROUTING_POINTS=n.toElementAndRoutingPoints=n.toElementAndBounds=n.isSelectableAndBoundsAware=n.isRoutingHandle=n.isRoutable=n.isNonRoutableSelectedBoundsAware=n.isNonRoutableSelectedMovableBoundsAware=n.toggleCssClass=n.removeCssClassOfElements=n.addCssClassToElements=n.removeCssClasses=n.addCssClasses=n.isNotUndefined=n.hasSelectedElements=n.getSelectedElementCount=n.getElements=n.getMatchingElements=n.forEachElement=n.filter=void 0;const e=z;function t(H,M){return H.all().filter(M)}n.filter=t;function i(H,M,Y){t(H,M).forEach(Y)}n.forEachElement=i;function o(H,M){return Array.from(t(H,M))}n.getMatchingElements=o;function r(H,M,Y){const te=ue=>ue!==void 0?Y?Y(ue):!0:!1;return M.map(ue=>H.getById(ue)).filter(te)}n.getElements=r;function s(H){let M=0;return i(H,e.isSelected,Y=>M++),M}n.getSelectedElementCount=s;function a(H){return s(H)>0}n.hasSelectedElements=a;function f(H){return H!==void 0}n.isNotUndefined=f;function h(H,...M){var Y;const te=Array.isArray(M[0])?M[0]:M,ue=(Y=H.cssClasses)!==null&&Y!==void 0?Y:[];(0,e.distinctAdd)(ue,...te),H.cssClasses=ue}n.addCssClasses=h;function g(H,...M){if(!H.cssClasses||H.cssClasses.length===0)return;const Y=Array.isArray(M[0])?M[0]:M;(0,e.remove)(H.cssClasses,...Y)}n.removeCssClasses=g;function y(H,...M){for(const Y of H)h(Y,M)}n.addCssClassToElements=y;function S(H,...M){for(const Y of H)g(Y,M)}n.removeCssClassOfElements=S;function P(H,M,Y){return Y?h(H,M):g(H,M)}n.toggleCssClass=P;function w(H){return C(H)&&(0,e.isMoveable)(H)}n.isNonRoutableSelectedMovableBoundsAware=w;function C(H){return(0,e.isBoundsAware)(H)&&(0,e.isSelected)(H)&&!E(H)}n.isNonRoutableSelectedBoundsAware=C;function E(H){return H instanceof e.GRoutableElement&&H.routingPoints!==void 0}n.isRoutable=E;function D(H){return H!==void 0&&H instanceof e.GRoutingHandle}n.isRoutingHandle=D;function j(H){return(0,e.isSelectable)(H)&&(0,e.isBoundsAware)(H)}n.isSelectableAndBoundsAware=j;function U(H){return{elementId:H.id,newPosition:{x:H.bounds.x,y:H.bounds.y},newSize:{width:H.bounds.width,height:H.bounds.height}}}n.toElementAndBounds=U;function p(H){return{elementId:H.id,newRoutingPoints:H.routingPoints}}n.toElementAndRoutingPoints=p,n.ALL_ROUTING_POINTS=void 0,n.ROUTING_POINT_KINDS=["linear","bezier-junction"],n.ROUTE_KINDS=[...n.ROUTING_POINT_KINDS,"source","target"];function b(H,M){const Y=M?R(H,M,n.ROUTING_POINT_KINDS):H.routingPoints;return{elementId:H.id,newRoutingPoints:Y}}n.calcElementAndRoutingPoints=b;function v(H,M){var Y,te;let ue=M?R(H,M,n.ROUTE_KINDS):void 0;return ue||(ue=[...H.routingPoints],ue.splice(0,0,((Y=H.source)===null||Y===void 0?void 0:Y.position)||e.Point.ORIGIN),ue.push(((te=H.target)===null||te===void 0?void 0:te.position)||e.Point.ORIGIN)),{elementId:H.id,newRoutingPoints:ue}}n.calcElementAndRoute=v;function R(H,M,Y=n.ALL_ROUTING_POINTS,te=Number.EPSILON){const ue=M.get(H.routerKind).route(H),Re=[];for(const ae of ue)Y&&!Y.includes(ae.kind)||n.ROUTING_POINT_KINDS.includes(ae.kind)&&Re.find(ot=>e.Point.maxDistance(ae,ot)<te)||Re.push(ae);return Re}n.calcRoute=R;function O(H){return typeof H=="string"?H:H.type}n.getElementTypeId=O;function N(H,M,Y=te=>!1){let te,ue=H;for(;ue!==void 0;)!Y(ue)&&M(ue)&&(te=ue),ue instanceof e.GChildElement?ue=ue.parent:ue=void 0;return te}n.findTopLevelElementByFeature=N;function T(H,M,Y){const te=e.Point.subtract(H,M),ue=(0,e.getZoom)(Y);return e.Point.divideScalar(te,ue)}n.calculateDeltaBetweenPoints=T;function $(H){const M=(0,e.getAbsoluteBounds)(H),Y=H.root.canvasBounds;return M.x<=Y.width&&M.x+M.width>=0&&M.y<=Y.height&&M.y+M.height>=0}n.isVisibleOnCanvas=$;function Q(H,M){if(!H||M!=null&&M(H))return[];const Y=H,te=[Y.id];return Y instanceof e.GParentElement&&te.push(...Y.children.flatMap(ue=>Q(ue,M))),te}n.getDescendantIds=Q;function K(H){const M=new Set(H);return Y=>{let te=Y;for(;te instanceof e.GChildElement;)if(te=te.parent,M.has(te))return!1;return!0}}n.isNotDescendantOfAnyElement=K;function Z(H){return H.filter(K(H))}n.removeDescendants=Z})(kt);var xu=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cs=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},sP=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.SelectFeedbackAction=Yt.SelectAllCommand=Yt.SelectCommand=Yt.SelectionService=void 0;const Kt=z,Mr=F,aP=kt;let Lr=class{constructor(){this.selectedElementIDs=new Set,this.toDispose=new Kt.DisposableCollection,this.onSelectionChangedEmitter=new Kt.Emitter}initialize(){this.toDispose.push(this.onSelectionChangedEmitter)}preLoadDiagram(){this.lazyInjector.getAll(Kt.TYPES.ISelectionListener).forEach(e=>this.onSelectionChanged(t=>e.selectionChanged(t.root,t.selectedElements,t.deselectedElements)))}dispose(){this.toDispose.dispose()}get onSelectionChanged(){return this.onSelectionChangedEmitter.event}modelRootChanged(e){this.updateSelection(e,[],[])}updateSelection(e,t,i){if(e===void 0&&t.length===0&&i.length===0)return;const o=this.root,r=new Set(this.selectedElementIDs);this.root=e;const s=[...t].filter(g=>i.indexOf(g)===-1),a=[...i].filter(g=>t.indexOf(g)===-1&&this.selectedElementIDs.has(g));a.forEach(g=>this.selectedElementIDs.delete(g)),s.forEach(g=>this.selectedElementIDs.add(g));const f=new Set(a);for(const g of this.selectedElementIDs)e.index.getById(g)===void 0&&(this.selectedElementIDs.delete(g),o!=null&&o.index.getById(g)&&f.add(g));(r.size!==this.selectedElementIDs.size||![...r].every(g=>this.selectedElementIDs.has(g)))&&(this.dispatchFeedback([W8.create({selectedElementsIDs:[...this.selectedElementIDs],deselectedElementsIDs:[...f]})]),this.notifyListeners(this.root,this.selectedElementIDs,f))}dispatchFeedback(e){this.feedbackDispatcher.registerFeedback(this,e)}notifyListeners(e,t,i){this.onSelectionChangedEmitter.fire({root:e,selectedElements:Array.from(t),deselectedElements:Array.from(i)})}getModelRoot(){return this.root}getSelectedElements(){return this.root?(0,aP.getElements)(this.root.index,Array.from(this.selectedElementIDs),Kt.isSelectable):[]}getSelectedElementIDs(){return[...this.selectedElementIDs]}hasSelectedElements(){return this.selectedElementIDs.size>0}isSingleSelection(){return this.selectedElementIDs.size===1}isMultiSelection(){return this.selectedElementIDs.size>1}};Yt.SelectionService=Lr;xu([(0,Mr.inject)(Kt.TYPES.IFeedbackActionDispatcher),cs("design:type",Object)],Lr.prototype,"feedbackDispatcher",void 0);xu([(0,Mr.inject)(Kt.LazyInjector),cs("design:type",Object)],Lr.prototype,"lazyInjector",void 0);xu([(0,Mr.inject)(Kt.TYPES.ILogger),cs("design:type",Object)],Lr.prototype,"logger",void 0);xu([(0,Mr.postConstruct)(),cs("design:type",Function),cs("design:paramtypes",[]),cs("design:returntype",void 0)],Lr.prototype,"initialize",null);xu([(0,Mr.preDestroy)(),cs("design:type",Function),cs("design:paramtypes",[]),cs("design:returntype",void 0)],Lr.prototype,"dispose",null);Yt.SelectionService=Lr=xu([(0,Mr.injectable)()],Lr);let cP=class extends Kt.Command{constructor(e,t){super(),this.action=e,this.selectionService=t,this.selected=[],this.deselected=[]}execute(e){const t=e.root,i=s=>s instanceof Kt.GChildElement&&(0,Kt.isSelectable)(s),o=(0,aP.getElements)(t.index,this.action.selectedElementsIDs,i),r=this.action.deselectAll?this.selectionService.getSelectedElements():(0,aP.getElements)(t.index,this.action.deselectedElementsIDs,i);return this.selectionService.updateSelection(t,(0,Kt.pluck)(o,"id"),(0,Kt.pluck)(r,"id")),t}undo(e){return e.root}redo(e){return e.root}};Yt.SelectCommand=cP;cP.KIND=Kt.SprottySelectCommand.KIND;Yt.SelectCommand=cP=xu([(0,Mr.injectable)(),sP(0,(0,Mr.inject)(Kt.TYPES.Action)),sP(1,(0,Mr.inject)(Lr)),cs("design:paramtypes",[Object,Lr])],cP);let dP=class extends Kt.Command{constructor(e,t){super(),this.action=e,this.selectionService=t,this.previousSelection=new Map}execute(e){const t=e.root,i=s=>s instanceof Kt.GChildElement&&(0,Kt.isSelectable)(s),o=(0,aP.getMatchingElements)(t.index,i),r=(0,Kt.pluck)(o,"id");return this.action.select?this.selectionService.updateSelection(t,r,[]):this.selectionService.updateSelection(t,[],r),t}undo(e){return e.root}redo(e){return e.root}};Yt.SelectAllCommand=dP;dP.KIND=Kt.SprottySelectAllCommand.KIND;Yt.SelectAllCommand=dP=xu([(0,Mr.injectable)(),sP(0,(0,Mr.inject)(Kt.TYPES.Action)),sP(1,(0,Mr.inject)(Lr)),cs("design:paramtypes",[Object,Lr])],dP);var W8;(function(n){n.KIND="selectFeedback";function e(s){return Kt.Action.hasKind(s,n.KIND)&&(0,Kt.hasArrayProp)(s,"selectedElementsIDs")&&(0,Kt.hasArrayProp)(s,"deselectedElementsIDs")}n.is=e;function t(s){return{...Kt.SelectAction.create(s),kind:n.KIND}}n.create=t;function i(s){return{...Kt.SelectAction.addSelection(s),kind:n.KIND}}n.addSelection=i;function o(s){return{...Kt.SelectAction.removeSelection(s),kind:n.KIND}}n.removeSelection=o;function r(s){return{...Kt.SelectAction.setSelection(s),kind:n.KIND}}n.setSelection=r})(W8||(Yt.SelectFeedbackAction=W8={}));var Gc=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Ir=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(An,"__esModule",{value:!0});An.EditorContextService=void 0;const Hi=z,Uc=F,Yx=Pt,qx=zc,Wx=Yt;let bs=class{constructor(){this.onEditModeChangedEmitter=new Hi.Emitter,this.onDirtyStateChangedEmitter=new Hi.Emitter,this.onModelRootChangedEmitter=new Hi.Emitter,this.toDispose=new Hi.DisposableCollection}get onEditModeChanged(){return this.onEditModeChangedEmitter.event}get onDirtyStateChanged(){return this.onDirtyStateChangedEmitter.event}get onModelRootChanged(){return this.onModelRootChangedEmitter.event}get onFocusChanged(){return this.focusTracker.onFocusChanged}get onSelectionChanged(){return this.selectionService.onSelectionChanged}initialize(){var e;this._editMode=(e=this.diagramOptions.editMode)!==null&&e!==void 0?e:Hi.EditMode.EDITABLE,this.toDispose.push(this.onEditModeChangedEmitter,this.onDirtyStateChangedEmitter)}preLoadDiagram(){this.lazyInjector.getAll(Hi.TYPES.IGModelRootListener).forEach(e=>{this.onModelRootChanged(t=>e.modelRootChanged(t))}),this.lazyInjector.getAll(Hi.TYPES.IEditModeListener).forEach(e=>{this.onEditModeChanged(t=>e.editModeChanged(t.newValue,t.oldValue))})}dispose(){this.toDispose.dispose()}get(e){return{selectedElementIds:Array.from(this.selectionService.getSelectedElementIDs()),lastMousePosition:this.mousePositionTracker.lastPositionOnDiagram,args:e}}getWithSelection(e,t){return{selectedElementIds:e,lastMousePosition:this.mousePositionTracker.lastPositionOnDiagram,args:t}}notifyModelRootChanged(e,t){if(!(t instanceof Hi.CommandStack))throw new Error("Invalid model root change notification. Notifier is not an instance of `CommandStack`.");this._modelRoot=e,this.onModelRootChangedEmitter.fire(e)}handle(e){Hi.SetEditModeAction.is(e)?this.handleSetEditModeAction(e):Hi.SetDirtyStateAction.is(e)&&this.handleSetDirtyStateAction(e)}handleSetEditModeAction(e){const t=this._editMode;this._editMode=e.editMode,this.onEditModeChangedEmitter.fire({newValue:this.editMode,oldValue:t})}handleSetDirtyStateAction(e){e.isDirty!==this._isDirty&&(this._isDirty=e.isDirty,this.onDirtyStateChangedEmitter.fire(e))}get sourceUri(){return this.diagramOptions.sourceUri}get editMode(){return this._editMode}get diagramType(){return this.diagramOptions.diagramType}get clientId(){return this.diagramOptions.clientId}get modelRoot(){if(!this._modelRoot)throw new Error("Model root not available yet");return this._modelRoot}get selectedElements(){return this.selectionService.getSelectedElements()}get isReadonly(){return this.editMode===Hi.EditMode.READONLY}get isDirty(){return this._isDirty}};An.EditorContextService=bs;Gc([(0,Uc.inject)(Wx.SelectionService),Ir("design:type",Wx.SelectionService)],bs.prototype,"selectionService",void 0);Gc([(0,Uc.inject)(Hi.MousePositionTracker),Ir("design:type",Hi.MousePositionTracker)],bs.prototype,"mousePositionTracker",void 0);Gc([(0,Uc.inject)(Hi.LazyInjector),Ir("design:type",Object)],bs.prototype,"lazyInjector",void 0);Gc([(0,Uc.inject)(Hi.TYPES.IDiagramOptions),Ir("design:type",Object)],bs.prototype,"diagramOptions",void 0);Gc([(0,Uc.inject)(Yx.GLSPActionDispatcher),Ir("design:type",Yx.GLSPActionDispatcher)],bs.prototype,"actionDispatcher",void 0);Gc([(0,Uc.inject)(qx.FocusTracker),Ir("design:type",qx.FocusTracker)],bs.prototype,"focusTracker",void 0);Gc([(0,Uc.postConstruct)(),Ir("design:type",Function),Ir("design:paramtypes",[]),Ir("design:returntype",void 0)],bs.prototype,"initialize",null);Gc([(0,Uc.preDestroy)(),Ir("design:type",Function),Ir("design:paramtypes",[]),Ir("design:returntype",void 0)],bs.prototype,"dispose",null);An.EditorContextService=bs=Gc([(0,Uc.injectable)()],bs);var e9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},_3=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Dg,"__esModule",{value:!0});Dg.GLSPCommandStack=void 0;const Wv=z,t9=F,N0e=An;let py=class extends Wv.CommandStack{constructor(){super(...arguments),this.toDispose=new Wv.DisposableCollection}dispose(){this.toDispose.dispose()}get editorContext(){return this.lazyInjector.get(N0e.EditorContextService)}get onModelRootChanged(){return this.editorContext.onModelRootChanged}undo(){return this.logger.warn(this,"GLSPCommandStack.undo() was called. This should never happen as the GLSP server is responsible for handling undo requests"),this.currentModel}redo(){return this.logger.warn(this,"GLSPCommandStack.redo() was called. This should never happen as the GLSP server is responsible for handling redo requests"),this.currentModel}async execute(e){if(e instanceof Wv.SetModelCommand||e instanceof Wv.UpdateModelCommand){const t=await super.execute(e);return this.notifyListeners(t),t}return super.execute(e)}notifyListeners(e){this.editorContext.notifyModelRootChanged(e,this)}};Dg.GLSPCommandStack=py;e9([(0,t9.inject)(Wv.LazyInjector),_3("design:type",Object)],py.prototype,"lazyInjector",void 0);e9([(0,t9.preDestroy)(),_3("design:type",Function),_3("design:paramtypes",[]),_3("design:returntype",void 0)],py.prototype,"dispose",null);Dg.GLSPCommandStack=py=e9([(0,t9.injectable)()],py);var db={},it={},Gn={},Is={};Object.defineProperty(Is,"__esModule",{value:!0});Is.Ranked=void 0;const Zx=z;var Qx;(function(n){n.DEFAULT_RANK=0;function e(i){return Zx.AnyObject.is(i)&&(0,Zx.hasNumberProp)(i,"rank")}n.is=e;function t(i){return e(i)?i.rank:n.DEFAULT_RANK}n.getRank=t,n.sortAsc=(i,o)=>t(i)-t(o),n.sortDesc=(i,o)=>t(o)-t(i),n.sort=n.sortAsc})(Qx||(Is.Ranked=Qx={}));Object.defineProperty(Gn,"__esModule",{value:!0});Gn.getFeedbackRank=Gn.FeedbackCommand=void 0;const j0e=z,vq=Is;class B0e extends j0e.Command{constructor(){super(...arguments),this.priority=0,this.rank=this.priority?-this.priority:vq.Ranked.DEFAULT_RANK}undo(e){return e.root}redo(e){return e.root}}Gn.FeedbackCommand=B0e;function $0e(n){var e;const t=n;return t!=null&&t.priority?-t.priority:(e=t.rank)!==null&&e!==void 0?e:vq.Ranked.DEFAULT_RANK}Gn.getFeedbackRank=$0e;var k0e=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},F0e=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},x0e=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(it,"__esModule",{value:!0});it.toggleCssClasses=it.deleteCssClasses=it.applyCssClasses=it.cursorFeedbackAction=it.CursorCSS=it.CSS_HIDDEN=it.CSS_GHOST_ELEMENT=it.ModifyCssFeedbackCommand=it.ModifyCSSFeedbackAction=void 0;const Z8=z,Xx=F,ND=kt,H0e=Gn;var dm;(function(n){n.KIND="modifyCSSFeedback";function e(i){return Z8.Action.hasKind(i,n.KIND)&&(0,Z8.hasArrayProp)(i,"elementIds")}n.is=e;function t(i){const{elements:o,...r}=i,s=o?o.map(a=>typeof a=="string"?a:a.id):void 0;return{kind:n.KIND,elementIds:s,...r}}n.create=t})(dm||(it.ModifyCSSFeedbackAction=dm={}));let uP=class extends H0e.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return(this.action.elementIds?(0,ND.getElements)(e.root.index,this.action.elementIds):[e.root]).forEach(i=>{this.action.remove&&(0,ND.removeCssClasses)(i,this.action.remove),this.action.add&&(0,ND.addCssClasses)(i,this.action.add)}),e.root}};it.ModifyCssFeedbackCommand=uP;uP.KIND=dm.KIND;it.ModifyCssFeedbackCommand=uP=k0e([(0,Xx.injectable)(),x0e(0,(0,Xx.inject)(Z8.TYPES.Action)),F0e("design:paramtypes",[Object])],uP);it.CSS_GHOST_ELEMENT="ghost-element";it.CSS_HIDDEN="hidden";var Q8;(function(n){n.DEFAULT="default-mode",n.OVERLAP_FORBIDDEN="overlap-forbidden-mode",n.NODE_CREATION="node-creation-mode",n.EDGE_CREATION_SOURCE="edge-creation-select-source-mode",n.EDGE_CREATION_TARGET="edge-creation-select-target-mode",n.EDGE_RECONNECT="edge-reconnect-select-target-mode",n.EDGE_CHECK_PENDING="edge-check-pending-mode",n.OPERATION_NOT_ALLOWED="edge-modification-not-allowed-mode",n.ELEMENT_DELETION="element-deletion-mode",n.RESIZE_NESW="resize-nesw-mode",n.RESIZE_NWSE="resize-nwse-mode",n.RESIZE_NW="resize-nw-mode",n.RESIZE_N="resize-n-mode",n.RESIZE_NE="resize-ne-mode",n.RESIZE_E="resize-e-mode",n.RESIZE_SE="resize-se-mode",n.RESIZE_S="resize-s-mode",n.RESIZE_SW="resize-sw-mode",n.RESIZE_W="resize-w-mode",n.MOVE="move-mode",n.MARQUEE="marquee-mode"})(Q8||(it.CursorCSS=Q8={}));function K0e(n){const e=[];return n&&e.push(n),dm.create({add:e,remove:Object.values(Q8)})}it.cursorFeedbackAction=K0e;function _q(n,...e){return dm.create({elements:[n],add:e})}it.applyCssClasses=_q;function yq(n,...e){return dm.create({elements:[n],remove:e})}it.deleteCssClasses=yq;function V0e(n,e,...t){return e?_q(n,...t):yq(n,...t)}it.toggleCssClasses=V0e;var Tg={},ub={},_c={};Object.defineProperty(_c,"__esModule",{value:!0});_c.MaybeActions=_c.feedbackFeature=void 0;const Jx=z;_c.feedbackFeature=Symbol("feedbackFeature");var eH;(function(n){function e(t){const i=t?(0,Jx.call)(t):[];return i?(0,Jx.asArray)(i):[]}n.asArray=e})(eH||(_c.MaybeActions=eH={}));Object.defineProperty(ub,"__esModule",{value:!0});ub.FeedbackEmitter=void 0;const tH=z,z0e=_c;let G0e=0;class U0e{constructor(e){this.feedbackDispatcher=e,this.id=G0e++,this.feedbackActions=[],this.cleanupActions=[]}add(e,t){if(!e&&!t)return this;const i=this.feedbackActions.length;return this.feedbackActions[i]=e,t&&(this.cleanupActions[i]=t),this}merge(e){return this.feedbackActions.push(...e.feedbackActions),this.cleanupActions.push(...e.cleanupActions),this}remove(e){const t=this.feedbackActions.indexOf(e);return t>=0&&(this.feedbackActions.splice(t,1),this.cleanupActions.splice(t,1)),this}clear(){return this.feedbackActions=[],this.cleanupActions=[],this}submit(){const e=(0,tH.arrayOf)(...this.feedbackActions),t=(0,tH.arrayOf)(...this.cleanupActions);return(e.length>0||t.length>0)&&(this.deregistration=this.feedbackDispatcher.registerFeedback(this,e,()=>t.flatMap(z0e.MaybeActions.asArray)),this.clear()),this}discard(){return this.feedbackDispatcher.deregisterFeedback(this),this.deregistration=void 0,this}revert(){var e;return(e=this.deregistration)===null||e===void 0||e.dispose(),this.deregistration=void 0,this}dispose(){return this.revert(),this.clear(),this}}ub.FeedbackEmitter=U0e;var IR=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},n9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Tg,"__esModule",{value:!0});Tg.FeedbackActionDispatcher=void 0;const jd=z,DR=F,nH=Gn,Y0e=ub,q0e=_c;let um=class{constructor(){this.registeredFeedback=new Map}registerFeedback(e,t,i){return e instanceof jd.GModelElement&&this.logger.log(this,"GModelElements as feedback emitters are discouraged, as they usually change between model updates and are considered unstable."),t.length>0&&(this.registeredFeedback.set(e,t),this.dispatchFeedback(t,e)),jd.Disposable.create(()=>this.deregisterFeedback(e,i))}deregisterFeedback(e,t){this.registeredFeedback.delete(e);const i=q0e.MaybeActions.asArray(t);i.length>0&&this.dispatchFeedback(i,e)}getRegisteredFeedback(){const e=[];return this.registeredFeedback.forEach(t=>e.push(...t)),e}getRegisteredFeedbackEmitters(e){const t=[];return this.registeredFeedback.forEach((i,o)=>{i.includes(e)&&t.push(o)}),t}getFeedbackCommands(){return this.getRegisteredFeedback().flatMap(e=>this.actionToCommands(e)).sort((e,t)=>(0,nH.getFeedbackRank)(e)-(0,nH.getFeedbackRank)(t))}async applyFeedbackCommands(e){var t;const i=(t=this.getFeedbackCommands())!==null&&t!==void 0?t:[];if((i==null?void 0:i.length)>0){const o=i.map(r=>r.execute(e));await Promise.all(o)}}actionToCommands(e){var t;return(t=this.actionHandlerRegistry.get(e.kind).filter((0,jd.toTypeGuard)(jd.CommandActionHandler)).map(i=>i.handle(e)))!==null&&t!==void 0?t:[]}createEmitter(){return new Y0e.FeedbackEmitter(this)}async dispatchFeedback(e,t){try{await(await this.actionDispatcher()).dispatchAll(e),this.logger.info(this,`Dispatched feedback actions for ${t}`)}catch(i){this.logger.error(this,"Failed to dispatch feedback actions",i)}}};Tg.FeedbackActionDispatcher=um;IR([(0,DR.inject)(jd.TYPES.IActionDispatcherProvider),n9("design:type",Function)],um.prototype,"actionDispatcher",void 0);IR([(0,DR.inject)(jd.TYPES.ILogger),n9("design:type",Object)],um.prototype,"logger",void 0);IR([(0,DR.inject)(jd.ActionHandlerRegistry),n9("design:type",jd.ActionHandlerRegistry)],um.prototype,"actionHandlerRegistry",void 0);Tg.FeedbackActionDispatcher=um=IR([(0,DR.injectable)()],um);var Og={},i9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},o9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},W0e=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Og,"__esModule",{value:!0});Og.FeedbackAwareSetModelCommand=void 0;const TR=z,my=F;let gy=class extends TR.SetModelCommand{constructor(e){super(e)}execute(e){const t=super.execute(e);return this.applyFeedback(t,e),t}applyFeedback(e,t){var i;const o={...t,root:e};(i=this.feedbackActionDispatcher)===null||i===void 0||i.applyFeedbackCommands(o)}};Og.FeedbackAwareSetModelCommand=gy;i9([(0,my.inject)(TR.TYPES.ILogger),o9("design:type",Object)],gy.prototype,"logger",void 0);i9([(0,my.inject)(TR.TYPES.IFeedbackActionDispatcher),(0,my.optional)(),o9("design:type",Object)],gy.prototype,"feedbackActionDispatcher",void 0);Og.FeedbackAwareSetModelCommand=gy=i9([(0,my.injectable)(),W0e(0,(0,my.inject)(TR.TYPES.Action)),o9("design:paramtypes",[Object])],gy);var Lg={},r9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},s9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Z0e=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Lg,"__esModule",{value:!0});Lg.FeedbackAwareUpdateModelCommand=void 0;const vy=z,_y=F;let yy=class extends vy.UpdateModelCommand{constructor(e){super({animate:!0,...e})}performUpdate(e,t,i){var o;const r={...i,root:t};return(o=this.feedbackActionDispatcher)===null||o===void 0||o.applyFeedbackCommands(r),super.performUpdate(e,t,i)}createAnimations(e,t,i){return super.createAnimations(e,t,i).filter(r=>!(r instanceof vy.MorphEdgesAnimation))}};Lg.FeedbackAwareUpdateModelCommand=yy;r9([(0,_y.inject)(vy.TYPES.ILogger),s9("design:type",Object)],yy.prototype,"logger",void 0);r9([(0,_y.inject)(vy.TYPES.IFeedbackActionDispatcher),(0,_y.optional)(),s9("design:type",Object)],yy.prototype,"feedbackActionDispatcher",void 0);Lg.FeedbackAwareUpdateModelCommand=yy=r9([(0,_y.injectable)(),Z0e(0,(0,_y.inject)(vy.TYPES.Action)),s9("design:paramtypes",[Object])],yy);var lu={},Ng=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},lb=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(lu,"__esModule",{value:!0});lu.DiagramLoader=lu.IDiagramStartup=void 0;const br=z,jg=F,iH=Pt,Q0e=Is,oH=Ao,rH=ys;var sH;(function(n){function e(t){return br.AnyObject.is(t)&&(0,br.hasNumberProp)(t,"rank",!0)&&("preLoadDiagram"in t||"preInitialize"in t||"preRequestModel"in t||"postRequestModel"in t||"postModelInitialization"in t)}n.is=e})(sH||(lu.IDiagramStartup=sH={}));let fu=class{get diagramStartups(){return this.lazyInjector.getAll(br.TYPES.IDiagramStartup)}async load(e={}){var t,i;this.diagramStartups.sort(Q0e.Ranked.sort),await this.invokeStartupHook("preLoadDiagram");const o={requestModelOptions:{sourceUri:(t=this.options.sourceUri)!==null&&t!==void 0?t:"",diagramType:this.options.diagramType,...e.requestModelOptions},initializeParameters:{applicationId:br.ApplicationIdProvider.get(),protocolVersion:br.GLSPClient.protocolVersion,...e.initializeParameters},enableNotifications:(i=e.enableNotifications)!==null&&i!==void 0?i:!0};await this.actionDispatcher.dispatch(br.SetModelAction.create(br.EMPTY_ROOT)),await this.invokeStartupHook("preInitialize"),await this.initialize(o),await this.invokeStartupHook("preRequestModel"),await this.requestModel(o),await this.invokeStartupHook("postRequestModel"),this.modelInitializationConstraint.onInitialized(()=>this.invokeStartupHook("postModelInitialization"))}async invokeStartupHook(e){var t;for(const i of this.diagramStartups)try{await((t=i[e])===null||t===void 0?void 0:t.call(i))}catch(o){console.error(`Error invoking diagram startup hook '${e}':`,`
`,o)}}async requestModel(e){const t=await this.actionDispatcher.request(br.RequestModelAction.create({options:e.requestModelOptions}));return this.actionDispatcher.dispatch(t)}async initialize(e){e.enableNotifications&&await this.actionDispatcher.dispatch(br.StatusAction.create("Initializing...",{severity:"INFO"}));const t=await this.options.glspClientProvider();await t.start(),t.initializeResult||await t.initializeServer(e.initializeParameters),this.modelSource.configure(t),e.enableNotifications&&this.actionDispatcher.dispatch(br.StatusAction.create("",{severity:"NONE"}))}};lu.DiagramLoader=fu;Ng([(0,jg.inject)(br.TYPES.IDiagramOptions),lb("design:type",Object)],fu.prototype,"options",void 0);Ng([(0,jg.inject)(iH.GLSPActionDispatcher),lb("design:type",iH.GLSPActionDispatcher)],fu.prototype,"actionDispatcher",void 0);Ng([(0,jg.inject)(oH.GLSPModelSource),lb("design:type",oH.GLSPModelSource)],fu.prototype,"modelSource",void 0);Ng([(0,jg.inject)(rH.ModelInitializationConstraint),lb("design:type",rH.ModelInitializationConstraint)],fu.prototype,"modelInitializationConstraint",void 0);Ng([(0,jg.inject)(br.LazyInjector),lb("design:type",Object)],fu.prototype,"lazyInjector",void 0);lu.DiagramLoader=fu=Ng([(0,jg.injectable)()],fu);var Bg={},X0e=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Bg,"__esModule",{value:!0});Bg.GModelRegistry=void 0;const J0e=z,ebe=F,aH=Ig;let X8=class extends J0e.SModelRegistry{register(e,t){if(e===void 0)throw new Error("Key is undefined");this.hasKey(e)&&(console.log(`Key is already registered: ${e}.Factory for model element '${e}' will be overwritten.`),console.warn(`Implicit overwriting by registering the same key twice is deprecated
 Use 'overrideModelElement()' instead of 'configureModelElement()' for explicit overwriting.`)),this.elements.set(e,t)}getDefaultFeatures(e){var t;const i=[...(t=super.getDefaultFeatures(e))!==null&&t!==void 0?t:[]];return i.includes(aH.argsFeature)||i.push(aH.argsFeature),i}};Bg.GModelRegistry=X8;Bg.GModelRegistry=X8=X0e([(0,ebe.injectable)()],X8);var $g={},a9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},bq=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty($g,"__esModule",{value:!0});$g.GLSPMousePositionTracker=void 0;const Ap=z,c9=F,tbe=Is;let by=class extends Ap.MousePositionTracker{constructor(){super(...arguments),this.rank=tbe.Ranked.DEFAULT_RANK-200}mouseMove(e,t){const i=(0,Ap.getAbsoluteClientBounds)(e.root,this.domHelper,this.viewerOptions),o={x:t.clientX,y:t.clientY},r=Ap.Point.subtract(o,i),s=e.root.parentToLocal(r);return this.lastPosition=s,[]}};$g.GLSPMousePositionTracker=by;a9([(0,c9.inject)(Ap.TYPES.ViewerOptions),bq("design:type",Object)],by.prototype,"viewerOptions",void 0);a9([(0,c9.inject)(Ap.TYPES.DOMHelper),bq("design:type",Ap.DOMHelper)],by.prototype,"domHelper",void 0);$g.GLSPMousePositionTracker=by=a9([(0,c9.injectable)()],by);var kg={},nbe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(kg,"__esModule",{value:!0});kg.SelectionClearingMouseListener=void 0;const ibe=F,obe=z;let J8=class extends obe.MouseListener{mouseDown(e,t){const i=document.getSelection();return i===null?[]:(i.removeAllRanges(),i.addRange(document.createRange()),[])}};kg.SelectionClearingMouseListener=J8;kg.SelectionClearingMouseListener=J8=nbe([(0,ibe.injectable)()],J8);var It={};Object.defineProperty(It,"__esModule",{value:!0});It.Tool=It.EnableDefaultToolsAction=It.EnableToolsAction=void 0;const Ad=z;var cH;(function(n){n.KIND="enable-tools";function e(i){return Ad.Action.hasKind(i,n.KIND)&&(0,Ad.hasArrayProp)(i,"toolIds")}n.is=e;function t(i){return{kind:n.KIND,toolIds:i}}n.create=t})(cH||(It.EnableToolsAction=cH={}));var dH;(function(n){n.KIND="enable-default-tools";function e(i){return Ad.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(dH||(It.EnableDefaultToolsAction=dH={}));var uH;(function(n){function e(t){return Ad.AnyObject.is(t)&&(0,Ad.hasStringProp)(t,"id")&&(0,Ad.hasFunctionProp)(t,"enable")&&(0,Ad.hasFunctionProp)(t,"disable")&&(0,Ad.hasBooleanProp)(t,"isEditTool",!0)}n.is=e})(uH||(It.Tool=uH={}));var Dr={},Fg=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},d9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.DefaultToolsEnablingKeyListener=Dr.ToolManagerActionHandler=Dr.ToolManager=void 0;const es=z,xg=F,lH=An,rbe=Is,eO=It;let Sy=class{constructor(){this.actives=[],this.tools=[],this.defaultTools=[],this._defaultToolsEnabled=!1}get defaultToolsEnabled(){return this._defaultToolsEnabled}preLoadDiagram(){const e=this.lazyInjector.getAll(es.TYPES.ITool),t=this.lazyInjector.getAll(es.TYPES.IDefaultTool);this.registerTools(...e),this.registerDefaultTools(...t),this.enableDefaultTools()}get managedTools(){return this.defaultTools.concat(this.tools)}get activeTools(){return this.actives}get rank(){return rbe.Ranked.DEFAULT_RANK-100}registerDefaultTools(...e){(0,es.distinctAdd)(this.defaultTools,...e)}registerTools(...e){(0,es.distinctAdd)(this.tools,...e)}disableActiveTools(){this._defaultToolsEnabled=!1,this.actives.forEach(e=>e.disable()),this.actives.splice(0,this.actives.length)}enableDefaultTools(){this.defaultToolsEnabled||(this.enable((0,es.pluck)(this.defaultTools,"id")),this._defaultToolsEnabled=!0)}enable(e){this.disableActiveTools();let t=e.map(i=>this.tool(i));this.editorContext&&this.editorContext.isReadonly&&(t=t.filter(i=>!(i!=null&&i.isEditTool))),t.forEach(i=>{i!==void 0&&(i.enable(),this.actives.push(i))})}tool(e){return this.managedTools.find(t=>t.id===e)}disableEditTools(){this.disableActiveTools(),this.enable(this.defaultTools.filter(e=>!e.isEditTool).map(e=>e.id))}editModeChanged(e,t){t!==e&&(e===es.EditMode.READONLY?this.disableEditTools():e===es.EditMode.EDITABLE&&this.enableDefaultTools())}};Dr.ToolManager=Sy;Fg([(0,xg.inject)(lH.EditorContextService),d9("design:type",lH.EditorContextService)],Sy.prototype,"editorContext",void 0);Fg([(0,xg.inject)(es.LazyInjector),d9("design:type",Object)],Sy.prototype,"lazyInjector",void 0);Dr.ToolManager=Sy=Fg([(0,xg.injectable)()],Sy);let lP=class{handle(e){eO.EnableDefaultToolsAction.is(e)?this.toolManager.enableDefaultTools():eO.EnableToolsAction.is(e)&&this.toolManager.enable(e.toolIds)}};Dr.ToolManagerActionHandler=lP;Fg([(0,xg.inject)(es.TYPES.IToolManager),d9("design:type",Object)],lP.prototype,"toolManager",void 0);Dr.ToolManagerActionHandler=lP=Fg([(0,xg.injectable)()],lP);let tO=class extends es.KeyListener{keyDown(e,t){return(0,es.matchesKeystroke)(t,"Escape")?[eO.EnableDefaultToolsAction.create()]:[]}};Dr.DefaultToolsEnablingKeyListener=tO;Dr.DefaultToolsEnablingKeyListener=tO=Fg([(0,xg.injectable)()],tO);var Hg={},Sq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Eq=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},sbe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Hg,"__esModule",{value:!0});Hg.GLSPUIExtensionRegistry=void 0;const nO=z,iO=F;let fP=class extends nO.UIExtensionRegistry{constructor(e=[]){super(e)}preLoadDiagram(){this.lazyInjector.getAll(nO.TYPES.IUIExtension).forEach(e=>this.register(e.id(),e))}};Hg.GLSPUIExtensionRegistry=fP;Sq([(0,iO.inject)(nO.LazyInjector),Eq("design:type",Object)],fP.prototype,"lazyInjector",void 0);Hg.GLSPUIExtensionRegistry=fP=Sq([(0,iO.injectable)(),sbe(0,(0,iO.optional)()),Eq("design:paramtypes",[Array])],fP);var Qf={},Cq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Pq=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},abe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Qf,"__esModule",{value:!0});Qf.GLSPKeyTool=void 0;const y3=z,oO=F;let hP=class extends y3.KeyTool{constructor(e=[]){super(e)}registerListener(e){return super.register(e),y3.Disposable.create(()=>this.deregister(e))}preLoadDiagram(){this.lazyInjector.getAll(y3.TYPES.KeyListener).forEach(e=>this.register(e))}};Qf.GLSPKeyTool=hP;Cq([(0,oO.inject)(y3.LazyInjector),Pq("design:type",Object)],hP.prototype,"lazyInjector",void 0);Qf.GLSPKeyTool=hP=Cq([(0,oO.injectable)(),abe(0,(0,oO.optional)()),Pq("design:paramtypes",[Array])],hP);var Xf={},wq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Aq=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},cbe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Xf,"__esModule",{value:!0});Xf.GLSPMouseTool=void 0;const Zv=z,rO=F,fH=Is;let pP=class extends Zv.MouseTool{constructor(e=[]){super(e)}preLoadDiagram(){this.lazyInjector.getAll(Zv.TYPES.MouseListener).forEach(e=>this.register(e))}register(e){super.register(e),this.rankedMouseListeners=hH(this.mouseListeners,t=>fH.Ranked.getRank(t))}registerListener(e){return this.register(e),Zv.Disposable.create(()=>this.deregister(e))}deregister(e){super.deregister(e),this.rankedMouseListeners=hH(this.mouseListeners,t=>fH.Ranked.getRank(t))}handleEvent(e,t,i){this.focusOnMouseEvent(e,t);const o=this.getTargetElement(t,i);o&&this.notifyListenersByRank(o,e,i)}async notifyListenersByRank(e,t,i){for(const o of this.rankedMouseListeners)await this.dispatchActions(o[1],t,e,i)}async dispatchActions(e,t,i,o){const r=e.map(s=>s[t](i,o)).reduce((s,a)=>s.concat(a));if(r.length>0){o.preventDefault();for(const s of r)Zv.Action.is(s)?await this.actionDispatcher.dispatch(s):s.then(a=>{this.actionDispatcher.dispatch(a)})}}};Xf.GLSPMouseTool=pP;wq([(0,rO.inject)(Zv.LazyInjector),Aq("design:type",Object)],pP.prototype,"lazyInjector",void 0);Xf.GLSPMouseTool=pP=wq([(0,rO.injectable)(),cbe(0,(0,rO.optional)()),Aq("design:paramtypes",[Array])],pP);function hH(n,e){const t=n.reduce((i,o)=>{const r=e(o);if(!i.has(r))i.set(r,[o]);else{const s=i.get(r);s&&s.push(o)}return i},new Map);return new Map([...t.entries()].sort())}var Kg={},dbe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Kg,"__esModule",{value:!0});Kg.GViewRegistry=void 0;const ube=z,lbe=F;let sO=class extends ube.ViewRegistry{register(e,t){if(e===void 0)throw new Error("Key is undefined");this.hasKey(e)&&console.log(`View instance for type '${e}' will be overwritten.`),this.elements.set(e,t)}};Kg.GViewRegistry=sO;Kg.GViewRegistry=sO=dbe([(0,lbe.injectable)()],sO);Object.defineProperty(db,"__esModule",{value:!0});db.defaultModule=void 0;const Me=z,jD=Pt,fbe=Zf,hbe=Dg,Ev=An,pbe=it,mbe=Tg,gbe=Og,vbe=Lg,_be=Ma,pH=zc,ybe=lu,bbe=Ao,mH=ys,Sbe=Bg,gH=$g,Ebe=kg,BD=Yt,vH=It,Uh=Dr,$D=Hg,kD=Qf,FD=Xf,Cbe=Kg;db.defaultModule=new Me.FeatureModule((n,e,t,i,...o)=>{Me.sprottyDefaultModule.registry(n,e,t,i,...o);const r={bind:n,unbind:e,isBound:t,rebind:i};(0,Me.bindLazyInjector)(r),n(Ev.EditorContextService).toSelf().inSingletonScope(),n(Me.TYPES.IDiagramStartup).toService(Ev.EditorContextService),n(Me.TYPES.IEditorContextServiceProvider).toProvider(s=>async()=>s.container.get(Ev.EditorContextService)),(0,Me.configureActionHandler)(r,Me.SetEditModeAction.KIND,Ev.EditorContextService),(0,Me.configureActionHandler)(r,Me.SetDirtyStateAction.KIND,Ev.EditorContextService),n(pH.FocusTracker).toSelf().inSingletonScope(),(0,Me.configureActionHandler)(r,_be.FocusStateChangedAction.KIND,pH.FocusTracker),n(Me.TYPES.IFeedbackActionDispatcher).to(mbe.FeedbackActionDispatcher).inSingletonScope(),(0,Me.configureCommand)(r,vbe.FeedbackAwareUpdateModelCommand),i(Me.SetModelCommand).to(gbe.FeedbackAwareSetModelCommand),n(FD.GLSPMouseTool).toSelf().inSingletonScope(),(0,Me.bindOrRebind)(r,Me.MouseTool).toService(FD.GLSPMouseTool),n(Me.TYPES.IDiagramStartup).toService(FD.GLSPMouseTool),n(gH.GLSPMousePositionTracker).toSelf().inSingletonScope(),(0,Me.bindOrRebind)(r,Me.MousePositionTracker).toService(gH.GLSPMousePositionTracker),n(kD.GLSPKeyTool).toSelf().inSingletonScope(),(0,Me.bindOrRebind)(r,Me.KeyTool).toService(kD.GLSPKeyTool),n(Me.TYPES.IDiagramStartup).toService(kD.GLSPKeyTool),(0,Me.bindAsService)(r,Me.TYPES.MouseListener,Ebe.SelectionClearingMouseListener),(0,Me.bindOrRebind)(r,Me.TYPES.ICommandStack).to(hbe.GLSPCommandStack).inSingletonScope(),n(jD.GLSPActionDispatcher).toSelf().inSingletonScope(),n(Me.TYPES.IGModelRootListener).toService(jD.GLSPActionDispatcher),(0,Me.bindOrRebind)(r,Me.TYPES.IActionDispatcher).toService(jD.GLSPActionDispatcher),(0,Me.bindOrRebind)(r,Me.ActionHandlerRegistry).to(fbe.GLSPActionHandlerRegistry).inSingletonScope(),(0,Me.bindAsService)(r,Me.TYPES.ModelSource,bbe.GLSPModelSource),n(ybe.DiagramLoader).toSelf().inSingletonScope(),n(mH.ModelInitializationConstraint).to(mH.DefaultModelInitializationConstraint).inSingletonScope(),(0,Me.bindOrRebind)(r,Me.TYPES.SModelRegistry).to(Sbe.GModelRegistry).inSingletonScope(),(0,Me.bindOrRebind)(r,Me.TYPES.ViewRegistry).to(Cbe.GViewRegistry).inSingletonScope(),n(BD.SelectionService).toSelf().inSingletonScope(),n(Me.TYPES.IGModelRootListener).toService(BD.SelectionService),n(Me.TYPES.IDiagramStartup).toService(BD.SelectionService),(0,Me.configureCommand)(r,pbe.ModifyCssFeedbackCommand),(0,Me.configureCommand)(r,Me.MoveCommand),(0,Me.bindAsService)(r,Me.TYPES.IVNodePostprocessor,Me.LocationPostprocessor),n(Me.TYPES.HiddenVNodePostprocessor).toService(Me.LocationPostprocessor),n(Me.TYPES.IToolManager).to(Uh.ToolManager).inSingletonScope(),n(Me.TYPES.IDiagramStartup).toService(Me.TYPES.IToolManager),n(Me.TYPES.IEditModeListener).toService(Me.TYPES.IToolManager),n(Uh.DefaultToolsEnablingKeyListener).toSelf().inSingletonScope(),n(Me.TYPES.KeyListener).toService(Uh.DefaultToolsEnablingKeyListener),n(Uh.ToolManagerActionHandler).toSelf().inSingletonScope(),(0,Me.configureActionHandler)(r,vH.EnableDefaultToolsAction.KIND,Uh.ToolManagerActionHandler),(0,Me.configureActionHandler)(r,vH.EnableToolsAction.KIND,Uh.ToolManagerActionHandler),n($D.GLSPUIExtensionRegistry).toSelf().inSingletonScope(),(0,Me.bindOrRebind)(r,Me.TYPES.UIExtensionRegistry).toService($D.GLSPUIExtensionRegistry),n(Me.TYPES.IDiagramStartup).toService($D.GLSPUIExtensionRegistry)},{featureId:Symbol("default")});var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.DragAwareMouseListener=void 0;const _H=z;class Pbe extends _H.MouseListener{constructor(e=0){super(),this._isMouseDown=!1,this._isMouseDrag=!1,this._dragSensitivity=0,this._dragSensitivity=e}mouseDown(e,t){return this._isMouseDown=!0,this._dragStart=this._dragSensitivity>0?{x:t.clientX,y:t.clientY}:void 0,[]}mouseMove(e,t){return this._isMouseDown?this._dragStart&&_H.Point.maxDistance(this._dragStart,{x:t.clientX,y:t.clientY})<this._dragSensitivity?this.nonDraggingMouseMove(e,t):(this._isMouseDrag=!0,this.draggingMouseMove(e,t)):this.nonDraggingMouseMove(e,t)}draggingMouseMove(e,t){return[]}nonDraggingMouseMove(e,t){return[]}mouseUp(e,t){return this._isMouseDown=!1,this._dragStart=void 0,this._isMouseDrag?(this._isMouseDrag=!1,this.draggingMouseUp(e,t)):this.nonDraggingMouseUp(e,t)}nonDraggingMouseUp(e,t){return[]}draggingMouseUp(e,t){return[]}get isMouseDrag(){return this._isMouseDrag}get isMouseDown(){return this._isMouseDown}dispose(){this._isMouseDrag=!1,this._isMouseDown=!1}}Hr.DragAwareMouseListener=Pbe;var Rq={},fb={},Jf={},eh={},no={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SResizeHandle=n.removeResizeHandles=n.addResizeHandles=n.GResizeHandle=n.isBoundsAwareMoveable=n.ResizeHandleLocation=n.isResizable=n.resizeFeature=void 0;const e=z,t=it;n.resizeFeature=Symbol("resizeFeature");function i(h){return(0,e.isBoundsAware)(h)&&(0,e.isSelectable)(h)&&h instanceof e.GParentElement&&h.hasFeature(n.resizeFeature)}n.isResizable=i;var o;(function(h){h.TopLeft="top-left",h.Top="top",h.TopRight="top-right",h.Right="right",h.BottomRight="bottom-right",h.Bottom="bottom",h.BottomLeft="bottom-left",h.Left="left"})(o||(n.ResizeHandleLocation=o={})),function(h){h.CORNERS=[h.TopLeft,h.TopRight,h.BottomRight,h.BottomLeft],h.CROSS=[h.Top,h.Right,h.Bottom,h.Left],h.ALL=[...h.CORNERS,...h.CROSS];function g(S){switch(S){case h.TopLeft:return h.BottomRight;case h.Top:return h.Bottom;case h.TopRight:return h.BottomLeft;case h.Right:return h.Left;case h.BottomRight:return h.TopLeft;case h.Bottom:return h.Top;case h.BottomLeft:return h.TopRight;case h.Left:return h.Right}}h.opposite=g;function y(S){switch(S){case h.TopLeft:return[e.Direction.Up,e.Direction.Left];case h.Top:return[e.Direction.Up];case h.TopRight:return[e.Direction.Up,e.Direction.Right];case h.Right:return[e.Direction.Right];case h.BottomRight:return[e.Direction.Down,e.Direction.Right];case h.Bottom:return[e.Direction.Down];case h.BottomLeft:return[e.Direction.Down,e.Direction.Left];case h.Left:return[e.Direction.Left]}}h.direction=y}(o||(n.ResizeHandleLocation=o={}));function r(h){return(0,e.isMoveable)(h)&&(0,e.isBoundsAware)(h)}n.isBoundsAwareMoveable=r;class s extends e.GChildElement{constructor(g,y=s.TYPE,S=!1){super(),this.location=g,this.type=y,this.hoverFeedback=S}hasFeature(g){return g===e.hoverFeedbackFeature}isNwResize(){return this.location===o.TopLeft}isNResize(){return this.location===o.Top}isNeResize(){return this.location===o.TopRight}isEResize(){return this.location===o.Right}isSeResize(){return this.location===o.BottomRight}isSResize(){return this.location===o.Bottom}isSwResize(){return this.location===o.BottomLeft}isWResize(){return this.location===o.Left}isNwSeResize(){return this.isNwResize()||this.isSeResize()}isNeSwResize(){return this.isNeResize()||this.isSwResize()}static getHandlePosition(g,y){const S=s.is(g)?g.parent.bounds:g instanceof e.GModelElement?g.bounds:g;switch(s.is(g)?g.location:y){case o.TopLeft:return e.Bounds.topLeft(S);case o.Top:return e.Bounds.topCenter(S);case o.TopRight:return e.Bounds.topRight(S);case o.Right:return e.Bounds.middleRight(S);case o.BottomRight:return e.Bounds.bottomRight(S);case o.Bottom:return e.Bounds.bottomCenter(S);case o.BottomLeft:return e.Bounds.bottomLeft(S);case o.Left:return e.Bounds.middleLeft(S)}}static getCursorCss(g){switch(g.location){case o.TopLeft:return t.CursorCSS.RESIZE_NW;case o.Top:return t.CursorCSS.RESIZE_N;case o.TopRight:return t.CursorCSS.RESIZE_NE;case o.Right:return t.CursorCSS.RESIZE_E;case o.BottomRight:return t.CursorCSS.RESIZE_SE;case o.Bottom:return t.CursorCSS.RESIZE_S;case o.BottomLeft:return t.CursorCSS.RESIZE_SW;case o.Left:return t.CursorCSS.RESIZE_W}}static is(g){return typeof g=="object"&&!!g&&"type"in g&&g.type===s.TYPE}}n.GResizeHandle=s,n.SResizeHandle=s,s.TYPE="resize-handle";function a(h,g=o.CORNERS){for(const y of o.ALL){const S=h.children.find(P=>P instanceof s&&P.location===y);g.includes(y)&&!S?h.add(new s(y)):!g.includes(y)&&S&&h.remove(S)}}n.addResizeHandles=a;function f(h){h.removeAll(g=>g instanceof s)}n.removeResizeHandles=f})(no);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Direction=n.getDirectionFrom=n.getDirectionOf=n.isSelectionBounds=n.SelectionBounds=n.SELECTION_BOUNDS=n.isHelperLine=n.HelperLine=n.HELPER_LINE=n.HelperLineType=void 0;const e=z,t=wg,i=no;n.HelperLineType={Left:"left",Right:"right",Center:"center",Top:"top",Bottom:"bottom",Middle:"middle",LeftRight:"left-right",RightLeft:"right-left",BottomTop:"bottom-top",TopBottom:"top-bottom"},n.HELPER_LINE="helper-line";class o extends e.GChildElement{constructor(y=e.Point.ORIGIN,S=e.Point.ORIGIN,P=n.HelperLineType.Left){super(),this.startPoint=y,this.endPoint=S,this.lineType=P,this.id=(0,t.v4)(),this.type=n.HELPER_LINE}get isLeft(){return this.lineType===n.HelperLineType.Left||this.lineType===n.HelperLineType.LeftRight}get isRight(){return this.lineType===n.HelperLineType.Right||this.lineType===n.HelperLineType.RightLeft}get isTop(){return this.lineType===n.HelperLineType.Top||this.lineType===n.HelperLineType.TopBottom}get isBottom(){return this.lineType===n.HelperLineType.Bottom||this.lineType===n.HelperLineType.BottomTop}get isMiddle(){return this.lineType===n.HelperLineType.Middle}get isCenter(){return this.lineType===n.HelperLineType.Center}}n.HelperLine=o;function r(g){return g.type===n.HELPER_LINE}n.isHelperLine=r,n.SELECTION_BOUNDS="selection-bounds";class s extends e.GShapeElement{constructor(y){super(),this.id=(0,t.v4)(),this.type=n.SELECTION_BOUNDS,y&&(this.bounds=y)}}n.SelectionBounds=s;function a(g){return g.type===n.SELECTION_BOUNDS}n.isSelectionBounds=a,n.getDirectionOf=e.Vector.direction;function f(g){return g===i.ResizeHandleLocation.TopLeft?[e.Direction.Up,e.Direction.Left]:g===i.ResizeHandleLocation.TopRight?[e.Direction.Up,e.Direction.Right]:g===i.ResizeHandleLocation.BottomLeft?[e.Direction.Down,e.Direction.Left]:g===i.ResizeHandleLocation.BottomRight?[e.Direction.Down,e.Direction.Right]:[]}n.getDirectionFrom=f;var h=z;Object.defineProperty(n,"Direction",{enumerable:!0,get:function(){return h.Direction}})})(eh);var wbe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Abe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},DE=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Jf,"__esModule",{value:!0});Jf.PositionSnapper=void 0;const yH=z,Cv=F,Va=eh;let aO=class{constructor(e,t){this.snapper=e,this.helperLineManager=t}snapPosition(e,t,i=!0){return i&&this.snapper?this.snapper.snap(e,t):{x:e.x,y:e.y}}snapDelta(e,t,i,o){const r=this.snapPosition(e,t,i),s=this.getMinimumDelta(t,i,o);return s&&(r.x=Math.abs(r.x)>=s.x?r.x:0,r.y=Math.abs(r.y)>=s.y?r.y:0),r}getMinimumDelta(e,t,i){return this.getHelperLineMinimum(e,t,i)}getHelperLineMinimum(e,t,i){if(!this.helperLineManager)return;const o=e.root.children.filter(s=>(0,Va.isHelperLine)(s));if(o.length===0)return;const r={x:0,y:0};return i.includes(Va.Direction.Left)&&o.some(s=>s.isLeft||s.isCenter)?r.x=this.helperLineManager.getMinimumMoveDelta(e,t,Va.Direction.Left):i.includes(Va.Direction.Right)&&o.some(s=>s.isRight||s.isCenter)&&(r.x=this.helperLineManager.getMinimumMoveDelta(e,t,Va.Direction.Right)),i.includes(Va.Direction.Up)&&o.some(s=>s.isTop||s.isMiddle)?r.y=this.helperLineManager.getMinimumMoveDelta(e,t,Va.Direction.Up):i.includes(Va.Direction.Down)&&o.some(s=>s.isBottom||s.isMiddle)&&(r.y=this.helperLineManager.getMinimumMoveDelta(e,t,Va.Direction.Down)),r}};Jf.PositionSnapper=aO;Jf.PositionSnapper=aO=wbe([(0,Cv.injectable)(),DE(0,(0,Cv.optional)()),DE(0,(0,Cv.inject)(yH.TYPES.ISnapper)),DE(1,(0,Cv.optional)()),DE(1,(0,Cv.inject)(yH.TYPES.IHelperLineManager)),Abe("design:paramtypes",[Object,Object])],aO);var Vg={},Ia={};Object.defineProperty(Ia,"__esModule",{value:!0});Ia.LayoutAware=void 0;var bH;(function(n){function e(a){return"layoutData"in a}n.is=e;function t(a){return e(a)?a.layoutData:void 0}n.getLayoutData=t;function i(a,f){a.layoutData=f}n.setLayoutData=i;function o(a,f){s(a).layoutData.computedDimensions=f}n.setComputedDimensions=o;function r(a){var f;return(f=t(a))===null||f===void 0?void 0:f.computedDimensions}n.getComputedDimensions=r;function s(a){var f;return a.layoutData=(f=a.layoutData)!==null&&f!==void 0?f:{},a}})(bH||(Ia.LayoutAware=bH={}));var Rbe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Vg,"__esModule",{value:!0});Vg.FreeFormLayouter=void 0;const SH=z,Mbe=F,Ibe=Ia;let mP=class extends SH.AbstractLayout{layout(e,t){const i=t.getBoundsData(e),o=this.getLayoutOptions(e),r=this.getChildrenSize(e,o,t),s=r.width>0?r.width+o.paddingLeft+o.paddingRight:0,a=r.height>0?r.height+o.paddingTop+o.paddingBottom:0;if(r.width>0&&r.height>0){const f=this.layoutChildren(e,t,o,s,a),h=this.getComputedContainerDimensions(o,r.width,r.height);Ibe.LayoutAware.setComputedDimensions(i,h),i.bounds=this.getFinalContainerBounds(e,f,o,h.width,h.height),i.boundsChanged=!0}else i.bounds={x:i.bounds.x,y:i.bounds.y,width:0,height:0},i.boundsChanged=!0}getChildrenSize(e,t,i){let o=0,r=0;return e.children.forEach(s=>{const a=i.getBoundsData(s).bounds;if(a!==void 0&&SH.Dimension.isValid(a)){const f=a.x+a.width,h=a.y+a.height;o=Math.max(o,f),r=Math.max(r,h)}}),{width:o,height:r}}layoutChild(e,t,i,o,r,s,a,f){return t.bounds={x:e.bounds.x,y:e.bounds.y,width:i.width,height:i.height},t.boundsChanged=!0,s}getComputedContainerDimensions(e,t,i){return{width:t+e.paddingLeft+e.paddingRight,height:i+e.paddingTop+e.paddingBottom}}getFinalContainerBounds(e,t,i,o,r){return{x:e.bounds.x,y:e.bounds.y,width:Math.max(i.minWidth,o),height:Math.max(i.minHeight,r)}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingFactor:1,minWidth:0,minHeight:0}}spread(e,t){return{...e,...t}}};Vg.FreeFormLayouter=mP;mP.KIND="freeform";Vg.FreeFormLayouter=mP=Rbe([(0,Mbe.injectable)()],mP);var hu={},Ro={},u9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},l9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Dbe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.LocalComputedBoundsCommand=Ro.LocalComputedBoundsAction=Ro.LocalRequestBoundsAction=void 0;const ta=z,gP=F,cO=Ao,EH=Ia;var CH;(function(n){function e(o){return ta.RequestBoundsAction.is(o)&&!cO.ServerAction.is(o)&&(0,ta.hasArrayProp)(o,"elementIDs",!0)}n.is=e;function t(o,r){return{...ta.RequestBoundsAction.create(o),elementIDs:r}}n.create=t;function i({root:o},r,s,a){return r.dispatch(n.create(o,a)),{model:o,modelChanged:!1,cause:s}}n.fromCommand=i})(CH||(Ro.LocalRequestBoundsAction=CH={}));var dO;(function(n){function e(i){return ta.ComputedBoundsAction.is(i)&&cO.ServerAction.is(i)}n.is=e;function t(i){return cO.ServerAction.mark(i),i}n.mark=t})(dO||(Ro.LocalComputedBoundsAction=dO={}));let lm=class extends ta.Command{constructor(e){super(),this.action=e}execute(e){var t,i;return dO.is(this.action)?(this.viewerOptions.needsClientLayout&&(this.computedBoundsApplicator.apply(e.root,this.action),(t=this.action.layoutData)===null||t===void 0||t.forEach(({elementId:o,layoutData:r})=>{const s=e.root.index.getById(o);s!==void 0&&EH.LayoutAware.setLayoutData(s,r)})),e.root):((i=this.action.layoutData)===null||i===void 0||i.forEach(({elementId:o,layoutData:r})=>{const s=e.root.index.getById(o);s!==void 0&&EH.LayoutAware.setLayoutData(s,r)}),{model:e.root,modelChanged:!1})}undo(e){return e.root}redo(e){return e.root}};Ro.LocalComputedBoundsCommand=lm;lm.KIND=ta.ComputedBoundsAction.KIND;u9([(0,gP.inject)(ta.ComputedBoundsApplicator),l9("design:type",ta.ComputedBoundsApplicator)],lm.prototype,"computedBoundsApplicator",void 0);u9([(0,gP.inject)(ta.TYPES.ViewerOptions),l9("design:type",Object)],lm.prototype,"viewerOptions",void 0);Ro.LocalComputedBoundsCommand=lm=u9([(0,gP.injectable)(),Dbe(0,(0,gP.inject)(ta.TYPES.Action)),l9("design:paramtypes",[Object])],lm);var Mq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Tbe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(hu,"__esModule",{value:!0});hu.GLSPHiddenBoundsUpdater=hu.BoundsDataExt=void 0;const El=z,uO=F,xD=kt,Obe=Ia,HD=Ro;class Lbe extends El.BoundsData{}hu.BoundsDataExt=Lbe;let vP=class extends El.HiddenBoundsUpdater{constructor(){super(...arguments),this.element2route=[]}getElement2BoundsData(){return this.element2boundsData}decorate(e,t){return super.decorate(e,t),(0,xD.isRoutable)(t)&&this.element2route.push((0,xD.calcElementAndRoute)(t,this.edgeRouterRegistry)),e}postUpdate(e){HD.LocalRequestBoundsAction.is(e)&&e.elementIDs&&this.focusOnElements(e.elementIDs),this.getBoundsFromDOM(),this.layouter.layout(this.getElement2BoundsData());const t=[],i=[],o=[];this.getElement2BoundsData().forEach((h,g)=>{if(h.boundsChanged&&h.bounds!==void 0){const y={elementId:g.id,newSize:{width:h.bounds.width,height:h.bounds.height}};g instanceof El.GChildElement&&(0,El.isLayoutContainer)(g.parent)&&(y.newPosition={x:h.bounds.x,y:h.bounds.y}),t.push(y)}h.alignmentChanged&&h.alignment!==void 0&&i.push({elementId:g.id,newAlignment:h.alignment}),Obe.LayoutAware.is(h)&&o.push({elementId:g.id,layoutData:h.layoutData})});const r=this.element2route.length===0?void 0:this.element2route,s=e.requestId,a=this.root!==void 0?this.root.revision:void 0,f=El.ComputedBoundsAction.create(t,{revision:a,alignments:i,layoutData:o,routes:r,responseId:s});HD.LocalRequestBoundsAction.is(e)&&HD.LocalComputedBoundsAction.mark(f),this.actionDispatcher.dispatch(f),this.getElement2BoundsData().clear(),this.element2route=[]}focusOnElements(e){const t=this.getElement2BoundsData();if(t.size>0){const i=[...t.keys()][0].index,o=new Set(e.flatMap(r=>this.expandElementId(r,i,e)));t.forEach((r,s)=>!o.has(s.id)&&t.delete(s))}}expandElementId(e,t,i){return(0,xD.getDescendantIds)(t.getById(e))}};hu.GLSPHiddenBoundsUpdater=vP;Mq([(0,uO.inject)(El.EdgeRouterRegistry),(0,uO.optional)(),Tbe("design:type",El.EdgeRouterRegistry)],vP.prototype,"edgeRouterRegistry",void 0);hu.GLSPHiddenBoundsUpdater=vP=Mq([(0,uO.injectable)()],vP);var zg={},Nbe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(zg,"__esModule",{value:!0});zg.HBoxLayouterExt=void 0;const yd=z,jbe=F,Bbe=Ia;let _P=class extends yd.HBoxLayouter{layout(e,t){var i,o;const r=t.getBoundsData(e),s=this.getLayoutOptions(e),a=this.getChildrenSize(e,s,t),f=this.getFixedContainerBounds(e,s,t),h=r.bounds?((i=r.bounds)===null||i===void 0?void 0:i.width)-s.paddingLeft-s.paddingRight:0,g=r.bounds?((o=r.bounds)===null||o===void 0?void 0:o.height)-s.paddingTop-s.paddingBottom:0,y=s.paddingFactor*(s.resizeContainer?Math.max(f.width-s.paddingLeft-s.paddingRight,a.width):Math.max(0,f.width-s.paddingLeft-s.paddingRight)),S=s.paddingFactor*(s.resizeContainer?Math.max(f.height-s.paddingTop-s.paddingBottom,a.height):Math.max(0,f.height-s.paddingTop-s.paddingBottom)),P=Math.max(h,y),w=Math.max(g,S),C=P-a.width,E=e.children.map(D=>this.getChildLayoutOptions(D,s)).filter(D=>D.hGrab).length;if(P>0&&w>0){const D=this.layoutChildren(e,t,s,P,w,C,E),j=this.getComputedContainerDimensions(s,a.width,a.height);Bbe.LayoutAware.setComputedDimensions(r,j),r.bounds=this.getFinalContainerBounds(e,D,s,j.width,j.height),r.boundsChanged=!0}}getChildrenSize(e,t,i){let o=0,r=-1,s=!0;return e.children.forEach(f=>{if((0,yd.isLayoutableChild)(f)){const h=i.getBoundsData(f).bounds;h!==void 0&&yd.Dimension.isValid(h)&&(o+=h.width,s?s=!1:o+=t.hGap,r=Math.max(r,h.height))}}),{width:o,height:r}}layoutChildren(e,t,i,o,r,s,a){let f={x:i.paddingLeft+.5*(o-o/i.paddingFactor),y:i.paddingTop+.5*(r-r/i.paddingFactor)};return e.children.forEach(h=>{if((0,yd.isLayoutableChild)(h)){const g=t.getBoundsData(h),y=g.bounds,S=this.getChildLayoutOptions(h,i);y!==void 0&&yd.Dimension.isValid(y)&&(f=this.layoutChild(h,g,y,S,i,f,o,r,s,a))}}),f}layoutChild(e,t,i,o,r,s,a,f,h,g){const y=o.vGrab?"top":o.vAlign,S=this.getDy(y,i,f);let P=super.layoutChild(e,t,i,o,r,s,a,f);if(t.bounds={...t.bounds,x:s.x,y:s.y+S},o.vGrab&&(t.bounds={x:t.bounds.x,y:t.bounds.y,width:t.bounds.width,height:f},t.boundsChanged=!0),o.hGrab&&h&&g){const w=t.bounds.width+h/g;t.bounds={x:t.bounds.x,y:t.bounds.y,width:w,height:t.bounds.height},t.boundsChanged=!0,P={x:s.x+w,y:s.y}}return P}getFixedContainerBounds(e,t,i){var o,r;const s=e;if((0,yd.isBoundsAware)(s)){const a=s.bounds,f=this.getElementLayoutOptions(s),h=(o=f==null?void 0:f.prefWidth)!==null&&o!==void 0?o:0,g=(r=f==null?void 0:f.prefHeight)!==null&&r!==void 0?r:0;return{...a,width:h,height:g}}return yd.Bounds.EMPTY}getChildLayoutOptions(e,t){return super.getChildLayoutOptions(e,this.filterContainerOptions(t))}getLayoutOptions(e){return super.getLayoutOptions(e)}getElementLayoutOptions(e){return e.layoutOptions}getComputedContainerDimensions(e,t,i){return{width:t+e.paddingLeft+e.paddingRight,height:i+e.paddingTop+e.paddingBottom}}getFinalContainerBounds(e,t,i,o,r){var s,a;const f=this.getElementLayoutOptions(e),h=(s=f==null?void 0:f.prefWidth)!==null&&s!==void 0?s:i.minWidth,g=(a=f==null?void 0:f.prefHeight)!==null&&a!==void 0?a:i.minHeight;return{x:e.bounds.x,y:e.bounds.y,width:Math.max(h,o),height:Math.max(g,r)}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,hGap:1,vAlign:"center",minWidth:0,minHeight:0,hGrab:!1,vGrab:!1,prefHeight:null,prefWidth:null}}filterContainerOptions(e){return{...e,...{vGrab:!1,hGrab:!1,prefHeight:null,prefWidth:null}}}};zg.HBoxLayouterExt=_P;_P.KIND=yd.HBoxLayouter.KIND;zg.HBoxLayouterExt=_P=Nbe([(0,jbe.injectable)()],_P);var pu={},$be=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(pu,"__esModule",{value:!0});pu.StatefulLayouterExt=pu.LayouterExt=void 0;const kbe=F,vl=z;let lO=class extends vl.Layouter{layout(e){new Iq(e,this.layoutRegistry,this.logger).layout()}};pu.LayouterExt=lO;pu.LayouterExt=lO=$be([(0,kbe.injectable)()],lO);class Iq extends vl.StatefulLayouter{constructor(e,t,i){super(e,t,i),this.elementToBoundsData=e,this.layoutRegistry2=t,this.toBeLayouted2=[],e.forEach((o,r)=>{(0,vl.isLayoutContainer)(r)&&this.toBeLayouted2.push(r)});for(const o of this.toBeLayouted2)e.delete(o)}getBoundsData(e){let t=this.elementToBoundsData.get(e),i=e.bounds;return(0,vl.isLayoutContainer)(e)&&this.toBeLayouted2.indexOf(e)>=0?i=this.doLayout(e):(0,vl.isLayoutContainer)(e)&&(i={x:0,y:0,width:-1,height:-1}),t||(t={bounds:i,boundsChanged:!1,alignmentChanged:!1},this.elementToBoundsData.set(e,t)),t}layout(){for(;this.toBeLayouted2.length>0;){const e=this.toBeLayouted2[0];this.doLayout(e)}for(this.toBeLayouted2=[],this.elementToBoundsData.forEach((e,t)=>{(0,vl.isLayoutContainer)(t)&&this.toBeLayouted2.push(t)});this.toBeLayouted2.length>0;){const e=this.toBeLayouted2[0];this.doLayout(e)}}doLayout(e){const t=this.toBeLayouted2.indexOf(e);t>=0&&this.toBeLayouted2.splice(t,1);const i=this.layoutRegistry2.get(e.layout);i&&i.layout(e,this);const o=this.elementToBoundsData.get(e);return o!==void 0&&o.bounds!==void 0?o.bounds:(this.log.error(e,"Layout failed"),vl.Bounds.EMPTY)}}pu.StatefulLayouterExt=Iq;var Ss={},Dq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Fbe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Ss,"__esModule",{value:!0});Ss.SetBoundsFeedbackCommand=Ss.SetBoundsFeedbackAction=void 0;const yP=z,Tq=F,xbe=Pt,Hbe=Is,Kbe=Ro;var fO;(function(n){n.KIND="setBoundsFeedback";function e(i){return yP.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,bounds:i}}n.create=t})(fO||(Ss.SetBoundsFeedbackAction=fO={}));let Ey=class extends yP.SetBoundsCommand{constructor(){super(...arguments),this.rank=Hbe.Ranked.DEFAULT_RANK}execute(e){super.execute(e),this.action.bounds.forEach(i=>{var o;const r=e.root.index.getById(i.elementId);if(r&&(0,yP.isLayoutContainer)(r)){const s=(o=r.layoutOptions)!==null&&o!==void 0?o:{};s.prefHeight=i.newSize.height,s.prefWidth=i.newSize.width,r.layoutOptions=s}});const t=this.action.bounds.map(i=>i.elementId);return Kbe.LocalRequestBoundsAction.fromCommand(e,this.actionDispatcher,this.action,t)}};Ss.SetBoundsFeedbackCommand=Ey;Ey.KIND=fO.KIND;Dq([(0,Tq.inject)(yP.TYPES.IActionDispatcher),Fbe("design:type",xbe.GLSPActionDispatcher)],Ey.prototype,"actionDispatcher",void 0);Ss.SetBoundsFeedbackCommand=Ey=Dq([(0,Tq.injectable)()],Ey);var Gg={},Vbe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Gg,"__esModule",{value:!0});Gg.VBoxLayouterExt=void 0;const bd=z,zbe=F,Gbe=Ia;let bP=class extends bd.VBoxLayouter{layout(e,t){var i,o;const r=t.getBoundsData(e),s=this.getLayoutOptions(e),a=this.getChildrenSize(e,s,t),f=this.getFixedContainerBounds(e,s,t),h=(((i=r.bounds)===null||i===void 0?void 0:i.width)||0)-s.paddingLeft-s.paddingRight,g=(((o=r.bounds)===null||o===void 0?void 0:o.height)||0)-s.paddingTop-s.paddingBottom,y=s.paddingFactor*(s.resizeContainer?Math.max(f.width-s.paddingLeft-s.paddingRight,a.width):Math.max(0,f.width-s.paddingLeft-s.paddingRight)),S=s.paddingFactor*(s.resizeContainer?Math.max(f.height-s.paddingTop-s.paddingBottom,a.height):Math.max(0,f.height-s.paddingTop-s.paddingBottom)),P=Math.max(h,y),w=Math.max(g,S),C=w-a.height,E=e.children.map(D=>this.getChildLayoutOptions(D,s)).filter(D=>D.vGrab).length;if(y>0&&S>0){const D=this.layoutChildren(e,t,s,P,w,C,E),j=this.getComputedContainerDimensions(s,a.width,a.height);Gbe.LayoutAware.setComputedDimensions(r,j),r.bounds=this.getFinalContainerBounds(e,D,s,j.width,j.height),r.boundsChanged=!0}}getChildrenSize(e,t,i){let o=-1,r=0,s=!0;return e.children.forEach(f=>{if((0,bd.isLayoutableChild)(f)){const h=i.getBoundsData(f).bounds;h!==void 0&&bd.Dimension.isValid(h)&&(r+=h.height,s?s=!1:r+=t.vGap,o=Math.max(o,h.width))}}),{width:o,height:r}}layoutChildren(e,t,i,o,r,s,a){let f={x:i.paddingLeft+.5*(o-o/i.paddingFactor),y:i.paddingTop+.5*(r-r/i.paddingFactor)};return e.children.forEach(h=>{if((0,bd.isLayoutableChild)(h)){const g=t.getBoundsData(h),y=g.bounds,S=this.getChildLayoutOptions(h,i);y!==void 0&&bd.Dimension.isValid(y)&&(f=this.layoutChild(h,g,y,S,i,f,o,r,s,a))}}),f}layoutChild(e,t,i,o,r,s,a,f,h,g){const y=o.hGrab?"left":o.hAlign,S=this.getDx(y,i,a);let P=super.layoutChild(e,t,i,o,r,s,a,f);if(t.bounds={...t.bounds,x:s.x+S,y:s.y},o.hGrab&&(t.bounds={x:t.bounds.x,y:t.bounds.y,width:a,height:t.bounds.height},t.boundsChanged=!0),o.vGrab&&h&&g){const w=t.bounds.height+h/g;t.bounds={x:t.bounds.x,y:t.bounds.y,width:t.bounds.width,height:w},t.boundsChanged=!0,P={x:s.x,y:s.y+w}}return P}getFixedContainerBounds(e,t,i){var o,r;const s=e;if((0,bd.isBoundsAware)(s)){const a=s.bounds,f=this.getElementLayoutOptions(s),h=(o=f==null?void 0:f.prefWidth)!==null&&o!==void 0?o:0,g=(r=f==null?void 0:f.prefHeight)!==null&&r!==void 0?r:0;return{...a,width:h,height:g}}return bd.Bounds.EMPTY}getChildLayoutOptions(e,t){return super.getChildLayoutOptions(e,this.filterContainerOptions(t))}getLayoutOptions(e){return super.getLayoutOptions(e)}getElementLayoutOptions(e){return e.layoutOptions}getComputedContainerDimensions(e,t,i){return{width:t+e.paddingLeft+e.paddingRight,height:i+e.paddingTop+e.paddingBottom}}getFinalContainerBounds(e,t,i,o,r){var s,a;const f=this.getElementLayoutOptions(e),h=(s=f==null?void 0:f.prefWidth)!==null&&s!==void 0?s:i.minWidth,g=(a=f==null?void 0:f.prefHeight)!==null&&a!==void 0?a:i.minHeight;return{x:e.bounds.x,y:e.bounds.y,width:Math.max(h,o),height:Math.max(g,r)}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,vGap:1,hAlign:"center",minWidth:0,minHeight:0,hGrab:!1,vGrab:!1,prefHeight:null,prefWidth:null}}filterContainerOptions(e){return{...e,...{vGrab:!1,hGrab:!1,prefHeight:null,prefWidth:null}}}};Gg.VBoxLayouterExt=bP;bP.KIND=bd.VBoxLayouter.KIND;Gg.VBoxLayouterExt=bP=Vbe([(0,zbe.injectable)()],bP);Object.defineProperty(fb,"__esModule",{value:!0});fb.boundsModule=void 0;const Yn=z,Ube=Jf,PH=Vg,Ybe=hu,qbe=zg,Wbe=pu,Zbe=Ro,Qbe=Ss,Xbe=Gg;fb.boundsModule=new Yn.FeatureModule((n,e,t,i)=>{const o={bind:n,isBound:t};(0,Yn.configureCommand)(o,Yn.SetBoundsCommand),(0,Yn.configureCommand)(o,Yn.RequestBoundsCommand),n(Yn.HiddenBoundsUpdater).toSelf().inSingletonScope(),(0,Yn.bindAsService)(o,Yn.TYPES.HiddenVNodePostprocessor,Ybe.GLSPHiddenBoundsUpdater),(0,Yn.configureCommand)(o,Zbe.LocalComputedBoundsCommand),(0,Yn.configureCommand)(o,Qbe.SetBoundsFeedbackCommand),n(Yn.TYPES.Layouter).to(Wbe.LayouterExt).inSingletonScope(),n(Yn.TYPES.LayoutRegistry).to(Yn.LayoutRegistry).inSingletonScope(),(0,Yn.configureLayout)(o,Yn.VBoxLayouter.KIND,Xbe.VBoxLayouterExt),(0,Yn.configureLayout)(o,Yn.HBoxLayouter.KIND,qbe.HBoxLayouterExt),(0,Yn.configureLayout)(o,PH.FreeFormLayouter.KIND,PH.FreeFormLayouter),n(Ube.PositionSnapper).toSelf()},{featureId:Symbol("bounds")});var hb={},Ug={},Jbe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Ug,"__esModule",{value:!0});Ug.GlspCommandPalette=void 0;const eSe=z,tSe=F,KD=Ms;let hO=class extends eSe.CommandPalette{initializeContents(e){super.initializeContents(e),e.classList.add(KD.CSS_UI_EXTENSION_CLASS)}setContainerVisible(e){var t,i;e?(t=this.containerElement)===null||t===void 0||t.classList.remove(KD.CSS_HIDDEN_EXTENSION_CLASS):(i=this.containerElement)===null||i===void 0||i.classList.add(KD.CSS_HIDDEN_EXTENSION_CLASS)}};Ug.GlspCommandPalette=hO;Ug.GlspCommandPalette=hO=Jbe([(0,tSe.injectable)()],hO);var Yg={},f9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},b3=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},pO;Object.defineProperty(Yg,"__esModule",{value:!0});Yg.CommandPaletteTool=void 0;const h9=F,mO=z;let fm=pO=class{postConstruct(){this.commandPaletteKeyListener=this.createCommandPaletteKeyListener()}get id(){return pO.ID}enable(){this.keyTool.register(this.commandPaletteKeyListener)}disable(){this.keyTool.deregister(this.commandPaletteKeyListener)}createCommandPaletteKeyListener(){return new mO.CommandPaletteKeyListener}};Yg.CommandPaletteTool=fm;fm.ID="glsp.command-palette-tool";f9([(0,h9.inject)(mO.KeyTool),b3("design:type",mO.KeyTool)],fm.prototype,"keyTool",void 0);f9([(0,h9.postConstruct)(),b3("design:type",Function),b3("design:paramtypes",[]),b3("design:returntype",void 0)],fm.prototype,"postConstruct",null);Yg.CommandPaletteTool=fm=pO=f9([(0,h9.injectable)()],fm);var mu={},p9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Oq=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(mu,"__esModule",{value:!0});mu.ServerCommandPaletteActionProvider=mu.ServerCommandPalette=void 0;const m9=F,gO=z,nSe=Pt,wH=An;var y_;(function(n){n.CONTEXT_ID="command-palette",n.TEXT="text",n.INDEX="index"})(y_||(mu.ServerCommandPalette=y_={}));let Cy=class{async getActions(e,t,i,o){const r=gO.RequestContextActions.create({contextId:y_.CONTEXT_ID,editorContext:this.editorContext.get({[y_.TEXT]:t,[y_.INDEX]:o||0})}),s=await this.actionDispatcher.requestUntil(r);return s?this.getPaletteActionsFromResponse(s):[]}getPaletteActionsFromResponse(e){return gO.SetContextActions.is(e)?e.actions:[]}};mu.ServerCommandPaletteActionProvider=Cy;p9([(0,m9.inject)(gO.TYPES.IActionDispatcher),Oq("design:type",nSe.GLSPActionDispatcher)],Cy.prototype,"actionDispatcher",void 0);p9([(0,m9.inject)(wH.EditorContextService),Oq("design:type",wH.EditorContextService)],Cy.prototype,"editorContext",void 0);mu.ServerCommandPaletteActionProvider=Cy=p9([(0,m9.injectable)()],Cy);Object.defineProperty(hb,"__esModule",{value:!0});hb.commandPaletteModule=void 0;const za=z,iSe=Ug,oSe=Yg,rSe=mu;hb.commandPaletteModule=new za.FeatureModule(n=>{(0,za.bindAsService)(n,za.TYPES.IUIExtension,iSe.GlspCommandPalette),n(za.TYPES.ICommandPaletteActionProviderRegistry).to(za.CommandPaletteActionProviderRegistry).inSingletonScope(),(0,za.bindAsService)(n,za.TYPES.ICommandPaletteActionProvider,rSe.ServerCommandPaletteActionProvider),(0,za.bindAsService)(n,za.TYPES.IDefaultTool,oSe.CommandPaletteTool)},{featureId:Symbol("commandPalette")});var pb={},qg={},mb=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Rp=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(qg,"__esModule",{value:!0});qg.GLSPContextMenuMouseListener=void 0;const Rd=z,Wl=F,AH=Pt,sSe=Ma;let Zl=class extends Rd.MouseListener{initialize(){var e;(e=this.contextMenuServiceProvider)===null||e===void 0||e.call(this).then(t=>this.menuService=t)}contextMenu(e,t){return this.openContextMenu(e,t)}openContextMenu(e,t){return!this.menuService||!this.menuProvider?[]:[this.showContextMenuItems(e,t)]}async showContextMenuItems(e,t){await this.handleContextElementSelection(e,t);const i={x:t.x,y:t.y},o=await this.menuProvider.getItems(e.root,i);return this.menuService.show(o,i,()=>this.focusEventTarget(t)),sSe.FocusStateChangedAction.create(!1)}async handleContextElementSelection(e,t){const i=(0,Rd.findParentByFeature)(e,Rd.isSelectable);if(!i)return this.actionDispatcher.dispatch(Rd.SelectAction.setSelection([]));if(!i.selected)return this.actionDispatcher.dispatch(Rd.SelectAction.setSelection([i.id]))}focusEventTarget(e){const t=e.target instanceof SVGElement?e.target:void 0,i=t==null?void 0:t.closest("svg");i&&i.focus()}};qg.GLSPContextMenuMouseListener=Zl;mb([(0,Wl.inject)(Rd.TYPES.IContextMenuServiceProvider),(0,Wl.optional)(),Rp("design:type",Function)],Zl.prototype,"contextMenuServiceProvider",void 0);mb([(0,Wl.inject)(Rd.TYPES.IContextMenuProviderRegistry),(0,Wl.optional)(),Rp("design:type",Rd.ContextMenuProviderRegistry)],Zl.prototype,"menuProvider",void 0);mb([(0,Wl.inject)(AH.GLSPActionDispatcher),Rp("design:type",AH.GLSPActionDispatcher)],Zl.prototype,"actionDispatcher",void 0);mb([(0,Wl.postConstruct)(),Rp("design:type",Function),Rp("design:paramtypes",[]),Rp("design:returntype",void 0)],Zl.prototype,"initialize",null);qg.GLSPContextMenuMouseListener=Zl=mb([(0,Wl.injectable)()],Zl);var gu={},g9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Lq=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(gu,"__esModule",{value:!0});gu.ServerContextMenuItemProvider=gu.ServerContextMenu=void 0;const v9=F,S3=z,aSe=Pt,RH=An;var vO;(function(n){n.CONTEXT_ID="context-menu"})(vO||(gu.ServerContextMenu=vO={}));let Py=class{async getItems(e,t){const i=Array.from(e.index.all().filter(S3.isSelected).map(a=>a.id)),o=this.editorContext.getWithSelection(i),r=S3.RequestContextActions.create({contextId:vO.CONTEXT_ID,editorContext:o}),s=await this.actionDispatcher.requestUntil(r);return s?this.getContextActionsFromResponse(s):[]}getContextActionsFromResponse(e){return S3.SetContextActions.is(e)?e.actions:[]}};gu.ServerContextMenuItemProvider=Py;g9([(0,v9.inject)(S3.TYPES.IActionDispatcher),Lq("design:type",aSe.GLSPActionDispatcher)],Py.prototype,"actionDispatcher",void 0);g9([(0,v9.inject)(RH.EditorContextService),Lq("design:type",RH.EditorContextService)],Py.prototype,"editorContext",void 0);gu.ServerContextMenuItemProvider=Py=g9([(0,v9.injectable)()],Py);Object.defineProperty(pb,"__esModule",{value:!0});pb.contextMenuModule=void 0;const Bs=z,cSe=qg,dSe=gu;pb.contextMenuModule=new Bs.FeatureModule(n=>{n(Bs.TYPES.IContextMenuServiceProvider).toProvider(e=>async()=>e.container.isBound(Bs.TYPES.IContextMenuService)?e.container.get(Bs.TYPES.IContextMenuService):(console.warn("'TYPES.IContextMenuService' is not bound. Use no-op implementation instead"),{show:()=>{}})),(0,Bs.bindAsService)(n,Bs.TYPES.MouseListener,cSe.GLSPContextMenuMouseListener),n(Bs.TYPES.IContextMenuProviderRegistry).to(Bs.ContextMenuProviderRegistry),(0,Bs.bindAsService)(n,Bs.TYPES.IContextMenuItemProvider,dSe.ServerContextMenuItemProvider)},{featureId:Symbol("contextMenu")});var OR={},yc={},Wg=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},LR=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(yc,"__esModule",{value:!0});yc.ServerCopyPasteHandler=yc.LocalClipboardService=void 0;const Zg=F,uSe=wg,Mp=z,lSe=Pt,MH=An;let _O=class{clear(){this.currentId=void 0,this.data=void 0}put(e,t){this.currentId=t,this.data=e}get(e){if(e===this.currentId)return this.data}};yc.LocalClipboardService=_O;yc.LocalClipboardService=_O=Wg([(0,Zg.injectable)()],_O);function fSe(n){return JSON.stringify({clipboardId:n})}function hSe(n){return n!==void 0&&"clipboardId"in n}function pSe(n){const e=n.getData(Nq),t=e?JSON.parse(e):void 0;return hSe(t)?t.clipboardId:void 0}const Nq="text/plain";let Ql=class{handleCopy(e){if(e.clipboardData&&this.shouldCopy(e)){const t=(0,uSe.v4)();e.clipboardData.setData(Nq,fSe(t)),this.actionDispatcher.request(Mp.RequestClipboardDataAction.create(this.editorContext.get())).then(i=>this.clipboardService.put(i.clipboardData,t)),e.preventDefault()}else e.clipboardData&&e.clipboardData.clearData(),this.clipboardService.clear()}handleCut(e){e.clipboardData&&this.shouldCopy(e)&&(this.handleCopy(e),this.actionDispatcher.dispatch(Mp.CutOperation.create(this.editorContext.get())),e.preventDefault())}handlePaste(e){if(e.clipboardData&&this.shouldPaste(e)){const t=pSe(e.clipboardData),i=this.clipboardService.get(t);i&&this.actionDispatcher.dispatch(Mp.PasteOperation.create({clipboardData:i,editorContext:this.editorContext.get()})),e.preventDefault()}}shouldCopy(e){return this.editorContext.get().selectedElementIds.length>0&&this.isDiagramActive()}shouldPaste(e){return this.isDiagramActive()}isDiagramActive(){var e,t;return((t=(e=document.activeElement)===null||e===void 0?void 0:e.parentElement)===null||t===void 0?void 0:t.id)===this.viewerOptions.baseDiv}};yc.ServerCopyPasteHandler=Ql;Wg([(0,Zg.inject)(Mp.TYPES.IActionDispatcher),LR("design:type",lSe.GLSPActionDispatcher)],Ql.prototype,"actionDispatcher",void 0);Wg([(0,Zg.inject)(Mp.TYPES.ViewerOptions),LR("design:type",Object)],Ql.prototype,"viewerOptions",void 0);Wg([(0,Zg.inject)(Mp.TYPES.IAsyncClipboardService),LR("design:type",Object)],Ql.prototype,"clipboardService",void 0);Wg([(0,Zg.inject)(MH.EditorContextService),LR("design:type",MH.EditorContextService)],Ql.prototype,"editorContext",void 0);yc.ServerCopyPasteHandler=Ql=Wg([(0,Zg.injectable)()],Ql);var Qg={},_9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},E3=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Qg,"__esModule",{value:!0});Qg.CopyPasteStartup=void 0;const yO=z,SP=F;let wy=class{constructor(){this.toDispose=new yO.DisposableCollection}postModelInitialization(){if(!this.copyPasteHandler)return;const e=o=>{var r;(r=this.copyPasteHandler)===null||r===void 0||r.handleCopy(o)},t=o=>{var r;(r=this.copyPasteHandler)===null||r===void 0||r.handleCut(o)},i=o=>{var r;(r=this.copyPasteHandler)===null||r===void 0||r.handlePaste(o)};window.addEventListener("copy",e),window.addEventListener("cut",t),window.addEventListener("paste",i),this.toDispose.push(yO.Disposable.create(()=>{window.removeEventListener("copy",e),window.removeEventListener("cut",t),window.removeEventListener("paste",i)}))}dispose(){this.toDispose.dispose()}};Qg.CopyPasteStartup=wy;_9([(0,SP.inject)(yO.TYPES.ICopyPasteHandler),(0,SP.optional)(),E3("design:type",Object)],wy.prototype,"copyPasteHandler",void 0);_9([(0,SP.preDestroy)(),E3("design:type",Function),E3("design:paramtypes",[]),E3("design:returntype",void 0)],wy.prototype,"dispose",null);Qg.CopyPasteStartup=wy=_9([(0,SP.injectable)()],wy);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneCopyPasteModule=n.copyPasteModule=void 0;const e=z,t=yc,i=Qg;n.copyPasteModule=new e.FeatureModule((o,r,s)=>{o(e.TYPES.ICopyPasteHandler).to(t.ServerCopyPasteHandler),o(e.TYPES.IAsyncClipboardService).to(t.LocalClipboardService).inSingletonScope()},{featureId:Symbol("copyPaste")}),n.standaloneCopyPasteModule=new e.FeatureModule((o,r,s)=>{(0,e.bindAsService)(o,e.TYPES.IDiagramStartup,i.CopyPasteStartup)},{featureId:Symbol("standaloneCopyPaste"),requires:n.copyPasteModule})})(OR);var gb={},Xg={},mSe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},C3;Object.defineProperty(Xg,"__esModule",{value:!0});Xg.GlspDecorationPlacer=void 0;const Pv=z,gSe=F;let EP=C3=class extends Pv.DecorationPlacer{getPosition(e){return e instanceof Pv.GChildElement&&e.parent instanceof Pv.GRoutableElement?super.getPosition(e):(0,Pv.isSizeable)(e)?{x:-C3.DECORATION_OFFSET.x,y:-C3.DECORATION_OFFSET.y}:Pv.Point.ORIGIN}};Xg.GlspDecorationPlacer=EP;EP.DECORATION_OFFSET={x:12,y:10};Xg.GlspDecorationPlacer=EP=C3=mSe([(0,gSe.injectable)()],EP);Object.defineProperty(gb,"__esModule",{value:!0});gb.decorationModule=void 0;const VD=z,vSe=Xg;gb.decorationModule=new VD.FeatureModule(n=>{(0,VD.bindAsService)(n,VD.TYPES.IVNodePostprocessor,vSe.GlspDecorationPlacer)},{featureId:Symbol("decoration")});var Jg={},_o={},jq=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Bq=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},_Se=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(_o,"__esModule",{value:!0});_o.templateToSchema=_o.AddTemplateElementsFeedbackCommand=_o.getTemplateElementId=_o.AddTemplateElementsAction=void 0;const CP=z,bO=F,ySe=Pt,bSe=Gn,SSe=kt,ESe=Ro;var SO;(function(n){n.KIND="addTemplateElements";function e(t){return{kind:n.KIND,...t}}n.create=e})(SO||(_o.AddTemplateElementsAction=SO={}));function $q(n){return typeof n=="string"?`${n}_feedback`:n.id}_o.getTemplateElementId=$q;let Ay=class extends bSe.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){const t=this.action.templates.map(o=>kq(o,e)).filter(SSe.isNotUndefined).map(o=>e.modelFactory.createElement(o)).map(o=>this.applyRootCssClasses(o,this.action.addClasses,this.action.removeClasses));t.forEach(o=>e.root.add(o));const i=t.map(o=>o.id);return ESe.LocalRequestBoundsAction.fromCommand(e,this.actionDispatcher,this.action,i)}applyRootCssClasses(e,t,i){return e.cssClasses=CSe(e.cssClasses,t,i),e}};_o.AddTemplateElementsFeedbackCommand=Ay;Ay.KIND=SO.KIND;jq([(0,bO.inject)(CP.TYPES.IActionDispatcher),Bq("design:type",ySe.GLSPActionDispatcher)],Ay.prototype,"actionDispatcher",void 0);_o.AddTemplateElementsFeedbackCommand=Ay=jq([(0,bO.injectable)(),_Se(0,(0,bO.inject)(CP.TYPES.Action)),Bq("design:paramtypes",[Object])],Ay);function kq(n,e){if(typeof n=="string"){const t=e.root.index.getById(n),i=t?e.modelFactory.createSchema(t):void 0;return i&&Fq(i),i}return n}_o.templateToSchema=kq;function Fq(n){var e;return n.id=$q(n.id),(e=n.children)===null||e===void 0||e.forEach(t=>Fq(t)),n}function CSe(n,e,t){const i=n??[];return e&&(0,CP.distinctAdd)(i,...e),t&&(0,CP.remove)(i,...t),i}var bc={},PSe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},wSe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},ASe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(bc,"__esModule",{value:!0});bc.RemoveTemplateElementsFeedbackCommand=bc.RemoveTemplateElementsAction=void 0;const xq=z,IH=F,RSe=Gn,MSe=_o;var EO;(function(n){n.KIND="removeTemplateElements";function e(t){return{kind:n.KIND,...t}}n.create=e})(EO||(bc.RemoveTemplateElementsAction=EO={}));let PP=class extends RSe.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){const t=e.root.index;for(const i of this.action.templates){const o=t.getById((0,MSe.getTemplateElementId)(i));o&&o instanceof xq.GChildElement&&o.parent.remove(o)}return e.root}};bc.RemoveTemplateElementsFeedbackCommand=PP;PP.KIND=EO.KIND;bc.RemoveTemplateElementsFeedbackCommand=PP=PSe([(0,IH.injectable)(),ASe(0,(0,IH.inject)(xq.TYPES.Action)),wSe("design:paramtypes",[Object])],PP);Object.defineProperty(Jg,"__esModule",{value:!0});Jg.elementTemplateModule=void 0;const zD=z,ISe=_o,DSe=bc;Jg.elementTemplateModule=new zD.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,zD.configureCommand)(o,ISe.AddTemplateElementsFeedbackCommand),(0,zD.configureCommand)(o,DSe.RemoveTemplateElementsFeedbackCommand)},{featureId:Symbol("elementTemplate")});var NR={},e1={},TSe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(e1,"__esModule",{value:!0});e1.ExportSvgActionHandler=void 0;const OSe=j7,LSe=F;let CO=class{handle(e){const t=new Blob([e.svg],{type:"text/plain;charset=utf-8"});(0,OSe.saveAs)(t,"diagram.svg")}};e1.ExportSvgActionHandler=CO;e1.ExportSvgActionHandler=CO=TSe([(0,LSe.injectable)()],CO);var t1={},NSe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(t1,"__esModule",{value:!0});t1.GLSPSvgExporter=void 0;const DH=z,jSe=F,BSe=wg;let PO=class extends DH.SvgExporter{export(e,t){if(typeof document<"u"){let i=this.findSvgElement();if(i){i=this.prepareSvgElement(i,e,t);const o=this.createSvg(i,e),r=this.getSvgExport(o,i,e,t);this.actionDispatcher.dispatch(DH.ExportSvgAction.create(r))}}}createSvg(e,t){const i=e.id;try{return e.id=i||(0,BSe.v4)(),super.createSvg(e,t)}finally{e.id=i}}findSvgElement(){const e=document.getElementById(this.options.hiddenDiv);return e&&e.querySelector("svg")}prepareSvgElement(e,t,i){return e}copyStyles(e,t,i){this.copyStyle(e,t,i);for(let o=0;o<e.childNodes.length;++o){const r=e.childNodes[o],s=t.childNodes[o];r instanceof Element&&this.copyStyles(r,s,[])}}copyStyle(e,t,i){const o=getComputedStyle(e),r=getComputedStyle(t);let s="";for(let a=0;a<o.length;a++){const f=o[a];if(!i.includes(f)){const h=o.getPropertyValue(f),g=o.getPropertyPriority(f);r.getPropertyValue(f)!==h&&(this.shouldUpdateStyle(t)?t.style.setProperty(f,h):s+=`${f}: ${h}${g?" !"+g:""}; `)}}s!==""&&t.setAttribute("style",s.trim())}shouldUpdateStyle(e){return"tagName"in e&&"style"in e}getSvgExport(e,t,i,o){const r=this.getSvgExportStyle(t,i,o);return r?e.replace('style="',`style="${r}`):e}getSvgExportStyle(e,t,i){const o=this.getBounds(t);return`width: ${o.width}px !important;height: ${o.height}px !important;border: none !important;cursor: default !important;`}};t1.GLSPSvgExporter=PO;t1.GLSPSvgExporter=PO=NSe([(0,jSe.injectable)()],PO);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneExportModule=n.exportModule=void 0;const e=z,t=e1,i=t1;n.exportModule=new e.FeatureModule((o,r,s)=>{const a={bind:o,isBound:s};(0,e.bindAsService)(a,e.TYPES.HiddenVNodePostprocessor,e.ExportSvgPostprocessor),(0,e.configureCommand)(a,e.ExportSvgCommand),o(e.TYPES.SvgExporter).to(i.GLSPSvgExporter).inSingletonScope()},{featureId:Symbol("export")}),n.standaloneExportModule=new e.FeatureModule((o,r,s)=>{const a={bind:o,isBound:s};(0,e.bindAsService)(a,e.TYPES.KeyListener,e.ExportSvgKeyListener),o(t.ExportSvgActionHandler).toSelf().inSingletonScope(),(0,e.configureActionHandler)(a,e.ExportSvgAction.KIND,t.ExportSvgActionHandler)},{featureId:Symbol("standaloneExport"),requires:n.exportModule})})(NR);var vb={},ds={},ti={},n1={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isReparentable=n.reparentFeature=n.isContainable=n.containerFeature=void 0,n.containerFeature=Symbol("containable");function e(i){return i.hasFeature(n.containerFeature)}n.isContainable=e,n.reparentFeature=Symbol("reparentFeature");function t(i){return i.hasFeature(n.reparentFeature)}n.isReparentable=t})(n1);Object.defineProperty(ti,"__esModule",{value:!0});ti.GEdge=ti.GGraph=void 0;const Md=z,Hq=Ig,$Se=n1;class Kq extends Md.SGraphImpl{isContainableElement(e){return!0}}ti.GGraph=Kq;Kq.DEFAULT_FEATURES=[...Md.SGraphImpl.DEFAULT_FEATURES,$Se.containerFeature,Hq.argsFeature];class Vq extends Md.SEdgeImpl{localToParent(e){const t=(0,Md.getRouteBounds)(this.routingPoints),i={x:e.x+t.x,y:e.y+t.y,width:-1,height:-1};return(0,Md.isBounds)(e)&&(i.width=e.width,i.height=e.height),i}parentToLocal(e){const t=(0,Md.getRouteBounds)(this.routingPoints),i={x:e.x-t.x,y:e.y-t.y,width:-1,height:-1};return(0,Md.isBounds)(e)&&(i.width=e.width,i.height=e.height),i}}ti.GEdge=Vq;Vq.DEFAULT_FEATURES=[...Md.SEdgeImpl.DEFAULT_FEATURES,Hq.argsFeature];var _b={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.GReconnectHandle=n.createReconnectHandle=n.isTargetRoutingHandle=n.isSourceRoutingHandle=n.removeReconnectHandles=n.addReconnectHandles=n.isReconnectHandle=n.isReconnectable=n.reconnectFeature=void 0;const e=z;n.reconnectFeature=Symbol("reconnectFeature");function t(y){return y instanceof e.GRoutableElement&&y.hasFeature(n.reconnectFeature)}n.isReconnectable=t;const i=-2;function o(y){return y!==void 0&&y instanceof g}n.isReconnectHandle=o;function r(y){s(y),h(y,"source",i),h(y,"target",y.routingPoints.length)}n.addReconnectHandles=r;function s(y){y.removeAll(S=>S instanceof g)}n.removeReconnectHandles=s;function a(y,S){return S.pointIndex===i}n.isSourceRoutingHandle=a;function f(y,S){return S.pointIndex===y.routingPoints.length}n.isTargetRoutingHandle=f;function h(y,S,P){const w=new g;return w.kind=S,w.pointIndex=P,w.type="routing-point",S==="target"&&y.id===e.edgeInProgressID&&(w.id=e.edgeInProgressTargetHandleID),y.add(w),w}n.createReconnectHandle=h;class g extends e.GRoutingHandle{hasFeature(S){return S!==e.selectFeature&&super.hasFeature(S)}}n.GReconnectHandle=g})(_b);var i1=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},kl=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},kSe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(ds,"__esModule",{value:!0});ds.TypeHintProvider=ds.ApplyTypeHintsCommand=ds.ApplyTypeHintsAction=void 0;const ho=z,Xl=F,TH=Pt,FSe=Gn,xSe=ti,zq=kt,HSe=no,KSe=_b,GD=n1;var wP;(function(n){n.KIND="applyTypeHints";function e(i){return ho.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(wP||(ds.ApplyTypeHintsAction=wP={}));let Ry=class extends FSe.FeedbackCommand{constructor(e){super(),this.action=e,this.rank=-10}execute(e){return e.root.index.all().forEach(t=>{if(t instanceof ho.GShapeElement||t instanceof ho.GModelRoot)return this.applyShapeTypeHint(t);t instanceof xSe.GEdge&&this.applyEdgeTypeHint(t)}),e.root}applyEdgeTypeHint(e){const t=this.typeHintProvider.getEdgeTypeHint(e);t&&e.features instanceof Set&&(Ga(e.features,ho.deletableFeature,t.deletable),Ga(e.features,ho.editFeature,t.routable),Ga(e.features,KSe.reconnectFeature,t.repositionable))}applyShapeTypeHint(e){const t=this.typeHintProvider.getShapeTypeHint(e);if(t&&e.features instanceof Set){Ga(e.features,ho.deletableFeature,t.deletable),Ga(e.features,ho.moveFeature,t.repositionable),Ga(e.features,HSe.resizeFeature,t.resizable),Ga(e.features,GD.reparentFeature,t.reparentable),Ga(e.features,GD.containerFeature,!0),(0,GD.isContainable)(e)&&(e.isContainableElement=o=>this.isContainableElement(o,t));const i=(0,ho.isConnectable)(e)?e.canConnect.bind(e):void 0;Ga(e.features,ho.connectableFeature,!0),(0,ho.isConnectable)(e)&&(e.canConnect=(o,r)=>this.canConnect(o,r,e,i))}}canConnect(e,t,i,o){var r;const s=this.typeHintProvider.getEdgeTypeHint(e.type);if(!s)return(r=o==null?void 0:o(e,t))!==null&&r!==void 0?r:!1;const a=t==="source"?s.sourceElementTypeIds:s.targetElementTypeIds;if(!a)return!0;const f=i.type+":";return a.some(h=>f.startsWith(h))}isContainableElement(e,t){var i,o;const r=(0,zq.getElementTypeId)(e)+":";return(o=(i=t.containableElementTypeIds)===null||i===void 0?void 0:i.some(s=>r.startsWith(s)))!==null&&o!==void 0?o:!1}};ds.ApplyTypeHintsCommand=Ry;Ry.KIND=wP.KIND;i1([(0,Xl.inject)(ho.TYPES.ITypeHintProvider),kl("design:type",Object)],Ry.prototype,"typeHintProvider",void 0);ds.ApplyTypeHintsCommand=Ry=i1([(0,Xl.injectable)(),kSe(0,(0,Xl.inject)(ho.TYPES.Action)),kl("design:paramtypes",[Object])],Ry);function Ga(n,e,t){t&&!n.has(e)?n.add(e):!t&&n.has(e)&&n.delete(e)}let hm=class{constructor(){this.shapeHints=new Map,this.edgeHints=new Map}init(){this.typeHintsFeedback=this.feedbackActionDispatcher.createEmitter()}handle(e){this.shapeHints.clear(),this.edgeHints.clear(),e.shapeHints.forEach(t=>this.shapeHints.set(t.elementTypeId,t)),e.edgeHints.forEach(t=>this.edgeHints.set(t.elementTypeId,t)),this.typeHintsFeedback.add(wP.create()).submit()}getShapeTypeHint(e){return this.getTypeHint(e,this.shapeHints)}getEdgeTypeHint(e){return this.getTypeHint(e,this.edgeHints)}getTypeHint(e,t){const i=(0,zq.getElementTypeId)(e);let o=t.get(i);if(o===void 0){const r=i.split(":");for(;o===void 0&&r.length>0;)if(r.pop(),o=t.get(r.join(":")),o){t.set(i,o);break}}return o}async postRequestModel(){const e=await this.actionDispatcher.request(ho.RequestTypeHintsAction.create());this.handle(e)}};ds.TypeHintProvider=hm;i1([(0,Xl.inject)(ho.TYPES.IFeedbackActionDispatcher),kl("design:type",Object)],hm.prototype,"feedbackActionDispatcher",void 0);i1([(0,Xl.inject)(TH.GLSPActionDispatcher),kl("design:type",TH.GLSPActionDispatcher)],hm.prototype,"actionDispatcher",void 0);i1([(0,Xl.postConstruct)(),kl("design:type",Function),kl("design:paramtypes",[]),kl("design:returntype",void 0)],hm.prototype,"init",null);ds.TypeHintProvider=hm=i1([(0,Xl.injectable)()],hm);Object.defineProperty(vb,"__esModule",{value:!0});vb.typeHintsModule=void 0;const nl=z,TE=ds;vb.typeHintsModule=new nl.FeatureModule((n,e,t)=>{const i={bind:n,unbind:e,isBound:t};(0,nl.bindAsService)(i,nl.TYPES.ITypeHintProvider,TE.TypeHintProvider),n(nl.TYPES.IDiagramStartup).toService(TE.TypeHintProvider),(0,nl.configureActionHandler)(i,nl.SetTypeHintsAction.KIND,TE.TypeHintProvider),(0,nl.configureCommand)(i,TE.ApplyTypeHintsCommand)},{featureId:Symbol("typeHints")});var yb={},o1={},Sc={},_i={},th=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},bb=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(_i,"__esModule",{value:!0});_i.BaseCreationTool=_i.BaseEditTool=void 0;const y9=z,nh=F,VSe=Pt,OH=An,zSe=It,LH=Qf,NH=Xf;let Ec=class{constructor(){this.toDisposeOnDisable=new y9.DisposableCollection}disable(){this.toDisposeOnDisable.dispose()}get isEditTool(){return!0}dispatchActions(e){return this.actionDispatcher.dispatchAll(e)}createFeedbackEmitter(){return this.feedbackDispatcher.createEmitter()}registerFeedback(e,t=this,i){return this.feedbackDispatcher.registerFeedback(t,e,i)}deregisterFeedback(e=this,t){this.feedbackDispatcher.deregisterFeedback(e,t)}};_i.BaseEditTool=Ec;th([(0,nh.inject)(y9.TYPES.IFeedbackActionDispatcher),bb("design:type",Object)],Ec.prototype,"feedbackDispatcher",void 0);th([(0,nh.inject)(y9.TYPES.IActionDispatcher),bb("design:type",VSe.GLSPActionDispatcher)],Ec.prototype,"actionDispatcher",void 0);th([(0,nh.inject)(NH.GLSPMouseTool),bb("design:type",NH.GLSPMouseTool)],Ec.prototype,"mouseTool",void 0);th([(0,nh.inject)(LH.GLSPKeyTool),bb("design:type",LH.GLSPKeyTool)],Ec.prototype,"keyTool",void 0);th([(0,nh.inject)(OH.EditorContextService),bb("design:type",OH.EditorContextService)],Ec.prototype,"editorContext",void 0);_i.BaseEditTool=Ec=th([(0,nh.injectable)()],Ec);let wO=class extends Ec{handle(e){if(this.isTriggerAction(e))return this.triggerAction=e,zSe.EnableToolsAction.create([this.id])}enable(){if(this.triggerAction===void 0)throw new TypeError(`Could not enable tool ${this.id}. The triggerAction cannot be undefined.`);this.doEnable()}};_i.BaseCreationTool=wO;_i.BaseCreationTool=wO=th([(0,nh.injectable)()],wO);var Yc={},Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.outsideOfViewport=Ct.absoluteToLocal=Ct.absoluteToParent=Ct.toAbsoluteSize=Ct.toAbsolutePosition=Ct.toAbsoluteBounds=Ct.getViewportBounds=Ct.getAbsolutePositionByPoint=Ct.getAbsolutePosition=void 0;const go=z;function GSe(n,e){return AP(n,{x:e.pageX,y:e.pageY})}Ct.getAbsolutePosition=GSe;function AP(n,e){let t=go.Point.subtract(e,n.root.canvasBounds);const i=(0,go.findParentByFeature)(n,go.isViewport);if(i){const o=i.zoom,r=go.Point.multiplyScalar(i.scroll,o);t=go.Point.add(t,r),t=go.Point.divideScalar(t,o)}return t}Ct.getAbsolutePositionByPoint=AP;function USe(n,e){const t=AP(n,go.Bounds.topLeft(e)),i=AP(n,go.Bounds.bottomRight(e));return go.Bounds.from(t,i)}Ct.getViewportBounds=USe;function jR(n){const e=(0,go.isAlignable)(n)?n.alignment:go.Point.ORIGIN,t=e.x,i=e.y,o=n.bounds.width,r=n.bounds.height;return(0,go.translateBounds)({x:t,y:i,width:o,height:r},n,n.root)}Ct.toAbsoluteBounds=jR;function YSe(n){return jR(n)}Ct.toAbsolutePosition=YSe;function qSe(n){return jR(n)}Ct.toAbsoluteSize=qSe;function WSe(n,e){return(0,go.isBoundsAware)(n.parent)?AO(n.parent,e):AO(n,e)}Ct.absoluteToParent=WSe;function AO(n,e){const t=jR(n);return go.Point.subtract(e,t)}Ct.absoluteToLocal=AO;function ZSe(n,e){return n.x<e.scroll.x||n.x>e.scroll.x+e.canvasBounds.width||n.y<e.scroll.y||n.y>e.scroll.y+e.canvasBounds.height}Ct.outsideOfViewport=ZSe;var r1={},QSe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(r1,"__esModule",{value:!0});r1.FeedbackEdgeEndView=void 0;const jH=z,XSe=F;let RO=class{render(e,t){var i;const o=(i=e.position)!==null&&i!==void 0?i:jH.Point.ORIGIN;return(0,jH.svg)("g",{x:o.x,y:o.y})}};r1.FeedbackEdgeEndView=RO;r1.FeedbackEdgeEndView=RO=QSe([(0,XSe.injectable)()],RO);(function(n){var e=l&&l.__decorate||function(b,v,R,O){var N=arguments.length,T=N<3?v:O===null?O=Object.getOwnPropertyDescriptor(v,R):O,$;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(b,v,R,O);else for(var Q=b.length-1;Q>=0;Q--)($=b[Q])&&(T=(N<3?$(T):N>3?$(v,R,T):$(v,R))||T);return N>3&&T&&Object.defineProperty(v,R,T),T},t=l&&l.__metadata||function(b,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(b,v)},i=l&&l.__param||function(b,v){return function(R,O){v(R,O,b)}};Object.defineProperty(n,"__esModule",{value:!0}),n.configureDanglingFeedbackEdge=n.removeDanglingFeedbackEdge=n.drawFeedbackEdge=n.defaultFeedbackEdgeSchema=n.feedbackEdgeEndId=n.feedbackEdgeId=n.FeedbackEdgeEnd=n.RemoveFeedbackEdgeCommand=n.RemoveFeedbackEdgeAction=n.DrawFeedbackEdgeCommand=n.DrawFeedbackEdgeAction=void 0;const o=z,r=F,s=_c,a=Gn,f=kt,h=Ct,g=r1;var y;(function(b){b.KIND="drawFeedbackEdge";function v(O){return o.Action.hasKind(O,b.KIND)}b.is=v;function R(O){return{kind:b.KIND,...O}}b.create=R})(y||(n.DrawFeedbackEdgeAction=y={}));let S=class extends a.FeedbackCommand{constructor(v){super(),this.action=v}execute(v){return j(v,this.action.sourceId,this.action.elementTypeId,this.action.edgeSchema),v.root}};n.DrawFeedbackEdgeCommand=S,S.KIND=y.KIND,n.DrawFeedbackEdgeCommand=S=e([(0,r.injectable)(),i(0,(0,r.inject)(o.TYPES.Action)),t("design:paramtypes",[Object])],S);var P;(function(b){b.KIND="removeFeedbackEdgeCommand";function v(O){return o.Action.hasKind(O,b.KIND)}b.is=v;function R(){return{kind:b.KIND}}b.create=R})(P||(n.RemoveFeedbackEdgeAction=P={}));let w=class extends a.FeedbackCommand{execute(v){return U(v.root),v.root}};n.RemoveFeedbackEdgeCommand=w,w.KIND=P.KIND,n.RemoveFeedbackEdgeCommand=w=e([(0,r.injectable)()],w);class C extends o.GDanglingAnchor{constructor(v,R,O=void 0,N=C.TYPE){super(),this.sourceId=v,this.elementTypeId=R,this.feedbackEdge=O,this.type=N}}n.FeedbackEdgeEnd=C,C.DEFAULT_FEATURES=[o.deletableFeature,s.feedbackFeature],C.TYPE="feedback-edge-end";function E(b){return b.id+"_feedback_edge"}n.feedbackEdgeId=E;function D(b){return b.id+"_feedback_anchor"}n.feedbackEdgeEndId=D,n.defaultFeedbackEdgeSchema={cssClasses:["feedback-edge"],opacity:.3};function j(b,v,R,O){const N=b.root,T=N.index.getById(v);if(!T)return;const $=(0,o.findParentByFeature)(T,o.isConnectable);if(!$||!(0,o.isBoundsAware)($))return;const Q=new C($.id,R);Q.id=D(N),Q.position=(0,h.toAbsolutePosition)($);const K={id:E(N),type:R,sourceId:$.id,targetId:Q.id,...n.defaultFeedbackEdgeSchema,...O},Z=b.modelFactory.createElement(K);(0,f.isRoutable)(Z)&&(Q.feedbackEdge=Z,N.add(Q),N.add(Z))}n.drawFeedbackEdge=j;function U(b){const v=b.index.getById(E(b)),R=b.index.getById(D(b));v instanceof o.GChildElement&&b.remove(v),R instanceof o.GChildElement&&b.remove(R)}n.removeDanglingFeedbackEdge=U;function p(b){!b.isBound(S)&&!b.isBound(w)&&!b.isBound(g.FeedbackEdgeEndView)&&((0,o.configureCommand)(b,S),(0,o.configureCommand)(b,w),(0,o.configureView)(b,C.TYPE,g.FeedbackEdgeEndView))}n.configureDanglingFeedbackEdge=p})(Yc);var s1={};Object.defineProperty(s1,"__esModule",{value:!0});s1.FeedbackEdgeEndMovingMouseListener=void 0;const ko=z,OE=Ct,BH=Yc;class JSe extends ko.MouseListener{constructor(e,t){super(),this.anchorRegistry=e,this.feedbackDispatcher=t,this.feedback=t.createEmitter()}mouseMove(e,t){const i=e.root,o=i.index.getById((0,BH.feedbackEdgeEndId)(i));if(!(o instanceof BH.FeedbackEdgeEnd)||!o.feedbackEdge)return[];const r=o.feedbackEdge,s=(0,OE.getAbsolutePosition)(o,t),a=(0,ko.findChildrenAtPosition)(e.root,s).reverse().find(f=>(0,ko.isConnectable)(f)&&f.canConnect(r,"target"));if(a instanceof ko.GConnectableElement&&r.source&&(0,ko.isBoundsAware)(r.source)){const f=this.computeAbsoluteAnchor(a,ko.Bounds.center((0,OE.toAbsoluteBounds)(r.source)));ko.Point.euclideanDistance(f,o.position)>1&&this.feedback.add(ko.MoveAction.create([{elementId:o.id,toPosition:f}],{animate:!1})).submit()}else this.feedback.add(ko.MoveAction.create([{elementId:o.id,toPosition:s}],{animate:!1})).submit();return[]}computeAbsoluteAnchor(e,t,i){const o=(0,OE.absoluteToParent)(e,t);let s=this.anchorRegistry.get(ko.PolylineEdgeRouter.KIND,e.anchorKind).getAnchor(e,o,i);if(e.parent!==e.root){const a=(0,ko.findParentByFeature)(e.parent,ko.isBoundsAware);if(a){const f=(0,OE.toAbsoluteBounds)(a);s=ko.Point.add(f,s)}}return s}dispose(){this.feedback.dispose()}}s1.FeedbackEdgeEndMovingMouseListener=JSe;var BR=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},b9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},MO;Object.defineProperty(Sc,"__esModule",{value:!0});Sc.EdgeCreationToolMouseListener=Sc.EdgeCreationTool=void 0;const ns=z,My=F,eEe=Hr,Xr=it,$H=It,tEe=ti,nEe=_i,kH=Yc,iEe=s1;let Jl=MO=class extends nEe.BaseCreationTool{constructor(){super(...arguments),this.isTriggerAction=ns.TriggerEdgeCreationAction.is}get id(){return MO.ID}doEnable(){this.toolFeedback(),this.creationListener(),this.trackFeedbackEdge()}toolFeedback(){const e=this.createFeedbackEmitter().add((0,Xr.cursorFeedbackAction)(Xr.CursorCSS.OPERATION_NOT_ALLOWED),(0,Xr.cursorFeedbackAction)()).submit();this.toDisposeOnDisable.push(e)}creationListener(){const e=new Gq(this.triggerAction,this.actionDispatcher,this.typeHintProvider,this,this.grid?this.grid.x/2:void 0);this.toDisposeOnDisable.push(e,this.mouseTool.registerListener(e))}trackFeedbackEdge(){const e=new iEe.FeedbackEdgeEndMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher);this.toDisposeOnDisable.push(e,this.mouseTool.registerListener(e))}};Sc.EdgeCreationTool=Jl;Jl.ID="tool_create_edge";BR([(0,My.inject)(ns.AnchorComputerRegistry),b9("design:type",ns.AnchorComputerRegistry)],Jl.prototype,"anchorRegistry",void 0);BR([(0,My.inject)(ns.TYPES.ITypeHintProvider),b9("design:type",Object)],Jl.prototype,"typeHintProvider",void 0);BR([(0,My.optional)(),(0,My.inject)(ns.TYPES.Grid),b9("design:type",Object)],Jl.prototype,"grid",void 0);Sc.EdgeCreationTool=Jl=MO=BR([(0,My.injectable)()],Jl);class Gq extends eEe.DragAwareMouseListener{constructor(e,t,i,o,r){super(r),this.triggerAction=e,this.actionDispatcher=t,this.typeHintProvider=i,this.tool=o,this.dragSensitivity=r,this.allowedTarget=!1,this.pendingDynamicCheck=!1,this.proxyEdge=new tEe.GEdge,this.proxyEdge.type=e.elementTypeId,this.cursorFeedback=o.createFeedbackEmitter(),this.feedbackEdgeFeedback=o.createFeedbackEmitter()}nonDraggingMouseUp(e,t){const i=[];return t.button===0?(this.isSourceSelected()?this.currentTarget&&this.allowedTarget&&(this.target=this.currentTarget.id):this.currentTarget&&this.allowedTarget&&(this.source=this.currentTarget.id,this.feedbackEdgeFeedback.add(kH.DrawFeedbackEdgeAction.create({elementTypeId:this.triggerAction.elementTypeId,sourceId:this.source}),kH.RemoveFeedbackEdgeAction.create()).submit()),this.source&&this.target&&(i.push(this.getCreateOperation(e,t,this.source,this.target)),this.isContinuousMode(e,t)?this.dispose():i.push($H.EnableDefaultToolsAction.create()))):t.button===2&&(this.dispose(),i.push($H.EnableDefaultToolsAction.create())),i}isContinuousMode(e,t){return(0,ns.isCtrlOrCmd)(t)}getCreateOperation(e,t,i,o){return ns.CreateEdgeOperation.create({elementTypeId:this.triggerAction.elementTypeId,sourceElementId:i,targetElementId:o,args:this.getCreateEdgeOperationArgs(e,t)})}getCreateEdgeOperationArgs(e,t){return{...this.triggerAction.args}}isSourceSelected(){return this.source!==void 0}isTargetSelected(){return this.target!==void 0}mouseOver(e,t){const i=(0,ns.findParentByFeature)(e,ns.isConnectable);if(i!==this.currentTarget){if(this.pendingDynamicCheck=!1,this.currentTarget=i,this.currentTarget){if(this.isSourceSelected()?this.isTargetSelected()||(this.allowedTarget=this.canConnect(i,"target")):this.allowedTarget=this.canConnect(i,"source"),this.pendingDynamicCheck)return[(0,Xr.cursorFeedbackAction)(Xr.CursorCSS.EDGE_CHECK_PENDING)]}else this.allowedTarget=!1;return[this.updateEdgeFeedback()]}return[]}updateEdgeFeedback(){return this.allowedTarget?this.isSourceSelected()?(0,Xr.cursorFeedbackAction)(Xr.CursorCSS.EDGE_CREATION_TARGET):(0,Xr.cursorFeedbackAction)(Xr.CursorCSS.EDGE_CREATION_SOURCE):(0,Xr.cursorFeedbackAction)(Xr.CursorCSS.OPERATION_NOT_ALLOWED)}canConnect(e,t){var i;if(!e||!(0,ns.isConnectable)(e)||!e.canConnect(this.proxyEdge,t))return!1;if(!this.isDynamic(this.proxyEdge.type))return!0;const o=(i=this.source)!==null&&i!==void 0?i:e,r=this.source?e:void 0;return this.pendingDynamicCheck=!0,this.actionDispatcher.request(ns.RequestCheckEdgeAction.create({sourceElement:o,targetElement:r,edgeType:this.proxyEdge.type})).then(s=>{this.pendingDynamicCheck&&(this.allowedTarget=s.isValid,this.actionDispatcher.dispatch(this.updateEdgeFeedback()),this.pendingDynamicCheck=!1)}).catch(s=>console.error("Dynamic edge check failed with: ",s)),!1}isDynamic(e){var t;const i=this.typeHintProvider.getEdgeTypeHint(e);return(t=i==null?void 0:i.dynamic)!==null&&t!==void 0?t:!1}dispose(){this.source=void 0,this.target=void 0,this.currentTarget=void 0,this.allowedTarget=!1,this.feedbackEdgeFeedback.dispose(),this.cursorFeedback.dispose(),super.dispose()}}Sc.EdgeCreationToolMouseListener=Gq;var Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});Ti.getSeverity=Ti.createGIssue=Ti.getGIssueMarker=Ti.getOrCreateGIssueMarker=Ti.GIssueMarker=void 0;const Ip=z;class S9 extends Ip.SIssueMarkerImpl{constructor(){super(),this.issues=[],this.type="marker",this.features=new Set(Ip.GDecoration.DEFAULT_FEATURES)}computeProjectionCssClasses(){const e=Yq(this);this.projectionCssClasses=["sprotty-issue","sprotty-"+e]}}Ti.GIssueMarker=S9;function oEe(n){let e;return e=Uq(n),e===void 0&&(e=new S9,(0,Ip.isBoundsAware)(n)&&(e.projectedBounds=n.parentToLocal(n.bounds)),n.add(e)),e}Ti.getOrCreateGIssueMarker=oEe;function Uq(n){let e;for(const t of n.children)t instanceof S9&&(e=t);return e}Ti.getGIssueMarker=Uq;function rEe(n,e){const t={message:n.description,severity:"info"};switch(n.kind){case Ip.MarkerKind.ERROR:{t.severity="error";break}case Ip.MarkerKind.INFO:{t.severity="info";break}case Ip.MarkerKind.WARNING:{t.severity="warning";break}}return t}Ti.createGIssue=rEe;function Yq(n){let e="info";for(const t of n.issues.map(i=>i.severity)){if(t==="error")return t;t==="warning"&&e==="info"&&(e=t)}return e}Ti.getSeverity=Yq;var sEe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(o1,"__esModule",{value:!0});o1.GlspHoverMouseListener=void 0;const aEe=F,Yh=z,cEe=Ma,FH=It,dEe=Sc,xH=Ti;let IO=class extends Yh.HoverMouseListener{constructor(){super(...arguments),this.enableHover=!0}handle(e){if(cEe.FocusStateChangedAction.is(e)&&!e.hasFocus){if(this.stopMouseOverTimer(),this.lastHoverFeedbackElementId){const t=this.lastHoverFeedbackElementId;return this.lastHoverFeedbackElementId=void 0,Yh.HoverFeedbackAction.create({mouseoverElement:t,mouseIsOver:!1})}}else FH.EnableToolsAction.is(e)?this.enableHover=!e.toolIds.includes(dEe.EdgeCreationTool.ID):FH.EnableDefaultToolsAction.is(e)&&(this.enableHover=!0)}mouseOver(e,t){return this.enableHover?super.mouseOver(e,t):[]}startMouseOverTimer(e,t){return this.stopMouseOverTimer(),new Promise(i=>{this.state.mouseOverTimer=window.setTimeout(()=>{const o=this.computePopupBounds(e,{x:t.pageX,y:t.pageY});e instanceof xH.GIssueMarker?i(Yh.SetPopupModelAction.create(this.createPopupModel(e,o))):i(Yh.RequestPopupModelAction.create({elementId:e.id,bounds:o})),this.state.popupOpen=!0,this.state.previousPopupElement=e},this.options.popupOpenDelay)})}createPopupModel(e,t){return e.issues!==void 0&&e.issues.length>0?{type:"html",id:"sprotty-popup",children:[this.createMarkerIssuePopup(e)],canvasBounds:this.modifyBounds(t)}:{type:Yh.EMPTY_ROOT.type,id:Yh.EMPTY_ROOT.id}}createMarkerIssuePopup(e){const t=this.createIssueMessage(e);return{type:"pre-rendered",id:"popup-title",code:`<div class="${(0,xH.getSeverity)(e)}"><div class="sprotty-popup-title">${t}</div></div>`}}createIssueMessage(e){return"<ul>"+e.issues.map(t=>"<li>"+t.severity.toUpperCase()+": "+t.message+"</li>").join("")+"</ul>"}modifyBounds(e){return e}};o1.GlspHoverMouseListener=IO;o1.GlspHoverMouseListener=IO=sEe([(0,aEe.injectable)()],IO);Object.defineProperty(yb,"__esModule",{value:!0});yb.hoverModule=void 0;const tt=z,HH=Ma,KH=It,LE=o1;yb.hoverModule=new tt.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};(0,tt.bindAsService)(i,tt.TYPES.PopupVNodePostprocessor,tt.PopupPositionUpdater),(0,tt.bindAsService)(i,tt.TYPES.MouseListener,LE.GlspHoverMouseListener),(0,tt.bindAsService)(i,tt.TYPES.PopupMouseListener,tt.PopupHoverMouseListener),(0,tt.bindAsService)(i,tt.TYPES.KeyListener,tt.HoverKeyListener),n(tt.TYPES.HoverState).toConstantValue({mouseOverTimer:void 0,mouseOutTimer:void 0,popupOpen:!1,previousPopupElement:void 0}),n(tt.ClosePopupActionHandler).toSelf().inSingletonScope(),(0,tt.configureCommand)(i,tt.HoverFeedbackCommand),(0,tt.configureCommand)(i,tt.SetPopupModelCommand),(0,tt.configureActionHandler)(i,tt.SetPopupModelCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,tt.FitToScreenCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,tt.CenterCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,tt.SetViewportCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,tt.MoveCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,HH.FocusStateChangedAction.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,KH.EnableToolsAction.KIND,LE.GlspHoverMouseListener),(0,tt.configureActionHandler)(i,KH.EnableDefaultToolsAction.KIND,LE.GlspHoverMouseListener),(0,tt.configureActionHandler)(i,HH.FocusStateChangedAction.KIND,LE.GlspHoverMouseListener)},{featureId:Symbol("hover")});var Sb={},a1={},uEe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(a1,"__esModule",{value:!0});a1.GlspEditLabelUI=void 0;const lEe=z,fEe=F,UD=Ms;let DO=class extends lEe.EditLabelUI{initializeContents(e){super.initializeContents(e),e.classList.add(UD.CSS_UI_EXTENSION_CLASS)}setContainerVisible(e){var t,i;e?((t=this.containerElement)===null||t===void 0||t.classList.remove(UD.CSS_HIDDEN_EXTENSION_CLASS),this.editControl.focus()):(i=this.containerElement)===null||i===void 0||i.classList.add(UD.CSS_HIDDEN_EXTENSION_CLASS)}};a1.GlspEditLabelUI=DO;a1.GlspEditLabelUI=DO=uEe([(0,fEe.injectable)()],DO);Object.defineProperty(Sb,"__esModule",{value:!0});Sb.labelEditUiModule=void 0;const wv=z,VH=a1;Sb.labelEditUiModule=new wv.FeatureModule((n,e,t,i,...o)=>{const r={bind:n,unbind:e,isBound:t,rebind:i};(0,wv.configureActionHandler)(r,wv.EditLabelAction.KIND,wv.EditLabelActionHandler),n(VH.GlspEditLabelUI).toSelf().inSingletonScope(),n(wv.TYPES.IUIExtension).toService(VH.GlspEditLabelUI)},{featureId:Symbol("labelEditUi")});var Eb={},c1={},hEe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},TO;Object.defineProperty(c1,"__esModule",{value:!0});c1.DirectLabelEditTool=void 0;const pEe=F,zH=z,mEe=_i;let RP=TO=class extends mEe.BaseEditTool{get id(){return TO.ID}createEditLabelMouseListener(){return new zH.EditLabelMouseListener}createEditLabelKeyListener(){return new zH.EditLabelKeyListener}enable(){this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.createEditLabelMouseListener()),this.keyTool.registerListener(this.createEditLabelKeyListener()))}};c1.DirectLabelEditTool=RP;RP.ID="glsp.direct-label-edit-tool";c1.DirectLabelEditTool=RP=TO=hEe([(0,pEe.injectable)()],RP);var us={},E9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},gEe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(us,"__esModule",{value:!0});us.BalloonLabelValidationDecorator=us.ServerEditLabelValidator=us.LabelEditValidation=void 0;const C9=F,b_=z,vEe=Pt;var MP;(function(n){n.CONTEXT_ID="label-edit";function e(i){const o=i.message;let r="ok";return b_.ValidationStatus.isError(i)?r="error":b_.ValidationStatus.isWarning(i)&&(r="warning"),{message:o,severity:r}}n.toEditLabelValidationResult=e;function t(i,o){return b_.RequestEditValidationAction.create({contextId:n.CONTEXT_ID,modelElementId:o,text:i})}n.createValidationRequestAction=t})(MP||(us.LabelEditValidation=MP={}));let IP=class{async validate(e,t){const i=MP.createValidationRequestAction(e,t.id),o=await this.actionDispatcher.requestUntil(i);return o?this.getValidationResultFromResponse(o):{severity:"ok"}}getValidationResultFromResponse(e){return b_.SetEditValidationResultAction.is(e)?MP.toEditLabelValidationResult(e.status):{severity:"ok"}}};us.ServerEditLabelValidator=IP;E9([(0,C9.inject)(b_.TYPES.IActionDispatcher),gEe("design:type",vEe.GLSPActionDispatcher)],IP.prototype,"actionDispatcher",void 0);us.ServerEditLabelValidator=IP=E9([(0,C9.injectable)()],IP);let OO=class{decorate(e,t){const i=e.parentElement;if(i)switch(t.message&&(i.setAttribute("data-balloon",t.message),i.setAttribute("data-balloon-pos","up-left"),i.setAttribute("data-balloon-visible","true")),t.severity){case"ok":i.classList.add("validation-ok");break;case"warning":i.classList.add("validation-warning");break;case"error":i.classList.add("validation-error");break}}dispose(e){const t=e.parentElement;t&&(t.removeAttribute("data-balloon"),t.removeAttribute("data-balloon-pos"),t.removeAttribute("data-balloon-visible"),t.classList.remove("validation-ok","validation-warning","validation-error"))}};us.BalloonLabelValidationDecorator=OO;us.BalloonLabelValidationDecorator=OO=E9([(0,C9.injectable)()],OO);Object.defineProperty(Eb,"__esModule",{value:!0});Eb.labelEditModule=void 0;const il=z,_Ee=c1,GH=us;Eb.labelEditModule=new il.FeatureModule((n,e,t,i)=>{n(il.TYPES.IEditLabelValidator).to(GH.ServerEditLabelValidator),n(il.TYPES.IEditLabelValidationDecorator).to(GH.BalloonLabelValidationDecorator),(0,il.bindAsService)(n,il.TYPES.IDefaultTool,_Ee.DirectLabelEditTool),(0,il.configureCommand)({bind:n,isBound:t},il.ApplyLabelEditCommand)},{featureId:Symbol("labelEdit")});var Cb={},on={},yn={};Object.defineProperty(yn,"__esModule",{value:!0});yn.toValidElementAndBounds=yn.toValidElementMove=yn.isValidMove=yn.isValidSize=yn.getLayoutOptions=yn.minDimensions=yn.minHeight=yn.minWidth=void 0;function $R(n){const e=P9(n);return e!==void 0&&typeof e.minWidth=="number"?e.minWidth:1}yn.minWidth=$R;function kR(n){const e=P9(n);return e!==void 0&&typeof e.minHeight=="number"?e.minHeight:1}yn.minHeight=kR;function yEe(n){return{width:$R(n),height:kR(n)}}yn.minDimensions=yEe;function P9(n){const e=n.layoutOptions;if(e!==void 0)return e}yn.getLayoutOptions=P9;function bEe(n,e){return e.width>=$R(n)&&e.height>=kR(n)}yn.isValidSize=bEe;function w9(n,e,t){var i;return(i=t==null?void 0:t.validate(n,e))!==null&&i!==void 0?i:!0}yn.isValidMove=w9;function SEe(n,e,t){if(w9(n,e.toPosition,t))return e}yn.toValidElementMove=SEe;function EEe(n,e,t){if(!w9(n,e.newPosition,t))return;const i=$R(n);e.newSize.width<i&&(e.newSize.width=i);const o=kR(n);return e.newSize.height<o&&(e.newSize.height=o),e}yn.toValidElementAndBounds=EEe;var d1=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},A9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(on,"__esModule",{value:!0});on.AlignElementsActionHandler=on.AlignElementsAction=on.SelectFunction=on.Alignment=on.ResizeElementsActionHandler=on.LayoutElementsActionHandler=on.ResizeElementsAction=on.ReduceFunction=on.ResizeDimension=void 0;const hi=z,ef=F,UH=Yt,CEe=kt,qq=yn,Wq=no;var Dp;(function(n){n[n.Width=0]="Width",n[n.Height=1]="Height",n[n.Width_And_Height=2]="Width_And_Height"})(Dp||(on.ResizeDimension=Dp={}));var LO;(function(n){function e(...a){return Math.min(...a)}n.min=e;function t(...a){return Math.max(...a)}n.max=t;function i(...a){return a.reduce((f,h)=>f+h,0)/a.length}n.avg=i;function o(...a){return a[0]}n.first=o;function r(...a){return a[a.length-1]}n.last=r;function s(a){return n[a]}n.get=s})(LO||(on.ReduceFunction=LO={}));var YH;(function(n){n.KIND="resizeElementAction";function e(i){return hi.Action.hasKind(i,n.KIND)&&(0,hi.hasArrayProp)(i,"elementIds")&&(0,hi.hasNumberProp)(i,"dimension")&&(0,hi.hasStringProp)(i,"reduceFunction")}n.is=e;function t(i){return{kind:n.KIND,dimension:Dp.Width,elementIds:[],...i}}n.create=t})(YH||(on.ResizeElementsAction=YH={}));let vu=class{getSelectedElements(e){const t=this.selectionService.getModelRoot().index,i=e.elementIds.length>0?e.elementIds:this.selectionService.getSelectedElementIDs();return(0,CEe.getElements)(t,i,this.isActionElement)}dispatchAction(e){this.actionDispatcher.dispatch(e)}dispatchActions(e){this.actionDispatcher.dispatchAll(e)}};on.LayoutElementsActionHandler=vu;d1([(0,ef.inject)(hi.TYPES.IActionDispatcher),A9("design:type",Object)],vu.prototype,"actionDispatcher",void 0);d1([(0,ef.inject)(UH.SelectionService),A9("design:type",UH.SelectionService)],vu.prototype,"selectionService",void 0);d1([(0,ef.inject)(hi.TYPES.IMovementRestrictor),(0,ef.optional)(),A9("design:type",Object)],vu.prototype,"movementRestrictor",void 0);on.LayoutElementsActionHandler=vu=d1([(0,ef.injectable)()],vu);let NO=class extends vu{handle(e){const t=this.getSelectedElements(e);if(t.length>1){const i=LO.get(e.reduceFunction);switch(e.dimension){case Dp.Width:return this.resizeWidth(t,i);case Dp.Height:return this.resizeHeight(t,i);case Dp.Width_And_Height:return this.resizeWidthAndHeight(t,i)}}}resizeWidth(e,t){const i=t(...e.map(o=>o.bounds.width));this.dispatchResizeActions(e,(o,r)=>{const s=.5*(i-o.bounds.width);r.newPosition.x=o.bounds.x-s,r.newSize.width=i})}resizeHeight(e,t){const i=t(...e.map(o=>o.bounds.height));this.dispatchResizeActions(e,(o,r)=>{const s=.5*(i-o.bounds.height);r.newPosition.y=o.bounds.y-s,r.newSize.height=i})}resizeWidthAndHeight(e,t){const i=t(...e.map(s=>s.bounds.width)),o=t(...e.map(s=>s.bounds.height)),r={width:i,height:o};this.dispatchResizeActions(e,(s,a)=>{const f=hi.Dimension.subtract(r,s.bounds),h=hi.Dimension.center(f);a.newPosition=hi.Point.subtract(s.bounds,h),a.newSize=r})}dispatchResizeActions(e,t){const i=[];e.forEach(o=>{const r=this.createElementAndBounds(o,t);r&&i.push(r)}),this.dispatchActions([hi.SetBoundsAction.create(i),hi.ChangeBoundsOperation.create(i)])}createElementAndBounds(e,t){const i={elementId:e.id,newPosition:{x:e.bounds.x,y:e.bounds.y},newSize:{width:e.bounds.width,height:e.bounds.height}};return t(e,i),(0,qq.toValidElementAndBounds)(e,i,this.movementRestrictor)}isActionElement(e){return(0,Wq.isResizable)(e)}};on.ResizeElementsActionHandler=NO;on.ResizeElementsActionHandler=NO=d1([(0,ef.injectable)()],NO);var Xa;(function(n){n[n.Left=0]="Left",n[n.Center=1]="Center",n[n.Right=2]="Right",n[n.Top=3]="Top",n[n.Middle=4]="Middle",n[n.Bottom=5]="Bottom"})(Xa||(on.Alignment=Xa={}));var jO;(function(n){function e(r){return r}n.all=e;function t(r){return[r[0]]}n.first=t;function i(r){return[r[r.length-1]]}n.last=i;function o(r){return n[r]}n.get=o})(jO||(on.SelectFunction=jO={}));var qH;(function(n){n.KIND="alignElements";function e(i){return hi.Action.hasKind(i,n.KIND)&&(0,hi.hasArrayProp)(i,"elementIds")&&(0,hi.hasNumberProp)(i,"alignment")&&(0,hi.hasStringProp)(i,"selectFunction")}n.is=e;function t(i={}){return{kind:n.KIND,elementIds:[],alignment:Xa.Left,selectFunction:"all",...i}}n.create=t})(qH||(on.AlignElementsAction=qH={}));let BO=class extends vu{handle(e){const t=this.getSelectedElements(e),o=jO.get(e.selectFunction)(t);if(t.length>1)switch(e.alignment){case Xa.Left:return this.alignLeft(o);case Xa.Center:return this.alignCenter(o);case Xa.Right:return this.alignRight(o);case Xa.Top:return this.alignTop(o);case Xa.Middle:return this.alignMiddle(o);case Xa.Bottom:return this.alignBottom(o)}}alignLeft(e){const t=e.map(i=>i.bounds.x).reduce((i,o)=>Math.min(i,o));this.dispatchAlignActions(e,(i,o)=>o.toPosition.x=t)}alignCenter(e){const t=e.map(s=>s.bounds.x).reduce((s,a)=>Math.min(s,a)),o=e.map(s=>s.bounds.x+s.bounds.width).reduce((s,a)=>Math.max(s,a))-t,r=t+.5*o;this.dispatchAlignActions(e,(s,a)=>a.toPosition.x=r-.5*s.bounds.width)}alignRight(e){const t=e.map(i=>i.bounds.x+i.bounds.width).reduce((i,o)=>Math.max(i,o));this.dispatchAlignActions(e,(i,o)=>o.toPosition.x=t-i.bounds.width)}alignTop(e){const t=e.map(i=>i.bounds.y).reduce((i,o)=>Math.min(i,o));this.dispatchAlignActions(e,(i,o)=>o.toPosition.y=t)}alignMiddle(e){const t=e.map(s=>s.bounds.y).reduce((s,a)=>Math.min(s,a)),o=e.map(s=>s.bounds.y+s.bounds.height).reduce((s,a)=>Math.max(s,a))-t,r=t+.5*o;this.dispatchAlignActions(e,(s,a)=>a.toPosition.y=r-.5*s.bounds.height)}alignBottom(e){const t=e.map(i=>i.bounds.y+i.bounds.height).reduce((i,o)=>Math.max(i,o));this.dispatchAlignActions(e,(i,o)=>o.toPosition.y=t-i.bounds.height)}dispatchAlignActions(e,t){const i=[],o=[];e.forEach(r=>{const s=this.createElementMove(r,t);if(s){i.push(s);const a=this.createElementAndBounds(r,s);o.push(a)}}),this.dispatchActions([hi.MoveAction.create(i),hi.ChangeBoundsOperation.create(o)])}createElementMove(e,t){const i={elementId:e.id,fromPosition:{x:e.bounds.x,y:e.bounds.y},toPosition:{x:e.bounds.x,y:e.bounds.y}};return t(e,i),(0,qq.toValidElementMove)(e,i,this.movementRestrictor)}createElementAndBounds(e,t){return{elementId:e.id,newPosition:{x:t.toPosition.x,y:t.toPosition.y},newSize:{width:e.bounds.width,height:e.bounds.height}}}isActionElement(e){return(0,Wq.isBoundsAwareMoveable)(e)}};on.AlignElementsActionHandler=BO;on.AlignElementsActionHandler=BO=d1([(0,ef.injectable)()],BO);Object.defineProperty(Cb,"__esModule",{value:!0});Cb.layoutModule=void 0;const YD=z,NE=on;Cb.layoutModule=new YD.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};(0,YD.configureActionHandler)(i,NE.ResizeElementsAction.KIND,NE.ResizeElementsActionHandler),(0,YD.configureActionHandler)(i,NE.AlignElementsAction.KIND,NE.AlignElementsActionHandler)},{featureId:Symbol("layout")});var Pb={},na={},ih={},FR=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},R9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(ih,"__esModule",{value:!0});ih.NavigationTargetResolver=void 0;const xR=F,Id=z;let pm=class{async resolve(e){return this.resolveWithSourceUri(this.diagramOptions.sourceUri,e)}async resolveWithSourceUri(e,t){const i=decodeURIComponent(t.uri);if(e&&e!==i&&`file://${e}`!==i){this.logger.info("Source and Target URI are different. Can't resolve locally.",e,i);return}if(Id.NavigationTarget.getElementIds(t).length>0)return Id.SetResolvedNavigationTargetAction.create(Id.NavigationTarget.getElementIds(t));const o=await this.requestResolution(t);if(Id.SetResolvedNavigationTargetAction.is(o))return o}requestResolution(e){return this.dispatcher.request(Id.ResolveNavigationTargetAction.create(e))}};ih.NavigationTargetResolver=pm;FR([(0,xR.inject)(Id.TYPES.IActionDispatcher),R9("design:type",Object)],pm.prototype,"dispatcher",void 0);FR([(0,xR.inject)(Id.TYPES.ILogger),R9("design:type",Object)],pm.prototype,"logger",void 0);FR([(0,xR.inject)(Id.TYPES.IDiagramOptions),R9("design:type",Object)],pm.prototype,"diagramOptions",void 0);ih.NavigationTargetResolver=pm=FR([(0,xR.injectable)()],pm);var u1=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},wb=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(na,"__esModule",{value:!0});na.NavigationActionHandler=na.ProcessNavigationArgumentsAction=na.NavigateAction=void 0;const On=z,l1=F,WH=ih;var $O;(function(n){n.KIND="navigate";function e(i){return On.Action.hasKind(i,n.KIND)&&(0,On.hasStringProp)(i,"targetTypeId")}n.is=e;function t(i,o={}){return{kind:n.KIND,targetTypeId:i,...o}}n.create=t})($O||(na.NavigateAction=$O={}));var DP;(function(n){n.KIND="processNavigationArguments";function e(i){return On.Action.hasKind(i,n.KIND)&&(0,On.hasObjectProp)(i,"args")}n.is=e;function t(i){return{kind:n.KIND,args:i}}n.create=t})(DP||(na.ProcessNavigationArgumentsAction=DP={}));let _u=class{constructor(){this.notificationTimeout=5e3}handle(e){$O.is(e)?this.handleNavigateAction(e):On.NavigateToTargetAction.is(e)?this.handleNavigateToTarget(e):DP.is(e)?this.processNavigationArguments(e.args):On.NavigateToExternalTargetAction.is(e)&&this.handleNavigateToExternalTarget(e)}async handleNavigateAction(e){try{const i=(await this.editorContextService()).get(e.args),o=await this.dispatcher.request(On.RequestNavigationTargetsAction.create({targetTypeId:e.targetTypeId,editorContext:i}));if(On.SetNavigationTargetsAction.is(o)&&o.targets&&o.targets.length===1)return o.targets.length>1&&this.logger.warn(this,"Processing of multiple targets is not supported yet. Only the first is being processed.",o.targets),this.dispatcher.dispatch(On.NavigateToTargetAction.create(o.targets[0]));this.warnAboutFailedNavigation("No valid navigation target found")}catch(t){this.logger.error(this,"Failed to obtain navigation target",t,e)}}async handleNavigateToTarget(e){try{const t=await this.resolveElements(e);if(this.containsElementIdsOrArguments(t)){this.navigateTo(t),this.handleResolutionArguments(t);return}else{this.navigateToExternal(e.target);return}}catch(t){this.logger.error(this,"Failed to navigate",t,e)}}resolveElements(e){return this.resolver.resolve(e.target)}containsElementIdsOrArguments(e){return e!==void 0&&(this.containsElementIds(e.elementIds)||this.containsArguments(e.args))}containsElementIds(e){return e!==void 0&&e.length>0}containsArguments(e){return e!==void 0&&e!==void 0&&Object.keys(e).length>0}navigateTo(e){const t=e.elementIds;this.containsElementIds(t)&&this.dispatcher.dispatchAll([On.SelectAllAction.create(!1),On.SelectAction.create({selectedElementsIDs:t}),On.CenterAction.create(t)])}handleResolutionArguments(e){const t=e.args;this.containsArguments(t)&&this.dispatcher.dispatch(DP.create(t))}navigateToExternal(e){return this.dispatcher.dispatch(On.NavigateToExternalTargetAction.create(e))}processNavigationArguments(e){e.info&&e.info.toString().length>0&&this.notify("INFO",e.info.toString()),e.warning&&e.warning.toString().length>0&&this.notify("WARNING",e.warning.toString()),e.error&&e.error.toString().length>0&&this.notify("ERROR",e.error.toString())}async handleNavigateToExternalTarget(e){(await this.actionHandlerRegistryProvider()).get(On.NavigateToExternalTargetAction.KIND).length===1&&this.warnAboutFailedNavigation("Could not resolve or navigate to target",e.target)}warnAboutFailedNavigation(e,t){const i=`${e}`+(t?`: '${t.uri}' (arguments: ${JSON.stringify(t.args)})`:"");this.logger.warn(this,e,t),this.notify("WARNING",i)}notify(e,t){const i=this.notificationTimeout;this.dispatcher.dispatchAll([On.StatusAction.create(t,{severity:e,timeout:i}),On.MessageAction.create(t,{severity:e})])}};na.NavigationActionHandler=_u;u1([(0,l1.inject)(On.TYPES.ILogger),wb("design:type",Object)],_u.prototype,"logger",void 0);u1([(0,l1.inject)(On.TYPES.IActionDispatcher),wb("design:type",Object)],_u.prototype,"dispatcher",void 0);u1([(0,l1.inject)(On.TYPES.ActionHandlerRegistryProvider),wb("design:type",Function)],_u.prototype,"actionHandlerRegistryProvider",void 0);u1([(0,l1.inject)(On.TYPES.IEditorContextServiceProvider),wb("design:type",Function)],_u.prototype,"editorContextService",void 0);u1([(0,l1.inject)(WH.NavigationTargetResolver),wb("design:type",WH.NavigationTargetResolver)],_u.prototype,"resolver",void 0);na.NavigationActionHandler=_u=u1([(0,l1.injectable)()],_u);Object.defineProperty(Pb,"__esModule",{value:!0});Pb.navigationModule=void 0;const ol=z,rl=na,PEe=ih;Pb.navigationModule=new ol.FeatureModule((n,e,t)=>{n(PEe.NavigationTargetResolver).toSelf().inSingletonScope(),n(rl.NavigationActionHandler).toSelf().inSingletonScope(),(0,ol.configureActionHandler)({bind:n,isBound:t},rl.NavigateAction.KIND,rl.NavigationActionHandler),(0,ol.configureActionHandler)({bind:n,isBound:t},ol.NavigateToTargetAction.KIND,rl.NavigationActionHandler),(0,ol.configureActionHandler)({bind:n,isBound:t},rl.ProcessNavigationArgumentsAction.KIND,rl.NavigationActionHandler),(0,ol.configureActionHandler)({bind:n,isBound:t},ol.NavigateToExternalTargetAction.KIND,rl.NavigationActionHandler)},{featureId:Symbol("navigation")});var Ab={},Zi={},HR=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Zi,"__esModule",{value:!0});Zi.GLSPBezierEdgeRouter=Zi.GLSPManhattanEdgeRouter=Zi.GLSPPolylineEdgeRouter=Zi.GLSPAbstractEdgeRouter=void 0;const os=z,KR=F;let kO=class extends os.AbstractEdgeRouter{getTranslatedAnchor(e,t,i,o,r){const s=super.getTranslatedAnchor(e,t,i,o,r);return os.Point.isValid(s)?s:t}cleanupRoutingPoints(e,t,i,o){yu(e.source)&&yu(e.target)&&super.cleanupRoutingPoints(e,t,i,o)}};Zi.GLSPAbstractEdgeRouter=kO;Zi.GLSPAbstractEdgeRouter=kO=HR([(0,KR.injectable)()],kO);let FO=class extends os.PolylineEdgeRouter{getTranslatedAnchor(e,t,i,o,r){const s=super.getTranslatedAnchor(e,t,i,o,r);return os.Point.isValid(s)?s:t}cleanupRoutingPoints(e,t,i,o){yu(e.source)&&yu(e.target)&&super.cleanupRoutingPoints(e,t,i,o)}};Zi.GLSPPolylineEdgeRouter=FO;Zi.GLSPPolylineEdgeRouter=FO=HR([(0,KR.injectable)()],FO);let xO=class extends os.ManhattanEdgeRouter{getTranslatedAnchor(e,t,i,o,r){const s=super.getTranslatedAnchor(e,t,i,o,r);return os.Point.isValid(s)?s:t}applyInnerHandleMoves(e,t){const i=this.route(e),o=e.routingPoints,r=this.getOptions(e).minimalPointDistance;t.forEach(s=>{const a=s.handle,f=a.pointIndex,h=this.correctX(o,f,s.toPosition.x,r),g=this.correctY(o,f,s.toPosition.y,r);switch(a.kind){case"manhattan-50%":f<0?o.length===0?(o.push({x:h,y:g}),s.handle.pointIndex=0):(0,os.almostEquals)(i[0].x,i[1].x)?this.alignX(o,0,h):this.alignY(o,0,g):f<o.length-1?(0,os.almostEquals)(o[f].x,o[f+1].x)?(this.alignX(o,f,h),this.alignX(o,f+1,h)):(this.alignY(o,f,g),this.alignY(o,f+1,g)):(0,os.almostEquals)(i[i.length-2].x,i[i.length-1].x)?this.alignX(o,o.length-1,h):this.alignY(o,o.length-1,g);break}})}cleanupRoutingPoints(e,t,i,o){yu(e.source)&&yu(e.target)&&super.cleanupRoutingPoints(e,t,i,o)}};Zi.GLSPManhattanEdgeRouter=xO;Zi.GLSPManhattanEdgeRouter=xO=HR([(0,KR.injectable)()],xO);let HO=class extends os.BezierEdgeRouter{getTranslatedAnchor(e,t,i,o,r){const s=super.getTranslatedAnchor(e,t,i,o,r);return os.Point.isValid(s)?s:t}cleanupRoutingPoints(e,t,i,o){yu(e.source)&&yu(e.target)&&super.cleanupRoutingPoints(e,t,i,o)}};Zi.GLSPBezierEdgeRouter=HO;Zi.GLSPBezierEdgeRouter=HO=HR([(0,KR.injectable)()],HO);function yu(n){return n?n.bounds?!0:n.position&&n.size?(n.bounds={...n.position,...n.size},!0):!1:!1}Object.defineProperty(Ab,"__esModule",{value:!0});Ab.routingModule=void 0;const nt=z,qD=Zi;Ab.routingModule=new nt.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};n(nt.EdgeRouterRegistry).toSelf().inSingletonScope(),n(nt.AnchorComputerRegistry).toSelf().inSingletonScope(),(0,nt.bindAsService)(o,nt.TYPES.IEdgeRouter,qD.GLSPManhattanEdgeRouter),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.ManhattanEllipticAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.ManhattanRectangularAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.ManhattanDiamondAnchor),(0,nt.bindAsService)(o,nt.TYPES.IEdgeRouter,qD.GLSPPolylineEdgeRouter),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.EllipseAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.RectangleAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.DiamondAnchor),(0,nt.bindAsService)(o,nt.TYPES.IEdgeRouter,qD.GLSPBezierEdgeRouter),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.BezierEllipseAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.BezierRectangleAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.BezierDiamondAnchor),(0,nt.configureCommand)({bind:n,isBound:t},nt.AddRemoveBezierSegmentCommand)},{featureId:Symbol("routing")});var VR={},f1={},wEe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},AEe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},REe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(f1,"__esModule",{value:!0});f1.SelectFeedbackCommand=void 0;const ZH=F,P3=z,MEe=Yt;let TP=class extends P3.Command{constructor(e){super(),this.action=e,this.sprottySelectCommand=new P3.SprottySelectCommand({...e,kind:P3.SelectAction.KIND})}execute(e){return this.sprottySelectCommand.execute(e)}undo(e){return this.sprottySelectCommand.undo(e)}redo(e){return this.sprottySelectCommand.redo(e)}};f1.SelectFeedbackCommand=TP;TP.KIND=MEe.SelectFeedbackAction.KIND;f1.SelectFeedbackCommand=TP=wEe([(0,ZH.injectable)(),REe(0,(0,ZH.inject)(P3.TYPES.Action)),AEe("design:paramtypes",[Object])],TP);var h1={},Da={},Rr={},IEe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.movementRestrictionFeedback=Rr.removeMovementRestrictionFeedback=Rr.createMovementRestrictionFeedback=Rr.NoOverlapMovementRestrictor=void 0;const Ed=z,DEe=F,Zq=it,QH=Ct,Qq=no;let KO=class{constructor(){this.cssClasses=["movement-not-allowed"]}validate(e,t){if(!(0,Ed.isMoveable)(e)||!t)return!1;const i=(0,Ed.isBoundsAware)(e)?e.bounds:{width:1,height:1},o=Object.create(e);return o.bounds={...i,...t},o.type="Ghost",o.id=e.id,!Array.from(e.root.index.all().filter(r=>r.id!==o.id&&r!==o.root&&r instanceof Ed.GNode).map(r=>r)).some(r=>this.areOverlapping(r,o))}isBoundsRelevant(e,t){return e.id!==t.id&&e!==t.root&&e instanceof Ed.GNode&&(0,Ed.isBoundsAware)(e)}areOverlapping(e,t){return Ed.Bounds.overlap((0,QH.toAbsoluteBounds)(e),(0,QH.toAbsoluteBounds)(t))}};Rr.NoOverlapMovementRestrictor=KO;Rr.NoOverlapMovementRestrictor=KO=IEe([(0,DEe.injectable)()],KO);function Xq(n,e){const t=[n];return n instanceof Ed.GParentElement&&n.children.filter(i=>i instanceof Qq.GResizeHandle).forEach(i=>t.push(i)),Zq.ModifyCSSFeedbackAction.create({elements:t,add:e.cssClasses})}Rr.createMovementRestrictionFeedback=Xq;function Jq(n,e){const t=[n];return n instanceof Ed.GParentElement&&n.children.filter(i=>i instanceof Qq.GResizeHandle).forEach(i=>t.push(i)),Zq.ModifyCSSFeedbackAction.create({elements:t,remove:e.cssClasses})}Rr.removeMovementRestrictionFeedback=Jq;function TEe(n,e,t){return t?Jq(n,e):Xq(n,e)}Rr.movementRestrictionFeedback=TEe;var Ta={},Cc={},OEe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},LEe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},NEe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Cc,"__esModule",{value:!0});Cc.ShowGridCommand=Cc.ShowGridAction=void 0;const VO=z,XH=F,jEe=Gn,JH=kt;var Iy;(function(n){n.KIND="showGrid",n.CSS_ROOT_CLASS="grid-background";function e(i){return VO.Action.hasKind(i,n.KIND)&&(0,VO.hasBooleanProp)(i,"show")}n.is=e;function t(i){return{kind:Dy.KIND,...i}}n.create=t})(Iy||(Cc.ShowGridAction=Iy={}));let Dy=class extends jEe.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return this.setGrid(e.root,this.action.show)}setGrid(e,t){return t?(0,JH.addCssClasses)(e,[Iy.CSS_ROOT_CLASS]):(0,JH.removeCssClasses)(e,[Iy.CSS_ROOT_CLASS]),e}};Cc.ShowGridCommand=Dy;Dy.KIND=Iy.KIND;Cc.ShowGridCommand=Dy=OEe([(0,XH.injectable)(),NEe(0,(0,XH.inject)(VO.TYPES.Action)),LEe("design:paramtypes",[Object])],Dy);var zR=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},S_=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Ta,"__esModule",{value:!0});Ta.GridManager=void 0;const eW=z,GR=F,eK=Cc;let mm=class{constructor(){this._gridVisible=!1}get isGridVisible(){return this._gridVisible}init(){this.gridFeedback=this.feedbackDispatcher.createEmitter()}handle(e){this.setGridVisible(e.show)}setGridVisible(e){this._gridVisible&&!e?(this._gridVisible=!1,this.gridFeedback.dispose()):!this._gridVisible&&e&&(this._gridVisible=!0,this.gridFeedback.add(eK.ShowGridAction.create({show:!0}),eK.ShowGridAction.create({show:!1})).submit())}toggleGridVisible(){this.setGridVisible(!this._gridVisible)}};Ta.GridManager=mm;zR([(0,GR.inject)(eW.TYPES.IFeedbackActionDispatcher),S_("design:type",Object)],mm.prototype,"feedbackDispatcher",void 0);zR([(0,GR.inject)(eW.TYPES.Grid),S_("design:type",Object)],mm.prototype,"grid",void 0);zR([(0,GR.postConstruct)(),S_("design:type",Function),S_("design:paramtypes",[]),S_("design:returntype",void 0)],mm.prototype,"init",null);Ta.GridManager=mm=zR([(0,GR.injectable)()],mm);var p1={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.InsertIndicator=n.ARG_LENGTH=void 0;const e=z,t=wg,i=Ig;n.ARG_LENGTH="length";class o extends e.GNode{constructor(s){super(),this.id=(0,t.v4)(),this.type=o.TYPE,this.features=(0,e.createFeatureSet)(o.DEFAULT_FEATURES),this.cssClasses=["insert-indicator","sprotty-node"],this.size=e.Dimension.ZERO,this.args={},s&&(this.args={[n.ARG_LENGTH]:s})}}n.InsertIndicator=o,o.DEFAULT_FEATURES=[e.boundsFeature,e.moveFeature,i.argsFeature],o.TYPE="node:insert-indicator"})(p1);var UR={},tf={};Object.defineProperty(tf,"__esModule",{value:!0});tf.DiagramMovementCalculator=tf.MovementCalculator=void 0;const dp=z;class tW{setPosition(e){this.position={...e}}updatePosition(e){var t;const i=dp.Vector.is(e)?e:e.vector;this.setPosition(dp.Point.add((t=this.position)!==null&&t!==void 0?t:dp.Point.ORIGIN,i))}get hasPosition(){return this.position!==void 0}calculateMoveTo(e){return this.position?dp.Point.move(this.position,e):dp.Movement.ZERO}dispose(){this.position=void 0}}tf.MovementCalculator=tW;class BEe extends tW{constructor(e){super(),this.positionTracker=e}init(){const e=this.positionTracker.lastPositionOnDiagram;e&&this.setPosition(e)}calculateMoveToCurrent(){const e=this.positionTracker.lastPositionOnDiagram;return e?this.calculateMoveTo(e):dp.Movement.ZERO}reset(){this.dispose()}}tf.DiagramMovementCalculator=BEe;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.MoveableRoutingHandle=n.MoveableResizeHandle=n.ChangeBoundsTracker=n.TrackedElementResize=n.DEFAULT_RESIZE_OPTIONS=n.TrackedMove=n.TrackedElementMove=n.DEFAULT_MOVE_OPTIONS=void 0;const e=z,t=kt,i=no,o=tf;n.DEFAULT_MOVE_OPTIONS={snap:!0,restrict:!0,validate:!0,skipStatic:!0,skipInvalid:!1};var r;(function(y){function S(P){return(0,e.hasObjectProp)(P,"element")&&(0,e.hasObjectProp)(P,"fromPosition")&&(0,e.hasObjectProp)(P,"toPosition")&&(0,e.hasBooleanProp)(P,"valid")}y.is=S})(r||(n.TrackedElementMove=r={}));var s;(function(y){function S(P){return e.Movement.is(P)&&(0,e.hasBooleanProp)(P,"valid")}y.is=S})(s||(n.TrackedMove=s={})),n.DEFAULT_RESIZE_OPTIONS={snap:!0,restrict:!0,validate:!0,symmetric:!0,constrainResize:!0,skipStatic:!0,skipInvalidSize:!1,skipInvalidMove:!1};var a;(function(y){function S(P){return(0,e.isBoundsAware)(P.element)&&(0,e.hasObjectProp)(P,"fromBounds")&&(0,e.hasObjectProp)(P,"toBounds")&&(0,e.hasObjectProp)(P,"valid")}y.is=S})(a||(n.TrackedElementResize=a={}));class f{constructor(S){this.manager=S,this.diagramMovement=new o.DiagramMovementCalculator(S.positionTracker)}startTracking(){return this.diagramMovement.init(),this}updateTrackingPosition(S){const P=s.is(S)?e.Vector.max(...S.elementMoves.map(w=>w.moveVector)):S;this.diagramMovement.updatePosition(P)}isTracking(){return this.diagramMovement.hasPosition}stopTracking(){return this.diagramMovement.dispose(),this}moveElements(S,P){const w=this.resolveMoveOptions(P),C=this.calculateDiagramMovement(),E={...C,elementMoves:[],valid:!0,options:w};if(e.Vector.isZero(C.vector)&&w.skipStatic)return E;const D=this.getMoveableElements(S,w);for(const j of D){const U=this.calculateElementMove(j,C.vector,w);this.skipElementMove(U,w)||(E.elementMoves.push(U),E.valid&&(E.valid=U.valid))}return E}resolveMoveOptions(S){var P,w;return{...n.DEFAULT_MOVE_OPTIONS,...S,snap:this.manager.usePositionSnap((P=S==null?void 0:S.snap)!==null&&P!==void 0?P:n.DEFAULT_MOVE_OPTIONS.snap),restrict:this.manager.useMovementRestriction((w=S==null?void 0:S.restrict)!==null&&w!==void 0?w:n.DEFAULT_MOVE_OPTIONS.restrict)}}calculateDiagramMovement(){return this.diagramMovement.calculateMoveToCurrent()}getMoveableElements(S,P){var w;return Array.isArray(S)?S:(0,t.getElements)(S.ctx.index,S.elementIDs,(w=S.guard)!==null&&w!==void 0?w:e.isMoveable)}skipElementMove(S,P){return P.skipInvalid&&!S.valid||P.skipStatic&&e.Vector.isZero(S.moveVector)}calculateElementMove(S,P,w){const C=S.position,E=e.Point.add(C,P),D={element:S,fromPosition:C,toPosition:E,valid:!0,moveVector:P,sourceVector:P};return w.snap&&(D.toPosition=this.snapPosition(D,w)),w.restrict&&(D.toPosition=this.restrictMovement(D,w)),w.validate&&(D.valid=this.validateElementMove(D,w)),D.moveVector=e.Point.vector(D.fromPosition,D.toPosition),D}snapPosition(S,P){return this.manager.snapPosition(S.element,S.toPosition)}restrictMovement(S,P){const w=e.Point.move(S.fromPosition,S.toPosition);return this.manager.restrictMovement(S.element,w).to}validateElementMove(S,P){return this.manager.hasValidPosition(S.element,S.toPosition)}resizeElements(S,P){const w=this.resolveResizeOptions(P),C=this.calculateDiagramMovement(),E=this.calculateHandleMove(new h(S),C.vector,w),D={...C,valid:{move:!0,size:!0},options:w,handleMove:E,elementResizes:[]};if(e.Vector.isZero(E.moveVector)&&w.skipStatic)return D;const j=this.getResizableElements(S,w);for(const U of j){const p=this.calculateElementResize(U,E,w);this.skipElementResize(p,w)||(D.elementResizes.push(p),D.valid.move=D.valid.move&&p.valid.move,D.valid.size=D.valid.size&&p.valid.size)}return D}resolveResizeOptions(S){var P,w,C;return{...n.DEFAULT_RESIZE_OPTIONS,...S,snap:this.manager.usePositionSnap((P=S==null?void 0:S.snap)!==null&&P!==void 0?P:n.DEFAULT_RESIZE_OPTIONS.snap),restrict:this.manager.useMovementRestriction((w=S==null?void 0:S.restrict)!==null&&w!==void 0?w:n.DEFAULT_RESIZE_OPTIONS.restrict),symmetric:this.manager.useSymmetricResize((C=S==null?void 0:S.symmetric)!==null&&C!==void 0?C:n.DEFAULT_RESIZE_OPTIONS.symmetric)}}calculateHandleMove(S,P,w){const C=this.resolveMoveOptions({...w,validate:!1});return this.calculateElementMove(S,P,C)}getResizableElements(S,P){return[S.parent]}skipElementResize(S,P){return P.skipInvalidMove&&!S.valid.move||P.skipInvalidSize&&!S.valid.size||P.skipStatic&&e.Dimension.equals(S.fromBounds,S.toBounds)}calculateElementResize(S,P,w){const C=S.bounds,E=this.calculateElementBounds(S,P,w),D={element:S,fromBounds:C,toBounds:E,valid:{size:!0,move:!0}};return w.validate&&(D.valid.size=this.manager.hasValidSize(D.element,D.toBounds),D.valid.move=P.valid&&this.manager.hasValidPosition(D.element,D.toBounds)),D}calculateElementBounds(S,P,w){let C=this.calculateBounds(S.bounds,P);if(w.symmetric){const D=this.calculateSymmetricHandleMove(P,w);C=this.calculateBounds(C,D)}if(!w.constrainResize||this.manager.hasValidSize(S,C))return C;const E=this.manager.getMinimumSize(S);if(P.moveVector=this.constrainResizeVector(S.bounds,P,E),w.symmetric&&(P.moveVector.x=S.bounds.width>E.width?P.moveVector.x/2:P.moveVector.x,P.moveVector.y=S.bounds.height>E.height?P.moveVector.y/2:P.moveVector.y),C=this.calculateBounds(S.bounds,P),w.symmetric){const D=this.calculateSymmetricHandleMove(P,{...w,snap:!1});C=this.calculateBounds(C,D)}return C}calculateSymmetricHandleMove(S,P){const w=this.resolveMoveOptions({...P,validate:!1,restrict:!1});return this.calculateElementMove(S.element.opposite(),e.Vector.reverse(S.moveVector),w)}calculateBounds(S,P){return!P||e.Vector.isZero(P.moveVector)?S:this.doCalculateBounds(S,P.moveVector,P.element.location)}doCalculateBounds(S,P,w){switch(w){case i.ResizeHandleLocation.TopLeft:return{x:S.x+P.x,y:S.y+P.y,width:S.width-P.x,height:S.height-P.y};case i.ResizeHandleLocation.Top:return{...S,y:S.y+P.y,height:S.height-P.y};case i.ResizeHandleLocation.TopRight:return{...S,y:S.y+P.y,width:S.width+P.x,height:S.height-P.y};case i.ResizeHandleLocation.Right:return{...S,width:S.width+P.x};case i.ResizeHandleLocation.BottomRight:return{...S,width:S.width+P.x,height:S.height+P.y};case i.ResizeHandleLocation.Bottom:return{...S,height:S.height+P.y};case i.ResizeHandleLocation.BottomLeft:return{...S,x:S.x+P.x,width:S.width-P.x,height:S.height+P.y};case i.ResizeHandleLocation.Left:return{...S,x:S.x+P.x,width:S.width-P.x}}}constrainResizeVector(S,P,w){const C=P.moveVector;switch(P.element.location){case i.ResizeHandleLocation.TopLeft:C.x=S.width-C.x<w.width?S.width-w.width:C.x,C.y=S.height-C.y<w.height?S.height-w.height:C.y;break;case i.ResizeHandleLocation.Top:C.y=S.height-C.y<w.height?S.height-w.height:C.y;break;case i.ResizeHandleLocation.TopRight:C.x=S.width+C.x<w.width?w.width-S.width:C.x,C.y=S.height-C.y<w.height?S.height-w.height:C.y;break;case i.ResizeHandleLocation.Right:C.x=S.width+C.x<w.width?w.width-S.width:C.x;break;case i.ResizeHandleLocation.BottomRight:C.x=S.width+C.x<w.width?w.width-S.width:C.x,C.y=S.height+C.y<w.height?w.height-S.height:C.y;break;case i.ResizeHandleLocation.Bottom:C.y=S.height+C.y<w.height?w.height-S.height:C.y;break;case i.ResizeHandleLocation.BottomLeft:C.x=S.width-C.x<w.width?S.width-w.width:C.x,C.y=S.height+C.y<w.height?w.height-S.height:C.y;break;case i.ResizeHandleLocation.Left:C.x=S.width-C.x<w.width?S.width-w.width:C.x;break}return C}dispose(){this.stopTracking()}}n.ChangeBoundsTracker=f;class h extends i.GResizeHandle{constructor(S,P=S.location,w=i.GResizeHandle.getHandlePosition(S.parent,P)){super(P,S.type,S.hoverFeedback),this.handle=S,this.location=P,this.position=w,this.id=S.id,this.parent=S.parent}opposite(){return new h(this.handle,i.ResizeHandleLocation.opposite(this.location))}}n.MoveableResizeHandle=h;class g extends e.GRoutingHandle{constructor(S,P){super(),this.handle=S,this.position=P,this.id=S.id,this.parent=S.parent}}n.MoveableRoutingHandle=g})(UR);(function(n){var e=l&&l.__decorate||function(C,E,D,j){var U=arguments.length,p=U<3?E:j===null?j=Object.getOwnPropertyDescriptor(E,D):j,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(C,E,D,j);else for(var v=C.length-1;v>=0;v--)(b=C[v])&&(p=(U<3?b(p):U>3?b(E,D,p):b(E,D))||p);return U>3&&p&&Object.defineProperty(E,D,p),p},t=l&&l.__metadata||function(C,E){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(C,E)},i=l&&l.__param||function(C,E){return function(D,j){E(D,j,C)}};Object.defineProperty(n,"__esModule",{value:!0}),n.ChangeBoundsManager=n.CSS_ACTIVE_HANDLE=n.CSS_RESTRICTED_RESIZE=n.CSS_RESIZE_MODE=void 0;const o=z,r=F,s=it,a=yn,f=Ia,h=no,g=Rr,y=Ta,S=p1,P=UR;n.CSS_RESIZE_MODE="resize-mode",n.CSS_RESTRICTED_RESIZE="resize-not-allowed",n.CSS_ACTIVE_HANDLE="active";let w=class{constructor(E,D,j,U,p){this.positionTracker=E,this.movementRestrictor=D,this.snapper=j,this.helperLineManager=U,this.gridManager=p}unsnapModifier(){return"shift"}usePositionSnap(E){return typeof E=="boolean"?E:!E.shiftKey}snapPosition(E,D){var j,U;return(U=(j=this.snapper)===null||j===void 0?void 0:j.snap(D,E))!==null&&U!==void 0?U:D}isValid(E){return this.hasValidPosition(E)&&this.hasValidSize(E)}hasValidPosition(E,D){return!(0,o.isLocateable)(E)||(0,a.isValidMove)(E,D??E.position,this.movementRestrictor)}hasValidSize(E,D){if(!(0,o.isBoundsAware)(E))return!0;const j=D??E.bounds,U=this.getMinimumSize(E);return!(j.width<U.width||j.height<U.height)}getMinimumSize(E){if(!(0,o.isBoundsAware)(E))return o.Dimension.EMPTY;const D=(0,a.minDimensions)(E),j=f.LayoutAware.getComputedDimensions(E);return j?{width:Math.max(D.width,j.width),height:Math.max(D.height,j.height)}:D}useMovementRestriction(E){return this.usePositionSnap(E)}restrictMovement(E,D){const j=this.getMinimumMovement(E,D);if(!j)return D;const U=o.Vector.abs(D.vector),p={x:U.x<j.x?D.from.x:D.to.x,y:U.y<j.y?D.from.y:D.to.y};return o.Point.move(D.from,p)}getMinimumMovement(E,D){var j;return E instanceof S.InsertIndicator&&this.gridManager?this.gridManager.grid:(j=this.helperLineManager)===null||j===void 0?void 0:j.getMinimumMoveVector(E,!0,D.direction)}addMoveFeedback(E,D,j,U){return E.add((0,s.cursorFeedbackAction)(s.CursorCSS.MOVE),(0,s.cursorFeedbackAction)(s.CursorCSS.DEFAULT)),D.elementMoves.forEach(p=>this.addMoveRestrictionFeedback(E,p,j,U)),E}addResizeFeedback(E,D,j,U){E.add(s.ModifyCSSFeedbackAction.create({add:[n.CSS_RESIZE_MODE]}),s.ModifyCSSFeedbackAction.create({remove:[n.CSS_RESIZE_MODE]}));const p=h.GResizeHandle.getCursorCss(D.handleMove.element);E.add((0,s.cursorFeedbackAction)(p),(0,s.cursorFeedbackAction)(s.CursorCSS.DEFAULT));const b=D.handleMove.element;return E.add((0,s.applyCssClasses)(b,n.CSS_ACTIVE_HANDLE),(0,s.deleteCssClasses)(b,n.CSS_ACTIVE_HANDLE)),E.add((0,s.toggleCssClasses)(b,!D.valid.size,n.CSS_RESTRICTED_RESIZE),(0,s.deleteCssClasses)(b,n.CSS_RESTRICTED_RESIZE)),D.elementResizes.forEach(v=>{this.addMoveRestrictionFeedback(E,v,j,U),E.add((0,s.toggleCssClasses)(v.element,!v.valid.size,n.CSS_RESTRICTED_RESIZE),(0,s.deleteCssClasses)(v.element,n.CSS_RESTRICTED_RESIZE))}),E}addMoveRestrictionFeedback(E,D,j,U){if(this.movementRestrictor){const p=P.TrackedElementMove.is(D)?D.valid:D.valid.move;E.add((0,g.movementRestrictionFeedback)(D.element,this.movementRestrictor,p),(0,g.removeMovementRestrictionFeedback)(D.element,this.movementRestrictor))}return E}defaultResizeLocations(){return h.ResizeHandleLocation.CORNERS}useSymmetricResize(E){return typeof E=="boolean"?E:E.ctrlKey}createTracker(){return new P.ChangeBoundsTracker(this)}};n.ChangeBoundsManager=w,n.ChangeBoundsManager=w=e([(0,r.injectable)(),i(0,(0,r.inject)(o.MousePositionTracker)),i(1,(0,r.optional)()),i(1,(0,r.inject)(o.TYPES.IMovementRestrictor)),i(2,(0,r.optional)()),i(2,(0,r.inject)(o.TYPES.ISnapper)),i(3,(0,r.optional)()),i(3,(0,r.inject)(o.TYPES.IHelperLineManager)),i(4,(0,r.optional)()),i(4,(0,r.inject)(y.GridManager)),t("design:paramtypes",[o.MousePositionTracker,Object,Object,Object,y.GridManager])],w)})(Da);var nW=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},$Ee=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(h1,"__esModule",{value:!0});h1.RankedSelectMouseListener=void 0;const Av=z,zO=F,kEe=Is,FEe=no,tK=Da;let OP=class extends Av.SelectMouseListener{constructor(){super(...arguments),this.rank=kEe.Ranked.DEFAULT_RANK-100}handleSelectTarget(e,t,i){const o=[];return o.push(Av.SelectAction.create({selectedElementsIDs:[e.id],deselectedElementsIDs:t.map(r=>r.id)})),o.push(Av.BringToFrontAction.create([e.id])),o}handleDeselectTarget(e,t){const i=[];return i.push(Av.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:[e.id]})),i}handleDeselectAll(e,t){const i=[];return i.push(Av.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:e.map(o=>o.id)})),i}handleButton(e,t){var i;return e instanceof FEe.GResizeHandle&&(!((i=this.changeBoundsManager)===null||i===void 0)&&i.useSymmetricResize(t))?[]:super.handleButton(e,t)}};h1.RankedSelectMouseListener=OP;nW([(0,zO.inject)(tK.ChangeBoundsManager),(0,zO.optional)(),$Ee("design:type",tK.ChangeBoundsManager)],OP.prototype,"changeBoundsManager",void 0);h1.RankedSelectMouseListener=OP=nW([(0,zO.injectable)()],OP);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneSelectModule=n.selectModule=void 0;const e=z,t=Yt,i=f1,o=h1;n.selectModule=new e.FeatureModule((r,s,a)=>{const f={bind:r,isBound:a};(0,e.configureCommand)(f,t.SelectCommand),(0,e.configureCommand)(f,t.SelectAllCommand),(0,e.configureCommand)(f,i.SelectFeedbackCommand),(0,e.bindAsService)(f,e.TYPES.MouseListener,o.RankedSelectMouseListener)},{featureId:Symbol("select")}),n.standaloneSelectModule=new e.FeatureModule(r=>{(0,e.bindAsService)(r,e.TYPES.KeyListener,e.SelectKeyboardListener)},{featureId:Symbol("standaloneSelect"),requires:n.selectModule})})(VR);var Rb={},Pc={},Mb=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},M9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Pc,"__esModule",{value:!0});Pc.SourceModelChangedActionHandler=Pc.ExternalSourceModelChangedHandler=void 0;const gm=F,E_=z;let Ty=class{};Pc.ExternalSourceModelChangedHandler=Ty;Pc.ExternalSourceModelChangedHandler=Ty=Mb([(0,gm.injectable)()],Ty);let vm=class{handle(e){if(E_.SourceModelChangedAction.is(e)){if(this.externalModelSourceChangedHandler){this.externalModelSourceChangedHandler.notifySourceModelChange(e.sourceModelName,this.options).then(t=>this.dispatcher.dispatchAll(t));return}this.showSimpleNotification(e)}}showSimpleNotification(e){const t=`The source model ${e.sourceModelName} has changed. You might want to consider reloading.`,i=0,o="WARNING";this.dispatcher.dispatchAll([E_.StatusAction.create(t,{severity:o,timeout:i}),E_.MessageAction.create(t,{severity:o})])}};Pc.SourceModelChangedActionHandler=vm;Mb([(0,gm.inject)(E_.TYPES.IActionDispatcher),M9("design:type",Object)],vm.prototype,"dispatcher",void 0);Mb([(0,gm.inject)(E_.TYPES.ViewerOptions),M9("design:type",Object)],vm.prototype,"options",void 0);Mb([(0,gm.inject)(Ty),(0,gm.optional)(),M9("design:type",Ty)],vm.prototype,"externalModelSourceChangedHandler",void 0);Pc.SourceModelChangedActionHandler=vm=Mb([(0,gm.injectable)()],vm);Object.defineProperty(Rb,"__esModule",{value:!0});Rb.sourceModelWatcherModule=void 0;const WD=z,xEe=Pc;Rb.sourceModelWatcherModule=new WD.FeatureModule((n,e,t)=>{(0,WD.configureActionHandler)({bind:n,isBound:t},WD.SourceModelChangedAction.KIND,xEe.SourceModelChangedActionHandler)},{featureId:Symbol("sourceModelWatcher")});var Ib={},m1={},I9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},iW=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},GO;Object.defineProperty(m1,"__esModule",{value:!0});m1.StatusOverlay=void 0;const Rv=z,D9=F,nK=Pt,iK=An,HEe=Ms;let _m=GO=class extends HEe.GLSPAbstractUIExtension{id(){return GO.ID}containerClass(){return"sprotty-status"}initializeContents(e){this.statusIconDiv=document.createElement("div"),e.appendChild(this.statusIconDiv),this.statusMessageDiv=document.createElement("div"),this.statusMessageDiv.classList.add("sprotty-status-message"),e.appendChild(this.statusMessageDiv)}setStatus(e){if(this.statusMessageDiv&&(this.statusMessageDiv.textContent=e.message,this.removeClasses(this.statusMessageDiv,1),this.statusMessageDiv.classList.add(e.severity.toLowerCase())),this.statusIconDiv){this.removeClasses(this.statusIconDiv,0);const t=this.statusIconDiv.classList;switch(t.add(e.severity.toLowerCase()),e.severity){case"FATAL":t.add(...(0,Rv.codiconCSSClasses)("error"));break;case"ERROR":t.add(...(0,Rv.codiconCSSClasses)("warning"));break;case"WARNING":t.add(...(0,Rv.codiconCSSClasses)("warning"));break;case"INFO":t.add(...(0,Rv.codiconCSSClasses)("info"));break}}}clearStatus(){this.setStatus(Rv.StatusAction.create("",{severity:"NONE"}))}clearTimeout(){this.pendingTimeout&&(window.clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0)}removeClasses(e,t){const i=e.classList;for(;i.length>t;){const o=i.item(i.length-1);o&&i.remove(o)}}handle(e){var t;if(this.clearTimeout(),e.severity==="NONE"){this.clearStatus();return}this.setStatus(e);const i=(t=e.timeout)!==null&&t!==void 0?t:-1;i>0&&(this.pendingTimeout=window.setTimeout(()=>this.clearStatus(),i))}preInitialize(){this.show(this.editorContext.modelRoot)}};m1.StatusOverlay=_m;_m.ID="glsp.server.status.overlay";I9([(0,D9.inject)(nK.GLSPActionDispatcher),iW("design:type",nK.GLSPActionDispatcher)],_m.prototype,"actionDispatcher",void 0);I9([(0,D9.inject)(iK.EditorContextService),iW("design:type",iK.EditorContextService)],_m.prototype,"editorContext",void 0);m1.StatusOverlay=_m=GO=I9([(0,D9.injectable)()],_m);Object.defineProperty(Ib,"__esModule",{value:!0});Ib.statusModule=void 0;const qh=z,ZD=m1;Ib.statusModule=new qh.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,qh.bindAsService)(o,qh.TYPES.IUIExtension,ZD.StatusOverlay),n(qh.TYPES.IDiagramStartup).toService(ZD.StatusOverlay),(0,qh.configureActionHandler)(o,qh.StatusAction.KIND,ZD.StatusOverlay)},{featureId:Symbol("status")});var Db={},g1={},oW=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},KEe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(g1,"__esModule",{value:!0});g1.MetadataPlacer=void 0;const Za=z,rW=F,VEe=ti;let LP=class{decorate(e,t){return t instanceof Za.GModelRoot&&(0,Za.setAttr)(e,"data-svg-metadata-api",!0),(0,Za.setAttr)(e,"data-svg-metadata-type",t.type),t instanceof Za.GChildElement&&(0,Za.setAttr)(e,"data-svg-metadata-parent-id",this.domHelper.createUniqueDOMElementId(t.parent)),t instanceof VEe.GEdge&&(t.source!==void 0&&(0,Za.setAttr)(e,"data-svg-metadata-edge-source-id",this.domHelper.createUniqueDOMElementId(t.source)),t.target!==void 0&&(0,Za.setAttr)(e,"data-svg-metadata-edge-target-id",this.domHelper.createUniqueDOMElementId(t.target))),e}postUpdate(){}};g1.MetadataPlacer=LP;oW([(0,rW.inject)(Za.TYPES.DOMHelper),KEe("design:type",Za.DOMHelper)],LP.prototype,"domHelper",void 0);g1.MetadataPlacer=LP=oW([(0,rW.injectable)()],LP);Object.defineProperty(Db,"__esModule",{value:!0});Db.svgMetadataModule=void 0;const oK=z,rK=g1;Db.svgMetadataModule=new oK.FeatureModule(n=>{n(rK.MetadataPlacer).toSelf().inSingletonScope(),n(oK.TYPES.IVNodePostprocessor).toService(rK.MetadataPlacer)},{featureId:Symbol("svgMetadata")});var Tb={},Dn={},Hu={},wc={},zEe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},GEe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},UEe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(wc,"__esModule",{value:!0});wc.EnableDebugModeCommand=wc.EnableDebugModeAction=void 0;const UO=z,sK=F,YEe=Gn,aK=kt;var Oy;(function(n){n.KIND="enableDebugMode",n.CSS_ROOT_CLASS="debug-mode";function e(i){return UO.Action.hasKind(i,n.KIND)&&(0,UO.hasBooleanProp)(i,"enable")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Oy||(wc.EnableDebugModeAction=Oy={}));let NP=class extends YEe.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return this.setDebugMode(e.root,this.action.enable)}setDebugMode(e,t){return t?(0,aK.addCssClasses)(e,[Oy.CSS_ROOT_CLASS]):(0,aK.removeCssClasses)(e,[Oy.CSS_ROOT_CLASS]),e}};wc.EnableDebugModeCommand=NP;NP.KIND=Oy.KIND;wc.EnableDebugModeCommand=NP=zEe([(0,sK.injectable)(),UEe(0,(0,sK.inject)(UO.TYPES.Action)),GEe("design:paramtypes",[Object])],NP);var T9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},w3=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Hu,"__esModule",{value:!0});Hu.DebugManager=void 0;const qEe=z,O9=F,cK=wc;let Ly=class{constructor(){this._debugEnabled=!1}get isDebugEnabled(){return this._debugEnabled}init(){this.debugFeedback=this.feedbackDispatcher.createEmitter()}handle(e){this.setDebugEnabled(e.enable)}setDebugEnabled(e){this._debugEnabled&&!e?(this._debugEnabled=!1,this.debugFeedback.dispose()):!this._debugEnabled&&e&&(this._debugEnabled=!0,this.debugFeedback.add(cK.EnableDebugModeAction.create({enable:!0}),cK.EnableDebugModeAction.create({enable:!1})).submit())}toggleDebugEnabled(){this.setDebugEnabled(!this._debugEnabled)}};Hu.DebugManager=Ly;T9([(0,O9.inject)(qEe.TYPES.IFeedbackActionDispatcher),w3("design:type",Object)],Ly.prototype,"feedbackDispatcher",void 0);T9([(0,O9.postConstruct)(),w3("design:type",Function),w3("design:paramtypes",[]),w3("design:returntype",void 0)],Ly.prototype,"init",null);Hu.DebugManager=Ly=T9([(0,O9.injectable)()],Ly);var mi={},Ob=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},WEe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},YO,qO;Object.defineProperty(mi,"__esModule",{value:!0});mi.DeleteToolMouseListener=mi.MouseDeleteTool=mi.DeleteKeyListener=mi.DelKeyDeleteTool=void 0;const Cr=z,Lb=F,QD=it,ZEe=It,QEe=_i;let Ny=YO=class{constructor(){this.isEditTool=!0,this.deleteKeyListener=new jP}get id(){return YO.ID}enable(){this.keytool.register(this.deleteKeyListener)}disable(){this.keytool.deregister(this.deleteKeyListener)}};mi.DelKeyDeleteTool=Ny;Ny.ID="glsp.delete-keyboard";Ob([(0,Lb.inject)(Cr.KeyTool),WEe("design:type",Cr.KeyTool)],Ny.prototype,"keytool",void 0);mi.DelKeyDeleteTool=Ny=YO=Ob([(0,Lb.injectable)()],Ny);let jP=class extends Cr.KeyListener{keyDown(e,t){if((0,Cr.matchesKeystroke)(t,"Delete")){const i=Array.from(e.root.index.all().filter(o=>(0,Cr.isDeletable)(o)&&(0,Cr.isSelectable)(o)&&o.selected).filter(o=>o.id!==o.root.id).map(o=>o.id));if(i.length>0)return[Cr.DeleteElementOperation.create(i)]}return[]}};mi.DeleteKeyListener=jP;mi.DeleteKeyListener=jP=Ob([(0,Lb.injectable)()],jP);let BP=qO=class extends QEe.BaseEditTool{constructor(){super(...arguments),this.deleteToolMouseListener=new $P}get id(){return qO.ID}enable(){const e=this.createFeedbackEmitter().add((0,QD.cursorFeedbackAction)(QD.CursorCSS.ELEMENT_DELETION),(0,QD.cursorFeedbackAction)()).submit();this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.deleteToolMouseListener),e)}};mi.MouseDeleteTool=BP;BP.ID="glsp.delete-mouse";mi.MouseDeleteTool=BP=qO=Ob([(0,Lb.injectable)()],BP);let $P=class extends Cr.MouseListener{mouseUp(e,t){const i=(0,Cr.findParentByFeature)(e,Cr.isDeletable);if(i===void 0)return[];const o=[];return o.push(Cr.DeleteElementOperation.create([i.id])),(0,Cr.isCtrlOrCmd)(t)||o.push(ZEe.EnableDefaultToolsAction.create()),o}};mi.DeleteToolMouseListener=$P;mi.DeleteToolMouseListener=$P=Ob([(0,Lb.injectable)()],$P);var Ji={},oh={},Nb={};(function(n){var e=l&&l.__decorate||function(C,E,D,j){var U=arguments.length,p=U<3?E:j===null?j=Object.getOwnPropertyDescriptor(E,D):j,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(C,E,D,j);else for(var v=C.length-1;v>=0;v--)(b=C[v])&&(p=(U<3?b(p):U>3?b(E,D,p):b(E,D))||p);return U>3&&p&&Object.defineProperty(E,D,p),p},t=l&&l.__metadata||function(C,E){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(C,E)},i=l&&l.__param||function(C,E){return function(D,j){E(D,j,C)}};Object.defineProperty(n,"__esModule",{value:!0}),n.removeMarquee=n.drawMarquee=n.MARQUEE=n.marqueeId=n.MarqueeEndMovingMouseListener=n.RemoveMarqueeCommand=n.RemoveMarqueeAction=n.DrawMarqueeCommand=n.DrawMarqueeAction=void 0;const o=F,r=z,s=Gn;var a;(function(C){C.KIND="drawMarquee";function E(j){return r.Action.hasKind(j,C.KIND)&&(0,r.hasObjectProp)(j,"startPoint")&&(0,r.hasObjectProp)(j,"endPoint")}C.is=E;function D(j){return{kind:C.KIND,...j}}C.create=D})(a||(n.DrawMarqueeAction=a={}));let f=class extends s.FeedbackCommand{constructor(E){super(),this.action=E}execute(E){return P(E,this.action.startPoint,this.action.endPoint),E.root}};n.DrawMarqueeCommand=f,f.KIND=a.KIND,n.DrawMarqueeCommand=f=e([(0,o.injectable)(),i(0,(0,o.inject)(r.TYPES.Action)),t("design:paramtypes",[Object])],f);var h;(function(C){C.KIND="removeMarquee";function E(j){return r.Action.hasKind(j,C.KIND)}C.is=E;function D(){return{kind:C.KIND}}C.create=D})(h||(n.RemoveMarqueeAction=h={}));let g=class extends s.FeedbackCommand{execute(E){return w(E.root),E.root}};n.RemoveMarqueeCommand=g,g.KIND=h.KIND,n.RemoveMarqueeCommand=g=e([(0,o.injectable)()],g);class y extends r.MouseListener{constructor(E){super(),this.anchorRegistry=E}mouseMove(E,D){return[]}}n.MarqueeEndMovingMouseListener=y;function S(C){return C.id+"_"+n.MARQUEE}n.marqueeId=S,n.MARQUEE="marquee";function P(C,E,D){const j=C.root;w(j);const U={type:n.MARQUEE,id:S(j),startPoint:E,endPoint:D},p=C.modelFactory.createElement(U);j.add(p)}n.drawMarquee=P;function w(C){const E=C.index.getById(S(C));E instanceof r.GChildElement&&C.remove(E)}n.removeMarquee=w})(Nb);var XEe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},JEe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},XD=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(oh,"__esModule",{value:!0});oh.MarqueeUtil=void 0;const Jr=z,jE=F,dK=ti,JD=kt,e3e=Ct,t3e=Nb;let WO=class{constructor(e={entireElement:!1,entireEdge:!1},t){this.marqueeBehavior=e,this.domHelper=t}isContinuousMode(e,t){return t.shiftKey}getMarkableNodes(e){return(0,JD.getMatchingElements)(e.index,this.isMarkableNode())}isMarkableNode(){return(0,Jr.typeGuard)((0,Jr.toTypeGuard)(Jr.GNode),JD.isSelectableAndBoundsAware)}getMarkableEdges(e){return(0,JD.getMatchingElements)(e.index,this.isMarkableEdge())}isMarkableEdge(){return(0,Jr.typeGuard)((0,Jr.toTypeGuard)(dK.GEdge),Jr.isSelectable)}updateStartPoint(e){this.startPoint=e}updateCurrentPoint(e){this.currentPoint=e}isMarked(e){return e instanceof dK.GEdge?this.isMarkedEdge(e):this.isMarkedNode(e)}drawMarqueeAction(){return t3e.DrawMarqueeAction.create({startPoint:this.startPoint,endPoint:this.currentPoint})}isMarkedEdge(e){const t=this.domHelper.createUniqueDOMElementId(e),i=document.getElementById(t);if(!i||i.getAttribute("transform")||!i.children[0])return!1;const o=i.children[0].getAttribute("d");return this.isEdgePathMarked(o)}isMarkedNode(e){return this.isNodeMarked(this.getNodeBounds(e))}getNodeBounds(e){return(0,e3e.toAbsoluteBounds)(e)}isEdgePathMarked(e){if(!e)return!1;const t=e.split(/M|L/).filter(i=>i).map(i=>{const o=i.split(",");return{x:parseInt(o[0],10),y:parseInt(o[1],10)}});return this.isEdgeMarked(t)}isEdgeMarked(e){return this.marqueeBehavior.entireEdge?this.isEntireEdgeMarked(e):this.isPartOfEdgeMarked(e)}isNodeMarked(e){const t=this.startPoint.x<this.currentPoint.x?this.isElementBetweenXAxis(e,this.startPoint.x,this.currentPoint.x):this.isElementBetweenXAxis(e,this.currentPoint.x,this.startPoint.x),i=this.startPoint.y<this.currentPoint.y?this.isElementBetweenYAxis(e,this.startPoint.y,this.currentPoint.y):this.isElementBetweenYAxis(e,this.currentPoint.y,this.startPoint.y);return t&&i}isEntireEdgeMarked(e){for(let t=0;t<e.length;t++)if(!this.pointInRect(e[t]))return!1;return!0}isPartOfEdgeMarked(e){for(let t=0;t<e.length-1;t++)if(this.isLineMarked(e[t],e[t+1]))return!0;return!1}isLineMarked(e,t){const i=new Jr.PointToPointLine(e,t);return this.pointInRect(e)||this.pointInRect(t)||this.lineIntersect(i,this.startPoint,{x:this.startPoint.x,y:this.currentPoint.y})||this.lineIntersect(i,this.startPoint,{x:this.currentPoint.x,y:this.startPoint.y})||this.lineIntersect(i,{x:this.currentPoint.x,y:this.startPoint.y},this.currentPoint)||this.lineIntersect(i,{x:this.startPoint.x,y:this.currentPoint.y},this.currentPoint)}lineIntersect(e,t,i){return e.intersection(new Jr.PointToPointLine(t,i))!==void 0}pointInRect(e){const t=this.startPoint.x<=this.currentPoint.x?this.isBetween(e.x,this.startPoint.x,this.currentPoint.x):this.isBetween(e.x,this.currentPoint.x,this.startPoint.x),i=this.startPoint.y<=this.currentPoint.y?this.isBetween(e.y,this.startPoint.y,this.currentPoint.y):this.isBetween(e.y,this.currentPoint.y,this.startPoint.y);return t&&i}isElementBetweenXAxis(e,t,i){const o=this.isBetween(e.x,t,i),r=this.isBetween(e.x+e.width,t,i);return this.marqueeBehavior.entireElement?o&&r:o||r||this.isBetween(t,e.x,e.x+e.width)||this.isBetween(i,e.x,e.x+e.width)}isElementBetweenYAxis(e,t,i){const o=this.isBetween(e.y,t,i),r=this.isBetween(e.y+e.height,t,i);return this.marqueeBehavior.entireElement?o&&r:o||r||this.isBetween(t,e.y,e.y+e.height)||this.isBetween(i,e.y,e.y+e.height)}isBetween(e,t,i){return t<=e&&e<=i}};oh.MarqueeUtil=WO;oh.MarqueeUtil=WO=XEe([(0,jE.injectable)(),XD(0,(0,jE.inject)(Jr.TYPES.IMarqueeBehavior)),XD(0,(0,jE.optional)()),XD(1,(0,jE.inject)(Jr.TYPES.DOMHelper)),JEe("design:paramtypes",[Object,Jr.DOMHelper])],WO);var L9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},n3e=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},ZO;Object.defineProperty(Ji,"__esModule",{value:!0});Ji.ShiftKeyListener=Ji.MarqueeMouseListener=Ji.MarqueeMouseTool=void 0;const A3=z,N9=F,i3e=Hr,eT=it,sW=It,uK=kt,lK=Ct,o3e=_i,fK=oh,QO=Nb;let jy=ZO=class extends o3e.BaseEditTool{constructor(){super(...arguments),this.shiftKeyListener=new kP}get id(){return ZO.ID}enable(){this.toDisposeOnDisable.push(this.mouseTool.registerListener(new aW(this.editorContext.modelRoot,this.marqueeUtil)),this.keyTool.registerListener(this.shiftKeyListener),this.createFeedbackEmitter().add((0,eT.cursorFeedbackAction)(eT.CursorCSS.MARQUEE),(0,eT.cursorFeedbackAction)()).submit())}get isEditTool(){return!1}};Ji.MarqueeMouseTool=jy;jy.ID="glsp.marquee-mouse-tool";L9([(0,N9.inject)(fK.MarqueeUtil),n3e("design:type",fK.MarqueeUtil)],jy.prototype,"marqueeUtil",void 0);Ji.MarqueeMouseTool=jy=ZO=L9([(0,N9.injectable)()],jy);class aW extends i3e.DragAwareMouseListener{constructor(e,t){super(),this.marqueeUtil=t,this.isActive=!1,this.nodes=this.marqueeUtil.getMarkableNodes(e),this.edges=this.marqueeUtil.getMarkableEdges(e)}mouseDown(e,t){return this.isActive=!0,this.marqueeUtil.updateStartPoint((0,lK.getAbsolutePosition)(e,t)),t.ctrlKey&&(this.previouslySelected=(0,uK.getMatchingElements)(e.index,(0,A3.typeGuard)(uK.isSelectableAndBoundsAware,A3.isSelected)).map(i=>i.id)),[]}mouseMove(e,t){if(this.marqueeUtil.updateCurrentPoint((0,lK.getAbsolutePosition)(e,t)),this.isActive){const i=this.nodes.filter(a=>this.marqueeUtil.isMarked(a)).map(a=>a.id),o=this.edges.filter(a=>this.marqueeUtil.isMarked(a)).map(a=>a.id),s=i.concat(o).concat(this.previouslySelected);return[A3.SelectAction.setSelection(s),this.marqueeUtil.drawMarqueeAction()]}return[]}mouseUp(e,t){return this.isActive=!1,this.marqueeUtil.isContinuousMode(e,t)?[QO.RemoveMarqueeAction.create()]:[QO.RemoveMarqueeAction.create(),sW.EnableDefaultToolsAction.create()]}}Ji.MarqueeMouseListener=aW;let kP=class extends A3.KeyListener{keyUp(e,t){return t.shiftKey?[]:[QO.RemoveMarqueeAction.create(),sW.EnableDefaultToolsAction.create()]}};Ji.ShiftKeyListener=kP;Ji.ShiftKeyListener=kP=L9([(0,N9.injectable)()],kP);var Ac={},r3e=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},s3e=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},a3e=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Ac,"__esModule",{value:!0});Ac.OriginViewportCommand=Ac.OriginViewportAction=void 0;const _p=z,hK=F;var XO;(function(n){n.KIND="originViewport";function e(i){return _p.Action.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,animate:!0,...i}}n.create=t})(XO||(Ac.OriginViewportAction=XO={}));let FP=class extends _p.BoundsAwareViewportCommand{constructor(e){super(e.animate),this.action=e}getElementIds(){return[]}initialize(e){if(!(0,_p.isViewport)(e))return;this.oldViewport={scroll:e.scroll,zoom:e.zoom};const t=this.getNewViewport(_p.Bounds.EMPTY,e);if(t){const{zoomLimits:i,horizontalScrollLimits:o,verticalScrollLimits:r}=this.viewerOptions;this.newViewport=(0,_p.limitViewport)(t,e.canvasBounds,o,r,i)}}getNewViewport(e,t){return{zoom:1,scroll:{x:0,y:0}}}};Ac.OriginViewportCommand=FP;FP.KIND=XO.KIND;Ac.OriginViewportCommand=FP=r3e([(0,hK.injectable)(),a3e(0,(0,hK.inject)(_p.TYPES.Action)),s3e("design:paramtypes",[Object])],FP);var rh=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Gd=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},up;Object.defineProperty(Dn,"__esModule",{value:!0});Dn.changeCodiconClass=Dn.changeCSSClass=Dn.createToolGroup=Dn.createIcon=Dn.compare=Dn.ToolPalette=Dn.EnableToolPaletteAction=void 0;const po=z,Rc=F,pK=Pt,mK=An,gK=zc,BE=It,c3e=Ms,vK=Hu,_K=Ta,d3e=mi,u3e=Ji,l3e=Ac,Ua="clicked",f3e="search",yK="tools",bK="chevron-right",SK="500px";var EK;(function(n){n.KIND="enableToolPalette";function e(i){return po.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(EK||(Dn.EnableToolPaletteAction=EK={}));let fa=up=class extends c3e.GLSPAbstractUIExtension{constructor(){super(...arguments),this.paletteItemsCopy=[],this.dynamic=!1}id(){return up.ID}containerClass(){return up.ID}postConstruct(){this.editorContext.onEditModeChanged(e=>this.editModeChanged(e.newValue,e.oldValue))}initialize(){return this.paletteItems?super.initialize():!1}initializeContents(e){this.createHeader(),this.createBody(),this.lastActiveButton=this.defaultToolsButton,e.setAttribute("aria-label","Tool-Palette")}onBeforeShow(e,t){this.modelRootId=t.id,this.containerElement.style.maxHeight=SK}addMinimizePaletteButton(){const e=document.getElementById(this.options.baseDiv),t=document.createElement("div");if(t.classList.add("minimize-palette-button"),this.containerElement.classList.add("collapsible-palette"),e){const i=e.insertBefore(t,e.firstChild),o=Fo(bK);this.updateMinimizePaletteButtonTooltip(t),o.onclick=r=>{this.isPaletteMaximized()?this.containerElement.style.maxHeight="0px":this.containerElement.style.maxHeight=SK,this.updateMinimizePaletteButtonTooltip(t),t5(o,yK),t5(o,bK)},i.appendChild(o)}}updateMinimizePaletteButtonTooltip(e){this.isPaletteMaximized()?e.title="Minimize palette":e.title="Maximize palette"}isPaletteMaximized(){return this.containerElement&&this.containerElement.style.maxHeight!=="0px"}createBody(){const e=document.createElement("div");e.classList.add("palette-body");let t=0;if(this.paletteItems.sort(JO).forEach(i=>{if(i.children){const o=cW(i);i.children.sort(JO).forEach(r=>o.appendChild(this.createToolButton(r,t++))),e.appendChild(o)}else e.appendChild(this.createToolButton(i,t++))}),this.paletteItems.length===0){const i=document.createElement("div");i.innerText="No results found.",i.classList.add("tool-button"),e.appendChild(i)}this.bodyDiv&&this.containerElement.removeChild(this.bodyDiv),this.containerElement.appendChild(e),this.bodyDiv=e}createHeader(){this.addMinimizePaletteButton();const e=document.createElement("div");e.classList.add("palette-header"),e.append(this.createHeaderTitle()),e.appendChild(this.createHeaderTools()),e.appendChild(this.searchField=this.createHeaderSearchField()),this.containerElement.appendChild(e)}createHeaderTools(){const e=document.createElement("div");e.classList.add("header-tools"),this.defaultToolsButton=this.createDefaultToolButton(),e.appendChild(this.defaultToolsButton);const t=this.createMouseDeleteToolButton();e.appendChild(t);const i=this.createMarqueeToolButton();e.appendChild(i);const o=this.createValidateButton();e.appendChild(o);const r=this.createResetViewportButton();if(e.appendChild(r),this.gridManager){const a=this.createToggleGridButton();e.appendChild(a)}if(this.debugManager){const a=this.createToggleDebugButton();e.appendChild(a)}const s=this.createSearchButton();return e.appendChild(s),e}createDefaultToolButton(){const e=Fo("inspect");return e.id="btn_default_tools",e.title="Enable selection tool",e.onclick=this.onClickStaticToolButton(e),e.ariaLabel=e.title,e.tabIndex=1,e}createMouseDeleteToolButton(){const e=Fo("chrome-close");return e.title="Enable deletion tool",e.onclick=this.onClickStaticToolButton(e,d3e.MouseDeleteTool.ID),e.ariaLabel=e.title,e.tabIndex=1,e}createMarqueeToolButton(){const e=Fo("screen-full");return e.title="Enable marquee tool",e.onclick=this.onClickStaticToolButton(e,u3e.MarqueeMouseTool.ID),e.ariaLabel=e.title,e.tabIndex=1,e}createValidateButton(){const e=Fo("pass");return e.title="Validate model",e.onclick=t=>{const i=[this.modelRootId];this.actionDispatcher.dispatch(po.RequestMarkersAction.create(i,{reason:po.MarkersReason.BATCH})),e.focus()},e.ariaLabel=e.title,e.tabIndex=1,e}createResetViewportButton(){const e=Fo("screen-normal");return e.title="Reset Viewport",e.onclick=t=>{this.actionDispatcher.dispatch(l3e.OriginViewportAction.create()),e.focus()},e.ariaLabel=e.title,e.tabIndex=1,e}createToggleGridButton(){var e;const t=Fo("symbol-numeric");return t.title="Toggle Grid",t.onclick=()=>{var i,o,r;!((i=this.gridManager)===null||i===void 0)&&i.isGridVisible?(t.classList.remove(Ua),(o=this.gridManager)===null||o===void 0||o.setGridVisible(!1)):(t.classList.add(Ua),(r=this.gridManager)===null||r===void 0||r.setGridVisible(!0))},!((e=this.gridManager)===null||e===void 0)&&e.isGridVisible&&t.classList.add(Ua),t.ariaLabel=t.title,t.tabIndex=1,t}createToggleDebugButton(){var e;const t=Fo("debug");return t.title="Debug Mode",t.onclick=()=>{var i,o,r;!((i=this.debugManager)===null||i===void 0)&&i.isDebugEnabled?(t.classList.remove(Ua),(o=this.debugManager)===null||o===void 0||o.setDebugEnabled(!1)):(t.classList.add(Ua),(r=this.debugManager)===null||r===void 0||r.setDebugEnabled(!0))},!((e=this.debugManager)===null||e===void 0)&&e.isDebugEnabled&&t.classList.add(Ua),t.ariaLabel=t.title,t.tabIndex=1,t}createSearchButton(){const e=Fo(f3e);return e.onclick=t=>{const i=document.getElementById(this.containerElement.id+"_search_field");i&&(i.style.display==="none"?(i.style.display="",i.focus()):i.style.display="none")},e.classList.add("search-icon"),e.title="Filter palette entries",e.ariaLabel=e.title,e.tabIndex=1,e}createHeaderSearchField(){const e=document.createElement("input");return e.classList.add("search-input"),e.id=this.containerElement.id+"_search_field",e.type="text",e.placeholder="Search...",e.style.display="none",e.onkeyup=()=>this.requestFilterUpdate(this.searchField.value),e.onkeydown=t=>this.clearOnEscape(t),e}createHeaderTitle(){const e=document.createElement("div");return e.classList.add("header-icon"),e.appendChild(Fo(yK)),e.insertAdjacentText("beforeend","Palette"),e}createToolButton(e,t){const i=document.createElement("div");return i.tabIndex=t,i.classList.add("tool-button"),e.icon&&i.appendChild(Fo(e.icon)),i.insertAdjacentText("beforeend",e.label),i.onclick=this.onClickCreateToolButton(i,e),i.onkeydown=o=>this.clearToolOnEscape(o),i}onClickCreateToolButton(e,t){return i=>{this.editorContext.isReadonly||(this.actionDispatcher.dispatchAll(t.actions),this.changeActiveButton(e),e.focus())}}onClickStaticToolButton(e,t){return i=>{if(!this.editorContext.isReadonly){const o=t?BE.EnableToolsAction.create([t]):BE.EnableDefaultToolsAction.create();this.actionDispatcher.dispatch(o),this.changeActiveButton(e),e.focus()}}}changeActiveButton(e){this.lastActiveButton&&this.lastActiveButton.classList.remove(Ua),e?(e.classList.add(Ua),this.lastActiveButton=e):this.defaultToolsButton&&(this.defaultToolsButton.classList.add(Ua),this.lastActiveButton=this.defaultToolsButton)}handle(e){var t;this.changeActiveButton(),po.UpdateModelAction.is(e)||po.SetModelAction.is(e)?this.reloadPaletteBody():BE.EnableDefaultToolsAction.is(e)&&this.focusTracker.hasFocus&&((t=this.focusTracker.diagramElement)===null||t===void 0||t.focus())}editModeChanged(e,t){this.actionDispatcher.dispatch(po.SetUIExtensionVisibilityAction.create({extensionId:up.ID,visible:!this.editorContext.isReadonly}))}clearOnEscape(e){(0,po.matchesKeystroke)(e,"Escape")&&(this.searchField.value="",this.requestFilterUpdate(""))}clearToolOnEscape(e){(0,po.matchesKeystroke)(e,"Escape")&&this.actionDispatcher.dispatch(BE.EnableDefaultToolsAction.create())}requestFilterUpdate(e){this.paletteItemsCopy.length===0&&(this.paletteItemsCopy=JSON.parse(JSON.stringify(this.paletteItems))),this.paletteItems=JSON.parse(JSON.stringify(this.paletteItemsCopy));const t=[];for(const i of this.paletteItems)if(i.children){const o=i.children.filter(r=>r.label.toLowerCase().includes(e.toLowerCase()));o.length>0&&(i.children.splice(0,i.children.length),o.forEach(r=>i.children.push(r)),t.push(i))}this.paletteItems=t,this.createBody()}async preRequestModel(){await this.setPaletteItems(),this.editorContext.isReadonly||this.show(this.editorContext.modelRoot)}async postRequestModel(){this.reloadPaletteBody()}async setPaletteItems(){const e=po.RequestContextActions.create({contextId:up.ID,editorContext:{selectedElementIds:[]}}),t=await this.actionDispatcher.request(e);this.paletteItems=t.actions.map(i=>i),this.dynamic=this.paletteItems.some(i=>this.hasDynamicAction(i))}hasDynamicAction(e){var t;const i=!!e.actions.find(o=>{var r;return po.TriggerNodeCreationAction.is(o)&&((r=o.ghostElement)===null||r===void 0?void 0:r.dynamic)});return i||((t=e.children)===null||t===void 0?void 0:t.some(o=>this.hasDynamicAction(o)))||!1}async reloadPaletteBody(){this.dynamic&&(await this.setPaletteItems(),this.paletteItemsCopy=[],this.requestFilterUpdate(this.searchField.value))}};Dn.ToolPalette=fa;fa.ID="tool-palette";rh([(0,Rc.inject)(pK.GLSPActionDispatcher),Gd("design:type",pK.GLSPActionDispatcher)],fa.prototype,"actionDispatcher",void 0);rh([(0,Rc.inject)(mK.EditorContextService),Gd("design:type",mK.EditorContextService)],fa.prototype,"editorContext",void 0);rh([(0,Rc.inject)(gK.FocusTracker),Gd("design:type",gK.FocusTracker)],fa.prototype,"focusTracker",void 0);rh([(0,Rc.inject)(_K.GridManager),(0,Rc.optional)(),Gd("design:type",_K.GridManager)],fa.prototype,"gridManager",void 0);rh([(0,Rc.inject)(vK.DebugManager),(0,Rc.optional)(),Gd("design:type",vK.DebugManager)],fa.prototype,"debugManager",void 0);rh([(0,Rc.postConstruct)(),Gd("design:type",Function),Gd("design:paramtypes",[]),Gd("design:returntype",void 0)],fa.prototype,"postConstruct",null);Dn.ToolPalette=fa=up=rh([(0,Rc.injectable)()],fa);function JO(n,e){const t=n.sortString.localeCompare(e.sortString);return t!==0?t:n.label.localeCompare(e.label)}Dn.compare=JO;function Fo(n){const e=document.createElement("i");return e.classList.add(...(0,po.codiconCSSClasses)(n)),e}Dn.createIcon=Fo;function cW(n){const e=document.createElement("div");e.classList.add("tool-group"),e.id=n.id;const t=document.createElement("div");return t.classList.add("group-header"),n.icon&&t.appendChild(Fo(n.icon)),t.insertAdjacentText("beforeend",n.label),t.ondblclick=i=>{const o="collapsed";e5(e,o),Array.from(e.children).forEach(r=>e5(r,o)),window.getSelection().removeAllRanges()},e.appendChild(t),e}Dn.createToolGroup=cW;function e5(n,e){n.classList.contains(e)?n.classList.remove(e):n.classList.add(e)}Dn.changeCSSClass=e5;function t5(n,e){n.classList.contains((0,po.codiconCSSClasses)(e)[1])?n.classList.remove((0,po.codiconCSSClasses)(e)[1]):n.classList.add((0,po.codiconCSSClasses)(e)[1])}Dn.changeCodiconClass=t5;Object.defineProperty(Tb,"__esModule",{value:!0});Tb.toolPaletteModule=void 0;const Ya=z,h3e=It,Mv=Dn;Tb.toolPaletteModule=new Ya.FeatureModule((n,e,t,i)=>{(0,Ya.bindAsService)(n,Ya.TYPES.IUIExtension,Mv.ToolPalette),n(Ya.TYPES.IDiagramStartup).toService(Mv.ToolPalette),(0,Ya.configureActionHandler)({bind:n,isBound:t},h3e.EnableDefaultToolsAction.KIND,Mv.ToolPalette),(0,Ya.configureActionHandler)({bind:n,isBound:t},Ya.UpdateModelAction.KIND,Mv.ToolPalette),(0,Ya.configureActionHandler)({bind:n,isBound:t},Ya.SetModelAction.KIND,Mv.ToolPalette)},{featureId:Symbol("toolPalette")});var jb={},bu={},Pn={},Bb=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},j9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Pn,"__esModule",{value:!0});Pn.MoveFinishedEventAction=Pn.MoveInitializedEventAction=Pn.HideChangeBoundsToolResizeFeedbackCommand=Pn.ShowChangeBoundsToolResizeFeedbackCommand=Pn.HideChangeBoundsToolResizeFeedbackAction=Pn.ShowChangeBoundsToolResizeFeedbackAction=void 0;const nf=z,$b=F,dW=Gn,uW=Ao,lW=kt,yp=no,CK=Da;var n5;(function(n){n.KIND="showChangeBoundsToolResizeFeedback";function e(i){return nf.Action.hasKind(i,n.KIND)&&(0,nf.hasStringProp)(i,"elementId")}n.is=e;function t(i){const o=typeof i=="string"?{elementId:i}:i;return{kind:n.KIND,...o}}n.create=t})(n5||(Pn.ShowChangeBoundsToolResizeFeedbackAction=n5={}));var i5;(function(n){n.KIND="hideChangeBoundsToolResizeFeedback";function e(i){return nf.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(i5||(Pn.HideChangeBoundsToolResizeFeedbackAction=i5={}));let ym=class extends dW.FeedbackCommand{execute(e){var t,i;const o=e.root.index;if((0,lW.forEachElement)(o,yp.isResizable,r=>r.id!==this.action.elementId&&(0,yp.removeResizeHandles)(r)),this.action.elementId){const r=o.getById(this.action.elementId);r&&(0,yp.isResizable)(r)&&(0,yp.addResizeHandles)(r,(i=(t=this.action.resizeLocations)!==null&&t!==void 0?t:r.resizeLocations)!==null&&i!==void 0?i:this.changeBoundsManager.defaultResizeLocations())}return e.root}};Pn.ShowChangeBoundsToolResizeFeedbackCommand=ym;ym.KIND=n5.KIND;Bb([(0,$b.inject)(nf.TYPES.Action),j9("design:type",Object)],ym.prototype,"action",void 0);Bb([(0,$b.inject)(CK.ChangeBoundsManager),j9("design:type",CK.ChangeBoundsManager)],ym.prototype,"changeBoundsManager",void 0);Pn.ShowChangeBoundsToolResizeFeedbackCommand=ym=Bb([(0,$b.injectable)()],ym);let By=class extends dW.FeedbackCommand{execute(e){const t=e.root.index;return(0,lW.forEachElement)(t,yp.isResizable,yp.removeResizeHandles),e.root}};Pn.HideChangeBoundsToolResizeFeedbackCommand=By;By.KIND=i5.KIND;Bb([(0,$b.inject)(nf.TYPES.Action),j9("design:type",Object)],By.prototype,"action",void 0);Pn.HideChangeBoundsToolResizeFeedbackCommand=By=Bb([(0,$b.injectable)()],By);var PK;(function(n){n.KIND="move-initialized-event";function e(i){return nf.Action.hasKind(i,n.KIND)}n.is=e;function t(){return uW.OptionalAction.mark({kind:n.KIND})}n.create=t})(PK||(Pn.MoveInitializedEventAction=PK={}));var wK;(function(n){n.KIND="move-finished-event";function e(i){return nf.Action.hasKind(i,n.KIND)}n.is=e;function t(){return uW.OptionalAction.mark({kind:n.KIND})}n.create=t})(wK||(Pn.MoveFinishedEventAction=wK={}));var kb={},xP={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */xP.exports;(function(n,e){(function(){var t,i="4.17.21",o=200,r="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",a="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",h=500,g="__lodash_placeholder__",y=1,S=2,P=4,w=1,C=2,E=1,D=2,j=4,U=8,p=16,b=32,v=64,R=128,O=256,N=512,T=30,$="...",Q=800,K=16,Z=1,H=2,M=3,Y=1/0,te=9007199254740991,ue=17976931348623157e292,Re=NaN,ae=4294967295,ot=ae-1,Ft=ae>>>1,et=[["ary",R],["bind",E],["bindKey",D],["curry",U],["curryRight",p],["flip",N],["partial",b],["partialRight",v],["rearg",O]],ht="[object Arguments]",wt="[object Array]",Ot="[object AsyncFunction]",vt="[object Boolean]",At="[object Date]",yi="[object DOMException]",Wt="[object Error]",Ze="[object Function]",ii="[object GeneratorFunction]",he="[object Map]",Ne="[object Number]",en="[object Null]",xt="[object Object]",Rn="[object Promise]",gn="[object Proxy]",oi="[object RegExp]",_t="[object Set]",Zt="[object String]",bi="[object Symbol]",X="[object Undefined]",ne="[object WeakMap]",fe="[object WeakSet]",ge="[object ArrayBuffer]",Pe="[object DataView]",Qt="[object Float32Array]",Fe="[object Float64Array]",xe="[object Int8Array]",Te="[object Int16Array]",Qe="[object Int32Array]",Xe="[object Uint8Array]",io="[object Uint8ClampedArray]",Xc="[object Uint16Array]",K1="[object Uint32Array]",MM=/\b__p \+= '';/g,IM=/\b(__p \+=) '' \+/g,DM=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Kr=/&(?:amp|lt|gt|quot|#39);/g,vS=/[&<>"']/g,TM=RegExp(Kr.source),gh=RegExp(vS.source),OM=/<%-([\s\S]+?)%>/g,V1=/<%([\s\S]+?)%>/g,_S=/<%=([\s\S]+?)%>/g,Jc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Vu=/^\w*$/,LM=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,z1=/[\\^$.*+?()[\]{}|]/g,zu=RegExp(z1.source),vh=/^\s+/,yS=/\s/,G1=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,bS=/\{\n\/\* \[wrapped with (.+)\] \*/,ed=/,? & /,V=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,oe=/[()=,{}\[\]\/\s]/,pe=/\\(\\)?/g,Ce=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Lt=/\w*$/,Dt=/^[-+]0x[0-9a-f]+$/i,Nt=/^0b[01]+$/i,cn=/^\[object .+?Constructor\]$/,dt=/^0o[0-7]+$/i,Xt=/^(?:0|[1-9]\d*)$/,bt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tn=/($^)/,ri=/['\n\r\u2028\u2029\\]/g,Bi="\\ud800-\\udfff",NM="\\u0300-\\u036f",FQ="\\ufe20-\\ufe2f",xQ="\\u20d0-\\u20ff",w4=NM+FQ+xQ,A4="\\u2700-\\u27bf",R4="a-z\\xdf-\\xf6\\xf8-\\xff",HQ="\\xac\\xb1\\xd7\\xf7",KQ="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",VQ="\\u2000-\\u206f",zQ=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",M4="A-Z\\xc0-\\xd6\\xd8-\\xde",I4="\\ufe0e\\ufe0f",D4=HQ+KQ+VQ+zQ,jM="['’]",GQ="["+Bi+"]",T4="["+D4+"]",SS="["+w4+"]",O4="\\d+",UQ="["+A4+"]",L4="["+R4+"]",N4="[^"+Bi+D4+O4+A4+R4+M4+"]",BM="\\ud83c[\\udffb-\\udfff]",YQ="(?:"+SS+"|"+BM+")",j4="[^"+Bi+"]",$M="(?:\\ud83c[\\udde6-\\uddff]){2}",kM="[\\ud800-\\udbff][\\udc00-\\udfff]",_h="["+M4+"]",B4="\\u200d",$4="(?:"+L4+"|"+N4+")",qQ="(?:"+_h+"|"+N4+")",k4="(?:"+jM+"(?:d|ll|m|re|s|t|ve))?",F4="(?:"+jM+"(?:D|LL|M|RE|S|T|VE))?",x4=YQ+"?",H4="["+I4+"]?",WQ="(?:"+B4+"(?:"+[j4,$M,kM].join("|")+")"+H4+x4+")*",ZQ="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",QQ="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",K4=H4+x4+WQ,XQ="(?:"+[UQ,$M,kM].join("|")+")"+K4,JQ="(?:"+[j4+SS+"?",SS,$M,kM,GQ].join("|")+")",eX=RegExp(jM,"g"),tX=RegExp(SS,"g"),FM=RegExp(BM+"(?="+BM+")|"+JQ+K4,"g"),nX=RegExp([_h+"?"+L4+"+"+k4+"(?="+[T4,_h,"$"].join("|")+")",qQ+"+"+F4+"(?="+[T4,_h+$4,"$"].join("|")+")",_h+"?"+$4+"+"+k4,_h+"+"+F4,QQ,ZQ,O4,XQ].join("|"),"g"),iX=RegExp("["+B4+Bi+w4+I4+"]"),oX=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rX=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],sX=-1,Jt={};Jt[Qt]=Jt[Fe]=Jt[xe]=Jt[Te]=Jt[Qe]=Jt[Xe]=Jt[io]=Jt[Xc]=Jt[K1]=!0,Jt[ht]=Jt[wt]=Jt[ge]=Jt[vt]=Jt[Pe]=Jt[At]=Jt[Wt]=Jt[Ze]=Jt[he]=Jt[Ne]=Jt[xt]=Jt[oi]=Jt[_t]=Jt[Zt]=Jt[ne]=!1;var Vt={};Vt[ht]=Vt[wt]=Vt[ge]=Vt[Pe]=Vt[vt]=Vt[At]=Vt[Qt]=Vt[Fe]=Vt[xe]=Vt[Te]=Vt[Qe]=Vt[he]=Vt[Ne]=Vt[xt]=Vt[oi]=Vt[_t]=Vt[Zt]=Vt[bi]=Vt[Xe]=Vt[io]=Vt[Xc]=Vt[K1]=!0,Vt[Wt]=Vt[Ze]=Vt[ne]=!1;var aX={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},cX={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},dX={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},uX={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},lX=parseFloat,fX=parseInt,V4=typeof l=="object"&&l&&l.Object===Object&&l,hX=typeof self=="object"&&self&&self.Object===Object&&self,si=V4||hX||Function("return this")(),xM=e&&!e.nodeType&&e,Gu=xM&&!0&&n&&!n.nodeType&&n,z4=Gu&&Gu.exports===xM,HM=z4&&V4.process,ar=function(){try{var q=Gu&&Gu.require&&Gu.require("util").types;return q||HM&&HM.binding&&HM.binding("util")}catch{}}(),G4=ar&&ar.isArrayBuffer,U4=ar&&ar.isDate,Y4=ar&&ar.isMap,q4=ar&&ar.isRegExp,W4=ar&&ar.isSet,Z4=ar&&ar.isTypedArray;function To(q,ee,J){switch(J.length){case 0:return q.call(ee);case 1:return q.call(ee,J[0]);case 2:return q.call(ee,J[0],J[1]);case 3:return q.call(ee,J[0],J[1],J[2])}return q.apply(ee,J)}function pX(q,ee,J,Se){for(var He=-1,St=q==null?0:q.length;++He<St;){var xn=q[He];ee(Se,xn,J(xn),q)}return Se}function cr(q,ee){for(var J=-1,Se=q==null?0:q.length;++J<Se&&ee(q[J],J,q)!==!1;);return q}function mX(q,ee){for(var J=q==null?0:q.length;J--&&ee(q[J],J,q)!==!1;);return q}function Q4(q,ee){for(var J=-1,Se=q==null?0:q.length;++J<Se;)if(!ee(q[J],J,q))return!1;return!0}function td(q,ee){for(var J=-1,Se=q==null?0:q.length,He=0,St=[];++J<Se;){var xn=q[J];ee(xn,J,q)&&(St[He++]=xn)}return St}function ES(q,ee){var J=q==null?0:q.length;return!!J&&yh(q,ee,0)>-1}function KM(q,ee,J){for(var Se=-1,He=q==null?0:q.length;++Se<He;)if(J(ee,q[Se]))return!0;return!1}function nn(q,ee){for(var J=-1,Se=q==null?0:q.length,He=Array(Se);++J<Se;)He[J]=ee(q[J],J,q);return He}function nd(q,ee){for(var J=-1,Se=ee.length,He=q.length;++J<Se;)q[He+J]=ee[J];return q}function VM(q,ee,J,Se){var He=-1,St=q==null?0:q.length;for(Se&&St&&(J=q[++He]);++He<St;)J=ee(J,q[He],He,q);return J}function gX(q,ee,J,Se){var He=q==null?0:q.length;for(Se&&He&&(J=q[--He]);He--;)J=ee(J,q[He],He,q);return J}function zM(q,ee){for(var J=-1,Se=q==null?0:q.length;++J<Se;)if(ee(q[J],J,q))return!0;return!1}var vX=GM("length");function _X(q){return q.split("")}function yX(q){return q.match(V)||[]}function X4(q,ee,J){var Se;return J(q,function(He,St,xn){if(ee(He,St,xn))return Se=St,!1}),Se}function CS(q,ee,J,Se){for(var He=q.length,St=J+(Se?1:-1);Se?St--:++St<He;)if(ee(q[St],St,q))return St;return-1}function yh(q,ee,J){return ee===ee?TX(q,ee,J):CS(q,J4,J)}function bX(q,ee,J,Se){for(var He=J-1,St=q.length;++He<St;)if(Se(q[He],ee))return He;return-1}function J4(q){return q!==q}function eN(q,ee){var J=q==null?0:q.length;return J?YM(q,ee)/J:Re}function GM(q){return function(ee){return ee==null?t:ee[q]}}function UM(q){return function(ee){return q==null?t:q[ee]}}function tN(q,ee,J,Se,He){return He(q,function(St,xn,Ht){J=Se?(Se=!1,St):ee(J,St,xn,Ht)}),J}function SX(q,ee){var J=q.length;for(q.sort(ee);J--;)q[J]=q[J].value;return q}function YM(q,ee){for(var J,Se=-1,He=q.length;++Se<He;){var St=ee(q[Se]);St!==t&&(J=J===t?St:J+St)}return J}function qM(q,ee){for(var J=-1,Se=Array(q);++J<q;)Se[J]=ee(J);return Se}function EX(q,ee){return nn(ee,function(J){return[J,q[J]]})}function nN(q){return q&&q.slice(0,sN(q)+1).replace(vh,"")}function Oo(q){return function(ee){return q(ee)}}function WM(q,ee){return nn(ee,function(J){return q[J]})}function U1(q,ee){return q.has(ee)}function iN(q,ee){for(var J=-1,Se=q.length;++J<Se&&yh(ee,q[J],0)>-1;);return J}function oN(q,ee){for(var J=q.length;J--&&yh(ee,q[J],0)>-1;);return J}function CX(q,ee){for(var J=q.length,Se=0;J--;)q[J]===ee&&++Se;return Se}var PX=UM(aX),wX=UM(cX);function AX(q){return"\\"+uX[q]}function RX(q,ee){return q==null?t:q[ee]}function bh(q){return iX.test(q)}function MX(q){return oX.test(q)}function IX(q){for(var ee,J=[];!(ee=q.next()).done;)J.push(ee.value);return J}function ZM(q){var ee=-1,J=Array(q.size);return q.forEach(function(Se,He){J[++ee]=[He,Se]}),J}function rN(q,ee){return function(J){return q(ee(J))}}function id(q,ee){for(var J=-1,Se=q.length,He=0,St=[];++J<Se;){var xn=q[J];(xn===ee||xn===g)&&(q[J]=g,St[He++]=J)}return St}function PS(q){var ee=-1,J=Array(q.size);return q.forEach(function(Se){J[++ee]=Se}),J}function DX(q){var ee=-1,J=Array(q.size);return q.forEach(function(Se){J[++ee]=[Se,Se]}),J}function TX(q,ee,J){for(var Se=J-1,He=q.length;++Se<He;)if(q[Se]===ee)return Se;return-1}function OX(q,ee,J){for(var Se=J+1;Se--;)if(q[Se]===ee)return Se;return Se}function Sh(q){return bh(q)?NX(q):vX(q)}function Vr(q){return bh(q)?jX(q):_X(q)}function sN(q){for(var ee=q.length;ee--&&yS.test(q.charAt(ee)););return ee}var LX=UM(dX);function NX(q){for(var ee=FM.lastIndex=0;FM.test(q);)++ee;return ee}function jX(q){return q.match(FM)||[]}function BX(q){return q.match(nX)||[]}var $X=function q(ee){ee=ee==null?si:Eh.defaults(si.Object(),ee,Eh.pick(si,rX));var J=ee.Array,Se=ee.Date,He=ee.Error,St=ee.Function,xn=ee.Math,Ht=ee.Object,QM=ee.RegExp,kX=ee.String,dr=ee.TypeError,wS=J.prototype,FX=St.prototype,Ch=Ht.prototype,AS=ee["__core-js_shared__"],RS=FX.toString,Tt=Ch.hasOwnProperty,xX=0,aN=function(){var c=/[^.]+$/.exec(AS&&AS.keys&&AS.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),MS=Ch.toString,HX=RS.call(Ht),KX=si._,VX=QM("^"+RS.call(Tt).replace(z1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),IS=z4?ee.Buffer:t,od=ee.Symbol,DS=ee.Uint8Array,cN=IS?IS.allocUnsafe:t,TS=rN(Ht.getPrototypeOf,Ht),dN=Ht.create,uN=Ch.propertyIsEnumerable,OS=wS.splice,lN=od?od.isConcatSpreadable:t,Y1=od?od.iterator:t,Uu=od?od.toStringTag:t,LS=function(){try{var c=Qu(Ht,"defineProperty");return c({},"",{}),c}catch{}}(),zX=ee.clearTimeout!==si.clearTimeout&&ee.clearTimeout,GX=Se&&Se.now!==si.Date.now&&Se.now,UX=ee.setTimeout!==si.setTimeout&&ee.setTimeout,NS=xn.ceil,jS=xn.floor,XM=Ht.getOwnPropertySymbols,YX=IS?IS.isBuffer:t,fN=ee.isFinite,qX=wS.join,WX=rN(Ht.keys,Ht),Hn=xn.max,Si=xn.min,ZX=Se.now,QX=ee.parseInt,hN=xn.random,XX=wS.reverse,JM=Qu(ee,"DataView"),q1=Qu(ee,"Map"),eI=Qu(ee,"Promise"),Ph=Qu(ee,"Set"),W1=Qu(ee,"WeakMap"),Z1=Qu(Ht,"create"),BS=W1&&new W1,wh={},JX=Xu(JM),eJ=Xu(q1),tJ=Xu(eI),nJ=Xu(Ph),iJ=Xu(W1),$S=od?od.prototype:t,Q1=$S?$S.valueOf:t,pN=$S?$S.toString:t;function I(c){if(vn(c)&&!ze(c)&&!(c instanceof st)){if(c instanceof ur)return c;if(Tt.call(c,"__wrapped__"))return mj(c)}return new ur(c)}var Ah=function(){function c(){}return function(d){if(!dn(d))return{};if(dN)return dN(d);c.prototype=d;var u=new c;return c.prototype=t,u}}();function kS(){}function ur(c,d){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=t}I.templateSettings={escape:OM,evaluate:V1,interpolate:_S,variable:"",imports:{_:I}},I.prototype=kS.prototype,I.prototype.constructor=I,ur.prototype=Ah(kS.prototype),ur.prototype.constructor=ur;function st(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ae,this.__views__=[]}function oJ(){var c=new st(this.__wrapped__);return c.__actions__=oo(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=oo(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=oo(this.__views__),c}function rJ(){if(this.__filtered__){var c=new st(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function sJ(){var c=this.__wrapped__.value(),d=this.__dir__,u=ze(c),_=d<0,A=u?c.length:0,L=_ee(0,A,this.__views__),x=L.start,G=L.end,W=G-x,ie=_?G:x-1,re=this.__iteratees__,ce=re.length,ve=0,we=Si(W,this.__takeCount__);if(!u||!_&&A==W&&we==W)return kN(c,this.__actions__);var je=[];e:for(;W--&&ve<we;){ie+=d;for(var qe=-1,Be=c[ie];++qe<ce;){var rt=re[qe],ut=rt.iteratee,jo=rt.type,Fi=ut(Be);if(jo==H)Be=Fi;else if(!Fi){if(jo==Z)continue e;break e}}je[ve++]=Be}return je}st.prototype=Ah(kS.prototype),st.prototype.constructor=st;function Yu(c){var d=-1,u=c==null?0:c.length;for(this.clear();++d<u;){var _=c[d];this.set(_[0],_[1])}}function aJ(){this.__data__=Z1?Z1(null):{},this.size=0}function cJ(c){var d=this.has(c)&&delete this.__data__[c];return this.size-=d?1:0,d}function dJ(c){var d=this.__data__;if(Z1){var u=d[c];return u===f?t:u}return Tt.call(d,c)?d[c]:t}function uJ(c){var d=this.__data__;return Z1?d[c]!==t:Tt.call(d,c)}function lJ(c,d){var u=this.__data__;return this.size+=this.has(c)?0:1,u[c]=Z1&&d===t?f:d,this}Yu.prototype.clear=aJ,Yu.prototype.delete=cJ,Yu.prototype.get=dJ,Yu.prototype.has=uJ,Yu.prototype.set=lJ;function Na(c){var d=-1,u=c==null?0:c.length;for(this.clear();++d<u;){var _=c[d];this.set(_[0],_[1])}}function fJ(){this.__data__=[],this.size=0}function hJ(c){var d=this.__data__,u=FS(d,c);if(u<0)return!1;var _=d.length-1;return u==_?d.pop():OS.call(d,u,1),--this.size,!0}function pJ(c){var d=this.__data__,u=FS(d,c);return u<0?t:d[u][1]}function mJ(c){return FS(this.__data__,c)>-1}function gJ(c,d){var u=this.__data__,_=FS(u,c);return _<0?(++this.size,u.push([c,d])):u[_][1]=d,this}Na.prototype.clear=fJ,Na.prototype.delete=hJ,Na.prototype.get=pJ,Na.prototype.has=mJ,Na.prototype.set=gJ;function ja(c){var d=-1,u=c==null?0:c.length;for(this.clear();++d<u;){var _=c[d];this.set(_[0],_[1])}}function vJ(){this.size=0,this.__data__={hash:new Yu,map:new(q1||Na),string:new Yu}}function _J(c){var d=QS(this,c).delete(c);return this.size-=d?1:0,d}function yJ(c){return QS(this,c).get(c)}function bJ(c){return QS(this,c).has(c)}function SJ(c,d){var u=QS(this,c),_=u.size;return u.set(c,d),this.size+=u.size==_?0:1,this}ja.prototype.clear=vJ,ja.prototype.delete=_J,ja.prototype.get=yJ,ja.prototype.has=bJ,ja.prototype.set=SJ;function qu(c){var d=-1,u=c==null?0:c.length;for(this.__data__=new ja;++d<u;)this.add(c[d])}function EJ(c){return this.__data__.set(c,f),this}function CJ(c){return this.__data__.has(c)}qu.prototype.add=qu.prototype.push=EJ,qu.prototype.has=CJ;function zr(c){var d=this.__data__=new Na(c);this.size=d.size}function PJ(){this.__data__=new Na,this.size=0}function wJ(c){var d=this.__data__,u=d.delete(c);return this.size=d.size,u}function AJ(c){return this.__data__.get(c)}function RJ(c){return this.__data__.has(c)}function MJ(c,d){var u=this.__data__;if(u instanceof Na){var _=u.__data__;if(!q1||_.length<o-1)return _.push([c,d]),this.size=++u.size,this;u=this.__data__=new ja(_)}return u.set(c,d),this.size=u.size,this}zr.prototype.clear=PJ,zr.prototype.delete=wJ,zr.prototype.get=AJ,zr.prototype.has=RJ,zr.prototype.set=MJ;function mN(c,d){var u=ze(c),_=!u&&Ju(c),A=!u&&!_&&dd(c),L=!u&&!_&&!A&&Dh(c),x=u||_||A||L,G=x?qM(c.length,kX):[],W=G.length;for(var ie in c)(d||Tt.call(c,ie))&&!(x&&(ie=="length"||A&&(ie=="offset"||ie=="parent")||L&&(ie=="buffer"||ie=="byteLength"||ie=="byteOffset")||Fa(ie,W)))&&G.push(ie);return G}function gN(c){var d=c.length;return d?c[lI(0,d-1)]:t}function IJ(c,d){return XS(oo(c),Wu(d,0,c.length))}function DJ(c){return XS(oo(c))}function tI(c,d,u){(u!==t&&!Gr(c[d],u)||u===t&&!(d in c))&&Ba(c,d,u)}function X1(c,d,u){var _=c[d];(!(Tt.call(c,d)&&Gr(_,u))||u===t&&!(d in c))&&Ba(c,d,u)}function FS(c,d){for(var u=c.length;u--;)if(Gr(c[u][0],d))return u;return-1}function TJ(c,d,u,_){return rd(c,function(A,L,x){d(_,A,u(A),x)}),_}function vN(c,d){return c&&Ls(d,Un(d),c)}function OJ(c,d){return c&&Ls(d,so(d),c)}function Ba(c,d,u){d=="__proto__"&&LS?LS(c,d,{configurable:!0,enumerable:!0,value:u,writable:!0}):c[d]=u}function nI(c,d){for(var u=-1,_=d.length,A=J(_),L=c==null;++u<_;)A[u]=L?t:BI(c,d[u]);return A}function Wu(c,d,u){return c===c&&(u!==t&&(c=c<=u?c:u),d!==t&&(c=c>=d?c:d)),c}function lr(c,d,u,_,A,L){var x,G=d&y,W=d&S,ie=d&P;if(u&&(x=A?u(c,_,A,L):u(c)),x!==t)return x;if(!dn(c))return c;var re=ze(c);if(re){if(x=bee(c),!G)return oo(c,x)}else{var ce=Ei(c),ve=ce==Ze||ce==ii;if(dd(c))return HN(c,G);if(ce==xt||ce==ht||ve&&!A){if(x=W||ve?{}:sj(c),!G)return W?dee(c,OJ(x,c)):cee(c,vN(x,c))}else{if(!Vt[ce])return A?c:{};x=See(c,ce,G)}}L||(L=new zr);var we=L.get(c);if(we)return we;L.set(c,x),jj(c)?c.forEach(function(Be){x.add(lr(Be,d,u,Be,c,L))}):Lj(c)&&c.forEach(function(Be,rt){x.set(rt,lr(Be,d,u,rt,c,L))});var je=ie?W?EI:SI:W?so:Un,qe=re?t:je(c);return cr(qe||c,function(Be,rt){qe&&(rt=Be,Be=c[rt]),X1(x,rt,lr(Be,d,u,rt,c,L))}),x}function LJ(c){var d=Un(c);return function(u){return _N(u,c,d)}}function _N(c,d,u){var _=u.length;if(c==null)return!_;for(c=Ht(c);_--;){var A=u[_],L=d[A],x=c[A];if(x===t&&!(A in c)||!L(x))return!1}return!0}function yN(c,d,u){if(typeof c!="function")throw new dr(s);return rv(function(){c.apply(t,u)},d)}function J1(c,d,u,_){var A=-1,L=ES,x=!0,G=c.length,W=[],ie=d.length;if(!G)return W;u&&(d=nn(d,Oo(u))),_?(L=KM,x=!1):d.length>=o&&(L=U1,x=!1,d=new qu(d));e:for(;++A<G;){var re=c[A],ce=u==null?re:u(re);if(re=_||re!==0?re:0,x&&ce===ce){for(var ve=ie;ve--;)if(d[ve]===ce)continue e;W.push(re)}else L(d,ce,_)||W.push(re)}return W}var rd=UN(Os),bN=UN(oI,!0);function NJ(c,d){var u=!0;return rd(c,function(_,A,L){return u=!!d(_,A,L),u}),u}function xS(c,d,u){for(var _=-1,A=c.length;++_<A;){var L=c[_],x=d(L);if(x!=null&&(G===t?x===x&&!No(x):u(x,G)))var G=x,W=L}return W}function jJ(c,d,u,_){var A=c.length;for(u=Ye(u),u<0&&(u=-u>A?0:A+u),_=_===t||_>A?A:Ye(_),_<0&&(_+=A),_=u>_?0:$j(_);u<_;)c[u++]=d;return c}function SN(c,d){var u=[];return rd(c,function(_,A,L){d(_,A,L)&&u.push(_)}),u}function ai(c,d,u,_,A){var L=-1,x=c.length;for(u||(u=Cee),A||(A=[]);++L<x;){var G=c[L];d>0&&u(G)?d>1?ai(G,d-1,u,_,A):nd(A,G):_||(A[A.length]=G)}return A}var iI=YN(),EN=YN(!0);function Os(c,d){return c&&iI(c,d,Un)}function oI(c,d){return c&&EN(c,d,Un)}function HS(c,d){return td(d,function(u){return xa(c[u])})}function Zu(c,d){d=ad(d,c);for(var u=0,_=d.length;c!=null&&u<_;)c=c[Ns(d[u++])];return u&&u==_?c:t}function CN(c,d,u){var _=d(c);return ze(c)?_:nd(_,u(c))}function $i(c){return c==null?c===t?X:en:Uu&&Uu in Ht(c)?vee(c):Dee(c)}function rI(c,d){return c>d}function BJ(c,d){return c!=null&&Tt.call(c,d)}function $J(c,d){return c!=null&&d in Ht(c)}function kJ(c,d,u){return c>=Si(d,u)&&c<Hn(d,u)}function sI(c,d,u){for(var _=u?KM:ES,A=c[0].length,L=c.length,x=L,G=J(L),W=1/0,ie=[];x--;){var re=c[x];x&&d&&(re=nn(re,Oo(d))),W=Si(re.length,W),G[x]=!u&&(d||A>=120&&re.length>=120)?new qu(x&&re):t}re=c[0];var ce=-1,ve=G[0];e:for(;++ce<A&&ie.length<W;){var we=re[ce],je=d?d(we):we;if(we=u||we!==0?we:0,!(ve?U1(ve,je):_(ie,je,u))){for(x=L;--x;){var qe=G[x];if(!(qe?U1(qe,je):_(c[x],je,u)))continue e}ve&&ve.push(je),ie.push(we)}}return ie}function FJ(c,d,u,_){return Os(c,function(A,L,x){d(_,u(A),L,x)}),_}function ev(c,d,u){d=ad(d,c),c=uj(c,d);var _=c==null?c:c[Ns(hr(d))];return _==null?t:To(_,c,u)}function PN(c){return vn(c)&&$i(c)==ht}function xJ(c){return vn(c)&&$i(c)==ge}function HJ(c){return vn(c)&&$i(c)==At}function tv(c,d,u,_,A){return c===d?!0:c==null||d==null||!vn(c)&&!vn(d)?c!==c&&d!==d:KJ(c,d,u,_,tv,A)}function KJ(c,d,u,_,A,L){var x=ze(c),G=ze(d),W=x?wt:Ei(c),ie=G?wt:Ei(d);W=W==ht?xt:W,ie=ie==ht?xt:ie;var re=W==xt,ce=ie==xt,ve=W==ie;if(ve&&dd(c)){if(!dd(d))return!1;x=!0,re=!1}if(ve&&!re)return L||(L=new zr),x||Dh(c)?ij(c,d,u,_,A,L):mee(c,d,W,u,_,A,L);if(!(u&w)){var we=re&&Tt.call(c,"__wrapped__"),je=ce&&Tt.call(d,"__wrapped__");if(we||je){var qe=we?c.value():c,Be=je?d.value():d;return L||(L=new zr),A(qe,Be,u,_,L)}}return ve?(L||(L=new zr),gee(c,d,u,_,A,L)):!1}function VJ(c){return vn(c)&&Ei(c)==he}function aI(c,d,u,_){var A=u.length,L=A,x=!_;if(c==null)return!L;for(c=Ht(c);A--;){var G=u[A];if(x&&G[2]?G[1]!==c[G[0]]:!(G[0]in c))return!1}for(;++A<L;){G=u[A];var W=G[0],ie=c[W],re=G[1];if(x&&G[2]){if(ie===t&&!(W in c))return!1}else{var ce=new zr;if(_)var ve=_(ie,re,W,c,d,ce);if(!(ve===t?tv(re,ie,w|C,_,ce):ve))return!1}}return!0}function wN(c){if(!dn(c)||wee(c))return!1;var d=xa(c)?VX:cn;return d.test(Xu(c))}function zJ(c){return vn(c)&&$i(c)==oi}function GJ(c){return vn(c)&&Ei(c)==_t}function UJ(c){return vn(c)&&oE(c.length)&&!!Jt[$i(c)]}function AN(c){return typeof c=="function"?c:c==null?ao:typeof c=="object"?ze(c)?IN(c[0],c[1]):MN(c):qj(c)}function cI(c){if(!ov(c))return WX(c);var d=[];for(var u in Ht(c))Tt.call(c,u)&&u!="constructor"&&d.push(u);return d}function YJ(c){if(!dn(c))return Iee(c);var d=ov(c),u=[];for(var _ in c)_=="constructor"&&(d||!Tt.call(c,_))||u.push(_);return u}function dI(c,d){return c<d}function RN(c,d){var u=-1,_=ro(c)?J(c.length):[];return rd(c,function(A,L,x){_[++u]=d(A,L,x)}),_}function MN(c){var d=PI(c);return d.length==1&&d[0][2]?cj(d[0][0],d[0][1]):function(u){return u===c||aI(u,c,d)}}function IN(c,d){return AI(c)&&aj(d)?cj(Ns(c),d):function(u){var _=BI(u,c);return _===t&&_===d?$I(u,c):tv(d,_,w|C)}}function KS(c,d,u,_,A){c!==d&&iI(d,function(L,x){if(A||(A=new zr),dn(L))qJ(c,d,x,u,KS,_,A);else{var G=_?_(MI(c,x),L,x+"",c,d,A):t;G===t&&(G=L),tI(c,x,G)}},so)}function qJ(c,d,u,_,A,L,x){var G=MI(c,u),W=MI(d,u),ie=x.get(W);if(ie){tI(c,u,ie);return}var re=L?L(G,W,u+"",c,d,x):t,ce=re===t;if(ce){var ve=ze(W),we=!ve&&dd(W),je=!ve&&!we&&Dh(W);re=W,ve||we||je?ze(G)?re=G:Mn(G)?re=oo(G):we?(ce=!1,re=HN(W,!0)):je?(ce=!1,re=KN(W,!0)):re=[]:sv(W)||Ju(W)?(re=G,Ju(G)?re=kj(G):(!dn(G)||xa(G))&&(re=sj(W))):ce=!1}ce&&(x.set(W,re),A(re,W,_,L,x),x.delete(W)),tI(c,u,re)}function DN(c,d){var u=c.length;if(u)return d+=d<0?u:0,Fa(d,u)?c[d]:t}function TN(c,d,u){d.length?d=nn(d,function(L){return ze(L)?function(x){return Zu(x,L.length===1?L[0]:L)}:L}):d=[ao];var _=-1;d=nn(d,Oo(Le()));var A=RN(c,function(L,x,G){var W=nn(d,function(ie){return ie(L)});return{criteria:W,index:++_,value:L}});return SX(A,function(L,x){return aee(L,x,u)})}function WJ(c,d){return ON(c,d,function(u,_){return $I(c,_)})}function ON(c,d,u){for(var _=-1,A=d.length,L={};++_<A;){var x=d[_],G=Zu(c,x);u(G,x)&&nv(L,ad(x,c),G)}return L}function ZJ(c){return function(d){return Zu(d,c)}}function uI(c,d,u,_){var A=_?bX:yh,L=-1,x=d.length,G=c;for(c===d&&(d=oo(d)),u&&(G=nn(c,Oo(u)));++L<x;)for(var W=0,ie=d[L],re=u?u(ie):ie;(W=A(G,re,W,_))>-1;)G!==c&&OS.call(G,W,1),OS.call(c,W,1);return c}function LN(c,d){for(var u=c?d.length:0,_=u-1;u--;){var A=d[u];if(u==_||A!==L){var L=A;Fa(A)?OS.call(c,A,1):pI(c,A)}}return c}function lI(c,d){return c+jS(hN()*(d-c+1))}function QJ(c,d,u,_){for(var A=-1,L=Hn(NS((d-c)/(u||1)),0),x=J(L);L--;)x[_?L:++A]=c,c+=u;return x}function fI(c,d){var u="";if(!c||d<1||d>te)return u;do d%2&&(u+=c),d=jS(d/2),d&&(c+=c);while(d);return u}function Je(c,d){return II(dj(c,d,ao),c+"")}function XJ(c){return gN(Th(c))}function JJ(c,d){var u=Th(c);return XS(u,Wu(d,0,u.length))}function nv(c,d,u,_){if(!dn(c))return c;d=ad(d,c);for(var A=-1,L=d.length,x=L-1,G=c;G!=null&&++A<L;){var W=Ns(d[A]),ie=u;if(W==="__proto__"||W==="constructor"||W==="prototype")return c;if(A!=x){var re=G[W];ie=_?_(re,W,G):t,ie===t&&(ie=dn(re)?re:Fa(d[A+1])?[]:{})}X1(G,W,ie),G=G[W]}return c}var NN=BS?function(c,d){return BS.set(c,d),c}:ao,eee=LS?function(c,d){return LS(c,"toString",{configurable:!0,enumerable:!1,value:FI(d),writable:!0})}:ao;function tee(c){return XS(Th(c))}function fr(c,d,u){var _=-1,A=c.length;d<0&&(d=-d>A?0:A+d),u=u>A?A:u,u<0&&(u+=A),A=d>u?0:u-d>>>0,d>>>=0;for(var L=J(A);++_<A;)L[_]=c[_+d];return L}function nee(c,d){var u;return rd(c,function(_,A,L){return u=d(_,A,L),!u}),!!u}function VS(c,d,u){var _=0,A=c==null?_:c.length;if(typeof d=="number"&&d===d&&A<=Ft){for(;_<A;){var L=_+A>>>1,x=c[L];x!==null&&!No(x)&&(u?x<=d:x<d)?_=L+1:A=L}return A}return hI(c,d,ao,u)}function hI(c,d,u,_){var A=0,L=c==null?0:c.length;if(L===0)return 0;d=u(d);for(var x=d!==d,G=d===null,W=No(d),ie=d===t;A<L;){var re=jS((A+L)/2),ce=u(c[re]),ve=ce!==t,we=ce===null,je=ce===ce,qe=No(ce);if(x)var Be=_||je;else ie?Be=je&&(_||ve):G?Be=je&&ve&&(_||!we):W?Be=je&&ve&&!we&&(_||!qe):we||qe?Be=!1:Be=_?ce<=d:ce<d;Be?A=re+1:L=re}return Si(L,ot)}function jN(c,d){for(var u=-1,_=c.length,A=0,L=[];++u<_;){var x=c[u],G=d?d(x):x;if(!u||!Gr(G,W)){var W=G;L[A++]=x===0?0:x}}return L}function BN(c){return typeof c=="number"?c:No(c)?Re:+c}function Lo(c){if(typeof c=="string")return c;if(ze(c))return nn(c,Lo)+"";if(No(c))return pN?pN.call(c):"";var d=c+"";return d=="0"&&1/c==-Y?"-0":d}function sd(c,d,u){var _=-1,A=ES,L=c.length,x=!0,G=[],W=G;if(u)x=!1,A=KM;else if(L>=o){var ie=d?null:hee(c);if(ie)return PS(ie);x=!1,A=U1,W=new qu}else W=d?[]:G;e:for(;++_<L;){var re=c[_],ce=d?d(re):re;if(re=u||re!==0?re:0,x&&ce===ce){for(var ve=W.length;ve--;)if(W[ve]===ce)continue e;d&&W.push(ce),G.push(re)}else A(W,ce,u)||(W!==G&&W.push(ce),G.push(re))}return G}function pI(c,d){return d=ad(d,c),c=uj(c,d),c==null||delete c[Ns(hr(d))]}function $N(c,d,u,_){return nv(c,d,u(Zu(c,d)),_)}function zS(c,d,u,_){for(var A=c.length,L=_?A:-1;(_?L--:++L<A)&&d(c[L],L,c););return u?fr(c,_?0:L,_?L+1:A):fr(c,_?L+1:0,_?A:L)}function kN(c,d){var u=c;return u instanceof st&&(u=u.value()),VM(d,function(_,A){return A.func.apply(A.thisArg,nd([_],A.args))},u)}function mI(c,d,u){var _=c.length;if(_<2)return _?sd(c[0]):[];for(var A=-1,L=J(_);++A<_;)for(var x=c[A],G=-1;++G<_;)G!=A&&(L[A]=J1(L[A]||x,c[G],d,u));return sd(ai(L,1),d,u)}function FN(c,d,u){for(var _=-1,A=c.length,L=d.length,x={};++_<A;){var G=_<L?d[_]:t;u(x,c[_],G)}return x}function gI(c){return Mn(c)?c:[]}function vI(c){return typeof c=="function"?c:ao}function ad(c,d){return ze(c)?c:AI(c,d)?[c]:pj(Rt(c))}var iee=Je;function cd(c,d,u){var _=c.length;return u=u===t?_:u,!d&&u>=_?c:fr(c,d,u)}var xN=zX||function(c){return si.clearTimeout(c)};function HN(c,d){if(d)return c.slice();var u=c.length,_=cN?cN(u):new c.constructor(u);return c.copy(_),_}function _I(c){var d=new c.constructor(c.byteLength);return new DS(d).set(new DS(c)),d}function oee(c,d){var u=d?_I(c.buffer):c.buffer;return new c.constructor(u,c.byteOffset,c.byteLength)}function ree(c){var d=new c.constructor(c.source,Lt.exec(c));return d.lastIndex=c.lastIndex,d}function see(c){return Q1?Ht(Q1.call(c)):{}}function KN(c,d){var u=d?_I(c.buffer):c.buffer;return new c.constructor(u,c.byteOffset,c.length)}function VN(c,d){if(c!==d){var u=c!==t,_=c===null,A=c===c,L=No(c),x=d!==t,G=d===null,W=d===d,ie=No(d);if(!G&&!ie&&!L&&c>d||L&&x&&W&&!G&&!ie||_&&x&&W||!u&&W||!A)return 1;if(!_&&!L&&!ie&&c<d||ie&&u&&A&&!_&&!L||G&&u&&A||!x&&A||!W)return-1}return 0}function aee(c,d,u){for(var _=-1,A=c.criteria,L=d.criteria,x=A.length,G=u.length;++_<x;){var W=VN(A[_],L[_]);if(W){if(_>=G)return W;var ie=u[_];return W*(ie=="desc"?-1:1)}}return c.index-d.index}function zN(c,d,u,_){for(var A=-1,L=c.length,x=u.length,G=-1,W=d.length,ie=Hn(L-x,0),re=J(W+ie),ce=!_;++G<W;)re[G]=d[G];for(;++A<x;)(ce||A<L)&&(re[u[A]]=c[A]);for(;ie--;)re[G++]=c[A++];return re}function GN(c,d,u,_){for(var A=-1,L=c.length,x=-1,G=u.length,W=-1,ie=d.length,re=Hn(L-G,0),ce=J(re+ie),ve=!_;++A<re;)ce[A]=c[A];for(var we=A;++W<ie;)ce[we+W]=d[W];for(;++x<G;)(ve||A<L)&&(ce[we+u[x]]=c[A++]);return ce}function oo(c,d){var u=-1,_=c.length;for(d||(d=J(_));++u<_;)d[u]=c[u];return d}function Ls(c,d,u,_){var A=!u;u||(u={});for(var L=-1,x=d.length;++L<x;){var G=d[L],W=_?_(u[G],c[G],G,u,c):t;W===t&&(W=c[G]),A?Ba(u,G,W):X1(u,G,W)}return u}function cee(c,d){return Ls(c,wI(c),d)}function dee(c,d){return Ls(c,oj(c),d)}function GS(c,d){return function(u,_){var A=ze(u)?pX:TJ,L=d?d():{};return A(u,c,Le(_,2),L)}}function Rh(c){return Je(function(d,u){var _=-1,A=u.length,L=A>1?u[A-1]:t,x=A>2?u[2]:t;for(L=c.length>3&&typeof L=="function"?(A--,L):t,x&&ki(u[0],u[1],x)&&(L=A<3?t:L,A=1),d=Ht(d);++_<A;){var G=u[_];G&&c(d,G,_,L)}return d})}function UN(c,d){return function(u,_){if(u==null)return u;if(!ro(u))return c(u,_);for(var A=u.length,L=d?A:-1,x=Ht(u);(d?L--:++L<A)&&_(x[L],L,x)!==!1;);return u}}function YN(c){return function(d,u,_){for(var A=-1,L=Ht(d),x=_(d),G=x.length;G--;){var W=x[c?G:++A];if(u(L[W],W,L)===!1)break}return d}}function uee(c,d,u){var _=d&E,A=iv(c);function L(){var x=this&&this!==si&&this instanceof L?A:c;return x.apply(_?u:this,arguments)}return L}function qN(c){return function(d){d=Rt(d);var u=bh(d)?Vr(d):t,_=u?u[0]:d.charAt(0),A=u?cd(u,1).join(""):d.slice(1);return _[c]()+A}}function Mh(c){return function(d){return VM(Uj(Gj(d).replace(eX,"")),c,"")}}function iv(c){return function(){var d=arguments;switch(d.length){case 0:return new c;case 1:return new c(d[0]);case 2:return new c(d[0],d[1]);case 3:return new c(d[0],d[1],d[2]);case 4:return new c(d[0],d[1],d[2],d[3]);case 5:return new c(d[0],d[1],d[2],d[3],d[4]);case 6:return new c(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new c(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var u=Ah(c.prototype),_=c.apply(u,d);return dn(_)?_:u}}function lee(c,d,u){var _=iv(c);function A(){for(var L=arguments.length,x=J(L),G=L,W=Ih(A);G--;)x[G]=arguments[G];var ie=L<3&&x[0]!==W&&x[L-1]!==W?[]:id(x,W);if(L-=ie.length,L<u)return JN(c,d,US,A.placeholder,t,x,ie,t,t,u-L);var re=this&&this!==si&&this instanceof A?_:c;return To(re,this,x)}return A}function WN(c){return function(d,u,_){var A=Ht(d);if(!ro(d)){var L=Le(u,3);d=Un(d),u=function(G){return L(A[G],G,A)}}var x=c(d,u,_);return x>-1?A[L?d[x]:x]:t}}function ZN(c){return ka(function(d){var u=d.length,_=u,A=ur.prototype.thru;for(c&&d.reverse();_--;){var L=d[_];if(typeof L!="function")throw new dr(s);if(A&&!x&&ZS(L)=="wrapper")var x=new ur([],!0)}for(_=x?_:u;++_<u;){L=d[_];var G=ZS(L),W=G=="wrapper"?CI(L):t;W&&RI(W[0])&&W[1]==(R|U|b|O)&&!W[4].length&&W[9]==1?x=x[ZS(W[0])].apply(x,W[3]):x=L.length==1&&RI(L)?x[G]():x.thru(L)}return function(){var ie=arguments,re=ie[0];if(x&&ie.length==1&&ze(re))return x.plant(re).value();for(var ce=0,ve=u?d[ce].apply(this,ie):re;++ce<u;)ve=d[ce].call(this,ve);return ve}})}function US(c,d,u,_,A,L,x,G,W,ie){var re=d&R,ce=d&E,ve=d&D,we=d&(U|p),je=d&N,qe=ve?t:iv(c);function Be(){for(var rt=arguments.length,ut=J(rt),jo=rt;jo--;)ut[jo]=arguments[jo];if(we)var Fi=Ih(Be),Bo=CX(ut,Fi);if(_&&(ut=zN(ut,_,A,we)),L&&(ut=GN(ut,L,x,we)),rt-=Bo,we&&rt<ie){var In=id(ut,Fi);return JN(c,d,US,Be.placeholder,u,ut,In,G,W,ie-rt)}var Ur=ce?u:this,Ka=ve?Ur[c]:c;return rt=ut.length,G?ut=Tee(ut,G):je&&rt>1&&ut.reverse(),re&&W<rt&&(ut.length=W),this&&this!==si&&this instanceof Be&&(Ka=qe||iv(Ka)),Ka.apply(Ur,ut)}return Be}function QN(c,d){return function(u,_){return FJ(u,c,d(_),{})}}function YS(c,d){return function(u,_){var A;if(u===t&&_===t)return d;if(u!==t&&(A=u),_!==t){if(A===t)return _;typeof u=="string"||typeof _=="string"?(u=Lo(u),_=Lo(_)):(u=BN(u),_=BN(_)),A=c(u,_)}return A}}function yI(c){return ka(function(d){return d=nn(d,Oo(Le())),Je(function(u){var _=this;return c(d,function(A){return To(A,_,u)})})})}function qS(c,d){d=d===t?" ":Lo(d);var u=d.length;if(u<2)return u?fI(d,c):d;var _=fI(d,NS(c/Sh(d)));return bh(d)?cd(Vr(_),0,c).join(""):_.slice(0,c)}function fee(c,d,u,_){var A=d&E,L=iv(c);function x(){for(var G=-1,W=arguments.length,ie=-1,re=_.length,ce=J(re+W),ve=this&&this!==si&&this instanceof x?L:c;++ie<re;)ce[ie]=_[ie];for(;W--;)ce[ie++]=arguments[++G];return To(ve,A?u:this,ce)}return x}function XN(c){return function(d,u,_){return _&&typeof _!="number"&&ki(d,u,_)&&(u=_=t),d=Ha(d),u===t?(u=d,d=0):u=Ha(u),_=_===t?d<u?1:-1:Ha(_),QJ(d,u,_,c)}}function WS(c){return function(d,u){return typeof d=="string"&&typeof u=="string"||(d=pr(d),u=pr(u)),c(d,u)}}function JN(c,d,u,_,A,L,x,G,W,ie){var re=d&U,ce=re?x:t,ve=re?t:x,we=re?L:t,je=re?t:L;d|=re?b:v,d&=~(re?v:b),d&j||(d&=~(E|D));var qe=[c,d,A,we,ce,je,ve,G,W,ie],Be=u.apply(t,qe);return RI(c)&&lj(Be,qe),Be.placeholder=_,fj(Be,c,d)}function bI(c){var d=xn[c];return function(u,_){if(u=pr(u),_=_==null?0:Si(Ye(_),292),_&&fN(u)){var A=(Rt(u)+"e").split("e"),L=d(A[0]+"e"+(+A[1]+_));return A=(Rt(L)+"e").split("e"),+(A[0]+"e"+(+A[1]-_))}return d(u)}}var hee=Ph&&1/PS(new Ph([,-0]))[1]==Y?function(c){return new Ph(c)}:KI;function ej(c){return function(d){var u=Ei(d);return u==he?ZM(d):u==_t?DX(d):EX(d,c(d))}}function $a(c,d,u,_,A,L,x,G){var W=d&D;if(!W&&typeof c!="function")throw new dr(s);var ie=_?_.length:0;if(ie||(d&=~(b|v),_=A=t),x=x===t?x:Hn(Ye(x),0),G=G===t?G:Ye(G),ie-=A?A.length:0,d&v){var re=_,ce=A;_=A=t}var ve=W?t:CI(c),we=[c,d,u,_,A,re,ce,L,x,G];if(ve&&Mee(we,ve),c=we[0],d=we[1],u=we[2],_=we[3],A=we[4],G=we[9]=we[9]===t?W?0:c.length:Hn(we[9]-ie,0),!G&&d&(U|p)&&(d&=~(U|p)),!d||d==E)var je=uee(c,d,u);else d==U||d==p?je=lee(c,d,G):(d==b||d==(E|b))&&!A.length?je=fee(c,d,u,_):je=US.apply(t,we);var qe=ve?NN:lj;return fj(qe(je,we),c,d)}function tj(c,d,u,_){return c===t||Gr(c,Ch[u])&&!Tt.call(_,u)?d:c}function nj(c,d,u,_,A,L){return dn(c)&&dn(d)&&(L.set(d,c),KS(c,d,t,nj,L),L.delete(d)),c}function pee(c){return sv(c)?t:c}function ij(c,d,u,_,A,L){var x=u&w,G=c.length,W=d.length;if(G!=W&&!(x&&W>G))return!1;var ie=L.get(c),re=L.get(d);if(ie&&re)return ie==d&&re==c;var ce=-1,ve=!0,we=u&C?new qu:t;for(L.set(c,d),L.set(d,c);++ce<G;){var je=c[ce],qe=d[ce];if(_)var Be=x?_(qe,je,ce,d,c,L):_(je,qe,ce,c,d,L);if(Be!==t){if(Be)continue;ve=!1;break}if(we){if(!zM(d,function(rt,ut){if(!U1(we,ut)&&(je===rt||A(je,rt,u,_,L)))return we.push(ut)})){ve=!1;break}}else if(!(je===qe||A(je,qe,u,_,L))){ve=!1;break}}return L.delete(c),L.delete(d),ve}function mee(c,d,u,_,A,L,x){switch(u){case Pe:if(c.byteLength!=d.byteLength||c.byteOffset!=d.byteOffset)return!1;c=c.buffer,d=d.buffer;case ge:return!(c.byteLength!=d.byteLength||!L(new DS(c),new DS(d)));case vt:case At:case Ne:return Gr(+c,+d);case Wt:return c.name==d.name&&c.message==d.message;case oi:case Zt:return c==d+"";case he:var G=ZM;case _t:var W=_&w;if(G||(G=PS),c.size!=d.size&&!W)return!1;var ie=x.get(c);if(ie)return ie==d;_|=C,x.set(c,d);var re=ij(G(c),G(d),_,A,L,x);return x.delete(c),re;case bi:if(Q1)return Q1.call(c)==Q1.call(d)}return!1}function gee(c,d,u,_,A,L){var x=u&w,G=SI(c),W=G.length,ie=SI(d),re=ie.length;if(W!=re&&!x)return!1;for(var ce=W;ce--;){var ve=G[ce];if(!(x?ve in d:Tt.call(d,ve)))return!1}var we=L.get(c),je=L.get(d);if(we&&je)return we==d&&je==c;var qe=!0;L.set(c,d),L.set(d,c);for(var Be=x;++ce<W;){ve=G[ce];var rt=c[ve],ut=d[ve];if(_)var jo=x?_(ut,rt,ve,d,c,L):_(rt,ut,ve,c,d,L);if(!(jo===t?rt===ut||A(rt,ut,u,_,L):jo)){qe=!1;break}Be||(Be=ve=="constructor")}if(qe&&!Be){var Fi=c.constructor,Bo=d.constructor;Fi!=Bo&&"constructor"in c&&"constructor"in d&&!(typeof Fi=="function"&&Fi instanceof Fi&&typeof Bo=="function"&&Bo instanceof Bo)&&(qe=!1)}return L.delete(c),L.delete(d),qe}function ka(c){return II(dj(c,t,_j),c+"")}function SI(c){return CN(c,Un,wI)}function EI(c){return CN(c,so,oj)}var CI=BS?function(c){return BS.get(c)}:KI;function ZS(c){for(var d=c.name+"",u=wh[d],_=Tt.call(wh,d)?u.length:0;_--;){var A=u[_],L=A.func;if(L==null||L==c)return A.name}return d}function Ih(c){var d=Tt.call(I,"placeholder")?I:c;return d.placeholder}function Le(){var c=I.iteratee||xI;return c=c===xI?AN:c,arguments.length?c(arguments[0],arguments[1]):c}function QS(c,d){var u=c.__data__;return Pee(d)?u[typeof d=="string"?"string":"hash"]:u.map}function PI(c){for(var d=Un(c),u=d.length;u--;){var _=d[u],A=c[_];d[u]=[_,A,aj(A)]}return d}function Qu(c,d){var u=RX(c,d);return wN(u)?u:t}function vee(c){var d=Tt.call(c,Uu),u=c[Uu];try{c[Uu]=t;var _=!0}catch{}var A=MS.call(c);return _&&(d?c[Uu]=u:delete c[Uu]),A}var wI=XM?function(c){return c==null?[]:(c=Ht(c),td(XM(c),function(d){return uN.call(c,d)}))}:VI,oj=XM?function(c){for(var d=[];c;)nd(d,wI(c)),c=TS(c);return d}:VI,Ei=$i;(JM&&Ei(new JM(new ArrayBuffer(1)))!=Pe||q1&&Ei(new q1)!=he||eI&&Ei(eI.resolve())!=Rn||Ph&&Ei(new Ph)!=_t||W1&&Ei(new W1)!=ne)&&(Ei=function(c){var d=$i(c),u=d==xt?c.constructor:t,_=u?Xu(u):"";if(_)switch(_){case JX:return Pe;case eJ:return he;case tJ:return Rn;case nJ:return _t;case iJ:return ne}return d});function _ee(c,d,u){for(var _=-1,A=u.length;++_<A;){var L=u[_],x=L.size;switch(L.type){case"drop":c+=x;break;case"dropRight":d-=x;break;case"take":d=Si(d,c+x);break;case"takeRight":c=Hn(c,d-x);break}}return{start:c,end:d}}function yee(c){var d=c.match(bS);return d?d[1].split(ed):[]}function rj(c,d,u){d=ad(d,c);for(var _=-1,A=d.length,L=!1;++_<A;){var x=Ns(d[_]);if(!(L=c!=null&&u(c,x)))break;c=c[x]}return L||++_!=A?L:(A=c==null?0:c.length,!!A&&oE(A)&&Fa(x,A)&&(ze(c)||Ju(c)))}function bee(c){var d=c.length,u=new c.constructor(d);return d&&typeof c[0]=="string"&&Tt.call(c,"index")&&(u.index=c.index,u.input=c.input),u}function sj(c){return typeof c.constructor=="function"&&!ov(c)?Ah(TS(c)):{}}function See(c,d,u){var _=c.constructor;switch(d){case ge:return _I(c);case vt:case At:return new _(+c);case Pe:return oee(c,u);case Qt:case Fe:case xe:case Te:case Qe:case Xe:case io:case Xc:case K1:return KN(c,u);case he:return new _;case Ne:case Zt:return new _(c);case oi:return ree(c);case _t:return new _;case bi:return see(c)}}function Eee(c,d){var u=d.length;if(!u)return c;var _=u-1;return d[_]=(u>1?"& ":"")+d[_],d=d.join(u>2?", ":" "),c.replace(G1,`{
/* [wrapped with `+d+`] */
`)}function Cee(c){return ze(c)||Ju(c)||!!(lN&&c&&c[lN])}function Fa(c,d){var u=typeof c;return d=d??te,!!d&&(u=="number"||u!="symbol"&&Xt.test(c))&&c>-1&&c%1==0&&c<d}function ki(c,d,u){if(!dn(u))return!1;var _=typeof d;return(_=="number"?ro(u)&&Fa(d,u.length):_=="string"&&d in u)?Gr(u[d],c):!1}function AI(c,d){if(ze(c))return!1;var u=typeof c;return u=="number"||u=="symbol"||u=="boolean"||c==null||No(c)?!0:Vu.test(c)||!Jc.test(c)||d!=null&&c in Ht(d)}function Pee(c){var d=typeof c;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?c!=="__proto__":c===null}function RI(c){var d=ZS(c),u=I[d];if(typeof u!="function"||!(d in st.prototype))return!1;if(c===u)return!0;var _=CI(u);return!!_&&c===_[0]}function wee(c){return!!aN&&aN in c}var Aee=AS?xa:zI;function ov(c){var d=c&&c.constructor,u=typeof d=="function"&&d.prototype||Ch;return c===u}function aj(c){return c===c&&!dn(c)}function cj(c,d){return function(u){return u==null?!1:u[c]===d&&(d!==t||c in Ht(u))}}function Ree(c){var d=nE(c,function(_){return u.size===h&&u.clear(),_}),u=d.cache;return d}function Mee(c,d){var u=c[1],_=d[1],A=u|_,L=A<(E|D|R),x=_==R&&u==U||_==R&&u==O&&c[7].length<=d[8]||_==(R|O)&&d[7].length<=d[8]&&u==U;if(!(L||x))return c;_&E&&(c[2]=d[2],A|=u&E?0:j);var G=d[3];if(G){var W=c[3];c[3]=W?zN(W,G,d[4]):G,c[4]=W?id(c[3],g):d[4]}return G=d[5],G&&(W=c[5],c[5]=W?GN(W,G,d[6]):G,c[6]=W?id(c[5],g):d[6]),G=d[7],G&&(c[7]=G),_&R&&(c[8]=c[8]==null?d[8]:Si(c[8],d[8])),c[9]==null&&(c[9]=d[9]),c[0]=d[0],c[1]=A,c}function Iee(c){var d=[];if(c!=null)for(var u in Ht(c))d.push(u);return d}function Dee(c){return MS.call(c)}function dj(c,d,u){return d=Hn(d===t?c.length-1:d,0),function(){for(var _=arguments,A=-1,L=Hn(_.length-d,0),x=J(L);++A<L;)x[A]=_[d+A];A=-1;for(var G=J(d+1);++A<d;)G[A]=_[A];return G[d]=u(x),To(c,this,G)}}function uj(c,d){return d.length<2?c:Zu(c,fr(d,0,-1))}function Tee(c,d){for(var u=c.length,_=Si(d.length,u),A=oo(c);_--;){var L=d[_];c[_]=Fa(L,u)?A[L]:t}return c}function MI(c,d){if(!(d==="constructor"&&typeof c[d]=="function")&&d!="__proto__")return c[d]}var lj=hj(NN),rv=UX||function(c,d){return si.setTimeout(c,d)},II=hj(eee);function fj(c,d,u){var _=d+"";return II(c,Eee(_,Oee(yee(_),u)))}function hj(c){var d=0,u=0;return function(){var _=ZX(),A=K-(_-u);if(u=_,A>0){if(++d>=Q)return arguments[0]}else d=0;return c.apply(t,arguments)}}function XS(c,d){var u=-1,_=c.length,A=_-1;for(d=d===t?_:d;++u<d;){var L=lI(u,A),x=c[L];c[L]=c[u],c[u]=x}return c.length=d,c}var pj=Ree(function(c){var d=[];return c.charCodeAt(0)===46&&d.push(""),c.replace(LM,function(u,_,A,L){d.push(A?L.replace(pe,"$1"):_||u)}),d});function Ns(c){if(typeof c=="string"||No(c))return c;var d=c+"";return d=="0"&&1/c==-Y?"-0":d}function Xu(c){if(c!=null){try{return RS.call(c)}catch{}try{return c+""}catch{}}return""}function Oee(c,d){return cr(et,function(u){var _="_."+u[0];d&u[1]&&!ES(c,_)&&c.push(_)}),c.sort()}function mj(c){if(c instanceof st)return c.clone();var d=new ur(c.__wrapped__,c.__chain__);return d.__actions__=oo(c.__actions__),d.__index__=c.__index__,d.__values__=c.__values__,d}function Lee(c,d,u){(u?ki(c,d,u):d===t)?d=1:d=Hn(Ye(d),0);var _=c==null?0:c.length;if(!_||d<1)return[];for(var A=0,L=0,x=J(NS(_/d));A<_;)x[L++]=fr(c,A,A+=d);return x}function Nee(c){for(var d=-1,u=c==null?0:c.length,_=0,A=[];++d<u;){var L=c[d];L&&(A[_++]=L)}return A}function jee(){var c=arguments.length;if(!c)return[];for(var d=J(c-1),u=arguments[0],_=c;_--;)d[_-1]=arguments[_];return nd(ze(u)?oo(u):[u],ai(d,1))}var Bee=Je(function(c,d){return Mn(c)?J1(c,ai(d,1,Mn,!0)):[]}),$ee=Je(function(c,d){var u=hr(d);return Mn(u)&&(u=t),Mn(c)?J1(c,ai(d,1,Mn,!0),Le(u,2)):[]}),kee=Je(function(c,d){var u=hr(d);return Mn(u)&&(u=t),Mn(c)?J1(c,ai(d,1,Mn,!0),t,u):[]});function Fee(c,d,u){var _=c==null?0:c.length;return _?(d=u||d===t?1:Ye(d),fr(c,d<0?0:d,_)):[]}function xee(c,d,u){var _=c==null?0:c.length;return _?(d=u||d===t?1:Ye(d),d=_-d,fr(c,0,d<0?0:d)):[]}function Hee(c,d){return c&&c.length?zS(c,Le(d,3),!0,!0):[]}function Kee(c,d){return c&&c.length?zS(c,Le(d,3),!0):[]}function Vee(c,d,u,_){var A=c==null?0:c.length;return A?(u&&typeof u!="number"&&ki(c,d,u)&&(u=0,_=A),jJ(c,d,u,_)):[]}function gj(c,d,u){var _=c==null?0:c.length;if(!_)return-1;var A=u==null?0:Ye(u);return A<0&&(A=Hn(_+A,0)),CS(c,Le(d,3),A)}function vj(c,d,u){var _=c==null?0:c.length;if(!_)return-1;var A=_-1;return u!==t&&(A=Ye(u),A=u<0?Hn(_+A,0):Si(A,_-1)),CS(c,Le(d,3),A,!0)}function _j(c){var d=c==null?0:c.length;return d?ai(c,1):[]}function zee(c){var d=c==null?0:c.length;return d?ai(c,Y):[]}function Gee(c,d){var u=c==null?0:c.length;return u?(d=d===t?1:Ye(d),ai(c,d)):[]}function Uee(c){for(var d=-1,u=c==null?0:c.length,_={};++d<u;){var A=c[d];_[A[0]]=A[1]}return _}function yj(c){return c&&c.length?c[0]:t}function Yee(c,d,u){var _=c==null?0:c.length;if(!_)return-1;var A=u==null?0:Ye(u);return A<0&&(A=Hn(_+A,0)),yh(c,d,A)}function qee(c){var d=c==null?0:c.length;return d?fr(c,0,-1):[]}var Wee=Je(function(c){var d=nn(c,gI);return d.length&&d[0]===c[0]?sI(d):[]}),Zee=Je(function(c){var d=hr(c),u=nn(c,gI);return d===hr(u)?d=t:u.pop(),u.length&&u[0]===c[0]?sI(u,Le(d,2)):[]}),Qee=Je(function(c){var d=hr(c),u=nn(c,gI);return d=typeof d=="function"?d:t,d&&u.pop(),u.length&&u[0]===c[0]?sI(u,t,d):[]});function Xee(c,d){return c==null?"":qX.call(c,d)}function hr(c){var d=c==null?0:c.length;return d?c[d-1]:t}function Jee(c,d,u){var _=c==null?0:c.length;if(!_)return-1;var A=_;return u!==t&&(A=Ye(u),A=A<0?Hn(_+A,0):Si(A,_-1)),d===d?OX(c,d,A):CS(c,J4,A,!0)}function ete(c,d){return c&&c.length?DN(c,Ye(d)):t}var tte=Je(bj);function bj(c,d){return c&&c.length&&d&&d.length?uI(c,d):c}function nte(c,d,u){return c&&c.length&&d&&d.length?uI(c,d,Le(u,2)):c}function ite(c,d,u){return c&&c.length&&d&&d.length?uI(c,d,t,u):c}var ote=ka(function(c,d){var u=c==null?0:c.length,_=nI(c,d);return LN(c,nn(d,function(A){return Fa(A,u)?+A:A}).sort(VN)),_});function rte(c,d){var u=[];if(!(c&&c.length))return u;var _=-1,A=[],L=c.length;for(d=Le(d,3);++_<L;){var x=c[_];d(x,_,c)&&(u.push(x),A.push(_))}return LN(c,A),u}function DI(c){return c==null?c:XX.call(c)}function ste(c,d,u){var _=c==null?0:c.length;return _?(u&&typeof u!="number"&&ki(c,d,u)?(d=0,u=_):(d=d==null?0:Ye(d),u=u===t?_:Ye(u)),fr(c,d,u)):[]}function ate(c,d){return VS(c,d)}function cte(c,d,u){return hI(c,d,Le(u,2))}function dte(c,d){var u=c==null?0:c.length;if(u){var _=VS(c,d);if(_<u&&Gr(c[_],d))return _}return-1}function ute(c,d){return VS(c,d,!0)}function lte(c,d,u){return hI(c,d,Le(u,2),!0)}function fte(c,d){var u=c==null?0:c.length;if(u){var _=VS(c,d,!0)-1;if(Gr(c[_],d))return _}return-1}function hte(c){return c&&c.length?jN(c):[]}function pte(c,d){return c&&c.length?jN(c,Le(d,2)):[]}function mte(c){var d=c==null?0:c.length;return d?fr(c,1,d):[]}function gte(c,d,u){return c&&c.length?(d=u||d===t?1:Ye(d),fr(c,0,d<0?0:d)):[]}function vte(c,d,u){var _=c==null?0:c.length;return _?(d=u||d===t?1:Ye(d),d=_-d,fr(c,d<0?0:d,_)):[]}function _te(c,d){return c&&c.length?zS(c,Le(d,3),!1,!0):[]}function yte(c,d){return c&&c.length?zS(c,Le(d,3)):[]}var bte=Je(function(c){return sd(ai(c,1,Mn,!0))}),Ste=Je(function(c){var d=hr(c);return Mn(d)&&(d=t),sd(ai(c,1,Mn,!0),Le(d,2))}),Ete=Je(function(c){var d=hr(c);return d=typeof d=="function"?d:t,sd(ai(c,1,Mn,!0),t,d)});function Cte(c){return c&&c.length?sd(c):[]}function Pte(c,d){return c&&c.length?sd(c,Le(d,2)):[]}function wte(c,d){return d=typeof d=="function"?d:t,c&&c.length?sd(c,t,d):[]}function TI(c){if(!(c&&c.length))return[];var d=0;return c=td(c,function(u){if(Mn(u))return d=Hn(u.length,d),!0}),qM(d,function(u){return nn(c,GM(u))})}function Sj(c,d){if(!(c&&c.length))return[];var u=TI(c);return d==null?u:nn(u,function(_){return To(d,t,_)})}var Ate=Je(function(c,d){return Mn(c)?J1(c,d):[]}),Rte=Je(function(c){return mI(td(c,Mn))}),Mte=Je(function(c){var d=hr(c);return Mn(d)&&(d=t),mI(td(c,Mn),Le(d,2))}),Ite=Je(function(c){var d=hr(c);return d=typeof d=="function"?d:t,mI(td(c,Mn),t,d)}),Dte=Je(TI);function Tte(c,d){return FN(c||[],d||[],X1)}function Ote(c,d){return FN(c||[],d||[],nv)}var Lte=Je(function(c){var d=c.length,u=d>1?c[d-1]:t;return u=typeof u=="function"?(c.pop(),u):t,Sj(c,u)});function Ej(c){var d=I(c);return d.__chain__=!0,d}function Nte(c,d){return d(c),c}function JS(c,d){return d(c)}var jte=ka(function(c){var d=c.length,u=d?c[0]:0,_=this.__wrapped__,A=function(L){return nI(L,c)};return d>1||this.__actions__.length||!(_ instanceof st)||!Fa(u)?this.thru(A):(_=_.slice(u,+u+(d?1:0)),_.__actions__.push({func:JS,args:[A],thisArg:t}),new ur(_,this.__chain__).thru(function(L){return d&&!L.length&&L.push(t),L}))});function Bte(){return Ej(this)}function $te(){return new ur(this.value(),this.__chain__)}function kte(){this.__values__===t&&(this.__values__=Bj(this.value()));var c=this.__index__>=this.__values__.length,d=c?t:this.__values__[this.__index__++];return{done:c,value:d}}function Fte(){return this}function xte(c){for(var d,u=this;u instanceof kS;){var _=mj(u);_.__index__=0,_.__values__=t,d?A.__wrapped__=_:d=_;var A=_;u=u.__wrapped__}return A.__wrapped__=c,d}function Hte(){var c=this.__wrapped__;if(c instanceof st){var d=c;return this.__actions__.length&&(d=new st(this)),d=d.reverse(),d.__actions__.push({func:JS,args:[DI],thisArg:t}),new ur(d,this.__chain__)}return this.thru(DI)}function Kte(){return kN(this.__wrapped__,this.__actions__)}var Vte=GS(function(c,d,u){Tt.call(c,u)?++c[u]:Ba(c,u,1)});function zte(c,d,u){var _=ze(c)?Q4:NJ;return u&&ki(c,d,u)&&(d=t),_(c,Le(d,3))}function Gte(c,d){var u=ze(c)?td:SN;return u(c,Le(d,3))}var Ute=WN(gj),Yte=WN(vj);function qte(c,d){return ai(eE(c,d),1)}function Wte(c,d){return ai(eE(c,d),Y)}function Zte(c,d,u){return u=u===t?1:Ye(u),ai(eE(c,d),u)}function Cj(c,d){var u=ze(c)?cr:rd;return u(c,Le(d,3))}function Pj(c,d){var u=ze(c)?mX:bN;return u(c,Le(d,3))}var Qte=GS(function(c,d,u){Tt.call(c,u)?c[u].push(d):Ba(c,u,[d])});function Xte(c,d,u,_){c=ro(c)?c:Th(c),u=u&&!_?Ye(u):0;var A=c.length;return u<0&&(u=Hn(A+u,0)),rE(c)?u<=A&&c.indexOf(d,u)>-1:!!A&&yh(c,d,u)>-1}var Jte=Je(function(c,d,u){var _=-1,A=typeof d=="function",L=ro(c)?J(c.length):[];return rd(c,function(x){L[++_]=A?To(d,x,u):ev(x,d,u)}),L}),ene=GS(function(c,d,u){Ba(c,u,d)});function eE(c,d){var u=ze(c)?nn:RN;return u(c,Le(d,3))}function tne(c,d,u,_){return c==null?[]:(ze(d)||(d=d==null?[]:[d]),u=_?t:u,ze(u)||(u=u==null?[]:[u]),TN(c,d,u))}var nne=GS(function(c,d,u){c[u?0:1].push(d)},function(){return[[],[]]});function ine(c,d,u){var _=ze(c)?VM:tN,A=arguments.length<3;return _(c,Le(d,4),u,A,rd)}function one(c,d,u){var _=ze(c)?gX:tN,A=arguments.length<3;return _(c,Le(d,4),u,A,bN)}function rne(c,d){var u=ze(c)?td:SN;return u(c,iE(Le(d,3)))}function sne(c){var d=ze(c)?gN:XJ;return d(c)}function ane(c,d,u){(u?ki(c,d,u):d===t)?d=1:d=Ye(d);var _=ze(c)?IJ:JJ;return _(c,d)}function cne(c){var d=ze(c)?DJ:tee;return d(c)}function dne(c){if(c==null)return 0;if(ro(c))return rE(c)?Sh(c):c.length;var d=Ei(c);return d==he||d==_t?c.size:cI(c).length}function une(c,d,u){var _=ze(c)?zM:nee;return u&&ki(c,d,u)&&(d=t),_(c,Le(d,3))}var lne=Je(function(c,d){if(c==null)return[];var u=d.length;return u>1&&ki(c,d[0],d[1])?d=[]:u>2&&ki(d[0],d[1],d[2])&&(d=[d[0]]),TN(c,ai(d,1),[])}),tE=GX||function(){return si.Date.now()};function fne(c,d){if(typeof d!="function")throw new dr(s);return c=Ye(c),function(){if(--c<1)return d.apply(this,arguments)}}function wj(c,d,u){return d=u?t:d,d=c&&d==null?c.length:d,$a(c,R,t,t,t,t,d)}function Aj(c,d){var u;if(typeof d!="function")throw new dr(s);return c=Ye(c),function(){return--c>0&&(u=d.apply(this,arguments)),c<=1&&(d=t),u}}var OI=Je(function(c,d,u){var _=E;if(u.length){var A=id(u,Ih(OI));_|=b}return $a(c,_,d,u,A)}),Rj=Je(function(c,d,u){var _=E|D;if(u.length){var A=id(u,Ih(Rj));_|=b}return $a(d,_,c,u,A)});function Mj(c,d,u){d=u?t:d;var _=$a(c,U,t,t,t,t,t,d);return _.placeholder=Mj.placeholder,_}function Ij(c,d,u){d=u?t:d;var _=$a(c,p,t,t,t,t,t,d);return _.placeholder=Ij.placeholder,_}function Dj(c,d,u){var _,A,L,x,G,W,ie=0,re=!1,ce=!1,ve=!0;if(typeof c!="function")throw new dr(s);d=pr(d)||0,dn(u)&&(re=!!u.leading,ce="maxWait"in u,L=ce?Hn(pr(u.maxWait)||0,d):L,ve="trailing"in u?!!u.trailing:ve);function we(In){var Ur=_,Ka=A;return _=A=t,ie=In,x=c.apply(Ka,Ur),x}function je(In){return ie=In,G=rv(rt,d),re?we(In):x}function qe(In){var Ur=In-W,Ka=In-ie,Wj=d-Ur;return ce?Si(Wj,L-Ka):Wj}function Be(In){var Ur=In-W,Ka=In-ie;return W===t||Ur>=d||Ur<0||ce&&Ka>=L}function rt(){var In=tE();if(Be(In))return ut(In);G=rv(rt,qe(In))}function ut(In){return G=t,ve&&_?we(In):(_=A=t,x)}function jo(){G!==t&&xN(G),ie=0,_=W=A=G=t}function Fi(){return G===t?x:ut(tE())}function Bo(){var In=tE(),Ur=Be(In);if(_=arguments,A=this,W=In,Ur){if(G===t)return je(W);if(ce)return xN(G),G=rv(rt,d),we(W)}return G===t&&(G=rv(rt,d)),x}return Bo.cancel=jo,Bo.flush=Fi,Bo}var hne=Je(function(c,d){return yN(c,1,d)}),pne=Je(function(c,d,u){return yN(c,pr(d)||0,u)});function mne(c){return $a(c,N)}function nE(c,d){if(typeof c!="function"||d!=null&&typeof d!="function")throw new dr(s);var u=function(){var _=arguments,A=d?d.apply(this,_):_[0],L=u.cache;if(L.has(A))return L.get(A);var x=c.apply(this,_);return u.cache=L.set(A,x)||L,x};return u.cache=new(nE.Cache||ja),u}nE.Cache=ja;function iE(c){if(typeof c!="function")throw new dr(s);return function(){var d=arguments;switch(d.length){case 0:return!c.call(this);case 1:return!c.call(this,d[0]);case 2:return!c.call(this,d[0],d[1]);case 3:return!c.call(this,d[0],d[1],d[2])}return!c.apply(this,d)}}function gne(c){return Aj(2,c)}var vne=iee(function(c,d){d=d.length==1&&ze(d[0])?nn(d[0],Oo(Le())):nn(ai(d,1),Oo(Le()));var u=d.length;return Je(function(_){for(var A=-1,L=Si(_.length,u);++A<L;)_[A]=d[A].call(this,_[A]);return To(c,this,_)})}),LI=Je(function(c,d){var u=id(d,Ih(LI));return $a(c,b,t,d,u)}),Tj=Je(function(c,d){var u=id(d,Ih(Tj));return $a(c,v,t,d,u)}),_ne=ka(function(c,d){return $a(c,O,t,t,t,d)});function yne(c,d){if(typeof c!="function")throw new dr(s);return d=d===t?d:Ye(d),Je(c,d)}function bne(c,d){if(typeof c!="function")throw new dr(s);return d=d==null?0:Hn(Ye(d),0),Je(function(u){var _=u[d],A=cd(u,0,d);return _&&nd(A,_),To(c,this,A)})}function Sne(c,d,u){var _=!0,A=!0;if(typeof c!="function")throw new dr(s);return dn(u)&&(_="leading"in u?!!u.leading:_,A="trailing"in u?!!u.trailing:A),Dj(c,d,{leading:_,maxWait:d,trailing:A})}function Ene(c){return wj(c,1)}function Cne(c,d){return LI(vI(d),c)}function Pne(){if(!arguments.length)return[];var c=arguments[0];return ze(c)?c:[c]}function wne(c){return lr(c,P)}function Ane(c,d){return d=typeof d=="function"?d:t,lr(c,P,d)}function Rne(c){return lr(c,y|P)}function Mne(c,d){return d=typeof d=="function"?d:t,lr(c,y|P,d)}function Ine(c,d){return d==null||_N(c,d,Un(d))}function Gr(c,d){return c===d||c!==c&&d!==d}var Dne=WS(rI),Tne=WS(function(c,d){return c>=d}),Ju=PN(function(){return arguments}())?PN:function(c){return vn(c)&&Tt.call(c,"callee")&&!uN.call(c,"callee")},ze=J.isArray,One=G4?Oo(G4):xJ;function ro(c){return c!=null&&oE(c.length)&&!xa(c)}function Mn(c){return vn(c)&&ro(c)}function Lne(c){return c===!0||c===!1||vn(c)&&$i(c)==vt}var dd=YX||zI,Nne=U4?Oo(U4):HJ;function jne(c){return vn(c)&&c.nodeType===1&&!sv(c)}function Bne(c){if(c==null)return!0;if(ro(c)&&(ze(c)||typeof c=="string"||typeof c.splice=="function"||dd(c)||Dh(c)||Ju(c)))return!c.length;var d=Ei(c);if(d==he||d==_t)return!c.size;if(ov(c))return!cI(c).length;for(var u in c)if(Tt.call(c,u))return!1;return!0}function $ne(c,d){return tv(c,d)}function kne(c,d,u){u=typeof u=="function"?u:t;var _=u?u(c,d):t;return _===t?tv(c,d,t,u):!!_}function NI(c){if(!vn(c))return!1;var d=$i(c);return d==Wt||d==yi||typeof c.message=="string"&&typeof c.name=="string"&&!sv(c)}function Fne(c){return typeof c=="number"&&fN(c)}function xa(c){if(!dn(c))return!1;var d=$i(c);return d==Ze||d==ii||d==Ot||d==gn}function Oj(c){return typeof c=="number"&&c==Ye(c)}function oE(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=te}function dn(c){var d=typeof c;return c!=null&&(d=="object"||d=="function")}function vn(c){return c!=null&&typeof c=="object"}var Lj=Y4?Oo(Y4):VJ;function xne(c,d){return c===d||aI(c,d,PI(d))}function Hne(c,d,u){return u=typeof u=="function"?u:t,aI(c,d,PI(d),u)}function Kne(c){return Nj(c)&&c!=+c}function Vne(c){if(Aee(c))throw new He(r);return wN(c)}function zne(c){return c===null}function Gne(c){return c==null}function Nj(c){return typeof c=="number"||vn(c)&&$i(c)==Ne}function sv(c){if(!vn(c)||$i(c)!=xt)return!1;var d=TS(c);if(d===null)return!0;var u=Tt.call(d,"constructor")&&d.constructor;return typeof u=="function"&&u instanceof u&&RS.call(u)==HX}var jI=q4?Oo(q4):zJ;function Une(c){return Oj(c)&&c>=-te&&c<=te}var jj=W4?Oo(W4):GJ;function rE(c){return typeof c=="string"||!ze(c)&&vn(c)&&$i(c)==Zt}function No(c){return typeof c=="symbol"||vn(c)&&$i(c)==bi}var Dh=Z4?Oo(Z4):UJ;function Yne(c){return c===t}function qne(c){return vn(c)&&Ei(c)==ne}function Wne(c){return vn(c)&&$i(c)==fe}var Zne=WS(dI),Qne=WS(function(c,d){return c<=d});function Bj(c){if(!c)return[];if(ro(c))return rE(c)?Vr(c):oo(c);if(Y1&&c[Y1])return IX(c[Y1]());var d=Ei(c),u=d==he?ZM:d==_t?PS:Th;return u(c)}function Ha(c){if(!c)return c===0?c:0;if(c=pr(c),c===Y||c===-Y){var d=c<0?-1:1;return d*ue}return c===c?c:0}function Ye(c){var d=Ha(c),u=d%1;return d===d?u?d-u:d:0}function $j(c){return c?Wu(Ye(c),0,ae):0}function pr(c){if(typeof c=="number")return c;if(No(c))return Re;if(dn(c)){var d=typeof c.valueOf=="function"?c.valueOf():c;c=dn(d)?d+"":d}if(typeof c!="string")return c===0?c:+c;c=nN(c);var u=Nt.test(c);return u||dt.test(c)?fX(c.slice(2),u?2:8):Dt.test(c)?Re:+c}function kj(c){return Ls(c,so(c))}function Xne(c){return c?Wu(Ye(c),-te,te):c===0?c:0}function Rt(c){return c==null?"":Lo(c)}var Jne=Rh(function(c,d){if(ov(d)||ro(d)){Ls(d,Un(d),c);return}for(var u in d)Tt.call(d,u)&&X1(c,u,d[u])}),Fj=Rh(function(c,d){Ls(d,so(d),c)}),sE=Rh(function(c,d,u,_){Ls(d,so(d),c,_)}),eie=Rh(function(c,d,u,_){Ls(d,Un(d),c,_)}),tie=ka(nI);function nie(c,d){var u=Ah(c);return d==null?u:vN(u,d)}var iie=Je(function(c,d){c=Ht(c);var u=-1,_=d.length,A=_>2?d[2]:t;for(A&&ki(d[0],d[1],A)&&(_=1);++u<_;)for(var L=d[u],x=so(L),G=-1,W=x.length;++G<W;){var ie=x[G],re=c[ie];(re===t||Gr(re,Ch[ie])&&!Tt.call(c,ie))&&(c[ie]=L[ie])}return c}),oie=Je(function(c){return c.push(t,nj),To(xj,t,c)});function rie(c,d){return X4(c,Le(d,3),Os)}function sie(c,d){return X4(c,Le(d,3),oI)}function aie(c,d){return c==null?c:iI(c,Le(d,3),so)}function cie(c,d){return c==null?c:EN(c,Le(d,3),so)}function die(c,d){return c&&Os(c,Le(d,3))}function uie(c,d){return c&&oI(c,Le(d,3))}function lie(c){return c==null?[]:HS(c,Un(c))}function fie(c){return c==null?[]:HS(c,so(c))}function BI(c,d,u){var _=c==null?t:Zu(c,d);return _===t?u:_}function hie(c,d){return c!=null&&rj(c,d,BJ)}function $I(c,d){return c!=null&&rj(c,d,$J)}var pie=QN(function(c,d,u){d!=null&&typeof d.toString!="function"&&(d=MS.call(d)),c[d]=u},FI(ao)),mie=QN(function(c,d,u){d!=null&&typeof d.toString!="function"&&(d=MS.call(d)),Tt.call(c,d)?c[d].push(u):c[d]=[u]},Le),gie=Je(ev);function Un(c){return ro(c)?mN(c):cI(c)}function so(c){return ro(c)?mN(c,!0):YJ(c)}function vie(c,d){var u={};return d=Le(d,3),Os(c,function(_,A,L){Ba(u,d(_,A,L),_)}),u}function _ie(c,d){var u={};return d=Le(d,3),Os(c,function(_,A,L){Ba(u,A,d(_,A,L))}),u}var yie=Rh(function(c,d,u){KS(c,d,u)}),xj=Rh(function(c,d,u,_){KS(c,d,u,_)}),bie=ka(function(c,d){var u={};if(c==null)return u;var _=!1;d=nn(d,function(L){return L=ad(L,c),_||(_=L.length>1),L}),Ls(c,EI(c),u),_&&(u=lr(u,y|S|P,pee));for(var A=d.length;A--;)pI(u,d[A]);return u});function Sie(c,d){return Hj(c,iE(Le(d)))}var Eie=ka(function(c,d){return c==null?{}:WJ(c,d)});function Hj(c,d){if(c==null)return{};var u=nn(EI(c),function(_){return[_]});return d=Le(d),ON(c,u,function(_,A){return d(_,A[0])})}function Cie(c,d,u){d=ad(d,c);var _=-1,A=d.length;for(A||(A=1,c=t);++_<A;){var L=c==null?t:c[Ns(d[_])];L===t&&(_=A,L=u),c=xa(L)?L.call(c):L}return c}function Pie(c,d,u){return c==null?c:nv(c,d,u)}function wie(c,d,u,_){return _=typeof _=="function"?_:t,c==null?c:nv(c,d,u,_)}var Kj=ej(Un),Vj=ej(so);function Aie(c,d,u){var _=ze(c),A=_||dd(c)||Dh(c);if(d=Le(d,4),u==null){var L=c&&c.constructor;A?u=_?new L:[]:dn(c)?u=xa(L)?Ah(TS(c)):{}:u={}}return(A?cr:Os)(c,function(x,G,W){return d(u,x,G,W)}),u}function Rie(c,d){return c==null?!0:pI(c,d)}function Mie(c,d,u){return c==null?c:$N(c,d,vI(u))}function Iie(c,d,u,_){return _=typeof _=="function"?_:t,c==null?c:$N(c,d,vI(u),_)}function Th(c){return c==null?[]:WM(c,Un(c))}function Die(c){return c==null?[]:WM(c,so(c))}function Tie(c,d,u){return u===t&&(u=d,d=t),u!==t&&(u=pr(u),u=u===u?u:0),d!==t&&(d=pr(d),d=d===d?d:0),Wu(pr(c),d,u)}function Oie(c,d,u){return d=Ha(d),u===t?(u=d,d=0):u=Ha(u),c=pr(c),kJ(c,d,u)}function Lie(c,d,u){if(u&&typeof u!="boolean"&&ki(c,d,u)&&(d=u=t),u===t&&(typeof d=="boolean"?(u=d,d=t):typeof c=="boolean"&&(u=c,c=t)),c===t&&d===t?(c=0,d=1):(c=Ha(c),d===t?(d=c,c=0):d=Ha(d)),c>d){var _=c;c=d,d=_}if(u||c%1||d%1){var A=hN();return Si(c+A*(d-c+lX("1e-"+((A+"").length-1))),d)}return lI(c,d)}var Nie=Mh(function(c,d,u){return d=d.toLowerCase(),c+(u?zj(d):d)});function zj(c){return kI(Rt(c).toLowerCase())}function Gj(c){return c=Rt(c),c&&c.replace(bt,PX).replace(tX,"")}function jie(c,d,u){c=Rt(c),d=Lo(d);var _=c.length;u=u===t?_:Wu(Ye(u),0,_);var A=u;return u-=d.length,u>=0&&c.slice(u,A)==d}function Bie(c){return c=Rt(c),c&&gh.test(c)?c.replace(vS,wX):c}function $ie(c){return c=Rt(c),c&&zu.test(c)?c.replace(z1,"\\$&"):c}var kie=Mh(function(c,d,u){return c+(u?"-":"")+d.toLowerCase()}),Fie=Mh(function(c,d,u){return c+(u?" ":"")+d.toLowerCase()}),xie=qN("toLowerCase");function Hie(c,d,u){c=Rt(c),d=Ye(d);var _=d?Sh(c):0;if(!d||_>=d)return c;var A=(d-_)/2;return qS(jS(A),u)+c+qS(NS(A),u)}function Kie(c,d,u){c=Rt(c),d=Ye(d);var _=d?Sh(c):0;return d&&_<d?c+qS(d-_,u):c}function Vie(c,d,u){c=Rt(c),d=Ye(d);var _=d?Sh(c):0;return d&&_<d?qS(d-_,u)+c:c}function zie(c,d,u){return u||d==null?d=0:d&&(d=+d),QX(Rt(c).replace(vh,""),d||0)}function Gie(c,d,u){return(u?ki(c,d,u):d===t)?d=1:d=Ye(d),fI(Rt(c),d)}function Uie(){var c=arguments,d=Rt(c[0]);return c.length<3?d:d.replace(c[1],c[2])}var Yie=Mh(function(c,d,u){return c+(u?"_":"")+d.toLowerCase()});function qie(c,d,u){return u&&typeof u!="number"&&ki(c,d,u)&&(d=u=t),u=u===t?ae:u>>>0,u?(c=Rt(c),c&&(typeof d=="string"||d!=null&&!jI(d))&&(d=Lo(d),!d&&bh(c))?cd(Vr(c),0,u):c.split(d,u)):[]}var Wie=Mh(function(c,d,u){return c+(u?" ":"")+kI(d)});function Zie(c,d,u){return c=Rt(c),u=u==null?0:Wu(Ye(u),0,c.length),d=Lo(d),c.slice(u,u+d.length)==d}function Qie(c,d,u){var _=I.templateSettings;u&&ki(c,d,u)&&(d=t),c=Rt(c),d=sE({},d,_,tj);var A=sE({},d.imports,_.imports,tj),L=Un(A),x=WM(A,L),G,W,ie=0,re=d.interpolate||tn,ce="__p += '",ve=QM((d.escape||tn).source+"|"+re.source+"|"+(re===_S?Ce:tn).source+"|"+(d.evaluate||tn).source+"|$","g"),we="//# sourceURL="+(Tt.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++sX+"]")+`
`;c.replace(ve,function(Be,rt,ut,jo,Fi,Bo){return ut||(ut=jo),ce+=c.slice(ie,Bo).replace(ri,AX),rt&&(G=!0,ce+=`' +
__e(`+rt+`) +
'`),Fi&&(W=!0,ce+=`';
`+Fi+`;
__p += '`),ut&&(ce+=`' +
((__t = (`+ut+`)) == null ? '' : __t) +
'`),ie=Bo+Be.length,Be}),ce+=`';
`;var je=Tt.call(d,"variable")&&d.variable;if(!je)ce=`with (obj) {
`+ce+`
}
`;else if(oe.test(je))throw new He(a);ce=(W?ce.replace(MM,""):ce).replace(IM,"$1").replace(DM,"$1;"),ce="function("+(je||"obj")+`) {
`+(je?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(G?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ce+`return __p
}`;var qe=Yj(function(){return St(L,we+"return "+ce).apply(t,x)});if(qe.source=ce,NI(qe))throw qe;return qe}function Xie(c){return Rt(c).toLowerCase()}function Jie(c){return Rt(c).toUpperCase()}function eoe(c,d,u){if(c=Rt(c),c&&(u||d===t))return nN(c);if(!c||!(d=Lo(d)))return c;var _=Vr(c),A=Vr(d),L=iN(_,A),x=oN(_,A)+1;return cd(_,L,x).join("")}function toe(c,d,u){if(c=Rt(c),c&&(u||d===t))return c.slice(0,sN(c)+1);if(!c||!(d=Lo(d)))return c;var _=Vr(c),A=oN(_,Vr(d))+1;return cd(_,0,A).join("")}function noe(c,d,u){if(c=Rt(c),c&&(u||d===t))return c.replace(vh,"");if(!c||!(d=Lo(d)))return c;var _=Vr(c),A=iN(_,Vr(d));return cd(_,A).join("")}function ioe(c,d){var u=T,_=$;if(dn(d)){var A="separator"in d?d.separator:A;u="length"in d?Ye(d.length):u,_="omission"in d?Lo(d.omission):_}c=Rt(c);var L=c.length;if(bh(c)){var x=Vr(c);L=x.length}if(u>=L)return c;var G=u-Sh(_);if(G<1)return _;var W=x?cd(x,0,G).join(""):c.slice(0,G);if(A===t)return W+_;if(x&&(G+=W.length-G),jI(A)){if(c.slice(G).search(A)){var ie,re=W;for(A.global||(A=QM(A.source,Rt(Lt.exec(A))+"g")),A.lastIndex=0;ie=A.exec(re);)var ce=ie.index;W=W.slice(0,ce===t?G:ce)}}else if(c.indexOf(Lo(A),G)!=G){var ve=W.lastIndexOf(A);ve>-1&&(W=W.slice(0,ve))}return W+_}function ooe(c){return c=Rt(c),c&&TM.test(c)?c.replace(Kr,LX):c}var roe=Mh(function(c,d,u){return c+(u?" ":"")+d.toUpperCase()}),kI=qN("toUpperCase");function Uj(c,d,u){return c=Rt(c),d=u?t:d,d===t?MX(c)?BX(c):yX(c):c.match(d)||[]}var Yj=Je(function(c,d){try{return To(c,t,d)}catch(u){return NI(u)?u:new He(u)}}),soe=ka(function(c,d){return cr(d,function(u){u=Ns(u),Ba(c,u,OI(c[u],c))}),c});function aoe(c){var d=c==null?0:c.length,u=Le();return c=d?nn(c,function(_){if(typeof _[1]!="function")throw new dr(s);return[u(_[0]),_[1]]}):[],Je(function(_){for(var A=-1;++A<d;){var L=c[A];if(To(L[0],this,_))return To(L[1],this,_)}})}function coe(c){return LJ(lr(c,y))}function FI(c){return function(){return c}}function doe(c,d){return c==null||c!==c?d:c}var uoe=ZN(),loe=ZN(!0);function ao(c){return c}function xI(c){return AN(typeof c=="function"?c:lr(c,y))}function foe(c){return MN(lr(c,y))}function hoe(c,d){return IN(c,lr(d,y))}var poe=Je(function(c,d){return function(u){return ev(u,c,d)}}),moe=Je(function(c,d){return function(u){return ev(c,u,d)}});function HI(c,d,u){var _=Un(d),A=HS(d,_);u==null&&!(dn(d)&&(A.length||!_.length))&&(u=d,d=c,c=this,A=HS(d,Un(d)));var L=!(dn(u)&&"chain"in u)||!!u.chain,x=xa(c);return cr(A,function(G){var W=d[G];c[G]=W,x&&(c.prototype[G]=function(){var ie=this.__chain__;if(L||ie){var re=c(this.__wrapped__),ce=re.__actions__=oo(this.__actions__);return ce.push({func:W,args:arguments,thisArg:c}),re.__chain__=ie,re}return W.apply(c,nd([this.value()],arguments))})}),c}function goe(){return si._===this&&(si._=KX),this}function KI(){}function voe(c){return c=Ye(c),Je(function(d){return DN(d,c)})}var _oe=yI(nn),yoe=yI(Q4),boe=yI(zM);function qj(c){return AI(c)?GM(Ns(c)):ZJ(c)}function Soe(c){return function(d){return c==null?t:Zu(c,d)}}var Eoe=XN(),Coe=XN(!0);function VI(){return[]}function zI(){return!1}function Poe(){return{}}function woe(){return""}function Aoe(){return!0}function Roe(c,d){if(c=Ye(c),c<1||c>te)return[];var u=ae,_=Si(c,ae);d=Le(d),c-=ae;for(var A=qM(_,d);++u<c;)d(u);return A}function Moe(c){return ze(c)?nn(c,Ns):No(c)?[c]:oo(pj(Rt(c)))}function Ioe(c){var d=++xX;return Rt(c)+d}var Doe=YS(function(c,d){return c+d},0),Toe=bI("ceil"),Ooe=YS(function(c,d){return c/d},1),Loe=bI("floor");function Noe(c){return c&&c.length?xS(c,ao,rI):t}function joe(c,d){return c&&c.length?xS(c,Le(d,2),rI):t}function Boe(c){return eN(c,ao)}function $oe(c,d){return eN(c,Le(d,2))}function koe(c){return c&&c.length?xS(c,ao,dI):t}function Foe(c,d){return c&&c.length?xS(c,Le(d,2),dI):t}var xoe=YS(function(c,d){return c*d},1),Hoe=bI("round"),Koe=YS(function(c,d){return c-d},0);function Voe(c){return c&&c.length?YM(c,ao):0}function zoe(c,d){return c&&c.length?YM(c,Le(d,2)):0}return I.after=fne,I.ary=wj,I.assign=Jne,I.assignIn=Fj,I.assignInWith=sE,I.assignWith=eie,I.at=tie,I.before=Aj,I.bind=OI,I.bindAll=soe,I.bindKey=Rj,I.castArray=Pne,I.chain=Ej,I.chunk=Lee,I.compact=Nee,I.concat=jee,I.cond=aoe,I.conforms=coe,I.constant=FI,I.countBy=Vte,I.create=nie,I.curry=Mj,I.curryRight=Ij,I.debounce=Dj,I.defaults=iie,I.defaultsDeep=oie,I.defer=hne,I.delay=pne,I.difference=Bee,I.differenceBy=$ee,I.differenceWith=kee,I.drop=Fee,I.dropRight=xee,I.dropRightWhile=Hee,I.dropWhile=Kee,I.fill=Vee,I.filter=Gte,I.flatMap=qte,I.flatMapDeep=Wte,I.flatMapDepth=Zte,I.flatten=_j,I.flattenDeep=zee,I.flattenDepth=Gee,I.flip=mne,I.flow=uoe,I.flowRight=loe,I.fromPairs=Uee,I.functions=lie,I.functionsIn=fie,I.groupBy=Qte,I.initial=qee,I.intersection=Wee,I.intersectionBy=Zee,I.intersectionWith=Qee,I.invert=pie,I.invertBy=mie,I.invokeMap=Jte,I.iteratee=xI,I.keyBy=ene,I.keys=Un,I.keysIn=so,I.map=eE,I.mapKeys=vie,I.mapValues=_ie,I.matches=foe,I.matchesProperty=hoe,I.memoize=nE,I.merge=yie,I.mergeWith=xj,I.method=poe,I.methodOf=moe,I.mixin=HI,I.negate=iE,I.nthArg=voe,I.omit=bie,I.omitBy=Sie,I.once=gne,I.orderBy=tne,I.over=_oe,I.overArgs=vne,I.overEvery=yoe,I.overSome=boe,I.partial=LI,I.partialRight=Tj,I.partition=nne,I.pick=Eie,I.pickBy=Hj,I.property=qj,I.propertyOf=Soe,I.pull=tte,I.pullAll=bj,I.pullAllBy=nte,I.pullAllWith=ite,I.pullAt=ote,I.range=Eoe,I.rangeRight=Coe,I.rearg=_ne,I.reject=rne,I.remove=rte,I.rest=yne,I.reverse=DI,I.sampleSize=ane,I.set=Pie,I.setWith=wie,I.shuffle=cne,I.slice=ste,I.sortBy=lne,I.sortedUniq=hte,I.sortedUniqBy=pte,I.split=qie,I.spread=bne,I.tail=mte,I.take=gte,I.takeRight=vte,I.takeRightWhile=_te,I.takeWhile=yte,I.tap=Nte,I.throttle=Sne,I.thru=JS,I.toArray=Bj,I.toPairs=Kj,I.toPairsIn=Vj,I.toPath=Moe,I.toPlainObject=kj,I.transform=Aie,I.unary=Ene,I.union=bte,I.unionBy=Ste,I.unionWith=Ete,I.uniq=Cte,I.uniqBy=Pte,I.uniqWith=wte,I.unset=Rie,I.unzip=TI,I.unzipWith=Sj,I.update=Mie,I.updateWith=Iie,I.values=Th,I.valuesIn=Die,I.without=Ate,I.words=Uj,I.wrap=Cne,I.xor=Rte,I.xorBy=Mte,I.xorWith=Ite,I.zip=Dte,I.zipObject=Tte,I.zipObjectDeep=Ote,I.zipWith=Lte,I.entries=Kj,I.entriesIn=Vj,I.extend=Fj,I.extendWith=sE,HI(I,I),I.add=Doe,I.attempt=Yj,I.camelCase=Nie,I.capitalize=zj,I.ceil=Toe,I.clamp=Tie,I.clone=wne,I.cloneDeep=Rne,I.cloneDeepWith=Mne,I.cloneWith=Ane,I.conformsTo=Ine,I.deburr=Gj,I.defaultTo=doe,I.divide=Ooe,I.endsWith=jie,I.eq=Gr,I.escape=Bie,I.escapeRegExp=$ie,I.every=zte,I.find=Ute,I.findIndex=gj,I.findKey=rie,I.findLast=Yte,I.findLastIndex=vj,I.findLastKey=sie,I.floor=Loe,I.forEach=Cj,I.forEachRight=Pj,I.forIn=aie,I.forInRight=cie,I.forOwn=die,I.forOwnRight=uie,I.get=BI,I.gt=Dne,I.gte=Tne,I.has=hie,I.hasIn=$I,I.head=yj,I.identity=ao,I.includes=Xte,I.indexOf=Yee,I.inRange=Oie,I.invoke=gie,I.isArguments=Ju,I.isArray=ze,I.isArrayBuffer=One,I.isArrayLike=ro,I.isArrayLikeObject=Mn,I.isBoolean=Lne,I.isBuffer=dd,I.isDate=Nne,I.isElement=jne,I.isEmpty=Bne,I.isEqual=$ne,I.isEqualWith=kne,I.isError=NI,I.isFinite=Fne,I.isFunction=xa,I.isInteger=Oj,I.isLength=oE,I.isMap=Lj,I.isMatch=xne,I.isMatchWith=Hne,I.isNaN=Kne,I.isNative=Vne,I.isNil=Gne,I.isNull=zne,I.isNumber=Nj,I.isObject=dn,I.isObjectLike=vn,I.isPlainObject=sv,I.isRegExp=jI,I.isSafeInteger=Une,I.isSet=jj,I.isString=rE,I.isSymbol=No,I.isTypedArray=Dh,I.isUndefined=Yne,I.isWeakMap=qne,I.isWeakSet=Wne,I.join=Xee,I.kebabCase=kie,I.last=hr,I.lastIndexOf=Jee,I.lowerCase=Fie,I.lowerFirst=xie,I.lt=Zne,I.lte=Qne,I.max=Noe,I.maxBy=joe,I.mean=Boe,I.meanBy=$oe,I.min=koe,I.minBy=Foe,I.stubArray=VI,I.stubFalse=zI,I.stubObject=Poe,I.stubString=woe,I.stubTrue=Aoe,I.multiply=xoe,I.nth=ete,I.noConflict=goe,I.noop=KI,I.now=tE,I.pad=Hie,I.padEnd=Kie,I.padStart=Vie,I.parseInt=zie,I.random=Lie,I.reduce=ine,I.reduceRight=one,I.repeat=Gie,I.replace=Uie,I.result=Cie,I.round=Hoe,I.runInContext=q,I.sample=sne,I.size=dne,I.snakeCase=Yie,I.some=une,I.sortedIndex=ate,I.sortedIndexBy=cte,I.sortedIndexOf=dte,I.sortedLastIndex=ute,I.sortedLastIndexBy=lte,I.sortedLastIndexOf=fte,I.startCase=Wie,I.startsWith=Zie,I.subtract=Koe,I.sum=Voe,I.sumBy=zoe,I.template=Qie,I.times=Roe,I.toFinite=Ha,I.toInteger=Ye,I.toLength=$j,I.toLower=Xie,I.toNumber=pr,I.toSafeInteger=Xne,I.toString=Rt,I.toUpper=Jie,I.trim=eoe,I.trimEnd=toe,I.trimStart=noe,I.truncate=ioe,I.unescape=ooe,I.uniqueId=Ioe,I.upperCase=roe,I.upperFirst=kI,I.each=Cj,I.eachRight=Pj,I.first=yj,HI(I,function(){var c={};return Os(I,function(d,u){Tt.call(I.prototype,u)||(c[u]=d)}),c}(),{chain:!1}),I.VERSION=i,cr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){I[c].placeholder=I}),cr(["drop","take"],function(c,d){st.prototype[c]=function(u){u=u===t?1:Hn(Ye(u),0);var _=this.__filtered__&&!d?new st(this):this.clone();return _.__filtered__?_.__takeCount__=Si(u,_.__takeCount__):_.__views__.push({size:Si(u,ae),type:c+(_.__dir__<0?"Right":"")}),_},st.prototype[c+"Right"]=function(u){return this.reverse()[c](u).reverse()}}),cr(["filter","map","takeWhile"],function(c,d){var u=d+1,_=u==Z||u==M;st.prototype[c]=function(A){var L=this.clone();return L.__iteratees__.push({iteratee:Le(A,3),type:u}),L.__filtered__=L.__filtered__||_,L}}),cr(["head","last"],function(c,d){var u="take"+(d?"Right":"");st.prototype[c]=function(){return this[u](1).value()[0]}}),cr(["initial","tail"],function(c,d){var u="drop"+(d?"":"Right");st.prototype[c]=function(){return this.__filtered__?new st(this):this[u](1)}}),st.prototype.compact=function(){return this.filter(ao)},st.prototype.find=function(c){return this.filter(c).head()},st.prototype.findLast=function(c){return this.reverse().find(c)},st.prototype.invokeMap=Je(function(c,d){return typeof c=="function"?new st(this):this.map(function(u){return ev(u,c,d)})}),st.prototype.reject=function(c){return this.filter(iE(Le(c)))},st.prototype.slice=function(c,d){c=Ye(c);var u=this;return u.__filtered__&&(c>0||d<0)?new st(u):(c<0?u=u.takeRight(-c):c&&(u=u.drop(c)),d!==t&&(d=Ye(d),u=d<0?u.dropRight(-d):u.take(d-c)),u)},st.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},st.prototype.toArray=function(){return this.take(ae)},Os(st.prototype,function(c,d){var u=/^(?:filter|find|map|reject)|While$/.test(d),_=/^(?:head|last)$/.test(d),A=I[_?"take"+(d=="last"?"Right":""):d],L=_||/^find/.test(d);A&&(I.prototype[d]=function(){var x=this.__wrapped__,G=_?[1]:arguments,W=x instanceof st,ie=G[0],re=W||ze(x),ce=function(rt){var ut=A.apply(I,nd([rt],G));return _&&ve?ut[0]:ut};re&&u&&typeof ie=="function"&&ie.length!=1&&(W=re=!1);var ve=this.__chain__,we=!!this.__actions__.length,je=L&&!ve,qe=W&&!we;if(!L&&re){x=qe?x:new st(this);var Be=c.apply(x,G);return Be.__actions__.push({func:JS,args:[ce],thisArg:t}),new ur(Be,ve)}return je&&qe?c.apply(this,G):(Be=this.thru(ce),je?_?Be.value()[0]:Be.value():Be)})}),cr(["pop","push","shift","sort","splice","unshift"],function(c){var d=wS[c],u=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",_=/^(?:pop|shift)$/.test(c);I.prototype[c]=function(){var A=arguments;if(_&&!this.__chain__){var L=this.value();return d.apply(ze(L)?L:[],A)}return this[u](function(x){return d.apply(ze(x)?x:[],A)})}}),Os(st.prototype,function(c,d){var u=I[d];if(u){var _=u.name+"";Tt.call(wh,_)||(wh[_]=[]),wh[_].push({name:d,func:u})}}),wh[US(t,D).name]=[{name:"wrapper",func:t}],st.prototype.clone=oJ,st.prototype.reverse=rJ,st.prototype.value=sJ,I.prototype.at=jte,I.prototype.chain=Bte,I.prototype.commit=$te,I.prototype.next=kte,I.prototype.plant=xte,I.prototype.reverse=Hte,I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=Kte,I.prototype.first=I.prototype.head,Y1&&(I.prototype[Y1]=Fte),I},Eh=$X();Gu?((Gu.exports=Eh)._=Eh,xM._=Eh):si._=Eh}).call(l)})(xP,xP.exports);var sh=xP.exports;Object.defineProperty(kb,"__esModule",{value:!0});kb.FeedbackMoveMouseListener=void 0;const tT=z,p3e=sh,m3e=Hr,$E=it,kE=kt,AK=no,RK=Pn;class g3e extends m3e.DragAwareMouseListener{constructor(e){super(),this.tool=e,this.elementId2startPos=new Map,this.tracker=e.createChangeBoundsTracker(),this.moveInitializedFeedback=e.createFeedbackEmitter(),this.moveFeedback=e.createFeedbackEmitter()}mouseDown(e,t){return super.mouseDown(e,t),t.button===0?(this.initializeMove(e,t),[]):(this.tracker.stopTracking(),[])}initializeMove(e,t){if(e instanceof AK.GResizeHandle)return;(0,tT.findParentByFeature)(e,this.isValidMoveable)!==void 0?(this.tracker.startTracking(),this.scheduleMoveInitialized()):this.tracker.stopTracking()}scheduleMoveInitialized(){var e;(e=this.pendingMoveInitialized)===null||e===void 0||e.cancel(),this.pendingMoveInitialized=(0,p3e.debounce)(()=>{this.moveInitialized(),this.pendingMoveInitialized=void 0},750),this.pendingMoveInitialized()}moveInitializationTimeout(){return 750}moveInitialized(){this.isMouseDown&&this.moveInitializedFeedback.add(RK.MoveInitializedEventAction.create(),RK.MoveFinishedEventAction.create()).add((0,$E.cursorFeedbackAction)($E.CursorCSS.MOVE),(0,$E.cursorFeedbackAction)($E.CursorCSS.DEFAULT)).submit()}isValidMoveable(e){return!!e&&(0,kE.isNonRoutableSelectedMovableBoundsAware)(e)&&!(e instanceof AK.GResizeHandle)}nonDraggingMouseUp(e,t){return this.moveInitializedFeedback.dispose(),this.tracker.stopTracking(),[]}draggingMouseMove(e,t){return super.draggingMouseMove(e,t),this.tracker.isTracking()?this.moveElements(e,t):[]}moveElements(e,t){var i;this.elementId2startPos.size===0&&this.initializeElementsToMove(e.root);const o=this.getElementsToMove(e),r=this.tracker.moveElements(o,{snap:t,restrict:t});return r.elementMoves.length===0?[]:((i=this.pendingMoveInitialized)===null||i===void 0||i.cancel(),this.moveFeedback.add(this.createMoveAction(r),()=>this.resetElementPositions(e)),this.addMoveFeedback(r,e,t),this.tracker.updateTrackingPosition(r),this.moveFeedback.submit(),[])}createMoveAction(e){return tT.MoveAction.create(e.elementMoves.map(t=>({elementId:t.element.id,toPosition:t.toPosition})),{animate:!1})}addMoveFeedback(e,t,i){this.tool.changeBoundsManager.addMoveFeedback(this.moveFeedback,e,t,i)}initializeElementsToMove(e){this.collectElementsToMove(e).forEach(i=>this.elementId2startPos.set(i.id,i.position))}collectElementsToMove(e){const t=(0,kE.filter)(e.index,this.isValidMoveable),i=(0,kE.removeDescendants)(t);return Array.from(i)}getElementsToMove(e){return(0,kE.getElements)(e.root.index,Array.from(this.elementId2startPos.keys()),this.isValidMoveable)}resetElementPositions(e){const t=this.revertElementMoves(e);return tT.MoveAction.create(t,{animate:!1,finished:!0})}revertElementMoves(e){var t;const i=[];return!((t=e==null?void 0:e.root)===null||t===void 0)&&t.index&&this.getElementsToMove(e).forEach(r=>i.push({elementId:r.id,toPosition:this.elementId2startPos.get(r.id)})),i}draggingMouseUp(e,t){return this.tracker.isTracking()?(this.getElementsToMove(e).filter(i=>this.tool.changeBoundsManager.isValid(i)).forEach(i=>this.elementId2startPos.delete(i.id)),this.dispose(),[]):[]}dispose(){var e;(e=this.pendingMoveInitialized)===null||e===void 0||e.cancel(),this.moveInitializedFeedback.dispose(),this.moveFeedback.dispose(),this.tracker.dispose(),this.elementId2startPos.clear(),super.dispose()}}kb.FeedbackMoveMouseListener=g3e;var Fb=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},YR=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},o5;Object.defineProperty(bu,"__esModule",{value:!0});bu.ChangeBoundsListener=bu.ChangeBoundsTool=void 0;const of=F,Vi=z,v3e=Hr,MK=Yt,Wh=kt,_3e=Ro,IK=Ss,DK=no,y3e=_i,r5=Da,FE=Pn,b3e=kb;let Su=o5=class extends y3e.BaseEditTool{get id(){return o5.ID}enable(){const e=this.createMoveMouseListener();Vi.Disposable.is(e)&&this.toDisposeOnDisable.push(e);const t=this.createChangeBoundsListener();Vi.Disposable.is(t)&&this.toDisposeOnDisable.push(t),this.toDisposeOnDisable.push(this.mouseTool.registerListener(e),this.mouseTool.registerListener(t),this.selectionService.onSelectionChanged(i=>t.selectionChanged(i.root,i.selectedElements)))}createChangeBoundsTracker(){return this.changeBoundsManager.createTracker()}createMoveMouseListener(){return new b3e.FeedbackMoveMouseListener(this)}createChangeBoundsListener(){return new B9(this)}};bu.ChangeBoundsTool=Su;Su.ID="glsp.change-bounds-tool";Fb([(0,of.inject)(MK.SelectionService),YR("design:type",MK.SelectionService)],Su.prototype,"selectionService",void 0);Fb([(0,of.inject)(Vi.EdgeRouterRegistry),(0,of.optional)(),YR("design:type",Vi.EdgeRouterRegistry)],Su.prototype,"edgeRouterRegistry",void 0);Fb([(0,of.inject)(Vi.TYPES.IMovementRestrictor),(0,of.optional)(),YR("design:type",Object)],Su.prototype,"movementRestrictor",void 0);Fb([(0,of.inject)(r5.ChangeBoundsManager),YR("design:type",r5.ChangeBoundsManager)],Su.prototype,"changeBoundsManager",void 0);bu.ChangeBoundsTool=Su=o5=Fb([(0,of.injectable)()],Su);class B9 extends v3e.DragAwareMouseListener{constructor(e){super(),this.tool=e,this.tracker=e.createChangeBoundsTracker(),this.handleFeedback=e.createFeedbackEmitter(),this.resizeFeedback=e.createFeedbackEmitter()}mouseDown(e,t){return super.mouseDown(e,t),t.button!==0||e instanceof Vi.GModelRoot?[]:(this.updateResizeElement(e,t),[])}updateResizeElement(e,t){var i,o;return this.activeResizeHandle=e instanceof DK.GResizeHandle?e:void 0,this.activeResizeElement=(o=(i=this.activeResizeHandle)===null||i===void 0?void 0:i.parent)!==null&&o!==void 0?o:this.findResizeElement(e),this.activeResizeElement?(t&&this.tracker.startTracking(),this.initialBounds={newSize:this.activeResizeElement.bounds,newPosition:this.activeResizeElement.bounds,elementId:this.activeResizeElement.id},this.tool.createFeedbackEmitter().add(_3e.LocalRequestBoundsAction.create(e.root,[this.activeResizeElement.id])).submit().dispose(),this.handleFeedback.add(FE.ShowChangeBoundsToolResizeFeedbackAction.create({elementId:this.activeResizeElement.id}),FE.HideChangeBoundsToolResizeFeedbackAction.create()),this.handleFeedback.submit(),!0):(this.disposeResize(),!1)}findResizeElement(e){return(0,Vi.findParentByFeature)(e,DK.isResizable)}draggingMouseMove(e,t){if(this.activeResizeHandle&&this.tracker.isTracking()){const i=this.tracker.resizeElements(this.activeResizeHandle,{snap:t,symmetric:t,restrict:t}),o=this.resizeBoundsAction(i);o.bounds.length>0&&(this.resizeFeedback.add(o,()=>this.resetBounds()),this.tracker.updateTrackingPosition(i.handleMove.moveVector),this.addResizeFeedback(i,e,t),this.resizeFeedback.submit())}return super.draggingMouseMove(e,t)}resizeBoundsAction(e){const t=e.elementResizes.filter(i=>i.valid.size);return IK.SetBoundsFeedbackAction.create(t.map(i=>this.toElementAndBounds(i)))}toElementAndBounds(e){return{elementId:e.element.id,newSize:e.toBounds,newPosition:e.toBounds}}addResizeFeedback(e,t,i){this.tool.changeBoundsManager.addResizeFeedback(this.resizeFeedback,e,t,i)}resetBounds(){return this.initialBounds?[IK.SetBoundsFeedbackAction.create([this.initialBounds]),FE.MoveFinishedEventAction.create()]:[FE.MoveFinishedEventAction.create()]}draggingMouseUp(e,t){const i=[];return this.activeResizeHandle?i.push(...this.handleResizeOnServer(this.activeResizeHandle)):i.push(...this.handleMoveOnServer(e)),this.disposeResize({keepHandles:!0}),i}nonDraggingMouseUp(e,t){return this.disposeResize({keepHandles:!0}),super.nonDraggingMouseUp(e,t)}handleMoveOnServer(e){const t=[],i=this.getElementsToMove(e);return t.push(...this.handleMoveElementsOnServer(i)),t.push(...this.handleMoveRoutingPointsOnServer(i)),t.length>0?[Vi.CompoundOperation.create(t)]:[]}getElementsToMove(e){const t=(0,Wh.getMatchingElements)(e.index,Wh.isNonRoutableSelectedMovableBoundsAware),i=new Set(t);return t.filter(o=>this.isValidMove(o,i))}handleMoveElementsOnServer(e){const t=e.map(Wh.toElementAndBounds);return t.length>0?[Vi.ChangeBoundsOperation.create(t)]:[]}isValidMove(e,t=new Set){return this.tool.changeBoundsManager.hasValidPosition(e)&&!this.isChildOfSelected(t,e)}isChildOfSelected(e,t){if(e.size===0)return!1;for(;t instanceof Vi.GChildElement;)if(t=t.parent,e.has(t))return!0;return!1}handleMoveRoutingPointsOnServer(e){const t=[],i=this.tool.edgeRouterRegistry;return i&&e.forEach(o=>{o instanceof Vi.GConnectableElement&&(o.incomingEdges.map(r=>(0,Wh.calcElementAndRoutingPoints)(r,i)).forEach(r=>t.push(r)),o.outgoingEdges.map(r=>(0,Wh.calcElementAndRoutingPoints)(r,i)).forEach(r=>t.push(r)))}),t.length>0?[Vi.ChangeRoutingPointsOperation.create(t)]:[]}handleResizeOnServer(e){if(this.initialBounds&&this.isValidResize(e.parent)){const t=(0,Wh.toElementAndBounds)(e.parent);if(!this.initialBounds.newPosition||!t.newPosition)return[];if(!Vi.Point.equals(this.initialBounds.newPosition,t.newPosition)||!Vi.Dimension.equals(this.initialBounds.newSize,t.newSize))return this.initialBounds=void 0,[Vi.ChangeBoundsOperation.create([t])]}return[]}isValidResize(e){return this.tool.changeBoundsManager.isValid(e)}selectionChanged(e,t){if(!(this.activeResizeElement&&t.includes(this.activeResizeElement.id))){for(const i of t.reverse()){const o=e.index.getById(i);if(o&&this.updateResizeElement(o))return}this.dispose()}}isActiveResizeElement(e){return e!==void 0&&this.activeResizeElement!==void 0&&e.id===this.activeResizeElement.id}disposeResize(e={keepHandles:!1}){e.keepHandles||this.handleFeedback.dispose(),this.resizeFeedback.dispose(),this.tracker.dispose(),this.activeResizeElement=void 0,this.activeResizeHandle=void 0,this.initialBounds=void 0}dispose(){this.disposeResize(),super.dispose()}}bu.ChangeBoundsListener=B9;B9.CSS_CLASS_ACTIVE=r5.CSS_ACTIVE_HANDLE;var Mc={},S3e=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Mc,"__esModule",{value:!0});Mc.SResizeHandleView=Mc.GResizeHandleView=void 0;const xE=z,E3e=F,C3e=no;let HP=class{render(e,t){if(t.targetKind==="hidden")return;const i=this.getPosition(e);if(i!==void 0){const o=(0,xE.svg)("circle",{"class-sprotty-resize-handle":!0,"class-mouseover":e.hoverFeedback,cx:i.x,cy:i.y,r:this.getRadius()});return(0,xE.setAttr)(o,"data-kind",e.location),o}return(0,xE.svg)("g",null)}getPosition(e){return xE.Point.subtract(C3e.GResizeHandle.getHandlePosition(e),e.parent.bounds)}getRadius(){return 7}};Mc.GResizeHandleView=HP;Mc.SResizeHandleView=HP;Mc.SResizeHandleView=Mc.GResizeHandleView=HP=S3e([(0,E3e.injectable)()],HP);Object.defineProperty(jb,"__esModule",{value:!0});jb.changeBoundsToolModule=void 0;const Zh=z,P3e=no,w3e=Da,A3e=bu,TK=Pn,R3e=Mc;jb.changeBoundsToolModule=new Zh.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};n(w3e.ChangeBoundsManager).toSelf().inSingletonScope(),(0,Zh.bindAsService)(o,Zh.TYPES.IDefaultTool,A3e.ChangeBoundsTool),(0,Zh.configureCommand)(o,TK.ShowChangeBoundsToolResizeFeedbackCommand),(0,Zh.configureCommand)(o,TK.HideChangeBoundsToolResizeFeedbackCommand),(0,Zh.configureView)(o,P3e.GResizeHandle.TYPE,R3e.GResizeHandleView)},{featureId:Symbol("changeBoundsTool")});var xb={};Object.defineProperty(xb,"__esModule",{value:!0});xb.deletionToolModule=void 0;const Iv=z,OK=mi;xb.deletionToolModule=new Iv.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,Iv.bindAsService)(o,Iv.TYPES.IDefaultTool,OK.DelKeyDeleteTool),(0,Iv.bindAsService)(o,Iv.TYPES.ITool,OK.MouseDeleteTool)},{featureId:Symbol("deletionTool")});var Hb={};Object.defineProperty(Hb,"__esModule",{value:!0});Hb.edgeCreationToolModule=void 0;const Dv=z,M3e=Yc,LK=Sc;Hb.edgeCreationToolModule=new Dv.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,Dv.bindAsService)(o,Dv.TYPES.ITool,LK.EdgeCreationTool),(0,Dv.configureActionHandler)(o,Dv.TriggerEdgeCreationAction.KIND,LK.EdgeCreationTool),(0,M3e.configureDanglingFeedbackEdge)(o)},{featureId:Symbol("edgeCreationTool")});var Kb={},Eu={},mt={},qR=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},WR=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},ZR=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(mt,"__esModule",{value:!0});mt.drawFeedbackEdgeSource=mt.FeedbackEdgeRouteMovingMouseListener=mt.FeedbackEdgeSourceMovingMouseListener=mt.FeedbackEdgeTargetMovingMouseListener=mt.DrawFeedbackEdgeSourceCommand=mt.DrawFeedbackEdgeSourceAction=mt.SwitchRoutingModeCommand=mt.SwitchRoutingModeAction=mt.HideEdgeReconnectHandlesFeedbackCommand=mt.ShowEdgeReconnectHandlesFeedbackCommand=mt.HideEdgeReconnectHandlesFeedbackAction=mt.ShowEdgeReconnectHandlesFeedbackAction=void 0;const pt=z,Cu=F,I3e=Hr,$9=Gn,Qs=kt,NK=Ct,s5=_b,jK=UR,C_=Yc,D3e=s1;var a5;(function(n){n.KIND="showReconnectHandlesFeedback";function e(i){return pt.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,elementId:i}}n.create=t})(a5||(mt.ShowEdgeReconnectHandlesFeedbackAction=a5={}));var c5;(function(n){n.KIND="hideReconnectHandlesFeedback";function e(i){return pt.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(c5||(mt.HideEdgeReconnectHandlesFeedbackAction=c5={}));let KP=class extends $9.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){const t=e.root.index;(0,Qs.forEachElement)(t,Qs.isRoutable,s5.removeReconnectHandles);const i=t.getById(this.action.elementId);return i&&(0,Qs.isRoutable)(i)&&(0,s5.addReconnectHandles)(i),e.root}};mt.ShowEdgeReconnectHandlesFeedbackCommand=KP;KP.KIND=a5.KIND;mt.ShowEdgeReconnectHandlesFeedbackCommand=KP=qR([(0,Cu.injectable)(),ZR(0,(0,Cu.inject)(pt.TYPES.Action)),WR("design:paramtypes",[Object])],KP);let VP=class extends $9.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){const t=e.root.index;return(0,Qs.forEachElement)(t,Qs.isRoutable,s5.removeReconnectHandles),e.root}};mt.HideEdgeReconnectHandlesFeedbackCommand=VP;VP.KIND=c5.KIND;mt.HideEdgeReconnectHandlesFeedbackCommand=VP=qR([(0,Cu.injectable)(),ZR(0,(0,Cu.inject)(pt.TYPES.Action)),WR("design:paramtypes",[Object])],VP);var zP;(function(n){n.KIND="switchRoutingMode";function e(t){return{...pt.SwitchEditModeAction.create(t),kind:n.KIND}}n.create=e})(zP||(mt.SwitchRoutingModeAction=zP={}));let GP=class extends pt.SwitchEditModeCommand{constructor(e){super({...e,kind:pt.SwitchEditModeAction.KIND})}};mt.SwitchRoutingModeCommand=GP;GP.KIND=zP.KIND;mt.SwitchRoutingModeCommand=GP=qR([(0,Cu.injectable)(),ZR(0,(0,Cu.inject)(pt.TYPES.Action)),WR("design:paramtypes",[Object])],GP);var d5;(function(n){n.KIND="drawFeedbackEdgeSource";function e(i){return pt.Action.hasKind(i,n.KIND)&&(0,pt.hasStringProp)(i,"elementTypeId")&&(0,pt.hasStringProp)(i,"targetId")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(d5||(mt.DrawFeedbackEdgeSourceAction=d5={}));let UP=class extends $9.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return fW(e,this.action.targetId,this.action.elementTypeId),e.root}};mt.DrawFeedbackEdgeSourceCommand=UP;UP.KIND=d5.KIND;mt.DrawFeedbackEdgeSourceCommand=UP=qR([(0,Cu.injectable)(),ZR(0,(0,Cu.inject)(pt.TYPES.Action)),WR("design:paramtypes",[Object])],UP);class T3e extends D3e.FeedbackEdgeEndMovingMouseListener{constructor(e,t){super(e,t)}}mt.FeedbackEdgeTargetMovingMouseListener=T3e;class O3e extends pt.MouseListener{constructor(e,t){super(),this.anchorRegistry=e,this.feedbackDispatcher=t,this.feedback=t.createEmitter()}mouseMove(e,t){const i=e.root,o=i.index.getById((0,C_.feedbackEdgeEndId)(i));if(!(o instanceof C_.FeedbackEdgeEnd)||!o.feedbackEdge)return[];const r=o.feedbackEdge,s=(0,NK.getAbsolutePosition)(o,t),a=(0,pt.findChildrenAtPosition)(e.root,s).find(f=>(0,pt.isConnectable)(f)&&f.canConnect(r,"source"));if(a instanceof pt.GConnectableElement&&r.target&&(0,pt.isBoundsAware)(r.target)){const f=this.computeAbsoluteAnchor(a,pt.Bounds.center(r.target.bounds));pt.Point.euclideanDistance(f,o.position)>1&&this.feedback.add(pt.MoveAction.create([{elementId:o.id,toPosition:f}],{animate:!1})).submit()}else this.feedback.add(pt.MoveAction.create([{elementId:o.id,toPosition:s}],{animate:!1})).submit();return[]}computeAbsoluteAnchor(e,t,i){let r=this.anchorRegistry.get(pt.PolylineEdgeRouter.KIND,e.anchorKind).getAnchor(e,t,i);if(e.parent!==e.root){const s=(0,pt.findParentByFeature)(e.parent,pt.isBoundsAware);if(s){const a=(0,NK.toAbsoluteBounds)(s);r=pt.Point.add(a,r)}}return r}dispose(){this.feedback.dispose()}}mt.FeedbackEdgeSourceMovingMouseListener=O3e;class L3e extends I3e.DragAwareMouseListener{constructor(e,t){super(),this.changeBoundsManager=e,this.edgeRouterRegistry=t,this.tracker=this.changeBoundsManager.createTracker()}mouseDown(e,t){const i=super.mouseDown(e,t);return t.button===0&&((0,pt.findParentByFeature)(e,Qs.isRoutingHandle)!==void 0?(i.push(zP.create({elementsToActivate:[e.id]})),this.tracker.startTracking()):this.tracker.dispose()),i}draggingMouseMove(e,t){return super.draggingMouseMove(e,t),this.tracker.isTracking()?this.moveRoutingHandles(e,t):[]}moveRoutingHandles(e,t){const i=this.getRoutingHandlesToMove(e),o=this.tracker.moveElements(i,{snap:t,restrict:t});return o.elementMoves.length===0?[]:(this.tracker.updateTrackingPosition(o),[pt.MoveAction.create(o.elementMoves.map(r=>({elementId:r.element.id,toPosition:r.toPosition})),{animate:!1})])}getRoutingHandlesToMove(e){return(0,Qs.getMatchingElements)(e.root.index,(0,pt.typeGuard)(Qs.isRoutingHandle,pt.isSelected)).map(i=>{const o=this.getHandlePosition(i);return o?new jK.MoveableRoutingHandle(i,o):void 0}).filter((0,pt.toTypeGuard)(jK.MoveableRoutingHandle))}getHandlePosition(e){if(this.edgeRouterRegistry){const t=e.parent;if(!(0,Qs.isRoutable)(t))return;const i=this.edgeRouterRegistry.get(t.routerKind),o=i.route(t);return i.getHandlePosition(t,o,e)}}nonDraggingMouseUp(e,t){return this.tracker.stopTracking(),[]}draggingMouseUp(e,t){return this.tracker.isTracking()?(this.dispose(),[]):[]}dispose(){this.tracker.dispose(),super.dispose()}}mt.FeedbackEdgeRouteMovingMouseListener=L3e;function fW(n,e,t){const i=n.root,o=i.index.getById(e);if(!o)return;const r=(0,pt.findParentByFeature)(o,pt.isConnectable);if(!r||!(0,pt.isBoundsAware)(r))return;const s=new C_.FeedbackEdgeEnd(r.id,t);s.id=(0,C_.feedbackEdgeEndId)(i),s.position={x:r.bounds.x,y:r.bounds.y};const a={type:"edge",id:(0,C_.feedbackEdgeId)(i),sourceId:s.id,targetId:r.id,opacity:.3},f=n.modelFactory.createElement(a);(0,Qs.isRoutable)(f)&&(s.feedbackEdge=f,i.add(s),i.add(f))}mt.drawFeedbackEdgeSource=fW;var Vb=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},QR=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},u5;Object.defineProperty(Eu,"__esModule",{value:!0});Eu.EdgeEditListener=Eu.EdgeEditTool=void 0;const Ki=z,bm=F,N3e=Hr,yr=it,BK=Yt,Tv=kt,HE=_b,j3e=_i,$K=Da,KE=Yc,Dd=mt;let Pu=u5=class extends j3e.BaseEditTool{get id(){return u5.ID}enable(){this.edgeEditListener=new hW(this),this.feedbackEdgeSourceMovingListener=new Dd.FeedbackEdgeSourceMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher),this.feedbackEdgeTargetMovingListener=new Dd.FeedbackEdgeTargetMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher),this.feedbackMovingListener=new Dd.FeedbackEdgeRouteMovingMouseListener(this.changeBoundsManager,this.edgeRouterRegistry),this.toDisposeOnDisable.push(this.edgeEditListener,this.mouseTool.registerListener(this.edgeEditListener),this.feedbackEdgeSourceMovingListener,this.feedbackEdgeTargetMovingListener,this.feedbackMovingListener,this.selectionService.onSelectionChanged(e=>this.edgeEditListener.selectionChanged(e.root,e.selectedElements)))}registerFeedbackListeners(){this.mouseTool.register(this.feedbackMovingListener),this.mouseTool.register(this.feedbackEdgeSourceMovingListener),this.mouseTool.register(this.feedbackEdgeTargetMovingListener)}deregisterFeedbackListeners(){this.feedbackEdgeSourceMovingListener.dispose(),this.feedbackEdgeTargetMovingListener.dispose(),this.mouseTool.deregister(this.feedbackEdgeSourceMovingListener),this.mouseTool.deregister(this.feedbackEdgeTargetMovingListener),this.mouseTool.deregister(this.feedbackMovingListener)}};Eu.EdgeEditTool=Pu;Pu.ID="glsp.edge-edit-tool";Vb([(0,bm.inject)(BK.SelectionService),QR("design:type",BK.SelectionService)],Pu.prototype,"selectionService",void 0);Vb([(0,bm.inject)(Ki.AnchorComputerRegistry),QR("design:type",Ki.AnchorComputerRegistry)],Pu.prototype,"anchorRegistry",void 0);Vb([(0,bm.inject)(Ki.EdgeRouterRegistry),(0,bm.optional)(),QR("design:type",Ki.EdgeRouterRegistry)],Pu.prototype,"edgeRouterRegistry",void 0);Vb([(0,bm.inject)($K.ChangeBoundsManager),QR("design:type",$K.ChangeBoundsManager)],Pu.prototype,"changeBoundsManager",void 0);Eu.EdgeEditTool=Pu=u5=Vb([(0,bm.injectable)()],Pu);class hW extends N3e.DragAwareMouseListener{constructor(e){super(),this.tool=e,this.cursorFeedback=this.tool.createFeedbackEmitter(),this.editFeedback=this.tool.createFeedbackEmitter()}isValidEdge(e){return e!==void 0&&e.id!==(0,KE.feedbackEdgeId)(e.root)&&(0,Ki.isSelected)(e)}setEdgeSelected(e){this.edge=e,(0,Ki.canEditRouting)(e)&&this.editFeedback.add(Dd.SwitchRoutingModeAction.create({elementsToActivate:[this.edge.id]}),Dd.SwitchRoutingModeAction.create({elementsToDeactivate:[this.edge.id]})),(0,HE.isReconnectable)(e)&&this.editFeedback.add(Dd.ShowEdgeReconnectHandlesFeedbackAction.create(this.edge.id),Dd.HideEdgeReconnectHandlesFeedbackAction.create()),this.editFeedback.submit()}isEdgeSelected(){return this.edge!==void 0&&(0,Ki.isSelected)(this.edge)}setReconnectHandleSelected(e,t){this.edge&&this.edge.target&&this.edge.source&&(this.editFeedback.dispose(),(0,HE.isSourceRoutingHandle)(e,t)?(this.editFeedback.add((0,yr.cursorFeedbackAction)(yr.CursorCSS.EDGE_RECONNECT),(0,yr.cursorFeedbackAction)()).add(Dd.DrawFeedbackEdgeSourceAction.create({elementTypeId:this.edge.type,targetId:this.edge.targetId}),KE.RemoveFeedbackEdgeAction.create()).submit(),this.reconnectMode="NEW_SOURCE"):(0,HE.isTargetRoutingHandle)(e,t)&&(this.editFeedback.add((0,yr.cursorFeedbackAction)(yr.CursorCSS.EDGE_CREATION_TARGET),(0,yr.cursorFeedbackAction)()).add(KE.DrawFeedbackEdgeAction.create({elementTypeId:this.edge.type,sourceId:this.edge.sourceId}),KE.RemoveFeedbackEdgeAction.create()).submit(),this.reconnectMode="NEW_TARGET"))}isReconnecting(){return this.reconnectMode!==void 0}isReconnectingNewSource(){return this.reconnectMode==="NEW_SOURCE"}setRoutingHandleSelected(e,t){this.edge&&this.edge.target&&this.edge.source&&(this.routingHandle=t)}requiresReconnect(e,t){return this.edge!==void 0&&(this.edge.sourceId!==e||this.edge.targetId!==t)}setNewConnectable(e){this.newConnectable=e}isReadyToReconnect(){return this.edge&&this.isReconnecting()&&this.newConnectable!==void 0}isReadyToReroute(){return this.routingHandle!==void 0}mouseDown(e,t){const i=super.mouseDown(e,t);if(t.button===0){const o=(0,Ki.findParentByFeature)(e,HE.isReconnectHandle),r=o?void 0:(0,Ki.findParentByFeature)(e,Tv.isRoutingHandle),s=(0,Ki.findParentByFeature)(e,Tv.isRoutable);this.isEdgeSelected()&&s&&o?this.setReconnectHandleSelected(s,o):this.isEdgeSelected()&&s&&r?this.setRoutingHandleSelected(s,r):this.isValidEdge(s)&&(this.dispose(),this.tool.registerFeedbackListeners(),this.setEdgeSelected(s))}else t.button===2&&this.dispose();return i}draggingMouseMove(e,t){return this.setNewConnectable(void 0),super.draggingMouseMove(e,t)}mouseUp(e,t){const i=super.mouseUp(e,t);if(!this.isReadyToReconnect()&&!this.isReadyToReroute())return i;if(this.edge&&this.newConnectable){const o=this.isReconnectingNewSource()?this.newConnectable.id:this.edge.sourceId,r=this.isReconnectingNewSource()?this.edge.targetId:this.newConnectable.id;this.requiresReconnect(o,r)&&i.push(Ki.ReconnectEdgeOperation.create({edgeElementId:this.edge.id,sourceElementId:o,targetElementId:r})),this.dispose()}else if(this.edge&&this.routingHandle){const o=e.index.getById(this.edge.id);if(o&&(0,Tv.isRoutable)(o)){const r=(0,Tv.calcElementAndRoutingPoints)(o,this.tool.edgeRouterRegistry);i.push(Ki.ChangeRoutingPointsOperation.create([r])),this.routingHandle=void 0}}return i}mouseOver(e,t){if(this.edge&&this.isReconnecting()){const i=(0,Ki.findParentByFeature)(e,Ki.isConnectable);if(!this.newConnectable||i!==this.newConnectable){if(this.setNewConnectable(i),i&&(this.reconnectMode==="NEW_SOURCE"&&i.canConnect(this.edge,"source")||this.reconnectMode==="NEW_TARGET"&&i.canConnect(this.edge,"target")))return this.cursorFeedback.add((0,yr.cursorFeedbackAction)(yr.CursorCSS.EDGE_RECONNECT),(0,yr.cursorFeedbackAction)()).submit(),[];this.cursorFeedback.add((0,yr.cursorFeedbackAction)(yr.CursorCSS.OPERATION_NOT_ALLOWED),(0,yr.cursorFeedbackAction)()).submit()}}return[]}selectionChanged(e,t){if(this.edge){if(t.indexOf(this.edge.id)>-1||this.isReconnecting())return;for(const i of t.reverse()){const o=e.index.getById(i);if(o){const r=(0,Ki.findParentByFeature)(o,Tv.isRoutable);if(this.isValidEdge(r)){this.setEdgeSelected(r);return}}}this.dispose()}}dispose(){this.edge=void 0,this.reconnectMode=void 0,this.newConnectable=void 0,this.routingHandle=void 0,this.cursorFeedback.dispose(),this.editFeedback.dispose(),this.tool.deregisterFeedbackListeners(),super.dispose()}}Eu.EdgeEditListener=hW;Object.defineProperty(Kb,"__esModule",{value:!0});Kb.edgeEditToolModule=void 0;const sl=z,B3e=Yc,$3e=Eu,VE=mt;Kb.edgeEditToolModule=new sl.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,sl.bindAsService)(o,sl.TYPES.IDefaultTool,$3e.EdgeEditTool),(0,sl.configureCommand)(o,VE.ShowEdgeReconnectHandlesFeedbackCommand),(0,sl.configureCommand)(o,VE.HideEdgeReconnectHandlesFeedbackCommand),(0,sl.configureCommand)(o,VE.DrawFeedbackEdgeSourceCommand),(0,sl.configureCommand)(o,VE.SwitchRoutingModeCommand),(0,B3e.configureDanglingFeedbackEdge)(o)},{featureId:Symbol("edgeEditTool")});var zb={},Ic={},k9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},pW=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},l5;Object.defineProperty(Ic,"__esModule",{value:!0});Ic.MarqueeKeyListener=Ic.MarqueeTool=void 0;const k3e=z,F9=F,f5=Yt,F3e=It,x3e=_i,H3e=Ji;let $y=l5=class extends x3e.BaseEditTool{get id(){return l5.ID}enable(){this.marqueeKeyListener||(this.marqueeKeyListener=new YP(this.selectionService)),this.toDisposeOnDisable.push(this.keyTool.registerListener(this.marqueeKeyListener))}};Ic.MarqueeTool=$y;$y.ID="glsp.marquee-tool";k9([(0,F9.inject)(f5.SelectionService),pW("design:type",f5.SelectionService)],$y.prototype,"selectionService",void 0);Ic.MarqueeTool=$y=l5=k9([(0,F9.injectable)()],$y);let YP=class extends k3e.KeyListener{constructor(e){super(),this.selectionService=e}keyDown(e,t){return t.shiftKey&&!this.selectionService.hasSelectedElements()?[F3e.EnableToolsAction.create([H3e.MarqueeMouseTool.ID])]:[]}};Ic.MarqueeKeyListener=YP;Ic.MarqueeKeyListener=YP=k9([(0,F9.injectable)(),pW("design:paramtypes",[f5.SelectionService])],YP);var Gb={};Object.defineProperty(Gb,"__esModule",{value:!0});Gb.MarqueeNode=void 0;const mW=z;class gW extends mW.RectangularNode{}Gb.MarqueeNode=gW;gW.DEFAULT_FEATURES=[mW.boundsFeature];var v1={},K3e=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(v1,"__esModule",{value:!0});v1.MarqueeView=void 0;const nT=z,V3e=F;let h5=class extends nT.RectangularNodeView{render(e,t){return(0,nT.svg)("g",null,(0,nT.svg)("rect",{"class-sprotty-node":!0,"class-marquee":!0,x:e.startPoint.x-e.endPoint.x<=0?e.startPoint.x:e.endPoint.x,y:e.startPoint.y-e.endPoint.y<=0?e.startPoint.y:e.endPoint.y,rx:0,ry:0,width:Math.abs(e.startPoint.x-e.endPoint.x),height:Math.abs(e.startPoint.y-e.endPoint.y)}))}};v1.MarqueeView=h5;v1.MarqueeView=h5=K3e([(0,V3e.injectable)()],h5);Object.defineProperty(zb,"__esModule",{value:!0});zb.marqueeSelectionToolModule=void 0;const hd=z,z3e=Ji,G3e=Ic,iT=Nb,U3e=Gb,Y3e=v1,q3e=oh;zb.marqueeSelectionToolModule=new hd.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};o.bind(q3e.MarqueeUtil).toSelf().inSingletonScope(),(0,hd.bindAsService)(o,hd.TYPES.IDefaultTool,G3e.MarqueeTool),(0,hd.bindAsService)(o,hd.TYPES.ITool,z3e.MarqueeMouseTool),(0,hd.configureCommand)(o,iT.DrawMarqueeCommand),(0,hd.configureCommand)(o,iT.RemoveMarqueeCommand),(0,hd.configureModelElement)(o,iT.MARQUEE,U3e.MarqueeNode,Y3e.MarqueeView)},{featureId:Symbol("marqueeSelectionTool")});var Ub={},XR={};(function(n){var e=l&&l.__decorate||function(h,g,y,S){var P=arguments.length,w=P<3?g:S===null?S=Object.getOwnPropertyDescriptor(g,y):S,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(h,g,y,S);else for(var E=h.length-1;E>=0;E--)(C=h[E])&&(w=(P<3?C(w):P>3?C(g,y,w):C(g,y))||w);return P>3&&w&&Object.defineProperty(g,y,w),w},t=l&&l.__metadata||function(h,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,g)};Object.defineProperty(n,"__esModule",{value:!0}),n.ContainerManager=n.DEFAULT_INSERT_OPTIONS=void 0;const i=z,o=F,r=it,s=n1,a=Da;n.DEFAULT_INSERT_OPTIONS={validateLocationInContainer:!1};let f=class{insert(g,y,S,P){var w;const C={...n.DEFAULT_INSERT_OPTIONS,...P},E=this.findContainer(y,g,P==null?void 0:P.evt);let D=!E||E.isContainableElement(S);return D&&(!E||C.validateLocationInContainer)&&(D=(w=P==null?void 0:P.validLocationOverwrite)!==null&&w!==void 0?w:this.changeBoundsManager.hasValidPosition(g,y)),{elementTypeId:S,container:E,location:y,valid:D,options:C}}findContainer(g,y,S){return(0,i.findChildrenAtPosition)(y.root,g).reverse().find(P=>{var w;return(0,s.isContainable)(P)&&!(!((w=P.cssClasses)===null||w===void 0)&&w.includes(r.CSS_GHOST_ELEMENT))})}addInsertFeedback(g,y,S,P){return y.valid?g.add((0,r.cursorFeedbackAction)(r.CursorCSS.NODE_CREATION),(0,r.cursorFeedbackAction)()):g.add((0,r.cursorFeedbackAction)(r.CursorCSS.OPERATION_NOT_ALLOWED),(0,r.cursorFeedbackAction)(r.CursorCSS.DEFAULT)),g}};n.ContainerManager=f,e([(0,o.inject)(a.ChangeBoundsManager),t("design:type",a.ChangeBoundsManager)],f.prototype,"changeBoundsManager",void 0),n.ContainerManager=f=e([(0,o.injectable)()],f)})(XR);var ia={},Yb={};Object.defineProperty(Yb,"__esModule",{value:!0});Yb.MouseTrackingElementPositionListener=void 0;const Qh=z,W3e=Hr,kK=it,Z3e=Ct,Q3e=Pn;class X3e extends W3e.DragAwareMouseListener{constructor(e,t,i="top-left",o){super(),this.elementId=e,this.tool=t,this.cursorPosition=i,this.editorContext=o,this.toDispose=new Qh.DisposableCollection,this.tracker=this.tool.changeBoundsManager.createTracker(),this.moveGhostFeedback=this.tool.createFeedbackEmitter(),this.toDispose.push(this.moveGhostFeedback);const r=o==null?void 0:o.onModelRootChanged(s=>this.modelRootChanged(s));r&&this.toDispose.push(r)}getTrackedElement(e,t){const i=e.root.index.getById(this.elementId);return!i||!(0,Qh.isMoveable)(i)?void 0:i}mouseMove(e,t){super.mouseMove(e,t);const i=this.getTrackedElement(e,t);if(!i)return[];const o=!this.tracker.isTracking();o&&this.initialize(i,e,t);const r=this.tracker.moveElements([i],{snap:t,restrict:t,skipStatic:!o}),s=r.elementMoves[0];return s?(this.moveGhostFeedback.add(Qh.MoveAction.create([{elementId:this.elementId,toPosition:s.toPosition}],{animate:!1}),Q3e.MoveFinishedEventAction.create()),this.addMoveFeedback(r,e,t),this.moveGhostFeedback.submit(),this.tracker.updateTrackingPosition(s.moveVector),[]):[]}initialize(e,t,i){this.tracker.startTracking(),e.position=this.initializeElementPosition(e,t,i)}initializeElementPosition(e,t,i){const o=(0,Z3e.getAbsolutePosition)(t,i);return this.cursorPosition==="middle"&&(0,Qh.isBoundsAware)(e)?Qh.Point.subtract(o,Qh.Dimension.center(e.bounds)):o}addMoveFeedback(e,t,i){this.moveGhostFeedback.add(kK.ModifyCSSFeedbackAction.create({elements:[this.elementId],remove:[kK.CSS_HIDDEN]})),this.tool.changeBoundsManager.addMoveFeedback(this.moveGhostFeedback,e,t,i)}modelRootChanged(e){this.tracker.stopTracking()}dispose(){this.toDispose.dispose(),super.dispose()}}Yb.MouseTrackingElementPositionListener=X3e;var JR=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},x9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},p5;Object.defineProperty(ia,"__esModule",{value:!0});ia.NodeCreationToolMouseListener=ia.NodeInsertTrackingListener=ia.NodeCreationTool=void 0;const ts=z,eM=F,J3e=Hr,P_=it,eCe=It,R3=_o,tCe=Yb,nCe=bc,iCe=_i,FK=Da,xK=XR,oCe=p1;let rf=p5=class extends iCe.BaseCreationTool{constructor(){super(...arguments),this.isTriggerAction=ts.TriggerNodeCreationAction.is}get id(){return p5.ID}doEnable(){var e;const t=(e=this.triggerAction.ghostElement)!==null&&e!==void 0?e:{template:this.modelFactory.createSchema(this.createInsertIndicator())};this.toDisposeOnDisable.push(this.createGhostElementTracker(t,"middle")),this.toDisposeOnDisable.push(this.createNodeCreationListener(t)),this.toDisposeOnDisable.push(this.createNodeCreationCursorFeedback().submit())}createInsertIndicator(){return new oCe.InsertIndicator}createGhostElementTracker(e,t){const i=new vW((0,R3.getTemplateElementId)(e.template),this.triggerAction.elementTypeId,this,t,this.editorContext);return new ts.DisposableCollection(i,this.mouseTool.registerListener(i))}createNodeCreationListener(e){const t=new _W(this.triggerAction,this,e);return new ts.DisposableCollection(t,this.mouseTool.registerListener(t))}createNodeCreationCursorFeedback(){return this.createFeedbackEmitter().add((0,P_.cursorFeedbackAction)(P_.CursorCSS.NODE_CREATION),(0,P_.cursorFeedbackAction)())}};ia.NodeCreationTool=rf;rf.ID="tool_create_node";JR([(0,eM.inject)(FK.ChangeBoundsManager),x9("design:type",FK.ChangeBoundsManager)],rf.prototype,"changeBoundsManager",void 0);JR([(0,eM.inject)(xK.ContainerManager),x9("design:type",xK.ContainerManager)],rf.prototype,"containerManager",void 0);JR([(0,eM.inject)(ts.TYPES.IModelFactory),x9("design:type",Object)],rf.prototype,"modelFactory",void 0);ia.NodeCreationTool=rf=p5=JR([(0,eM.injectable)()],rf);class vW extends tCe.MouseTrackingElementPositionListener{constructor(e,t,i,o="top-left",r){super(e,i,o,r),this.elementTypeId=t,this.tool=i}addMoveFeedback(e,t,i){super.addMoveFeedback(e,t,i);const o=e.elementMoves[0].element,r=e.elementMoves[0].toPosition,s=this.tool.containerManager.insert(o,r,this.elementTypeId,{evt:i});this.tool.containerManager.addInsertFeedback(this.moveGhostFeedback,s,t,i)}}ia.NodeInsertTrackingListener=vW;class _W extends J3e.DragAwareMouseListener{constructor(e,t,i){super(),this.triggerAction=e,this.tool=t,this.ghostElement=i,this.cursorFeedback=t.createFeedbackEmitter(),this.ghostElementFeedback=t.createFeedbackEmitter(),this.ghostElementId=(0,R3.getTemplateElementId)(i.template),this.createGhostElement(i)}get elementTypeId(){return this.triggerAction.elementTypeId}nonDraggingMouseUp(e,t){const i=[],o=this.getTrackedInsert(e,t);return o.valid&&i.push(this.getCreateOperation(e,t,o)),this.isContinuousMode(e,t)?(this.disposeAllButGhostElement(),i):(o.valid?this.ghostElementFeedback.discard():this.dispose(),i.push(eCe.EnableDefaultToolsAction.create()),i)}isContinuousMode(e,t){return(0,ts.isCtrlOrCmd)(t)}getCreateOperation(e,t,i){var o;return ts.CreateNodeOperation.create(this.elementTypeId,{location:i.location,containerId:(o=i.container)===null||o===void 0?void 0:o.id,args:this.getCreateNodeOperationArgs(i,e,t)})}getCreateNodeOperationArgs(e,t,i){let o={...this.triggerAction.args};const r=this.getGhostElement(t,i);if(r){const s=(0,ts.isBoundsAware)(r)?ts.Bounds.dimension(r.bounds):ts.Dimension.ZERO;o={...o,"ghost-x":r.position.x,"ghost-y":r.position.y,"ghost-width":s.width,"ghost-height":s.height}}return o}createGhostElement(e){const t=[e.template];return this.ghostElementFeedback.add(R3.AddTemplateElementsAction.create({templates:t,addClasses:[P_.CSS_HIDDEN,P_.CSS_GHOST_ELEMENT]}),nCe.RemoveTemplateElementsAction.create({templates:t})),this.ghostElementFeedback.submit(),(0,R3.getTemplateElementId)(e.template)}getGhostElement(e,t){const i=e.index.getById(this.ghostElementId);return i&&(0,ts.isMoveable)(i)?i:void 0}getTrackedInsert(e,t){const i=this.getGhostElement(e,t);return i?this.tool.containerManager.insert(i,i.position,this.elementTypeId,{evt:t}):{elementTypeId:this.elementTypeId,location:ts.Point.ORIGIN,valid:!1,options:{evt:t}}}disposeAllButGhostElement(){super.dispose()}dispose(){this.ghostElementFeedback.dispose(),this.disposeAllButGhostElement()}}ia.NodeCreationToolMouseListener=_W;var _1={},ls={};Object.defineProperty(ls,"__esModule",{value:!0});ls.CornerRadius=ls.EdgePadding=ls.GArgument=void 0;const Ov=Ig;var ky;(function(n){function e(E){return typeof E=="number"?E:void 0}n.asNumber=e;function t(E){return E.map(e)}n.asNumbers=t;function i(E){return typeof E=="string"?E:void 0}n.asString=i;function o(E){return E.map(i)}n.asStrings=o;function r(E){return typeof E=="boolean"?E:void 0}n.asBoolean=r;function s(E){return E.map(r)}n.asBooleans=s;function a(E,D){return(0,Ov.hasArgs)(E)?E.args[D]:void 0}n.getArgument=a;function f(E,D){return(0,Ov.hasArgs)(E)?e(E.args[D]):void 0}n.getNumber=f;function h(E,D){return(0,Ov.hasArgs)(E)?i(E.args[D]):void 0}n.getString=h;function g(E,D){return(0,Ov.hasArgs)(E)?r(E.args[D]):void 0}n.getBoolean=g;function y(E,...D){if(!(0,Ov.hasArgs)(E))return;const j=[];for(const U of D){const p=E.args[U];p&&j.push(p)}return j}n.getArguments=y;function S(E,...D){const j=y(E,...D);return j?t(j):void 0}n.getNumbers=S;function P(E,...D){const j=y(E,...D);return j?o(j):void 0}n.getStrings=P;function w(E,...D){const j=y(E,...D);return j?s(j):void 0}n.getBooleans=w;function C(E,D){return E.length===D&&E.filter(j=>j===void 0).length===0}n.hasNValues=C})(ky||(ls.GArgument=ky={}));var HK;(function(n){const e="edgePadding";function t(i){return ky.getNumber(i,e)}n.from=t})(HK||(ls.EdgePadding=HK={}));class ha{constructor(e=0,t=e,i=e,o=t){this.topLeft=e,this.topRight=t,this.bottomRight=i,this.bottomLeft=o}static from(e){const t=ky.getNumbers(e,this.KEY_RADIUS_TOP_LEFT,this.KEY_RADIUS_TOP_RIGHT,this.KEY_RADIUS_BOTTOM_RIGHT,this.KEY_RADIUS_BOTTOM_LEFT);if(!(t===void 0||t[0]===void 0))return ky.hasNValues(t,4)?new ha(t[0],t[1],t[2],t[3]):new ha(t[0])}}ls.CornerRadius=ha;ha.NO_RADIUS=new ha(0);ha.KEY_RADIUS_TOP_LEFT="radiusTopLeft";ha.KEY_RADIUS_TOP_RIGHT="radiusTopRight";ha.KEY_RADIUS_BOTTOM_RIGHT="radiusBottomRight";ha.KEY_RADIUS_BOTTOM_LEFT="radiusBottomLeft";var yW=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},rCe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(_1,"__esModule",{value:!0});_1.InsertIndicatorView=void 0;const Qv=z,m5=F,sCe=ls,aCe=p1;let qP=class{render(e,t){if(t.targetKind==="hidden")return;const i=this.getSize(e),o=(0,Qv.svg)("g",null,(0,Qv.svg)("polyline",{"class-sprotty-node":!0,"class-insert-indicator":!0,points:`0,${-i/2} 0,${i/2}`}),(0,Qv.svg)("polyline",{"class-sprotty-node":!0,"class-insert-indicator":!0,points:`${-i/2},0 ${i/2},0`}));return e.cssClasses.forEach(r=>(0,Qv.setClass)(o,r,!0)),o}getSize(e){var t,i,o;return(o=(t=sCe.GArgument.getNumber(e,aCe.ARG_LENGTH))!==null&&t!==void 0?t:(i=this.grid)===null||i===void 0?void 0:i.x)!==null&&o!==void 0?o:10}};_1.InsertIndicatorView=qP;yW([(0,m5.optional)(),(0,m5.inject)(Qv.TYPES.Grid),rCe("design:type",Object)],qP.prototype,"grid",void 0);_1.InsertIndicatorView=qP=yW([(0,m5.injectable)()],qP);Object.defineProperty(Ub,"__esModule",{value:!0});Ub.nodeCreationToolModule=void 0;const Xh=z,cCe=Jg,dCe=XR,KK=p1,VK=ia,uCe=_1;Ub.nodeCreationToolModule=new Xh.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};n(dCe.ContainerManager).toSelf().inSingletonScope(),(0,Xh.bindAsService)(o,Xh.TYPES.ITool,VK.NodeCreationTool),(0,Xh.configureActionHandler)(o,Xh.TriggerNodeCreationAction.KIND,VK.NodeCreationTool),(0,Xh.configureModelElement)(o,KK.InsertIndicator.TYPE,KK.InsertIndicator,uCe.InsertIndicatorView)},{featureId:Symbol("nodeCreationTool"),requires:cCe.elementTemplateModule});var wu={},lCe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(wu,"__esModule",{value:!0});wu.toolFocusLossModule=wu.EnableDefaultToolsOnFocusLossHandler=void 0;const zK=z,fCe=F,bW=Ma,hCe=It;let WP=class{handle(e){if(bW.FocusStateChangedAction.is(e)&&!e.hasFocus)return hCe.EnableDefaultToolsAction.create()}};wu.EnableDefaultToolsOnFocusLossHandler=WP;wu.EnableDefaultToolsOnFocusLossHandler=WP=lCe([(0,fCe.injectable)()],WP);wu.toolFocusLossModule=new zK.FeatureModule((n,e,t)=>{(0,zK.configureActionHandler)({bind:n,isBound:t},bW.FocusStateChangedAction.KIND,WP)},{featureId:Symbol("toolFocusLoss ")});var tM={},En={},sf={};Object.defineProperty(sf,"__esModule",{value:!0});sf.collectIssueMarkers=sf.MarkerPredicates=void 0;const oT=z,pCe=Ti;var GK;(function(n){n.ALL=()=>!0,n.ERRORS=t=>e(t,oT.MarkerKind.ERROR),n.WARNINGS=t=>e(t,oT.MarkerKind.WARNING),n.INFOS=t=>e(t,oT.MarkerKind.INFO);function e(t,i){return t.issues.find(o=>o.severity===i)!==void 0}n.hasIssueWithSeverity=e})(GK||(sf.MarkerPredicates=GK={}));function SW(n){const e=[];for(const t of n.children)t instanceof pCe.GIssueMarker&&e.push(t),e.push(...SW(t));return e}sf.collectIssueMarkers=SW;var Ds=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},y1=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(En,"__esModule",{value:!0});En.MarkerNavigatorKeyListener=En.MarkerNavigatorContextMenuItemProvider=En.NavigateToMarkerActionHandler=En.MarkerNavigator=En.LeftToRightTopToBottomComparator=En.GModelElementComparator=En.NavigateToMarkerAction=void 0;const Gi=z,Ts=F,mCe=Pt,ZP=Yt,g5=kt,M3=sf;var Sm;(function(n){n.KIND="navigateToMarker";function e(i){return Gi.Action.hasKind(i,n.KIND)&&(0,Gi.hasStringProp)(i,"direction")&&(0,Gi.hasArrayProp)(i,"severities")}n.is=e;function t(i){return{kind:n.KIND,direction:"next",severities:Au.ALL_SEVERITIES,...i}}n.create=t})(Sm||(En.NavigateToMarkerAction=Sm={}));class Fy{compare(e,t){return 0}}En.GModelElementComparator=Fy;let v5=class{compare(e,t){const i=(0,Gi.findParentByFeature)(e,g5.isSelectableAndBoundsAware),o=(0,Gi.findParentByFeature)(t,g5.isSelectableAndBoundsAware);if(i&&o){if(i.bounds.y!==o.bounds.y)return i.bounds.y-o.bounds.y;if(i.bounds.x!==o.bounds.x)return i.bounds.x-o.bounds.x}return 0}};En.LeftToRightTopToBottomComparator=v5;En.LeftToRightTopToBottomComparator=v5=Ds([(0,Ts.injectable)()],v5);let Au=class{next(e,t,i=M3.MarkerPredicates.ALL){const o=this.getMarkers(e,i);return t===void 0?o.length>0?o[0]:void 0:o[this.getNextIndex(t,o)%o.length]}previous(e,t,i=M3.MarkerPredicates.ALL){const o=this.getMarkers(e,i);return t===void 0?o.length>0?o[0]:void 0:o[this.getPreviousIndex(t,o)%o.length]}getMarkers(e,t){return(0,M3.collectIssueMarkers)(e).filter(t).sort(this.markerComparator.compare)}getNextIndex(e,t){for(let i=0;i<t.length;i++)if(this.markerComparator.compare(t[i],e)>0)return i;return 0}getPreviousIndex(e,t){for(let i=t.length-1;i>=0;i--)if(this.markerComparator.compare(t[i],e)<0)return i;return t.length-1}};En.MarkerNavigator=Au;Au.ALL_SEVERITIES=["error","warning","info"];Ds([(0,Ts.inject)(Fy),y1("design:type",Fy)],Au.prototype,"markerComparator",void 0);En.MarkerNavigator=Au=Ds([(0,Ts.injectable)()],Au);let af=class{handle(e){const t=this.getSelectedElements(e),i=this.getTarget(e,t),o=i?(0,Gi.findParentByFeature)(i,Gi.isSelectable):void 0;if(o){const r=t.map(s=>s.id).filter(s=>s!==o.id);this.actionDispatcher.dispatch(Gi.SelectAction.create({selectedElementsIDs:[o.id],deselectedElementsIDs:r})),this.actionDispatcher.dispatch(Gi.CenterAction.create([o.id]))}}getSelectedElements(e){return e.selectedElementIds&&e.selectedElementIds.length>0?(0,g5.getElements)(this.selectionService.getModelRoot().index,e.selectedElementIds,Gi.isSelectable):this.selectionService.getSelectedElements()}getTarget(e,t){const i=this.selectionService.getModelRoot(),o=t.sort(this.markerComparator.compare).find(Gi.isBoundsAware);return e.direction==="previous"?this.markerNavigator.previous(i,o,r=>this.matchesSeverities(e,r)):this.markerNavigator.next(i,o,r=>this.matchesSeverities(e,r))}matchesSeverities(e,t){return t.issues.find(i=>e.severities.includes(i.severity))!==void 0}};En.NavigateToMarkerActionHandler=af;Ds([(0,Ts.inject)(Fy),y1("design:type",Fy)],af.prototype,"markerComparator",void 0);Ds([(0,Ts.inject)(Au),y1("design:type",Au)],af.prototype,"markerNavigator",void 0);Ds([(0,Ts.inject)(ZP.SelectionService),y1("design:type",ZP.SelectionService)],af.prototype,"selectionService",void 0);Ds([(0,Ts.inject)(Gi.TYPES.IActionDispatcher),y1("design:type",mCe.GLSPActionDispatcher)],af.prototype,"actionDispatcher",void 0);En.NavigateToMarkerActionHandler=af=Ds([(0,Ts.injectable)()],af);let QP=class{getItems(e,t){const i=Array.from(this.selectionService.getSelectedElementIDs()),o=(0,M3.collectIssueMarkers)(e).length>0;return Promise.resolve([{id:"navigate",label:"Go to",group:"navigate",actions:[],children:[{id:"next-marker",label:"Next marker",group:"marker",actions:[Sm.create({direction:"next",selectedElementIds:i})],isEnabled:()=>o},{id:"previous-marker",label:"Previous marker",group:"marker",actions:[Sm.create({direction:"previous",selectedElementIds:i})],isEnabled:()=>o}]}])}};En.MarkerNavigatorContextMenuItemProvider=QP;Ds([(0,Ts.inject)(ZP.SelectionService),y1("design:type",ZP.SelectionService)],QP.prototype,"selectionService",void 0);En.MarkerNavigatorContextMenuItemProvider=QP=Ds([(0,Ts.injectable)()],QP);let _5=class extends Gi.KeyListener{keyDown(e,t){return(0,Gi.matchesKeystroke)(t,"Period","ctrl")?[Sm.create({direction:"next"})]:(0,Gi.matchesKeystroke)(t,"Comma","ctrl")?[Sm.create({direction:"previous"})]:[]}};En.MarkerNavigatorKeyListener=_5;En.MarkerNavigatorKeyListener=_5=Ds([(0,Ts.injectable)()],_5);var Bn={},qc=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},b1=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},EW=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Bn,"__esModule",{value:!0});Bn.DeleteMarkersCommand=Bn.ApplyMarkersCommand=Bn.ApplyMarkersAction=Bn.SetMarkersActionHandler=Bn.ExternalMarkerManager=Bn.ValidationFeedbackEmitter=void 0;const pa=z,Nr=F,UK=An,CW=Gn,gCe=kt,Tp=Ti;let Em=class{constructor(){this.registeredFeedbackByReason=new Map}registerValidationFeedbackAction(e,t=""){var i,o;const r=(o=(i=this.registeredFeedbackByReason.get(t))===null||i===void 0?void 0:i.dispose())!==null&&o!==void 0?o:this.feedbackActionDispatcher.createEmitter();r.add(e,()=>pa.DeleteMarkersAction.create(e.markers)).submit(),this.registeredFeedbackByReason.set(t,r)}};Bn.ValidationFeedbackEmitter=Em;qc([(0,Nr.inject)(pa.TYPES.IFeedbackActionDispatcher),b1("design:type",Object)],Em.prototype,"feedbackActionDispatcher",void 0);Bn.ValidationFeedbackEmitter=Em=qc([(0,Nr.injectable)()],Em);let xy=class{connect(e){this.actionDispatcher=e}removeMarkers(e){this.actionDispatcher&&this.actionDispatcher.dispatch(pa.DeleteMarkersAction.create(e))}};Bn.ExternalMarkerManager=xy;Bn.ExternalMarkerManager=xy=qc([(0,Nr.injectable)()],xy);let Cm=class{handle(e){const t=e.markers;this.setMarkers(t,e.reason)}async setMarkers(e,t){var i;const o=this.editorContextService.sourceUri;(i=this.externalMarkerManager)===null||i===void 0||i.setMarkers(e,t,o);const r=XP.create(e);this.validationFeedbackEmitter.registerValidationFeedbackAction(r,t)}};Bn.SetMarkersActionHandler=Cm;qc([(0,Nr.inject)(Em),b1("design:type",Em)],Cm.prototype,"validationFeedbackEmitter",void 0);qc([(0,Nr.inject)(xy),(0,Nr.optional)(),b1("design:type",xy)],Cm.prototype,"externalMarkerManager",void 0);qc([(0,Nr.inject)(UK.EditorContextService),b1("design:type",UK.EditorContextService)],Cm.prototype,"editorContextService",void 0);Bn.SetMarkersActionHandler=Cm=qc([(0,Nr.injectable)()],Cm);var XP;(function(n){n.KIND="applyMarkers";function e(i){return pa.Action.hasKind(i,n.KIND)&&(0,pa.hasArrayProp)(i,"markers")}n.is=e;function t(i){return{kind:n.KIND,markers:i}}n.create=t})(XP||(Bn.ApplyMarkersAction=XP={}));let JP=class extends CW.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return this.action.markers.forEach(t=>{const i=e.root.index.getById(t.elementId);if(i instanceof pa.GParentElement){const o=(0,Tp.getOrCreateGIssueMarker)(i),r=(0,Tp.createGIssue)(t);o.issues.push(r),o instanceof Tp.GIssueMarker&&o.computeProjectionCssClasses(),PW(i,o)}}),e.root}};Bn.ApplyMarkersCommand=JP;JP.KIND=XP.KIND;Bn.ApplyMarkersCommand=JP=qc([(0,Nr.injectable)(),EW(0,(0,Nr.inject)(pa.TYPES.Action)),b1("design:paramtypes",[Object])],JP);function PW(n,e){const t=(0,Tp.getSeverity)(e);n.cssClasses?(n.cssClasses=n.cssClasses.filter(i=>!i.match("info|warning|error")),n.cssClasses.push(t)):n.cssClasses=[t]}function vCe(n,e){const t=(0,Tp.getSeverity)(e);(0,gCe.removeCssClasses)(n,[t])}let ew=class extends CW.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return this.action.markers.forEach(t=>{const i=e.root.index.getById(t.elementId);if(i instanceof pa.GParentElement){const o=(0,Tp.getGIssueMarker)(i);if(o){vCe(i,o);for(let r=0;r<o.issues.length;++r)o.issues[r].message===t.description&&o.issues.splice(r--,1);o.issues.length===0?i.remove(o):PW(i,o)}}}),e.root}};Bn.DeleteMarkersCommand=ew;ew.KIND=pa.DeleteMarkersAction.KIND;Bn.DeleteMarkersCommand=ew=qc([(0,Nr.injectable)(),EW(0,(0,Nr.inject)(pa.TYPES.Action)),b1("design:paramtypes",[Object])],ew);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneMarkerNavigatorModule=n.markerNavigatorModule=n.validationModule=void 0;const e=z,t=En,i=Bn;n.validationModule=new e.FeatureModule((o,r,s)=>{const a={bind:o,isBound:s};(0,e.configureActionHandler)(a,e.SetMarkersAction.KIND,i.SetMarkersActionHandler),(0,e.configureCommand)(a,i.ApplyMarkersCommand),(0,e.configureCommand)(a,i.DeleteMarkersCommand),o(i.ValidationFeedbackEmitter).toSelf().inSingletonScope()},{featureId:Symbol("validation")}),n.markerNavigatorModule=new e.FeatureModule((o,r,s)=>{o(t.GModelElementComparator).to(t.LeftToRightTopToBottomComparator).inSingletonScope(),o(t.MarkerNavigator).toSelf().inSingletonScope(),(0,e.configureActionHandler)({bind:o,isBound:s},t.NavigateToMarkerAction.KIND,t.NavigateToMarkerActionHandler)},{featureId:Symbol("markerNavigator")}),n.standaloneMarkerNavigatorModule=new e.FeatureModule(o=>{(0,e.bindAsService)(o,e.TYPES.IContextMenuProvider,t.MarkerNavigatorContextMenuItemProvider),(0,e.bindAsService)(o,e.TYPES.KeyListener,t.MarkerNavigatorKeyListener)},{featureId:Symbol("standaloneMarkerNavigator"),requires:n.markerNavigatorModule})})(tM);var nM={},Wc={};Object.defineProperty(Wc,"__esModule",{value:!0});Wc.FocusDomAction=void 0;const YK=z;var qK;(function(n){n.KIND="focusDomAction";function e(i){return YK.Action.hasKind(i,n.KIND)&&(0,YK.hasStringProp)(i,"id")}n.is=e;function t(i){return{kind:n.KIND,id:i}}n.create=t})(qK||(Wc.FocusDomAction=qK={}));var S1={},_Ce=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(S1,"__esModule",{value:!0});S1.GLSPScrollMouseListener=void 0;const yCe=F,bCe=z,WK=It,SCe=Ji;let y5=class extends bCe.ScrollMouseListener{constructor(){super(...arguments),this.preventScrolling=!1}handle(e){e.kind===WK.EnableToolsAction.KIND?e.toolIds.includes(SCe.MarqueeMouseTool.ID)&&(this.preventScrolling=!0):e.kind===WK.EnableDefaultToolsAction.KIND&&(this.preventScrolling=!1)}mouseDown(e,t){return this.preventScrolling?[]:super.mouseDown(e,t)}};S1.GLSPScrollMouseListener=y5;S1.GLSPScrollMouseListener=y5=_Ce([(0,yCe.injectable)()],y5);var ma={},ECe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},CCe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},PCe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(ma,"__esModule",{value:!0});ma.RepositionCommand=ma.RepositionAction=void 0;const Ko=z,ZK=F,wCe=ti,ACe=kt;var b5;(function(n){n.KIND="repositionAction";function e(i){return Ko.Action.hasKind(i,n.KIND)&&(0,Ko.hasArrayProp)(i,"elementIDs")}n.is=e;function t(i){return{kind:n.KIND,elementIDs:i}}n.create=t})(b5||(ma.RepositionAction=b5={}));let tw=class extends Ko.BoundsAwareViewportCommand{constructor(e){super(!0),this.action=e}boundsInViewport(e,t,i){var o;if(e instanceof Ko.GChildElement&&e.parent!==i)return this.boundsInViewport(e.parent,e.parent.localToParent(t),i);if(e instanceof wCe.GEdge){const r=(0,Ko.getRouteBounds)((o=(0,ACe.calcElementAndRoute)(e).newRoutingPoints)!==null&&o!==void 0?o:[]);return e instanceof Ko.GChildElement&&e.parent!==i?this.boundsInViewport(e.parent,e.parent.localToParent(r),i):r}return t}getElementIds(){return this.action.elementIDs}getNewViewport(e,t){if(Ko.Dimension.isValid(t.canvasBounds)&&(0,Ko.isViewport)(t)){if(this.isFullyVisible(e,t))return;{const i=t.zoom,o=Ko.Bounds.center(e),r=Ko.Dimension.center(t.canvasBounds),s=Ko.Point.subtract(o,r);return{scroll:Ko.Point.map(s,f=>f/i),zoom:i}}}}isFullyVisible(e,t){return e.x>=t.scroll.x&&e.x+e.width<=t.scroll.x+t.canvasBounds.width/t.zoom&&e.y>=t.scroll.y&&e.y+e.height<=t.scroll.y+t.canvasBounds.height/t.zoom}};ma.RepositionCommand=tw;tw.KIND=b5.KIND;ma.RepositionCommand=tw=ECe([(0,ZK.injectable)(),PCe(0,(0,ZK.inject)(Ko.TYPES.Action)),CCe("design:paramtypes",[Object])],tw);var E1={},iM=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},H9=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(E1,"__esModule",{value:!0});E1.RestoreViewportHandler=void 0;const QK=z,oM=F,XK=An,JK=zc,RCe=It,MCe=Wc;let Pm=class{handle(e){(RCe.EnableDefaultToolsAction.is(e)||MCe.FocusDomAction.is(e)&&e.id==="graph")&&this.focusGraph()}get graphSelector(){return`#${CSS.escape(this.domHelper.createUniqueDOMElementId(this.editorContext.modelRoot))}`}async postRequestModel(){await this.waitForElement(this.graphSelector),this.focusGraph()}focusGraph(){var e;if(this.focusTracker.hasFocus){const t=(e=this.focusTracker.diagramElement)===null||e===void 0?void 0:e.querySelector(this.graphSelector);t==null||t.focus()}}waitForElement(e){return new Promise(t=>{if(document.querySelector(e))return t(document.querySelector(e));const i=new MutationObserver(o=>{document.querySelector(e)&&(i.disconnect(),t(document.querySelector(e)))});i.observe(document.body,{childList:!0,subtree:!0})})}};E1.RestoreViewportHandler=Pm;iM([(0,oM.inject)(QK.TYPES.DOMHelper),H9("design:type",QK.DOMHelper)],Pm.prototype,"domHelper",void 0);iM([(0,oM.inject)(JK.FocusTracker),H9("design:type",JK.FocusTracker)],Pm.prototype,"focusTracker",void 0);iM([(0,oM.inject)(XK.EditorContextService),H9("design:type",XK.EditorContextService)],Pm.prototype,"editorContext",void 0);E1.RestoreViewportHandler=Pm=iM([(0,oM.injectable)()],Pm);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneViewportModule=n.viewportModule=void 0;const e=z,t=It,i=Wc,o=S1,r=Ac,s=ma,a=E1;n.viewportModule=new e.FeatureModule((f,h,g)=>{const y={bind:f,isBound:g};(0,e.configureCommand)(y,e.CenterCommand),(0,e.configureCommand)(y,e.FitToScreenCommand),(0,e.configureCommand)(y,e.GetViewportCommand),(0,e.configureCommand)(y,e.SetViewportCommand),(0,e.configureCommand)(y,s.RepositionCommand),(0,e.configureCommand)(y,r.OriginViewportCommand),(0,e.bindAsService)(y,e.TYPES.MouseListener,e.ZoomMouseListener),(0,e.bindAsService)(y,e.TYPES.MouseListener,o.GLSPScrollMouseListener),(0,e.configureActionHandler)(y,t.EnableToolsAction.KIND,o.GLSPScrollMouseListener),(0,e.configureActionHandler)(y,t.EnableDefaultToolsAction.KIND,o.GLSPScrollMouseListener),(0,e.bindAsService)(y,e.TYPES.IDiagramStartup,a.RestoreViewportHandler),(0,e.configureActionHandler)(y,t.EnableDefaultToolsAction.KIND,a.RestoreViewportHandler),(0,e.configureActionHandler)(y,i.FocusDomAction.KIND,a.RestoreViewportHandler)},{featureId:Symbol("viewport")}),n.standaloneViewportModule=new e.FeatureModule((f,h,g)=>{const y={bind:f,isBound:g};(0,e.bindAsService)(y,e.TYPES.KeyListener,e.CenterKeyboardListener)},{featureId:Symbol("standaloneViewport"),requires:n.viewportModule})})(nM);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.initializeDiagramContainer=n.configureDiagramOptions=n.createDiagramOptionsModule=n.DEFAULT_MODULES=void 0;const e=z,t=db,i=fb,o=hb,r=pb,s=OR,a=gb,f=Jg,h=NR,g=vb,y=yb,S=Sb,P=Eb,w=Cb,C=Pb,E=Ab,D=VR,j=Rb,U=Ib,p=Db,b=Tb,v=jb,R=xb,O=Hb,N=Kb,T=zb,$=Ub,Q=wu,K=tM,Z=nM;n.DEFAULT_MODULES=[t.defaultModule,e.buttonModule,e.edgeIntersectionModule,e.edgeLayoutModule,e.expandModule,h.exportModule,e.fadeModule,i.boundsModule,o.commandPaletteModule,r.contextMenuModule,a.decorationModule,P.labelEditModule,y.hoverModule,D.selectModule,s.copyPasteModule,Z.viewportModule,S.labelEditUiModule,w.layoutModule,K.markerNavigatorModule,g.typeHintsModule,e.modelSourceModule,j.sourceModelWatcherModule,C.navigationModule,E.routingModule,b.toolPaletteModule,O.edgeCreationToolModule,N.edgeEditToolModule,R.deletionToolModule,f.elementTemplateModule,$.nodeCreationToolModule,v.changeBoundsToolModule,T.marqueeSelectionToolModule,Q.toolFocusLossModule,K.validationModule,e.zorderModule,p.svgMetadataModule,U.statusModule];function H(te,ue){return new e.FeatureModule((Re,ae,ot,Ft)=>M({bind:Re,unbind:ae,isBound:ot,rebind:Ft},te,ue))}n.createDiagramOptionsModule=H;function M(te,ue,Re){(0,e.configureViewerOptions)(te,{baseDiv:ue.clientId,hiddenDiv:ue.clientId+"_hidden",zoomLimits:{min:.1,max:20},...Re}),te.bind(e.TYPES.IDiagramOptions).toConstantValue(ue)}n.configureDiagramOptions=M;function Y(te,...ue){const Re=(0,e.resolveContainerConfiguration)(...n.DEFAULT_MODULES,...ue),ae=Re[0];if(!ae||!(ae instanceof e.FeatureModule&&ae.featureId===t.defaultModule.featureId))throw new Error("Invalid module configuration. The first module to load should be the `defaultModule` (or an equivalent replacement module)");return te.load(...Re),te}n.initializeDiagramContainer=Y})(Rq);var rM={},K9={},ga={},eo={},ICe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},I3;Object.defineProperty(eo,"__esModule",{value:!0});eo.KeyShortcutUIExtension=eo.SetAccessibleKeyShortcutAction=void 0;const wW=z,DCe=F,TCe=sh,OCe=Ms;var S5;(function(n){n.KIND="setAccessibleKeyShortcut";function e(i){return wW.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,token:i.token,keys:i.keys}}n.create=t})(S5||(eo.SetAccessibleKeyShortcutAction=S5={}));let nw=I3=class extends OCe.GLSPAbstractUIExtension{constructor(){super(...arguments),this.registrations={}}handle(e){S5.is(e)&&(this.registrations[e.token]=e.keys,this.containerElement&&this.refreshUI())}id(){return I3.ID}containerClass(){return I3.ID}show(e,...t){super.show(e,...t),this.shortcutsContainer.focus()}refreshUI(){this.shortcutsContainer.innerHTML="";const e=Object.values(this.registrations).flatMap(h=>h);e.sort((h,g)=>h.group<g.group?-1:h.group>g.group?1:h.position-g.position);const t=(0,TCe.groupBy)(e,h=>h.group),i=document.createElement("table");i.classList.add("shortcut-table");const o=document.createElement("thead"),r=document.createElement("tbody"),s=document.createElement("tr"),a=document.createElement("th"),f=document.createElement("th");a.classList.add("column-title"),a.innerText="Command",f.innerText="Keybinding",s.appendChild(a),s.appendChild(f),o.appendChild(s);for(const[h,g]of Object.entries(t))r.appendChild(this.createGroupHeader(h)),g.forEach(y=>{r.appendChild(this.createEntry(y))});i.appendChild(o),i.appendChild(r),this.shortcutsContainer.append(i)}createGroupHeader(e){const t=document.createElement("tr"),i=document.createElement("td"),o=document.createElement("strong"),r=document.createElement("td");return o.innerText=e,i.appendChild(o),t.appendChild(i),t.appendChild(r),t}getShortcutHTML(e){const t=document.createElement("span");return t.innerHTML=e.map(i=>`<kbd>${i}</kbd>`).join(" + "),t}createEntry(e){const t=document.createElement("tr"),i=document.createElement("td"),o=document.createElement("td"),r=this.getShortcutHTML(e.shortcuts);return o.innerText=e.description,i.appendChild(r),t.appendChild(o),t.appendChild(i),t}initializeContents(e){this.container=document.createElement("div"),this.container.classList.add("keyboard-shortcuts-menu");const t=document.createElement("h3");t.classList.add("menu-header"),t.innerText="Keyboard Shortcuts",this.container.appendChild(t);const i=document.createElement("button");i.id="key-shortcut-close-btn",i.textContent="x",i.addEventListener("click",()=>{this.hide()}),this.container.appendChild(i),this.shortcutsContainer=document.createElement("div"),this.shortcutsContainer.classList.add("keyboard-shortcuts-container"),this.shortcutsContainer.tabIndex=30,this.shortcutsContainer.addEventListener("keydown",o=>{(o.key==="Escape"||(0,wW.matchesKeystroke)(o,"KeyH","alt"))&&this.hide()}),this.container.appendChild(this.shortcutsContainer),e.appendChild(this.container),e.ariaLabel="Shortcut-Menu",this.refreshUI()}};eo.KeyShortcutUIExtension=nw;nw.ID="key-shortcut";eo.KeyShortcutUIExtension=nw=I3=ICe([(0,DCe.injectable)()],nw);var Dc={},AW=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},LCe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},E5;Object.defineProperty(Dc,"__esModule",{value:!0});Dc.AccessibleShortcutKeyListener=Dc.AccessibleKeyShortcutTool=void 0;const RW=F,w_=z,NCe=_i,jCe=eo;let Hy=E5=class extends NCe.BaseEditTool{constructor(){super(...arguments),this.shortcutKeyListener=new sM}get id(){return E5.ID}enable(){this.keytool.register(this.shortcutKeyListener)}disable(){this.keytool.deregister(this.shortcutKeyListener)}};Dc.AccessibleKeyShortcutTool=Hy;Hy.ID="accessible-key-shortcut-tool";AW([(0,RW.inject)(w_.KeyTool),LCe("design:type",w_.KeyTool)],Hy.prototype,"keytool",void 0);Dc.AccessibleKeyShortcutTool=Hy=E5=AW([(0,RW.injectable)()],Hy);class sM extends w_.KeyListener{constructor(){super(...arguments),this.token=Symbol(sM.name)}keyDown(e,t){return this.matchesActivateShortcutHelpKeystroke(t)?[w_.SetUIExtensionVisibilityAction.create({extensionId:jCe.KeyShortcutUIExtension.ID,visible:!0})]:[]}matchesActivateShortcutHelpKeystroke(e){return(0,w_.matchesKeystroke)(e,"KeyH","alt")}}Dc.AccessibleShortcutKeyListener=sM;var Tc={},Qi={},BCe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},C5;Object.defineProperty(Qi,"__esModule",{value:!0});Qi.SearchAutocompletePalette=Qi.RevealEdgeElementAutocompleteSuggestionProvider=Qi.RevealNodesWithoutNameAutocompleteSuggestionProvider=Qi.RevealNamedElementAutocompleteSuggestionProvider=void 0;const pi=z,$Ce=F,eV=sh,Ky=Mo,kCe=cb,rT=it,FCe=ma,MW=ti,sT="search-hidden",aT="search-highlighted";class IW{async retrieveSuggestions(e,t){return(0,Ky.toArray)(e.index.all().filter(o=>(0,pi.isNameable)(o))).map(o=>{var r;return{element:o,action:{label:`[${o.type}] ${(r=(0,pi.name)(o))!==null&&r!==void 0?r:"<no-name>"}`,actions:this.getActions(o),icon:(0,pi.codiconCSSString)("eye")}}})}getActions(e){return[pi.SelectAction.create({selectedElementsIDs:[e.id]}),pi.CenterAction.create([e.id],{retainZoom:!0})]}}Qi.RevealNamedElementAutocompleteSuggestionProvider=IW;class DW{async retrieveSuggestions(e,t){return(0,Ky.toArray)(e.index.all().filter(o=>!(0,pi.isNameable)(o)&&o instanceof pi.GNode)).map(o=>({element:o,action:{label:`[${o.type}]`,actions:this.getActions(o),icon:(0,pi.codiconCSSString)("symbol-namespace")}}))}getActions(e){return[pi.SelectAction.create({selectedElementsIDs:[e.id]}),pi.CenterAction.create([e.id],{retainZoom:!0})]}}Qi.RevealNodesWithoutNameAutocompleteSuggestionProvider=DW;class TW{async retrieveSuggestions(e,t){return(0,Ky.toArray)(e.index.all().filter(o=>o instanceof MW.GEdge)).map(o=>({element:o,action:{label:`[${o.type}]  ${this.getEdgeLabel(e,o)}`,actions:this.getActions(o),icon:(0,pi.codiconCSSString)("arrow-both")}}))}getActions(e){return[pi.SelectAction.create({selectedElementsIDs:[e.id]}),pi.CenterAction.create([e.sourceId,e.targetId])]}getEdgeLabel(e,t){var i,o;let r="",s="";const a=e.index.getById(t.sourceId),f=e.index.getById(t.targetId);return a!==void 0&&(r=(i=(0,pi.name)(a))!==null&&i!==void 0?i:a.type),f!==void 0&&(s=(o=(0,pi.name)(f))!==null&&o!==void 0?o:f.type),r+" -> "+s}}Qi.RevealEdgeElementAutocompleteSuggestionProvider=TW;let iw=C5=class extends kCe.BaseAutocompletePalette{constructor(){super(...arguments),this.cachedSuggestions=[]}id(){return C5.ID}initializeContents(e){super.initializeContents(e),this.autocompleteWidget.inputField.placeholder="Search for elements",e.setAttribute("aria-label","Search Field")}getSuggestionProviders(e,t){return[new IW,new TW,new DW]}async retrieveSuggestions(e,t){const i=this.getSuggestionProviders(e,t),o=(await Promise.all(i.map(r=>r.retrieveSuggestions(e,t)))).flat(1);return this.cachedSuggestions=o,o.map(r=>r.action)}async visibleSuggestionsChanged(e,t){await this.applyCSS(this.getHiddenElements(e,this.getSuggestionsFromLabeledActions(t)),sT),await this.deleteCSS(this.getSuggestionsFromLabeledActions(t).map(i=>i.element),sT)}async selectedSuggestionChanged(e,t){if(await this.deleteAllCSS(e,aT),t!==void 0){const i=this.getSuggestionsFromLabeledActions([t]),o=[];i.map(r=>o.push(FCe.RepositionAction.create([r.element.id]))),this.actionDispatcher.dispatchAll(o),await this.applyCSS(i.map(r=>r.element),aT)}}show(e,...t){this.actionDispatcher.dispatch(pi.SelectAllAction.create(!1)),super.show(e,...t)}hide(){this.root!==void 0&&(this.deleteAllCSS(this.root,sT),this.deleteAllCSS(this.root,aT),this.autocompleteWidget.inputField.value=""),super.hide()}applyCSS(e,t){const i=e.map(o=>(0,rT.applyCssClasses)(o,t));return this.actionDispatcher.dispatchAll(i)}deleteCSS(e,t){const i=e.map(o=>(0,rT.deleteCssClasses)(o,t));return this.actionDispatcher.dispatchAll(i)}deleteAllCSS(e,t){const i=(0,Ky.toArray)(e.index.all().map(o=>(0,rT.deleteCssClasses)(o,t)));return this.actionDispatcher.dispatchAll(i)}getSuggestionsFromLabeledActions(e){return this.cachedSuggestions.filter(t=>e.find(i=>(0,eV.isEqual)(i,t.action)))}getHiddenSuggestionsFromLabeledActions(e){return this.cachedSuggestions.filter(t=>!e.find(i=>(0,eV.isEqual)(i,t.action)))}getHiddenElements(e,t){return(0,Ky.toArray)(e.index.all().filter(i=>i instanceof pi.GNode||i instanceof MW.GEdge).filter(i=>t.find(o=>o.element.id===i.id)===void 0))}};Qi.SearchAutocompletePalette=iw;iw.ID="search-autocomplete-palette";Qi.SearchAutocompletePalette=iw=C5=BCe([(0,$Ce.injectable)()],iw);var V9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},OW=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},P5;Object.defineProperty(Tc,"__esModule",{value:!0});Tc.SearchAutocompletePaletteKeyListener=Tc.SearchAutocompletePaletteTool=void 0;const z9=F,xCe=qt,Vy=z,HCe=Pt,KCe=eo,tV=Qi;let wm=P5=class{constructor(){this.keyListener=new LW(this)}get id(){return P5.ID}enable(){this.keyTool.register(this.keyListener),this.keyListener.registerShortcutKey()}disable(){this.keyTool.deregister(this.keyListener)}};Tc.SearchAutocompletePaletteTool=wm;wm.ID="glsp.search-autocomplete-palette-tool";V9([(0,z9.inject)(Vy.TYPES.IActionDispatcher),OW("design:type",HCe.GLSPActionDispatcher)],wm.prototype,"actionDispatcher",void 0);V9([(0,z9.inject)(Vy.KeyTool),OW("design:type",Vy.KeyTool)],wm.prototype,"keyTool",void 0);Tc.SearchAutocompletePaletteTool=wm=P5=V9([(0,z9.injectable)()],wm);class LW extends Vy.KeyListener{constructor(e){super(),this.tool=e,this.token=tV.SearchAutocompletePalette.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(KCe.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["CTRL","F"],description:"Activate search for elements",group:"Search",position:0}]}))}keyDown(e,t){return this.matchesSearchActivateKeystroke(t)?[Vy.SetUIExtensionVisibilityAction.create({extensionId:tV.SearchAutocompletePalette.ID,visible:!0})]:[]}matchesSearchActivateKeystroke(e){return(0,xCe.matchesKeystroke)(e,"KeyF","ctrl")}}Tc.SearchAutocompletePaletteKeyListener=LW;const VCe={default_navigation_mode_activated:"Navigation On: Use arrow keys to select preceding (←) or succeding (→) elements. Use the up (↑) and down (↓) arrows to navigate paths. Press 'N' to exit.",default_navigation_mode_deactivated:"Navigation Off: Press 'N' for default navigation, 'ALT+N' for position based navigation.",local_navigation_mode_activated:"Position based Nav On: Navigate nearest elements using arrow keys: (↑) for above, (↓) for below, (←) for previous, (→) for next element. Press 'ALT+N' to exit.",local_navigation_mode_deactivated:"Position based Nav Off: Press 'N' for default navigation, 'ALT+N' for position based navigation."},zCe={focus_on:"Currently focused: ",focus_off:"Currently no element is focused."},GCe={resize_mode_activated:"Resize On: Use plus(+) and minus(-) to resize, 'CTRL'+'0' for default size. Press 'ESC' to exit.",resize_mode_deactivated:"Resize Off: Press 'ALT'+'A' for resize mode."},UCe={zoom_in_grid:"Select a digit from 1-9 to zoom in on the respective box."},YCe={marqueeTool:"Currently marquee tool is only usable with mouse."},qb={navigation:VCe,focus:zCe,resize:GCe,grid:UCe,tool_palette:YCe};var sr={};Object.defineProperty(sr,"__esModule",{value:!0});sr.ShowToastMessageAction=sr.HideToastAction=void 0;const NW=z;var nV;(function(n){n.KIND="hideToastMessageAction";function e(i){return NW.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,options:i}}n.create=t})(nV||(sr.HideToastAction=nV={}));var iV;(function(n){n.KIND="showToastMessageAction",n.TIMEOUT=2e3;function e(o){return NW.Action.hasKind(o,n.KIND)}n.is=e;function t(o){var r,s;return{kind:n.KIND,options:{...o,position:(r=o.position)!==null&&r!==void 0?r:"center",id:(s=o.id)!==null&&s!==void 0?s:Symbol("toast id")}}}n.create=t;function i(o){var r,s;return{kind:n.KIND,options:{timeout:n.TIMEOUT,...o,position:(r=o.position)!==null&&r!==void 0?r:"center",id:(s=o.id)!==null&&s!==void 0?s:Symbol("toast id")}}}n.createWithTimeout=i})(iV||(sr.ShowToastMessageAction=iV={}));var Wb=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},aM=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},w5;Object.defineProperty(ga,"__esModule",{value:!0});ga.ElementNavigatorKeyListener=ga.ElementNavigatorTool=void 0;const is=z,Zb=F,qCe=Mo,al=qt,WCe=Pt,Jh=It,ZCe=ma,QCe=eo,oV=Dc,rV=Tc,ep=qb,tp=sr,XCe=ti;let va=w5=class{constructor(){this.isEditTool=!1,this.elementNavigatorKeyListener=new Fs(this)}get id(){return w5.ID}enable(){this.keytool.register(this.elementNavigatorKeyListener),this.elementNavigatorKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.elementNavigatorKeyListener)}};ga.ElementNavigatorTool=va;va.ID="glsp.diagram-navigation";Wb([(0,Zb.inject)(is.KeyTool),aM("design:type",is.KeyTool)],va.prototype,"keytool",void 0);Wb([(0,Zb.inject)(is.TYPES.IElementNavigator),aM("design:type",Object)],va.prototype,"elementNavigator",void 0);Wb([(0,Zb.inject)(is.TYPES.ILocalElementNavigator),aM("design:type",Object)],va.prototype,"localElementNavigator",void 0);Wb([(0,Zb.inject)(is.TYPES.IActionDispatcher),aM("design:type",WCe.GLSPActionDispatcher)],va.prototype,"actionDispatcher",void 0);ga.ElementNavigatorTool=va=w5=Wb([(0,Zb.injectable)()],va);var Ri;(function(n){n.POSITION="position",n.DEFAULT="default",n.NONE="none"})(Ri||(Ri={}));class Fs extends is.KeyListener{constructor(e){super(),this.tool=e,this.mode=Ri.NONE,this.token=Fs.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(QCe.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["N"],description:"Activate default navigation",group:"Navigation",position:0},{shortcuts:["ALT","N"],description:"Activate position based navigation",group:"Navigation",position:1},{shortcuts:["⬅  ⬆  ➡  ⬇"],description:"Navigate by relation or neighbors according to navigation mode",group:"Navigation",position:2}]}))}keyDown(e,t){return this.resetOnEscape(t,e),this.getSelectedElements(e.root).length>0?(this.triggerPositionNavigationOnEvent(t,e)||this.triggerDefaultNavigationOnEvent(t,e),this.navigate(e,t)):(this.resetPositionNavigationOnEvent(t,e),this.resetDefaultNavigationOnEvent(t,e),[])}resetOnEscape(e,t){var i,o;this.mode!==Ri.NONE&&this.matchesDeactivateNavigationMode(e)&&((o=(i=this.navigator)===null||i===void 0?void 0:i.clean)===null||o===void 0||o.call(i,t.root),this.clean(),this.mode===Ri.POSITION?this.tool.actionDispatcher.dispatchAll([Jh.EnableDefaultToolsAction.create(),tp.ShowToastMessageAction.createWithTimeout({id:Symbol.for(Fs.name),message:ep.navigation.local_navigation_mode_deactivated})]):this.mode===Ri.DEFAULT&&this.tool.actionDispatcher.dispatchAll([Jh.EnableDefaultToolsAction.create(),tp.ShowToastMessageAction.createWithTimeout({id:Symbol.for(Fs.name),message:ep.navigation.default_navigation_mode_deactivated})]),this.mode=Ri.NONE)}triggerPositionNavigationOnEvent(e,t){return this.matchesActivatePositionNavigation(e)?(this.mode!==Ri.POSITION?(this.clean(),this.tool.actionDispatcher.dispatchAll([Jh.EnableToolsAction.create([va.ID,rV.SearchAutocompletePaletteTool.ID,oV.AccessibleKeyShortcutTool.ID]),tp.ShowToastMessageAction.create({id:Symbol.for(Fs.name),message:ep.navigation.local_navigation_mode_activated})]),this.navigator=this.tool.elementNavigator,this.mode=Ri.POSITION):this.resetPositionNavigationOnEvent(e,t),!0):!1}resetPositionNavigationOnEvent(e,t){var i,o;this.mode===Ri.POSITION&&this.matchesActivatePositionNavigation(e)&&((o=(i=this.navigator)===null||i===void 0?void 0:i.clean)===null||o===void 0||o.call(i,t.root),this.clean(),this.mode=Ri.NONE,this.tool.actionDispatcher.dispatchAll([Jh.EnableDefaultToolsAction.create(),tp.ShowToastMessageAction.createWithTimeout({id:Symbol.for(Fs.name),message:ep.navigation.local_navigation_mode_deactivated})]))}triggerDefaultNavigationOnEvent(e,t){return this.matchesActivateDefaultNavigation(e)?(this.mode!==Ri.DEFAULT?(this.clean(),this.tool.actionDispatcher.dispatchAll([Jh.EnableToolsAction.create([va.ID,rV.SearchAutocompletePaletteTool.ID,oV.AccessibleKeyShortcutTool.ID]),tp.ShowToastMessageAction.create({id:Symbol.for(Fs.name),message:ep.navigation.default_navigation_mode_activated})]),this.navigator=this.tool.localElementNavigator,this.mode=Ri.DEFAULT):this.resetDefaultNavigationOnEvent(e,t),!0):!1}resetDefaultNavigationOnEvent(e,t){var i,o;this.mode===Ri.DEFAULT&&this.matchesActivateDefaultNavigation(e)&&((o=(i=this.navigator)===null||i===void 0?void 0:i.clean)===null||o===void 0||o.call(i,t.root),this.clean(),this.mode=Ri.NONE,this.tool.actionDispatcher.dispatchAll([Jh.EnableDefaultToolsAction.create(),tp.ShowToastMessageAction.createWithTimeout({id:Symbol.for(Fs.name),message:ep.navigation.default_navigation_mode_deactivated})]))}navigate(e,t){var i,o,r,s;const a=this.getSelectedElements(e.root),f=a.length>0?a[0]:void 0;if(this.mode!==Ri.NONE&&this.navigator!==void 0&&f!==void 0&&(0,is.isBoundsAware)(f)){(o=(i=this.navigator).clean)===null||o===void 0||o.call(i,f.root,f,this.previousNode);const h=this.navigateOnEvent(t,this.navigator,f);h!==void 0&&((s=(r=this.navigator).process)===null||s===void 0||s.call(r,f.root,f,h,this.previousNode));const g=h?(0,is.findParentByFeature)(h,is.isSelectable):void 0;if(g){f instanceof XCe.GEdge||(this.previousNode=f);const y=a.map(S=>S.id).filter(S=>S!==g.id);return[is.SelectAction.create({selectedElementsIDs:[g.id],deselectedElementsIDs:y}),ZCe.RepositionAction.create([g.id])]}}return[]}navigateOnEvent(e,t,i){var o,r;if(this.matchesNavigatePrevious(e))return t.previous(i.root,i);if(this.matchesNavigateNext(e))return t.next(i.root,i);if(this.matchesNavigateUp(e))return(o=t.up)===null||o===void 0?void 0:o.call(t,i.root,i,this.previousNode);if(this.matchesNavigateDown(e))return(r=t.down)===null||r===void 0?void 0:r.call(t,i.root,i,this.previousNode)}clean(){this.previousNode=void 0,this.navigator=void 0}getSelectedElements(e){return(0,qCe.toArray)(e.index.all().filter(t=>(0,is.isSelected)(t)))}matchesDeactivateNavigationMode(e){return(0,al.matchesKeystroke)(e,"Escape")}matchesActivateDefaultNavigation(e){return(0,al.matchesKeystroke)(e,"KeyN")}matchesActivatePositionNavigation(e){return(0,al.matchesKeystroke)(e,"KeyN","alt")}matchesNavigatePrevious(e){return(0,al.matchesKeystroke)(e,"ArrowLeft")}matchesNavigateNext(e){return(0,al.matchesKeystroke)(e,"ArrowRight")}matchesNavigateUp(e){return(0,al.matchesKeystroke)(e,"ArrowUp")}matchesNavigateDown(e){return(0,al.matchesKeystroke)(e,"ArrowDown")}}ga.ElementNavigatorKeyListener=Fs;var C1={},G9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},jW=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(C1,"__esModule",{value:!0});C1.LocalElementNavigator=void 0;const zy=z,ow=F,JCe=Pt,sV=it,Lv=ti;let Gy=class{constructor(){this.navigableElementCSS="navigable-element"}previous(e,t,i,o){return this.getPreviousElement(t,o)}next(e,t,i,o){return this.getNextElement(t,o)}up(e,t,i,o){return this.getIterable(t,i,o)}down(e,t,i,o){return this.getIterable(t,i,o)}process(e,t,i,o,r){let s=[];i instanceof Lv.GEdge&&(t instanceof Lv.GEdge?s=this.getIterables(i,t.source===i.source?t.source:t.target,r):s=this.getIterables(i,t,r)),s.filter(a=>a.id!==i.id).forEach(a=>this.actionDispatcher.dispatch((0,sV.applyCssClasses)(a,this.navigableElementCSS)))}clean(e,t,i){e.index.all().forEach(o=>this.actionDispatcher.dispatch((0,sV.deleteCssClasses)(o,this.navigableElementCSS)))}getIterables(e,t,i=()=>!0){var o,r;const s=[];return e instanceof Lv.GEdge&&(e.target===t?(o=e.target)===null||o===void 0||o.incomingEdges.forEach(a=>s.push(a)):(r=e.source)===null||r===void 0||r.outgoingEdges.forEach(a=>s.push(a))),s.filter(i)}getIterable(e,t,i=()=>!0){return this.getIterables(e,t,i).filter(o=>o.id!==e.id)[0]}getNextElement(e,t=()=>!0){const i=[];if(e instanceof zy.GConnectableElement)e.outgoingEdges.forEach(o=>i.push(o));else if(e instanceof Lv.GEdge){const o=e.target;i.push(o)}return i.filter(t)[0]}getPreviousElement(e,t=()=>!0){const i=[];if(e instanceof zy.GConnectableElement)e.incomingEdges.forEach(o=>i.push(o));else if(e instanceof Lv.GEdge){const o=e.source;i.push(o)}return i.filter(t)[0]}};C1.LocalElementNavigator=Gy;G9([(0,ow.inject)(zy.EdgeRouterRegistry),(0,ow.optional)(),jW("design:type",zy.EdgeRouterRegistry)],Gy.prototype,"edgeRouterRegistry",void 0);G9([(0,ow.inject)(zy.TYPES.IActionDispatcher),jW("design:type",JCe.GLSPActionDispatcher)],Gy.prototype,"actionDispatcher",void 0);C1.LocalElementNavigator=Gy=G9([(0,ow.injectable)()],Gy);var P1={},BW=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ePe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(P1,"__esModule",{value:!0});P1.PositionNavigator=void 0;const $W=F,tPe=Mo,Xv=z,nPe=Pt;let rw=class{previous(e,t,i,o){return this.getNearestElement(e,t,r=>this.bounds(e,r).x<this.bounds(e,t).x)}next(e,t,i,o){return this.getNearestElement(e,t,r=>this.bounds(e,r).x>this.bounds(e,t).x)}up(e,t,i,o){return this.getNearestElement(e,t,r=>this.bounds(e,r).y<this.bounds(e,t).y)}down(e,t,i,o){return this.getNearestElement(e,t,r=>this.bounds(e,r).y>this.bounds(e,t).y)}getNearestElement(e,t,i){const o=this.boundElements(e).filter(i);return this.sortByDistance(e,t,o)[0]}sortByDistance(e,t,i){const o=(r,s)=>{const a=s.x-r.x,f=s.y-r.y;return Math.sqrt(a*a+f*f)};return i.sort((r,s)=>o(this.bounds(e,r),this.bounds(e,t))-o(this.bounds(e,s),this.bounds(e,t)))}boundElements(e){return(0,tPe.toArray)(e.index.all().filter(t=>t instanceof Xv.GNode&&(0,Xv.isSelectable)(t)&&(0,Xv.isBoundsAware)(t)))}bounds(e,t){return this.boundsInViewport(t,t.bounds,e)}boundsInViewport(e,t,i){return e instanceof Xv.GChildElement&&e.parent!==i?this.boundsInViewport(e.parent,e.parent.localToParent(t),i):t}};P1.PositionNavigator=rw;BW([(0,$W.inject)(Xv.TYPES.IActionDispatcher),ePe("design:type",nPe.GLSPActionDispatcher)],rw.prototype,"actionDispatcher",void 0);P1.PositionNavigator=rw=BW([(0,$W.injectable)()],rw);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.glspElementNavigationModule=n.configureElementNavigationTool=n.elementNavigationModule=void 0;const e=z,t=ga,i=C1,o=P1;n.elementNavigationModule=new e.FeatureModule((s,a,f,h)=>{r({bind:s,unbind:a,isBound:f,rebind:h})},{featureId:Symbol("elementNavigation")}),n.glspElementNavigationModule=n.elementNavigationModule;function r(s){(0,e.bindAsService)(s,e.TYPES.IDefaultTool,t.ElementNavigatorTool),(0,e.bindAsService)(s,e.TYPES.IElementNavigator,o.PositionNavigator),(0,e.bindAsService)(s,e.TYPES.ILocalElementNavigator,i.LocalElementNavigator)}n.configureElementNavigationTool=r})(K9);var U9={},w1={},Y9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},kW=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},D3;Object.defineProperty(w1,"__esModule",{value:!0});w1.FocusTrackerTool=void 0;const q9=F,FW=z,iPe=Pt,oPe=qb,rPe=sr;let Am=D3=class{constructor(){this.isEditTool=!1,this.focusInFunction=e=>this.focusIn(e),this.focusOutFunction=e=>this.focusOut(e),this.registered=!1}get id(){return D3.ID}enable(){this.registered||(document.addEventListener("focusin",this.focusInFunction),document.addEventListener("focusout",this.focusOutFunction)),this.registered=!0}disable(){}async focusOut(e){await this.showToast("Focus not set")}async focusIn(e){let t;const i=e.target;if(i instanceof HTMLElement){const o=this.parentWithAriaLabel(i),r=this.handleTextNode(i);i.ariaLabel!==null?t=this.handleAriaLabel(i):o===void 0&&r!==void 0?t=r:o!==void 0&&r===void 0?t=`Focus is in ${o.ariaLabel}`:o!==void 0&&r!==void 0&&(t=`${o.ariaLabel} -> ${r}`)}await this.showToast(t)}handleTextNode(e){const t=Array.prototype.filter.call(e.childNodes,i=>i.nodeType===Node.TEXT_NODE).map(i=>i.textContent).join("");if(t.trim().length!==0)return t}handleAriaLabel(e){return e.ariaLabel===null?void 0:e.ariaLabel}showToast(e){return this.actionDispatcher.dispatchAll([rPe.ShowToastMessageAction.create({id:Symbol.for(D3.ID),message:`${oPe.focus.focus_on} ${e??"unknown"}`,position:"left"})])}parentWithAriaLabel(e){let t=e.parentElement;for(;t!==null&&t!==document.body&&t!==document.getElementById(this.viewerOptions.baseDiv)&&t.ariaLabel===null;)t=t.parentElement;if(!(t===document.getElementById(this.viewerOptions.baseDiv)||t===document.body))return t??void 0}};w1.FocusTrackerTool=Am;Am.ID="glsp.focus-tracker";Y9([(0,q9.inject)(FW.TYPES.IActionDispatcher),kW("design:type",iPe.GLSPActionDispatcher)],Am.prototype,"actionDispatcher",void 0);Y9([(0,q9.inject)(FW.TYPES.ViewerOptions),kW("design:type",Object)],Am.prototype,"viewerOptions",void 0);w1.FocusTrackerTool=Am=D3=Y9([(0,q9.injectable)()],Am);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.glspFocusTrackerModule=n.configureFocusTrackerTool=n.focusTrackerModule=void 0;const e=z,t=w1;n.focusTrackerModule=new e.FeatureModule((o,r,s,a)=>{i({bind:o,unbind:r,isBound:s,rebind:a})},{featureId:Symbol("focusTracker")}),n.glspFocusTrackerModule=n.focusTrackerModule;function i(o){(0,e.bindAsService)(o,e.TYPES.IDefaultTool,t.FocusTrackerTool)}n.configureFocusTrackerTool=i})(U9);var W9={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.glspShortcutHelpModule=n.configureShortcutHelpTool=n.shortcutHelpModule=void 0;const e=z,t=eo,i=Dc;n.shortcutHelpModule=new e.FeatureModule((r,s,a,f)=>{o({bind:r,unbind:s,isBound:a,rebind:f})},{featureId:Symbol("shortcutHelp")}),n.glspShortcutHelpModule=n.shortcutHelpModule;function o(r){(0,e.bindAsService)(r,e.TYPES.IDefaultTool,i.AccessibleKeyShortcutTool),(0,e.bindAsService)(r,e.TYPES.IUIExtension,t.KeyShortcutUIExtension),(0,e.configureActionHandler)(r,t.SetAccessibleKeyShortcutAction.KIND,t.KeyShortcutUIExtension)}n.configureShortcutHelpTool=o})(W9);var cf={},A1={};Object.defineProperty(A1,"__esModule",{value:!0});A1.SetEdgeTargetSelectionAction=void 0;const cT=z;var aV;(function(n){n.KIND="setEdgeTargetSelectionAction";function e(i){return cT.Action.hasKind(i,n.KIND)&&(0,cT.hasStringProp)(i,"elementId")&&(0,cT.hasObjectProp)(i,"context")}n.is=e;function t(i,o){return{kind:n.KIND,elementId:i,context:o}}n.create=t})(aV||(A1.SetEdgeTargetSelectionAction=aV={}));var er={},xW=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(er,"__esModule",{value:!0});er.PossibleEdgeTargetAutocompleteSuggestionProvider=er.EdgeAutocompletePalette=er.EdgeAutocompletePaletteMetadata=void 0;const HW=F,Op=z,sPe=It,aPe=Mo,cPe=Qi,dPe=A1,uPe=uu,lPe=ti;var sw;(function(n){n.ID="edge-autocomplete-palette"})(sw||(er.EdgeAutocompletePaletteMetadata=sw={}));let A5=class extends cPe.SearchAutocompletePalette{constructor(){super(...arguments),this.targetSuggestionProvider=new aw}id(){return sw.ID}handle(e){Op.TriggerEdgeCreationAction.is(e)&&(this.context={trigger:e,role:"source"},this.targetSuggestionProvider.setContext(e,this.context))}onBeforeShow(e,t,...i){var o;super.onBeforeShow(e,t,...i),this.autocompleteWidget.inputField.placeholder=`Search for ${(o=this.context)===null||o===void 0?void 0:o.role} elements`}getSuggestionProviders(e,t){return[this.targetSuggestionProvider]}reload(){const e=this.context;this.hide(),this.context=e,this.actionDispatcher.dispatch(Op.SetUIExtensionVisibilityAction.create({extensionId:sw.ID,visible:!0}))}executeSuggestion(e){var t,i,o,r;const s=(0,uPe.toActionArray)(e)[0];((t=this.context)===null||t===void 0?void 0:t.role)==="source"?(this.context.sourceId=s.elementId,this.context.role="target",this.reload()):((i=this.context)===null||i===void 0?void 0:i.role)==="target"&&(this.context.targetId=s.elementId),((o=this.context)===null||o===void 0?void 0:o.sourceId)!==void 0&&((r=this.context)===null||r===void 0?void 0:r.targetId)!==void 0&&(this.actionDispatcher.dispatchAll([Op.CreateEdgeOperation.create({elementTypeId:this.context.trigger.elementTypeId,sourceElementId:this.context.sourceId,targetElementId:this.context.targetId,args:this.context.trigger.args}),sPe.EnableDefaultToolsAction.create()]),this.hide())}autocompleteHide(e){e!=="submission"&&this.hide()}};er.EdgeAutocompletePalette=A5;er.EdgeAutocompletePalette=A5=xW([(0,HW.injectable)()],A5);let aw=class{setContext(e,t){this.proxyEdge=new lPe.GEdge,this.proxyEdge.type=e.elementTypeId,this.context=t}isAllowedSource(e,t){return e!==void 0&&this.proxyEdge!==void 0&&(0,Op.isConnectable)(e)&&e.canConnect(this.proxyEdge,t)}async retrieveSuggestions(e,t){const i=this.context;return this.context===void 0?[]:(0,aPe.toArray)(e.index.all().filter(r=>this.isAllowedSource(r,i.role))).map(r=>{var s;return{element:r,action:{label:`[${r.type}] ${(s=(0,Op.name)(r))!==null&&s!==void 0?s:"<no-name>"}`,actions:[dPe.SetEdgeTargetSelectionAction.create(r.id,i.role)],icon:(0,Op.codiconCSSString)("arrow-both")}}})}};er.PossibleEdgeTargetAutocompleteSuggestionProvider=aw;er.PossibleEdgeTargetAutocompleteSuggestionProvider=aw=xW([(0,HW.injectable)()],aw);var Ru={},KW=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},fPe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},R5;Object.defineProperty(Ru,"__esModule",{value:!0});Ru.EdgeAutocompletePaletteKeyListener=Ru.EdgeAutocompletePaletteTool=void 0;const VW=F,cw=z,hPe=qt,pPe=er;let Uy=R5=class{constructor(){this.keyListener=new zW}get id(){return R5.ID}enable(){this.keyTool.register(this.keyListener)}disable(){this.keyTool.deregister(this.keyListener)}};Ru.EdgeAutocompletePaletteTool=Uy;Uy.ID="glsp.edge-autocomplete-palette-tool";KW([(0,VW.inject)(cw.KeyTool),fPe("design:type",cw.KeyTool)],Uy.prototype,"keyTool",void 0);Ru.EdgeAutocompletePaletteTool=Uy=R5=KW([(0,VW.injectable)()],Uy);class zW extends cw.KeyListener{keyDown(e,t){return(0,hPe.matchesKeystroke)(t,"Escape")?[cw.SetUIExtensionVisibilityAction.create({extensionId:pPe.EdgeAutocompletePaletteMetadata.ID,visible:!1,contextElementsId:[]})]:[]}}Ru.EdgeAutocompletePaletteKeyListener=zW;var R1={},jr={};Object.defineProperty(jr,"__esModule",{value:!0});jr.KeyboardNodeGridMetadata=jr.KeyboardGridMetadata=void 0;var cV;(function(n){n.ID="keyboard-grid",n.TAB_INDEX=15})(cV||(jr.KeyboardGridMetadata=cV={}));var dV;(function(n){n.ID="keyboard-node-grid"})(dV||(jr.KeyboardNodeGridMetadata=dV={}));var Zc={};Object.defineProperty(Zc,"__esModule",{value:!0});Zc.KeyboardPointerMetadata=void 0;var uV;(function(n){n.ID="keyboard-pointer",n.CRICLE_HEIGHT=16,n.CIRCLE_WIDTH=16,n.TAB_INDEX=10})(uV||(Zc.KeyboardPointerMetadata=uV={}));var ah={},mPe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(ah,"__esModule",{value:!0});ah.KeyboardToolPalette=void 0;const cl=z,gPe=F,dl=qt,dT=It,Kn=Dn,vPe=mi,_Pe=Ji,yPe=Wc,bPe=er,SPe=ga,EPe=jr,CPe=qb,PPe=sr,wPe="search",APe="tools",lV="chevron-right",RPe="500px",GW=["Digit1","Numpad1"],UW=["Digit2","Numpad2"],YW=["Digit3","Numpad3"],qW=["Digit4","Numpad4"],WW=["Digit5","Numpad5"],uT="accessibility-show-shortcuts",Nv=["KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyX","KeyY","KeyZ"],lT=[GW,UW,YW,qW,WW];let M5=class extends Kn.ToolPalette{constructor(){super(...arguments),this.keyboardIndexButtonMapping=new Map,this.headerToolsButtonMapping=new Map}get interactablePaletteItems(){return this.paletteItems.sort(Kn.compare).map(e=>{var t,i;return(i=(t=e.children)===null||t===void 0?void 0:t.sort(Kn.compare))!==null&&i!==void 0?i:[e]}).reduce((e,t)=>e.concat(t),[])}initializeContents(e){this.containerElement.setAttribute("aria-label","Tool Palette"),this.containerElement.tabIndex=20,this.containerElement.classList.add("accessibility-tool-palette"),this.createHeader(),this.createBody(),this.lastActiveButton=this.defaultToolsButton,this.containerElement.onkeyup=t=>{this.clearToolOnEscape(t),this.isShortcutsVisible()&&(this.selectItemOnCharacter(t),this.triggerHeaderToolsByKey(t))}}handle(e){if(Kn.EnableToolPaletteAction.is(e)){const t=cl.RequestContextActions.create({contextId:Kn.ToolPalette.ID,editorContext:{selectedElementIds:[]}});this.actionDispatcher.requestUntil(t).then(i=>{cl.SetContextActions.is(i)&&(this.paletteItems=i.actions.map(o=>o),this.actionDispatcher.dispatchAll([cl.SetUIExtensionVisibilityAction.create({extensionId:Kn.ToolPalette.ID,visible:!this.editorContext.isReadonly})]))})}else yPe.FocusDomAction.is(e)&&e.id===Kn.ToolPalette.ID?(this.containerElement.contains(document.activeElement)?this.toggleShortcutVisibility():this.showShortcuts(),this.containerElement.focus()):super.handle(e)}addMinimizePaletteButton(){const e=document.getElementById(this.options.baseDiv),t=document.createElement("div");if(t.classList.add("minimize-palette-button"),this.containerElement.classList.add("collapsible-palette"),e){const i=e.insertBefore(t,e.firstChild),o=(0,Kn.createIcon)(lV);this.updateMinimizePaletteButtonTooltip(t),o.onclick=r=>{this.isPaletteMaximized()?(this.containerElement.style.overflow="hidden",this.containerElement.style.maxHeight="0px"):(this.containerElement.style.overflow="visible",this.containerElement.style.maxHeight=RPe),this.updateMinimizePaletteButtonTooltip(t),(0,Kn.changeCodiconClass)(o,APe),(0,Kn.changeCodiconClass)(o,lV)},i.appendChild(o)}}createBody(){const e=document.createElement("div");e.classList.add("palette-body");const t=21;let i=0;if(this.keyboardIndexButtonMapping.clear(),this.paletteItems.sort(Kn.compare).forEach(o=>{if(o.children){const r=(0,Kn.createToolGroup)(o);o.children.sort(Kn.compare).forEach(s=>{const a=this.createKeyboardToolButton(s,t,i);r.appendChild(a),this.keyboardIndexButtonMapping.set(i,a),i++}),e.appendChild(r)}else{const r=this.createKeyboardToolButton(o,t,i);e.appendChild(r),this.keyboardIndexButtonMapping.set(i,r),i++}}),this.paletteItems.length===0){const o=document.createElement("div");o.innerText="No results found.",o.classList.add("tool-button"),e.appendChild(o)}this.bodyDiv&&this.containerElement.removeChild(this.bodyDiv),this.containerElement.appendChild(e),this.bodyDiv=e}createHeaderTools(){this.headerToolsButtonMapping.clear();let e=0;const t=document.createElement("div");t.classList.add("header-tools"),this.defaultToolsButton=this.createDefaultToolButton(),this.headerToolsButtonMapping.set(e++,this.defaultToolsButton),t.appendChild(this.defaultToolsButton),this.deleteToolButton=this.createMouseDeleteToolButton(),this.headerToolsButtonMapping.set(e++,this.deleteToolButton),t.appendChild(this.deleteToolButton),this.marqueeToolButton=this.createMarqueeToolButton(),this.headerToolsButtonMapping.set(e++,this.marqueeToolButton),t.appendChild(this.marqueeToolButton),this.validateToolButton=this.createValidateButton(),this.headerToolsButtonMapping.set(e++,this.validateToolButton),t.appendChild(this.validateToolButton);const i=this.createResetViewportButton();if(this.headerToolsButtonMapping.set(e++,i),t.appendChild(i),this.gridManager){const o=this.createToggleGridButton();this.headerToolsButtonMapping.set(e++,o),t.appendChild(o)}if(this.debugManager){const o=this.createToggleDebugButton();this.headerToolsButtonMapping.set(e++,o),t.appendChild(o)}return this.searchToolButton=this.createSearchButton(),this.headerToolsButtonMapping.set(e++,this.searchToolButton),t.appendChild(this.searchToolButton),t}createDefaultToolButton(){const e=(0,Kn.createIcon)("inspect");return e.id="btn_default_tools",e.title="Enable selection tool",e.onclick=this.onClickStaticToolButton(e),e.appendChild(this.createKeyboardShotcut(GW[0])),e}createMouseDeleteToolButton(){const e=(0,Kn.createIcon)("chrome-close");return e.title="Enable deletion tool",e.onclick=this.onClickStaticToolButton(e,vPe.MouseDeleteTool.ID),e.appendChild(this.createKeyboardShotcut(UW[0])),e}createMarqueeToolButton(){const e=(0,Kn.createIcon)("screen-full");e.title="Enable marquee tool";const t=PPe.ShowToastMessageAction.createWithTimeout({id:Symbol.for(SPe.ElementNavigatorKeyListener.name),message:CPe.tool_palette.marqueeTool});return e.onclick=this.onClickStaticToolButton(e,_Pe.MarqueeMouseTool.ID,t),e.appendChild(this.createKeyboardShotcut(YW[0])),e}createValidateButton(){const e=(0,Kn.createIcon)("pass");return e.title="Validate model",e.onclick=t=>{const i=[this.modelRootId];this.actionDispatcher.dispatch(cl.RequestMarkersAction.create(i))},e.appendChild(this.createKeyboardShotcut(qW[0])),e}onClickStaticToolButton(e,t,i){return o=>{if(!this.editorContext.isReadonly){const r=t?dT.EnableToolsAction.create([t]):dT.EnableDefaultToolsAction.create();i?this.actionDispatcher.dispatchAll([r,i]):this.actionDispatcher.dispatchAll([r]),this.changeActiveButton(e),e.focus()}}}createSearchButton(){const e=(0,Kn.createIcon)(wPe);return e.onclick=t=>{const i=document.getElementById(this.containerElement.id+"_search_field");i&&(i.style.display==="none"?(i.style.display="",i.focus()):i.style.display="none")},e.classList.add("search-icon"),e.title="Filter palette entries",e.appendChild(this.createKeyboardShotcut(WW[0])),e}createHeaderSearchField(){const e=document.createElement("input");return e.classList.add("search-input"),e.tabIndex=21,e.id=this.containerElement.id+"_search_field",e.type="text",e.placeholder="Search...",e.style.display="none",e.onkeyup=t=>{this.requestFilterUpdate(this.searchField.value),t.stopPropagation(),e.value===""?this.focusToolPaletteOnEscape(t):this.clearOnEscape(t)},e}focusToolPaletteOnEscape(e){(0,dl.matchesKeystroke)(e,"Escape")&&this.containerElement.focus()}createKeyboardShotcut(e){const t=document.createElement("div");t.classList.add("key-shortcut");let i=e.toString();return e.includes("Key")?i=e.toString().substring(3):e.includes("Digit")&&(i=e.toString().substring(5)),t.innerHTML=i,t}createKeyboardToolButton(e,t,i){const o=document.createElement("div");return i<Nv.length&&o.appendChild(this.createKeyboardShotcut(Nv[i])),o.tabIndex=t,o.classList.add("tool-button"),e.icon&&o.appendChild((0,Kn.createIcon)(e.icon)),o.insertAdjacentText("beforeend",e.label),o.onclick=this.onClickCreateToolButton(o,e),o.onkeydown=r=>{this.clickToolOnEnter(r,o,e),this.clearToolOnEscape(r),(0,dl.matchesKeystroke)(r,"ArrowDown")?i+1>this.keyboardIndexButtonMapping.size-1?this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(0)):this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(i+1)):(0,dl.matchesKeystroke)(r,"ArrowUp")&&(i-1<0?this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(this.keyboardIndexButtonMapping.size-1)):this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(i-1)))},o}clickToolOnEnter(e,t,i){(0,dl.matchesKeystroke)(e,"Enter")&&(this.editorContext.isReadonly||(this.actionDispatcher.dispatchAll(i.actions),this.changeActiveButton(t),this.selectItemOnCharacter(e)))}selectItemOnCharacter(e){var t;let i;const o=this.interactablePaletteItems,r=o.length<Nv.length?o.length:Nv.length;for(let s=0;s<r;s++){const a=Nv[s];if((0,dl.matchesKeystroke)(e,a)){i=s;break}}i!==void 0&&(o[i].actions.some(s=>s.kind===cl.TriggerNodeCreationAction.KIND)?this.actionDispatcher.dispatchAll([...o[i].actions,cl.SetUIExtensionVisibilityAction.create({extensionId:EPe.KeyboardNodeGridMetadata.ID,visible:!0,contextElementsId:[]})]):this.actionDispatcher.dispatchAll([...o[i].actions,cl.SetUIExtensionVisibilityAction.create({extensionId:bPe.EdgeAutocompletePaletteMetadata.ID,visible:!0,contextElementsId:[]})]),this.changeActiveButton(this.keyboardIndexButtonMapping.get(i)),(t=this.keyboardIndexButtonMapping.get(i))===null||t===void 0||t.focus())}triggerHeaderToolsByKey(e){var t;let i;for(let o=0;o<lT.length;o++)for(let r=0;r<lT[o].length;r++){const s=lT[o][r];if((0,dl.matchesKeystroke)(e,s)){e.stopPropagation(),e.preventDefault(),i=o;break}}i!==void 0&&((t=this.headerToolsButtonMapping.get(i))===null||t===void 0||t.click())}selectItemViaArrowKey(e){e!==void 0&&(this.changeActiveButton(e),e==null||e.focus())}clearToolOnEscape(e){(0,dl.matchesKeystroke)(e,"Escape")&&(e.target instanceof HTMLElement&&e.target.blur(),this.actionDispatcher.dispatch(dT.EnableDefaultToolsAction.create()))}toggleShortcutVisibility(){this.isShortcutsVisible()?this.hideShortcuts():this.showShortcuts()}isShortcutsVisible(){return this.containerElement.classList.contains(uT)}showShortcuts(){this.containerElement.classList.add(uT)}hideShortcuts(){this.containerElement.classList.remove(uT)}};ah.KeyboardToolPalette=M5;ah.KeyboardToolPalette=M5=mPe([(0,gPe.injectable)()],M5);var ZW=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},MPe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},I5;Object.defineProperty(R1,"__esModule",{value:!0});R1.GlobalKeyListenerTool=void 0;const QW=F,fT=z,hT=qt,IPe=Dn,fV=Wc,hV=jr,DPe=Zc,pV=eo,mV=Pt,TPe=ah;let Yy=I5=class{constructor(){this.isEditTool=!1,this.alreadyRegistered=!1}get id(){return I5.ID}enable(){this.alreadyRegistered||(this.alreadyRegistered=!0,document.addEventListener("keyup",this.trigger.bind(this)),this.registerShortcutKey())}disable(){}registerShortcutKey(){this.actionDispatcher.onceModelInitialized().then(()=>{this.actionDispatcher.dispatchAll([pV.SetAccessibleKeyShortcutAction.create({token:TPe.KeyboardToolPalette.name,keys:[{shortcuts:["ALT","P"],description:"Focus on tool palette",group:"Tool-Palette",position:0}]}),pV.SetAccessibleKeyShortcutAction.create({token:"Graph",keys:[{shortcuts:["ALT","G"],description:"Focus on graph",group:"Graph",position:0}]})])})}trigger(e){this.actionDispatcher.dispatchAll(this.handleKeyEvent(e))}handleKeyEvent(e){return this.matchesSetFocusOnToolPalette(e)?[fV.FocusDomAction.create(IPe.ToolPalette.ID)]:this.matchesSetFocusOnDiagram(e)?[fV.FocusDomAction.create("graph")]:this.matchesReleaseFocusFromToolPalette(e)?[fT.SetUIExtensionVisibilityAction.create({extensionId:DPe.KeyboardPointerMetadata.ID,visible:!1,contextElementsId:[]}),fT.SetUIExtensionVisibilityAction.create({extensionId:hV.KeyboardGridMetadata.ID,visible:!1,contextElementsId:[]}),fT.SetUIExtensionVisibilityAction.create({extensionId:hV.KeyboardNodeGridMetadata.ID,visible:!1,contextElementsId:[]})]:[]}matchesSetFocusOnToolPalette(e){return(0,hT.matchesKeystroke)(e,"KeyP","alt")}matchesSetFocusOnDiagram(e){return(0,hT.matchesKeystroke)(e,"KeyG","alt")}matchesReleaseFocusFromToolPalette(e){return(0,hT.matchesKeystroke)(e,"Escape")}};R1.GlobalKeyListenerTool=Yy;Yy.ID="glsp.global-key-listener";ZW([(0,QW.inject)(mV.GLSPActionDispatcher),MPe("design:type",mV.GLSPActionDispatcher)],Yy.prototype,"actionDispatcher",void 0);R1.GlobalKeyListenerTool=Yy=I5=ZW([(0,QW.injectable)()],Yy);var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.KeyboardGridKeyboardEventAction=tr.KeyboardGridCellSelectedAction=tr.EnableKeyboardGridAction=void 0;const Rm=z;var gV;(function(n){n.KIND="enableKeyboardGrid";function e(i){return Rm.Action.hasKind(i,n.KIND)&&(0,Rm.hasObjectProp)(i,"options")}n.is=e;function t(i){return{kind:n.KIND,options:i}}n.create=t})(gV||(tr.EnableKeyboardGridAction=gV={}));var vV;(function(n){n.KIND="keyboardGridCellSelectedAction";function e(i){return Rm.Action.hasKind(i,n.KIND)&&(0,Rm.hasObjectProp)(i,"options")}n.is=e;function t(i){return{kind:n.KIND,options:i}}n.create=t})(vV||(tr.KeyboardGridCellSelectedAction=vV={}));var _V;(function(n){n.KIND="keyboardGridKeyboardEvent";function e(i){return Rm.Action.hasKind(i,n.KIND)&&(0,Rm.hasObjectProp)(i,"options")}n.is=e;function t(i){return{kind:n.KIND,options:i}}n.create=t})(_V||(tr.KeyboardGridKeyboardEventAction=_V={}));var ch={},XW=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},OPe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(ch,"__esModule",{value:!0});ch.KeyboardGrid=void 0;const D5=z,JW=F,pT=qt,LPe=Ms,mT=tr,zE=jr;let dw=class extends LPe.GLSPAbstractUIExtension{constructor(){super(...arguments),this.triggerActions=[]}id(){return zE.KeyboardGridMetadata.ID}containerClass(){return zE.KeyboardGridMetadata.ID}handle(e){mT.EnableKeyboardGridAction.is(e)&&(this.triggerActions=e.options.triggerActions,this.originId=e.options.originId,this.actionDispatcher.dispatch(D5.SetUIExtensionVisibilityAction.create({extensionId:zE.KeyboardGridMetadata.ID,visible:!0})))}initializeContents(e){e.tabIndex=zE.KeyboardGridMetadata.TAB_INDEX,e.classList.add("grid-container");for(let t=1;t<=9;t++){const i=document.createElement("div"),o=document.createElement("div");o.classList.add("grid-item"),o.id=`keyboard-grid-item-${t}`,i.classList.add("grid-item-number"),i.innerHTML=t.toString(),o.appendChild(i),e.appendChild(o)}this.containerElement.onkeydown=t=>{this.onKeyDown(t)}}onKeyDown(e){this.activateCellIfDigitEvent(e),this.hideIfEscapeEvent(e),this.actionDispatcher.dispatch(mT.KeyboardGridKeyboardEventAction.create({originId:this.originId,event:e}))}setContainerVisible(e){this.containerElement&&(e?(this.containerElement.style.visibility="visible",this.containerElement.style.opacity="0.7"):(this.containerElement.style.visibility="hidden",this.containerElement.style.opacity="0"))}show(e,...t){super.show(e,...t),this.containerElement.focus()}hideIfEscapeEvent(e){this.matchesDeactivateGrid(e)&&this.hide()}activateCellIfDigitEvent(e){let t;for(let i=1;i<=9;i++)if(this.matchesGridBoxAtIndex(e,i)){t=i;break}if(t!==void 0){const i=this.centerPositionOfCell(t);this.dispatchActionsForCell(t,i)}}dispatchActionsForCell(e,t){this.actionDispatcher.dispatchAll([...this.triggerActions,mT.KeyboardGridCellSelectedAction.create({originId:this.originId,cellId:e.toString(),centerCellPosition:t})])}centerPositionOfCell(e){let t=0,i=0;const o=document.getElementById(`keyboard-grid-item-${e}`);if(o!==null){const r=this.getCenterOfCell(o);t=r[0],i=r[1]}return{x:t,y:i}}matchesDeactivateGrid(e){return(0,pT.matchesKeystroke)(e,"Escape")}matchesGridBoxAtIndex(e,t){return(0,pT.matchesKeystroke)(e,"Digit"+t)||(0,pT.matchesKeystroke)(e,"Numpad"+t)}getOffset(e){let t=0,i=0;for(;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft-e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{top:i,left:t}}getCenterOfCell(e){const t=this.getOffset(e).left,i=this.getOffset(e).top,o=e.offsetWidth,r=e.offsetHeight,s=o/2,a=r/2;return[t+s,i+a]}};ch.KeyboardGrid=dw;XW([(0,JW.inject)(D5.TYPES.IActionDispatcher),OPe("design:type",D5.ActionDispatcher)],dw.prototype,"actionDispatcher",void 0);ch.KeyboardGrid=dw=XW([(0,JW.injectable)()],dw);var Yo={},NPe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Yo,"__esModule",{value:!0});Yo.GridRevealNamedElementSuggestionProvider=Yo.GridRevealEdgeSuggestionProvider=Yo.GridSearchPalette=Yo.GridSearchPaletteMetadata=void 0;const eZ=z,jPe=F,Z9=Qi,tZ=jr;var T5;(function(n){n.ID="grid-search-palette"})(T5||(Yo.GridSearchPaletteMetadata=T5={}));let O5=class extends Z9.SearchAutocompletePalette{id(){return T5.ID}getSuggestionProviders(e,t){return[new iZ,new nZ]}};Yo.GridSearchPalette=O5;Yo.GridSearchPalette=O5=NPe([(0,jPe.injectable)()],O5);class nZ extends Z9.RevealEdgeElementAutocompleteSuggestionProvider{getActions(e){return[...super.getActions(e),eZ.SetUIExtensionVisibilityAction.create({extensionId:tZ.KeyboardGridMetadata.ID,visible:!0})]}}Yo.GridRevealEdgeSuggestionProvider=nZ;class iZ extends Z9.RevealNamedElementAutocompleteSuggestionProvider{getActions(e){return[...super.getActions(e),eZ.SetUIExtensionVisibilityAction.create({extensionId:tZ.KeyboardGridMetadata.ID,visible:!0})]}}Yo.GridRevealNamedElementSuggestionProvider=iZ;var M1={},dh={},I1={};Object.defineProperty(I1,"__esModule",{value:!0});I1.SetKeyboardPointerRenderPositionAction=void 0;const gT=z;var yV;(function(n){n.KIND="setKeyboardPointerRenderPositionAction";function e(i){return gT.Action.hasKind(i,n.KIND)&&(0,gT.hasNumberProp)(i,"x")&&(0,gT.hasNumberProp)(i,"y")}n.is=e;function t(i,o){return{kind:n.KIND,x:i,y:o}}n.create=t})(yV||(I1.SetKeyboardPointerRenderPositionAction=yV={}));var Qb={};Object.defineProperty(Qb,"__esModule",{value:!0});Qb.KeyboardPointerKeyboardListener=void 0;const GE=z,ul=qt,BPe=jr,$Pe=Zc,kPe=It,FPe=it;class xPe{get position(){return this.keyboardPointer.getPosition}constructor(e,t){this.keyboardPointer=e,this.actionDispatcher=t}keyDown(e){this.moveIfArrows(e),this.createIfEnterEvent(e),this.hideIfEscapeEvent(e)}moveIfArrows(e){this.matchesMovePointerDown(e)?(this.position.renderPosition=this.position.calcRelativeRenderPosition(0,10),this.keyboardPointer.render()):this.matchesMovePointerUp(e)?(this.position.renderPosition=this.position.calcRelativeRenderPosition(0,-10),this.keyboardPointer.render()):this.matchesMovePointerRight(e)?(this.position.renderPosition=this.position.calcRelativeRenderPosition(10,0),this.keyboardPointer.render()):this.matchesMovePointerLeft(e)&&(this.position.renderPosition=this.position.calcRelativeRenderPosition(-10,0),this.keyboardPointer.render())}createIfEnterEvent(e){const t=this.keyboardPointer.triggerAction.elementTypeId,{container:i,status:o}=this.position.containableParentAtDiagramPosition(t);if(i!==void 0&&o===FPe.CursorCSS.NODE_CREATION){if(this.matchesConfirmPointerPosition(e)){const r=i.id,s=this.position.diagramPosition;this.actionDispatcher.dispatchAll([GE.SetUIExtensionVisibilityAction.create({extensionId:$Pe.KeyboardPointerMetadata.ID,visible:!1,contextElementsId:[]}),GE.SetUIExtensionVisibilityAction.create({extensionId:BPe.KeyboardNodeGridMetadata.ID,visible:!1,contextElementsId:[]}),GE.CreateNodeOperation.create(t,{location:s,containerId:r,args:this.keyboardPointer.triggerAction.args}),kPe.EnableDefaultToolsAction.create()])}else if(this.matchesConfirmPointerPositionAndStayInMode(e)){const r=i.id,s=this.position.diagramPosition;this.actionDispatcher.dispatch(GE.CreateNodeOperation.create(t,{location:s,containerId:r,args:this.keyboardPointer.triggerAction.args}))}}}hideIfEscapeEvent(e){this.matchesDeactivatePointer(e)&&this.keyboardPointer.hide()}matchesDeactivatePointer(e){return(0,ul.matchesKeystroke)(e,"Escape")}matchesConfirmPointerPosition(e){return(0,ul.matchesKeystroke)(e,"Enter")}matchesConfirmPointerPositionAndStayInMode(e){return(0,ul.matchesKeystroke)(e,"Enter","ctrl")}matchesMovePointerLeft(e){return(0,ul.matchesKeystroke)(e,"ArrowLeft")}matchesMovePointerRight(e){return(0,ul.matchesKeystroke)(e,"ArrowRight")}matchesMovePointerUp(e){return(0,ul.matchesKeystroke)(e,"ArrowUp")}matchesMovePointerDown(e){return(0,ul.matchesKeystroke)(e,"ArrowDown")}}Qb.KeyboardPointerKeyboardListener=xPe;var Xb={};Object.defineProperty(Xb,"__esModule",{value:!0});Xb.KeyboardPointerPosition=void 0;const bV=z,HPe=n1,KPe=Ct,SV=Zc,EV=it;class VPe{constructor(e){this.keyboardPointer=e,this.renderPosition={x:20,y:20}}get centerizedRenderPosition(){return{x:this.renderPosition.x+SV.KeyboardPointerMetadata.CIRCLE_WIDTH/2,y:this.renderPosition.y+SV.KeyboardPointerMetadata.CRICLE_HEIGHT/2}}get diagramPosition(){return(0,KPe.getAbsolutePositionByPoint)(this.keyboardPointer.editorContextService.modelRoot,this.centerizedRenderPosition)}childrenAtDiagramPosition(){const e=this.diagramPosition;return[this.keyboardPointer.editorContextService.modelRoot,...(0,bV.findChildrenAtPosition)(this.keyboardPointer.editorContextService.modelRoot,e)]}containableParentAtDiagramPosition(e){const t=this.childrenAtDiagramPosition();return this.containableParentOf(t.reverse()[0],e)}calcRelativeRenderPosition(e,t){return{x:this.renderPosition.x+e,y:this.renderPosition.y+t}}containableParentOf(e,t){const i=(0,bV.findParentByFeature)(e,HPe.isContainable);return{container:i,status:this.isCreationAllowed(i,t)?EV.CursorCSS.NODE_CREATION:EV.CursorCSS.OPERATION_NOT_ALLOWED}}isCreationAllowed(e,t){return e&&e.isContainableElement(t)}}Xb.KeyboardPointerPosition=VPe;var oZ=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},rZ=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},zPe=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(dh,"__esModule",{value:!0});dh.KeyboardPointer=void 0;const sZ=z,L5=F,CV=An,PV=it,GPe=Ms,UPe=tr,YPe=I1,jv=Zc,qPe=Qb,WPe=Xb;let uw=class extends GPe.GLSPAbstractUIExtension{constructor(e){super(),this.actionDispatcher=e,this._triggerAction={elementTypeId:"task:automated",kind:"triggerNodeCreation"},this.position=new WPe.KeyboardPointerPosition(this),this.keyListener=new qPe.KeyboardPointerKeyboardListener(this,e)}get triggerAction(){return this._triggerAction}get isVisible(){var e;return((e=this.containerElement)===null||e===void 0?void 0:e.style.visibility)==="visible"}get getPosition(){return this.position}get getKeyListener(){return this.keyListener}id(){return jv.KeyboardPointerMetadata.ID}containerClass(){return jv.KeyboardPointerMetadata.ID}initializeContents(e){e.style.position="absolute",e.style.height=`${jv.KeyboardPointerMetadata.CRICLE_HEIGHT}px`,e.style.width=`${jv.KeyboardPointerMetadata.CIRCLE_WIDTH}px`,e.style.borderRadius="100%"}onBeforeShow(e,t,...i){this.render()}handle(e){sZ.TriggerNodeCreationAction.is(e)?this._triggerAction=e:YPe.SetKeyboardPointerRenderPositionAction.is(e)?(this.position.renderPosition={x:e.x,y:e.y},this.render()):UPe.KeyboardGridCellSelectedAction.is(e)&&e.options.originId===jv.KeyboardPointerMetadata.ID&&(this.position.renderPosition=e.options.centerCellPosition,this.render())}render(){if(this.containerElement!==void 0){const{x:e,y:t}=this.position.renderPosition;this.containerElement.style.left=`${e}px`,this.containerElement.style.top=`${t}px`;const{status:i}=this.position.containableParentAtDiagramPosition(this._triggerAction.elementTypeId);switch(this.containerElement.style.borderStyle="solid",this.containerElement.style.borderWidth="thick",i){case PV.CursorCSS.NODE_CREATION:{this.containerElement.style.borderColor="green";break}case PV.CursorCSS.OPERATION_NOT_ALLOWED:{this.containerElement.style.borderColor="red";break}}}}};dh.KeyboardPointer=uw;oZ([(0,L5.inject)(CV.EditorContextService),rZ("design:type",CV.EditorContextService)],uw.prototype,"editorContextService",void 0);dh.KeyboardPointer=uw=oZ([(0,L5.injectable)(),zPe(0,(0,L5.inject)(sZ.TYPES.IActionDispatcher)),rZ("design:paramtypes",[Object])],uw);var aZ=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ZPe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(M1,"__esModule",{value:!0});M1.KeyboardNodeGrid=void 0;const cZ=F,wV=z,QPe=qt,AV=dh,RV=Zc,XPe=Yo,JPe=ch,ewe=jr;let lw=class extends JPe.KeyboardGrid{constructor(){super(...arguments),this.triggerActions=[wV.SetUIExtensionVisibilityAction.create({extensionId:RV.KeyboardPointerMetadata.ID,visible:!0})],this.originId=RV.KeyboardPointerMetadata.ID}id(){return ewe.KeyboardNodeGridMetadata.ID}handle(e){}onKeyDown(e){super.onKeyDown(e),this.showSearchOnEvent(e),this.keyboardPointer.isVisible&&this.keyboardPointer.getKeyListener.keyDown(e)}showSearchOnEvent(e){(0,QPe.matchesKeystroke)(e,"KeyF","ctrl")&&(e.preventDefault(),this.actionDispatcher.dispatch(wV.SetUIExtensionVisibilityAction.create({extensionId:XPe.GridSearchPaletteMetadata.ID,visible:!0})),this.hide())}};M1.KeyboardNodeGrid=lw;aZ([(0,cZ.inject)(AV.KeyboardPointer),ZPe("design:type",AV.KeyboardPointer)],lw.prototype,"keyboardPointer",void 0);M1.KeyboardNodeGrid=lw=aZ([(0,cZ.injectable)()],lw);Object.defineProperty(cf,"__esModule",{value:!0});cf.configureKeyboardControlTools=cf.keyboardControlModule=void 0;const ln=z,twe=A1,vT=er,nwe=Ru,iwe=R1,MV=tr,IV=ch,owe=Yo,rwe=M1,swe=I1,UE=dh;cf.keyboardControlModule=new ln.FeatureModule((n,e,t,i)=>{dZ({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("keyboardControl")});function dZ(n){(0,ln.bindAsService)(n,ln.TYPES.IDefaultTool,iwe.GlobalKeyListenerTool),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,UE.KeyboardPointer),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,IV.KeyboardGrid),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,rwe.KeyboardNodeGrid),(0,ln.configureActionHandler)(n,ln.TriggerNodeCreationAction.KIND,UE.KeyboardPointer),(0,ln.configureActionHandler)(n,swe.SetKeyboardPointerRenderPositionAction.KIND,UE.KeyboardPointer),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,vT.EdgeAutocompletePalette),(0,ln.bindAsService)(n,ln.TYPES.IDefaultTool,nwe.EdgeAutocompletePaletteTool),(0,ln.configureActionHandler)(n,MV.EnableKeyboardGridAction.KIND,IV.KeyboardGrid),(0,ln.configureActionHandler)(n,MV.KeyboardGridCellSelectedAction.KIND,UE.KeyboardPointer),(0,ln.configureActionHandler)(n,ln.TriggerEdgeCreationAction.KIND,vT.EdgeAutocompletePalette),(0,ln.configureActionHandler)(n,twe.SetEdgeTargetSelectionAction.KIND,vT.EdgeAutocompletePalette),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,owe.GridSearchPalette)}cf.configureKeyboardControlTools=dZ;var df={};Object.defineProperty(df,"__esModule",{value:!0});df.configureKeyboardToolPaletteTool=df.keyboardToolPaletteModule=void 0;const Qr=z,awe=It,cwe=Dn,dwe=Wc,ll=ah;df.keyboardToolPaletteModule=new Qr.FeatureModule((n,e,t,i)=>{uZ({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("keyboardToolPalette")});function uZ(n){(0,Qr.bindAsService)(n,Qr.TYPES.IUIExtension,ll.KeyboardToolPalette),n.bind(Qr.TYPES.IDiagramStartup).toService(ll.KeyboardToolPalette),(0,Qr.configureActionHandler)(n,awe.EnableDefaultToolsAction.KIND,ll.KeyboardToolPalette),(0,Qr.configureActionHandler)(n,dwe.FocusDomAction.KIND,ll.KeyboardToolPalette),(0,Qr.configureActionHandler)(n,cwe.EnableToolPaletteAction.KIND,ll.KeyboardToolPalette),(0,Qr.configureActionHandler)(n,Qr.UpdateModelAction.KIND,ll.KeyboardToolPalette),(0,Qr.configureActionHandler)(n,Qr.SetModelAction.KIND,ll.KeyboardToolPalette)}df.configureKeyboardToolPaletteTool=uZ;var uf={},yo={},Oa=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},oa=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(yo,"__esModule",{value:!0});yo.MoveElementHandler=yo.MoveViewportHandler=yo.MoveElementAction=yo.MoveViewportAction=void 0;const Di=z,Br=F,uwe=sh,fw=An,DV=kt,lwe=yn,fwe=Ct;var hw;(function(n){n.KIND="moveViewportAction";function e(i){return Di.Action.hasKind(i,n.KIND)}n.is=e;function t(i,o){return{kind:n.KIND,moveX:i,moveY:o}}n.create=t})(hw||(yo.MoveViewportAction=hw={}));var N5;(function(n){n.KIND="moveElementAction";function e(i){return Di.Action.hasKind(i,n.KIND)}n.is=e;function t(i,o,r,s=!0){return{kind:n.KIND,elementIds:i,moveX:o,moveY:r,snap:s}}n.create=t})(N5||(yo.MoveElementAction=N5={}));let qy=class{handle(e){hw.is(e)&&this.handleMoveViewport(e)}handleMoveViewport(e){const t=(0,Di.findParentByFeature)(this.editorContextService.modelRoot,Di.isViewport);t&&this.dispatcher.dispatch(this.moveViewport(t,e.moveX,e.moveY))}moveViewport(e,t,i){const o={scroll:{x:e.scroll.x+t,y:e.scroll.y+i},zoom:e.zoom};return Di.SetViewportAction.create(e.id,o,{animate:!1})}};yo.MoveViewportHandler=qy;Oa([(0,Br.inject)(fw.EditorContextService),oa("design:type",fw.EditorContextService)],qy.prototype,"editorContextService",void 0);Oa([(0,Br.inject)(Di.TYPES.IActionDispatcher),oa("design:type",Object)],qy.prototype,"dispatcher",void 0);yo.MoveViewportHandler=qy=Oa([(0,Br.injectable)()],qy);let Oc=class{init(){this.moveFeedback=this.feedbackDispatcher.createEmitter()}handle(e){N5.is(e)&&this.handleMoveElement(e)}handleMoveElement(e){const t=this.editorContextService.modelRoot,i=(0,Di.findParentByFeature)(t,Di.isViewport);if(!i)return;const o=[],r=[],s=(0,DV.getElements)(t.index,e.elementIds,DV.isSelectableAndBoundsAware);for(const f of s){const h=this.getTargetBounds(f,e);r.push({elementId:f.id,fromPosition:{x:f.bounds.x,y:f.bounds.y},toPosition:h}),(0,fwe.outsideOfViewport)(h,i)&&o.push(hw.create(e.moveX,e.moveY))}this.dispatcher.dispatchAll(o);const a=Di.MoveAction.create(r,{animate:!1});this.moveFeedback.add(a).submit(),this.scheduleChangeBounds(this.toElementAndBounds(r))}getTargetBounds(e,t){let i=Di.Point.add(e.bounds,{x:t.moveX,y:t.moveY});return this.snapper&&t.snap&&(i=this.snapper.snap(i,e)),(0,lwe.isValidMove)(e,i,this.movementRestrictor)||(i={x:e.bounds.x,y:e.bounds.y}),i}scheduleChangeBounds(e){var t;(t=this.debouncedChangeBounds)===null||t===void 0||t.cancel(),this.debouncedChangeBounds=(0,uwe.debounce)(()=>{this.moveFeedback.dispose(),this.dispatcher.dispatchAll([Di.ChangeBoundsOperation.create(e)]),this.debouncedChangeBounds=void 0},300),this.debouncedChangeBounds()}toElementAndBounds(e){const t=[];for(const i of e){const o=this.editorContextService.modelRoot.index.getById(i.elementId);o&&(0,Di.isBoundsAware)(o)&&t.push({elementId:i.elementId,newSize:{height:o.bounds.height,width:o.bounds.width},newPosition:{x:i.toPosition.x,y:i.toPosition.y}})}return t}};yo.MoveElementHandler=Oc;Oa([(0,Br.inject)(fw.EditorContextService),oa("design:type",fw.EditorContextService)],Oc.prototype,"editorContextService",void 0);Oa([(0,Br.inject)(Di.TYPES.IActionDispatcher),oa("design:type",Object)],Oc.prototype,"dispatcher",void 0);Oa([(0,Br.inject)(Di.TYPES.IFeedbackActionDispatcher),oa("design:type",Object)],Oc.prototype,"feedbackDispatcher",void 0);Oa([(0,Br.inject)(Di.TYPES.ISnapper),(0,Br.optional)(),oa("design:type",Object)],Oc.prototype,"snapper",void 0);Oa([(0,Br.inject)(Di.TYPES.IMovementRestrictor),(0,Br.optional)(),oa("design:type",Object)],Oc.prototype,"movementRestrictor",void 0);Oa([(0,Br.postConstruct)(),oa("design:type",Function),oa("design:paramtypes",[]),oa("design:returntype",void 0)],Oc.prototype,"init",null);yo.MoveElementHandler=Oc=Oa([(0,Br.injectable)()],Oc);var bo={},D1=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cM=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(bo,"__esModule",{value:!0});bo.ZoomElementHandler=bo.ZoomViewportHandler=bo.ZoomElementAction=bo.ZoomViewportAction=void 0;const T1=F,lZ=sh,Vo=z,pw=An,TV=kt;var j5;(function(n){n.KIND="zoomViewportAction";function e(i){return Vo.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,zoomFactor:i}}n.create=t})(j5||(bo.ZoomViewportAction=j5={}));var B5;(function(n){n.KIND="zoomElementAction";function e(i){return Vo.Action.hasKind(i,n.KIND)}n.is=e;function t(i,o){return{kind:n.KIND,elementIds:i,zoomFactor:o}}n.create=t})(B5||(bo.ZoomElementAction=B5={}));let lf=class{constructor(){this.throttledHandleViewportZoom=(0,lZ.throttle)(e=>this.handleZoomViewport(e),150)}handle(e){j5.is(e)&&this.throttledHandleViewportZoom(e)}handleZoomViewport(e){const t=(0,Vo.findParentByFeature)(this.editorContextService.modelRoot,Vo.isViewport);t&&this.dispatcher.dispatch(this.setNewZoomFactor(t,e.zoomFactor))}setNewZoomFactor(e,t){const i=e.zoom*t,o={scroll:e.scroll,zoom:i};return Vo.SetViewportAction.create(e.id,o,{animate:!0})}};bo.ZoomViewportHandler=lf;lf.defaultZoomInFactor=1.1;lf.defaultZoomOutFactor=.9;D1([(0,T1.inject)(pw.EditorContextService),cM("design:type",pw.EditorContextService)],lf.prototype,"editorContextService",void 0);D1([(0,T1.inject)(Vo.TYPES.IActionDispatcher),cM("design:type",Object)],lf.prototype,"dispatcher",void 0);bo.ZoomViewportHandler=lf=D1([(0,T1.injectable)()],lf);let Wy=class{constructor(){this.throttledHandleElementZoom=(0,lZ.throttle)(e=>this.handleZoomElement(e),150)}handle(e){B5.is(e)&&this.throttledHandleElementZoom(e)}handleZoomElement(e){const t=(0,Vo.findParentByFeature)(this.editorContextService.modelRoot,Vo.isViewport);if(!t)return;const i=(0,TV.getElements)(this.editorContextService.modelRoot.index,e.elementIds,TV.isSelectableAndBoundsAware),o=this.getCenter(t,i);this.dispatcher.dispatch(this.setNewZoomFactor(t,e.zoomFactor,o))}getCenter(e,t){const o=t.map(r=>this.boundsInViewport(e,r,r.bounds)).reduce((r,s)=>Vo.Bounds.combine(r,s));return Vo.Bounds.center(o)}boundsInViewport(e,t,i){return t instanceof Vo.GChildElement&&t.parent!==e?this.boundsInViewport(e,t.parent,t.parent.localToParent(i)):i}setNewZoomFactor(e,t,i){const o=e.zoom*t,r={scroll:{x:i.x-.5*e.canvasBounds.width/o,y:i.y-.5*e.canvasBounds.height/o},zoom:o};return Vo.SetViewportAction.create(e.id,r,{animate:!0})}};bo.ZoomElementHandler=Wy;D1([(0,T1.inject)(pw.EditorContextService),cM("design:type",pw.EditorContextService)],Wy.prototype,"editorContextService",void 0);D1([(0,T1.inject)(Vo.TYPES.IActionDispatcher),cM("design:type",Object)],Wy.prototype,"dispatcher",void 0);bo.ZoomElementHandler=Wy=D1([(0,T1.injectable)()],Wy);Object.defineProperty(uf,"__esModule",{value:!0});uf.configureMoveZoom=uf.moveZoomModule=void 0;const Jv=z,np=yo,ip=bo;uf.moveZoomModule=new Jv.FeatureModule((n,e,t,i)=>{fZ({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("moveZoom")});function fZ(n){n.bind(np.MoveViewportHandler).toSelf().inSingletonScope(),n.bind(np.MoveElementHandler).toSelf().inSingletonScope(),n.bind(ip.ZoomViewportHandler).toSelf().inSingletonScope(),n.bind(ip.ZoomElementHandler).toSelf().inSingletonScope(),(0,Jv.configureActionHandler)(n,np.MoveViewportAction.KIND,np.MoveViewportHandler),(0,Jv.configureActionHandler)(n,np.MoveElementAction.KIND,np.MoveElementHandler),(0,Jv.configureActionHandler)(n,ip.ZoomViewportAction.KIND,ip.ZoomViewportHandler),(0,Jv.configureActionHandler)(n,ip.ZoomElementAction.KIND,ip.ZoomElementHandler)}uf.configureMoveZoom=fZ;var ff={},fs={},O1=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Ud=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},OV=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}},T3;Object.defineProperty(fs,"__esModule",{value:!0});fs.ResizeElementHandler=fs.ResizeElementAction=fs.ResizeType=void 0;const hf=z,sc=F,hwe=sh,LV=An,_T=kt,YE=yn;var A_;(function(n){n[n.Increase=0]="Increase",n[n.Decrease=1]="Decrease",n[n.MinSize=2]="MinSize"})(A_||(fs.ResizeType=A_={}));var $5;(function(n){n.KIND="resizeElementAction";function e(i){return hf.Action.hasKind(i,n.KIND)}n.is=e;function t(i,o){return{kind:n.KIND,elementIds:i,resizeType:o}}n.create=t})($5||(fs.ResizeElementAction=$5={}));let _a=T3=class{constructor(e){this.snapper=e,this.grid={x:T3.defaultResizeX,y:T3.defaultResizeY},this.isEditMode=!1}init(){this.resizeFeedback=this.feedbackDispatcher.createEmitter()}handle(e){$5.is(e)&&this.handleResizeElement(e)}handleResizeElement(e){var t;const i=(0,_T.getElements)(this.editorContextService.modelRoot.index,e.elementIds,_T.isSelectableAndBoundsAware),o=this.computeElementAndBounds(i,e);this.resizeFeedback.add(hf.SetBoundsAction.create(o)).submit(),(t=this.debouncedChangeBounds)===null||t===void 0||t.cancel(),this.debouncedChangeBounds=(0,hwe.debounce)(()=>{this.resizeFeedback.dispose(),this.dispatcher.dispatchAll([hf.ChangeBoundsOperation.create(o)]),this.debouncedChangeBounds=void 0},300),this.debouncedChangeBounds()}computeElementAndBounds(e,t){const i=[];return e.forEach(o=>{const{x:r,y:s,width:a,height:f}=o.bounds;let h=0,g=0;if(t.resizeType===A_.Decrease?(h=a-this.grid.x,g=f-this.grid.y):t.resizeType===A_.Increase?(h=a+this.grid.x,g=f+this.grid.y):t.resizeType===A_.MinSize&&(h=(0,YE.minWidth)(o),g=(0,YE.minHeight)(o)),this.isValidBoundChange(o,{x:r,y:s},{width:h,height:g})){const y={id:o.id,bounds:{x:r,y:s,width:h,height:g}};i.push((0,_T.toElementAndBounds)(y))}}),i}isValidBoundChange(e,t,i){return(0,YE.isValidSize)(e,i)&&(0,YE.isValidMove)(e,t)}};fs.ResizeElementHandler=_a;_a.defaultResizeX=20;_a.defaultResizeY=20;O1([(0,sc.inject)(LV.EditorContextService),Ud("design:type",LV.EditorContextService)],_a.prototype,"editorContextService",void 0);O1([(0,sc.inject)(hf.TYPES.IActionDispatcher),Ud("design:type",Object)],_a.prototype,"dispatcher",void 0);O1([(0,sc.inject)(hf.TYPES.IFeedbackActionDispatcher),Ud("design:type",Object)],_a.prototype,"feedbackDispatcher",void 0);O1([(0,sc.inject)(hf.TYPES.Grid),(0,sc.optional)(),Ud("design:type",Object)],_a.prototype,"grid",void 0);O1([(0,sc.postConstruct)(),Ud("design:type",Function),Ud("design:paramtypes",[]),Ud("design:returntype",void 0)],_a.prototype,"init",null);fs.ResizeElementHandler=_a=T3=O1([(0,sc.injectable)(),OV(0,(0,sc.inject)(hf.TYPES.ISnapper)),OV(0,(0,sc.optional)()),Ud("design:paramtypes",[Object])],_a);var Lc={},uh=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},L1=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},k5,e_;Object.defineProperty(Lc,"__esModule",{value:!0});Lc.ResizeKeyListener=Lc.ResizeKeyTool=void 0;const Nc=F,fl=qt,Mm=z,pwe=Pt,NV=Yt,jV=It,mwe=eo,BV=qb,$V=sr,op=fs;let Es=k5=class{constructor(){this.isEditTool=!0,this.resizeKeyListener=new mw(this)}get id(){return k5.ID}enable(){this.keytool.register(this.resizeKeyListener),this.resizeKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.resizeKeyListener)}};Lc.ResizeKeyTool=Es;Es.ID="glsp.resize-key-tool";uh([(0,Nc.inject)(Mm.KeyTool),L1("design:type",Mm.KeyTool)],Es.prototype,"keytool",void 0);uh([(0,Nc.inject)(Mm.TYPES.IMovementRestrictor),(0,Nc.optional)(),L1("design:type",Object)],Es.prototype,"movementRestrictor",void 0);uh([(0,Nc.inject)(Mm.TYPES.ISnapper),(0,Nc.optional)(),L1("design:type",Object)],Es.prototype,"snapper",void 0);uh([(0,Nc.inject)(Mm.TYPES.IActionDispatcher),L1("design:type",pwe.GLSPActionDispatcher)],Es.prototype,"actionDispatcher",void 0);uh([(0,Nc.inject)(NV.SelectionService),L1("design:type",NV.SelectionService)],Es.prototype,"selectionService",void 0);Lc.ResizeKeyTool=Es=k5=uh([(0,Nc.injectable)()],Es);let mw=e_=class extends Mm.KeyListener{constructor(e){super(),this.tool=e,this.isEditMode=!1,this.token=e_.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(mwe.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["ALT","A"],description:"Activate resize mode for selected element",group:"Resize",position:0},{shortcuts:["+"],description:"Increase size of element",group:"Resize",position:1},{shortcuts:["-"],description:"Increase size of element",group:"Resize",position:2},{shortcuts:["CTRL","0"],description:"Set element size to default",group:"Resize",position:3}]}))}keyDown(e,t){const i=[],o=this.tool.selectionService.getSelectedElementIDs();return this.isEditMode&&this.matchesDeactivateResizeModeKeystroke(t)&&(this.isEditMode=!1,this.tool.actionDispatcher.dispatch($V.ShowToastMessageAction.createWithTimeout({id:Symbol.for(e_.name),message:BV.resize.resize_mode_deactivated})),i.push(jV.EnableDefaultToolsAction.create())),o.length>0&&(!this.isEditMode&&this.matchesActivateResizeModeKeystroke(t)&&(this.isEditMode=!0,this.tool.actionDispatcher.dispatch($V.ShowToastMessageAction.create({id:Symbol.for(e_.name),message:BV.resize.resize_mode_activated})),i.push(jV.EnableToolsAction.create([Es.ID]))),this.isEditMode&&(this.matchesIncreaseSizeKeystroke(t)?i.push(op.ResizeElementAction.create(o,op.ResizeType.Increase)):this.matchesDecreaseSizeKeystroke(t)?i.push(op.ResizeElementAction.create(o,op.ResizeType.Decrease)):this.matchesMinSizeKeystroke(t)&&i.push(op.ResizeElementAction.create(o,op.ResizeType.MinSize)))),i}matchesIncreaseSizeKeystroke(e){return e.key==="+"||(0,fl.matchesKeystroke)(e,"NumpadAdd")}matchesActivateResizeModeKeystroke(e){return(0,fl.matchesKeystroke)(e,"KeyA","alt")}matchesDeactivateResizeModeKeystroke(e){return(0,fl.matchesKeystroke)(e,"Escape")}matchesMinSizeKeystroke(e){return(0,fl.matchesKeystroke)(e,"Digit0","ctrl")||(0,fl.matchesKeystroke)(e,"Numpad0","ctrl")}matchesDecreaseSizeKeystroke(e){return(0,fl.matchesKeystroke)(e,"Minus")||(0,fl.matchesKeystroke)(e,"NumpadSubtract")}};Lc.ResizeKeyListener=mw;Lc.ResizeKeyListener=mw=e_=uh([(0,Nc.injectable)(),L1("design:paramtypes",[Es])],mw);Object.defineProperty(ff,"__esModule",{value:!0});ff.configureResizeTools=ff.resizeKeyModule=void 0;const O3=z,yT=fs,gwe=Lc;ff.resizeKeyModule=new O3.FeatureModule((n,e,t,i)=>{hZ({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("resizeKey")});function hZ(n){n.bind(yT.ResizeElementHandler).toSelf().inSingletonScope(),(0,O3.configureActionHandler)(n,yT.ResizeElementAction.KIND,yT.ResizeElementHandler),(0,O3.bindAsService)(n,O3.TYPES.IDefaultTool,gwe.ResizeKeyTool)}ff.configureResizeTools=hZ;var pf={};Object.defineProperty(pf,"__esModule",{value:!0});pf.configureSearchPaletteModule=pf.searchPaletteModule=void 0;const t_=z,vwe=Qi,_we=Tc;pf.searchPaletteModule=new t_.FeatureModule((n,e,t,i)=>{pZ({bind:n,isBound:t,rebind:i})},{featureId:Symbol("searchPalette")});function pZ(n){(0,t_.bindAsService)(n,t_.TYPES.IUIExtension,vwe.SearchAutocompletePalette),(0,t_.bindAsService)(n,t_.TYPES.IDefaultTool,_we.SearchAutocompletePaletteTool)}pf.configureSearchPaletteModule=pZ;var Q9={},N1={},X9=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},mZ=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},L3;Object.defineProperty(N1,"__esModule",{value:!0});N1.Toast=void 0;const ywe=z,J9=F,bwe=Pt,kV=An,Swe=Ms,FV=sr;let Im=L3=class extends Swe.GLSPAbstractUIExtension{constructor(){super(...arguments),this.messages={}}id(){return L3.ID}containerClass(){return L3.ID}initializeContents(e){this.render()}handle(e){FV.ShowToastMessageAction.is(e)?(this.messages[e.options.id]=e.options,this.render(),e.options.timeout&&setTimeout(()=>{this.delete(e.options.id)},e.options.timeout)):FV.HideToastAction.is(e)&&(e.options.timeout?setTimeout(()=>{this.delete(e.options.id)},e.options.timeout):this.delete(e.options.id))}render(){this.containerElement!==void 0&&(this.containerElement.innerHTML="",this.values(this.messages).forEach(e=>{this.containerElement.appendChild(this.createToastMessage(e))}))}delete(e){delete this.messages[e],this.render()}createToastMessage(e){const t=document.createElement("div");t.classList.add("toast-cell",`toast-column-${e.position}`);const i=document.createElement("div");i.classList.add("toast-container");const o=document.createElement("span");return o.textContent=e.message,i.appendChild(o),t.appendChild(i),t}preInitialize(){this.show(this.editorContext.modelRoot)}values(e){return Object.getOwnPropertySymbols(e).map(t=>e[t])}};N1.Toast=Im;Im.ID="toast";X9([(0,J9.inject)(ywe.TYPES.IActionDispatcher),mZ("design:type",bwe.GLSPActionDispatcher)],Im.prototype,"actionDispatcher",void 0);X9([(0,J9.inject)(kV.EditorContextService),mZ("design:type",kV.EditorContextService)],Im.prototype,"editorContext",void 0);N1.Toast=Im=L3=X9([(0,J9.injectable)()],Im);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.glspToastModule=n.configureToastTool=n.toastModule=void 0;const e=z,t=sr,i=N1;n.toastModule=new e.FeatureModule((r,s,a,f)=>{o({bind:r,unbind:s,isBound:a,rebind:f})},{featureId:Symbol("toast")}),n.glspToastModule=n.toastModule;function o(r){(0,e.bindAsService)(r,e.TYPES.IUIExtension,i.Toast),r.bind(e.TYPES.IDiagramStartup).toService(i.Toast),(0,e.configureActionHandler)(r,t.ShowToastMessageAction.KIND,i.Toast),(0,e.configureActionHandler)(r,t.HideToastAction.KIND,i.Toast)}n.configureToastTool=o})(Q9);var mf={},Mu={},e4=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},gZ=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},F5;Object.defineProperty(Mu,"__esModule",{value:!0});Mu.DeselectKeyListener=Mu.DeselectKeyTool=void 0;const Cl=z,t4=F,Ewe=Mo,Cwe=qt,Pwe=mt;let Dm=F5=class{constructor(){this.isEditTool=!0,this.deselectKeyListener=new vZ}get id(){return F5.ID}enable(){this.keytool.register(this.deselectKeyListener)}disable(){this.keytool.deregister(this.deselectKeyListener)}};Mu.DeselectKeyTool=Dm;Dm.ID="glsp.deselect-key-tool";e4([(0,t4.inject)(Cl.KeyTool),gZ("design:type",Cl.KeyTool)],Dm.prototype,"keytool",void 0);e4([(0,t4.inject)(Cl.TYPES.IToolManager),gZ("design:type",Object)],Dm.prototype,"toolManager",void 0);Mu.DeselectKeyTool=Dm=F5=e4([(0,t4.injectable)()],Dm);class vZ extends Cl.KeyListener{keyDown(e,t){if(this.matchesDeselectKeystroke(t)){const i=(0,Ewe.toArray)(e.root.index.all().filter(s=>(0,Cl.isSelectable)(s)&&s.selected)),o=[];i.length>0&&o.push(Cl.SelectAction.create({deselectedElementsIDs:i.map(s=>s.id)}));const r=i.filter(s=>s instanceof Cl.GRoutableElement).map(s=>s.id);return r.length>0&&o.push(Pwe.SwitchRoutingModeAction.create({elementsToDeactivate:r})),o}return[]}matchesDeselectKeystroke(e){return(0,Cwe.matchesKeystroke)(e,"Escape")}}Mu.DeselectKeyListener=vZ;var Iu={},lh=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},j1=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},x5;Object.defineProperty(Iu,"__esModule",{value:!0});Iu.MoveKeyListener=Iu.MovementKeyTool=void 0;const Tm=z,jc=F,pd=qt,wwe=Pt,xV=Yt,HV=Da,Awe=eo,md=yo;let ya=x5=class{constructor(){this.isEditTool=!0}get id(){return x5.ID}enable(){this.movementKeyListener||(this.movementKeyListener=new Yd(this,this.grid)),this.keytool.register(this.movementKeyListener),this.movementKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.movementKeyListener)}};Iu.MovementKeyTool=ya;ya.ID="glsp.movement-key-tool";lh([(0,jc.inject)(Tm.KeyTool),j1("design:type",Tm.KeyTool)],ya.prototype,"keytool",void 0);lh([(0,jc.inject)(xV.SelectionService),j1("design:type",xV.SelectionService)],ya.prototype,"selectionService",void 0);lh([(0,jc.inject)(Tm.TYPES.ISnapper),(0,jc.optional)(),j1("design:type",Object)],ya.prototype,"snapper",void 0);lh([(0,jc.inject)(Tm.TYPES.IActionDispatcher),j1("design:type",wwe.GLSPActionDispatcher)],ya.prototype,"actionDispatcher",void 0);lh([(0,jc.inject)(Tm.TYPES.Grid),(0,jc.optional)(),j1("design:type",Object)],ya.prototype,"grid",void 0);lh([(0,jc.inject)(HV.ChangeBoundsManager),j1("design:type",HV.ChangeBoundsManager)],ya.prototype,"changeBoundsManager",void 0);Iu.MovementKeyTool=ya=x5=lh([(0,jc.injectable)()],ya);class Yd extends Tm.KeyListener{constructor(e,t={x:Yd.defaultMoveX,y:Yd.defaultMoveY}){super(),this.tool=e,this.grid=t,this.token=Yd.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(Awe.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["⬅  ⬆  ➡  ⬇"],description:"Move element or viewport",group:"Move",position:0}]}))}keyDown(e,t){const i=this.tool.selectionService.getSelectedElementIDs(),o=this.tool.changeBoundsManager.usePositionSnap(t),r=o?this.grid.x:1,s=o?this.grid.y:1;if(i.length>0){if(this.matchesMoveUpKeystroke(t))return[md.MoveElementAction.create(i,0,-s,o)];if(this.matchesMoveDownKeystroke(t))return[md.MoveElementAction.create(i,0,s,o)];if(this.matchesMoveRightKeystroke(t))return[md.MoveElementAction.create(i,r,0,o)];if(this.matchesMoveLeftKeystroke(t))return[md.MoveElementAction.create(i,-r,0,o)]}else{if(this.matchesMoveUpKeystroke(t))return[md.MoveViewportAction.create(0,-s)];if(this.matchesMoveDownKeystroke(t))return[md.MoveViewportAction.create(0,s)];if(this.matchesMoveRightKeystroke(t))return[md.MoveViewportAction.create(r,0)];if(this.matchesMoveLeftKeystroke(t))return[md.MoveViewportAction.create(-r,0)]}return[]}matchesMoveUpKeystroke(e){const t=this.tool.changeBoundsManager.unsnapModifier();return(0,pd.matchesKeystroke)(e,"ArrowUp")||!!t&&(0,pd.matchesKeystroke)(e,"ArrowUp",t)}matchesMoveDownKeystroke(e){const t=this.tool.changeBoundsManager.unsnapModifier();return(0,pd.matchesKeystroke)(e,"ArrowDown")||!!t&&(0,pd.matchesKeystroke)(e,"ArrowDown",t)}matchesMoveRightKeystroke(e){const t=this.tool.changeBoundsManager.unsnapModifier();return(0,pd.matchesKeystroke)(e,"ArrowRight")||!!t&&(0,pd.matchesKeystroke)(e,"ArrowRight",t)}matchesMoveLeftKeystroke(e){const t=this.tool.changeBoundsManager.unsnapModifier();return(0,pd.matchesKeystroke)(e,"ArrowLeft")||!!t&&(0,pd.matchesKeystroke)(e,"ArrowLeft",t)}}Iu.MoveKeyListener=Yd;Yd.defaultMoveX=20;Yd.defaultMoveY=20;var Du={},Jb=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},dM=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},n_;Object.defineProperty(Du,"__esModule",{value:!0});Du.ZoomKeyListener=Du.ZoomKeyTool=void 0;const eS=F,bl=qt,qd=z,Rwe=Pt,KV=Yt,Mwe=eo,qE=bo,H5=tr,Iwe=Ct,VV=An,_Z=sr,yZ=ga,Dwe=qb;let Bc=n_=class{constructor(){this.isEditTool=!1,this.zoomKeyListener=new Pr(this)}get id(){return n_.ID}enable(){this.keytool.register(this.zoomKeyListener),this.zoomKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.zoomKeyListener)}handle(e){if((0,qd.isViewport)(this.editorContextService.modelRoot)){let t;H5.KeyboardGridCellSelectedAction.is(e)&&e.options.originId===n_.ID?t=this.zoomKeyListener.setNewZoomFactor(this.editorContextService.modelRoot,Pr.defaultZoomInFactor,(0,Iwe.getAbsolutePositionByPoint)(this.editorContextService.modelRoot,e.options.centerCellPosition)):H5.KeyboardGridKeyboardEventAction.is(e)&&e.options.originId===n_.ID&&((0,bl.matchesKeystroke)(e.options.event,"Minus")?t=this.zoomKeyListener.setNewZoomFactor(this.editorContextService.modelRoot,Pr.defaultZoomOutFactor):(0,bl.matchesKeystroke)(e.options.event,"Digit0","ctrl")&&(t=qd.CenterAction.create([]))),t&&this.actionDispatcher.dispatchAll([t,_Z.HideToastAction.create({id:Symbol.for(yZ.ElementNavigatorKeyListener.name)})])}}};Du.ZoomKeyTool=Bc;Bc.ID="glsp.zoom-key-tool";Jb([(0,eS.inject)(qd.KeyTool),dM("design:type",qd.KeyTool)],Bc.prototype,"keytool",void 0);Jb([(0,eS.inject)(qd.TYPES.IActionDispatcher),dM("design:type",Rwe.GLSPActionDispatcher)],Bc.prototype,"actionDispatcher",void 0);Jb([(0,eS.inject)(KV.SelectionService),dM("design:type",KV.SelectionService)],Bc.prototype,"selectionService",void 0);Jb([(0,eS.inject)(VV.EditorContextService),dM("design:type",VV.EditorContextService)],Bc.prototype,"editorContextService",void 0);Du.ZoomKeyTool=Bc=n_=Jb([(0,eS.injectable)()],Bc);class Pr extends qd.KeyListener{constructor(e){super(),this.tool=e,this.token=Pr.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(Mwe.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["+"],description:"Zoom in to element or viewport",group:"Zoom",position:0},{shortcuts:["-"],description:"Zoom out to element or viewport",group:"Zoom",position:1},{shortcuts:["CTRL","0"],description:"Reset zoom to default",group:"Zoom",position:2},{shortcuts:["CTRL","+"],description:"Zoom in via Grid",group:"Zoom",position:3}]}))}setNewZoomFactor(e,t,i){let o;const r=e.zoom*t;return i?o={scroll:{x:i.x-.5*e.canvasBounds.width/r,y:i.y-.5*e.canvasBounds.height/r},zoom:r}:o={scroll:e.scroll,zoom:r},qd.SetViewportAction.create(e.id,o,{animate:!0})}keyDown(e,t){const i=this.tool.selectionService.getSelectedElementIDs();return this.matchesZoomViaGrid(t)?[H5.EnableKeyboardGridAction.create({originId:Bc.ID,triggerActions:[]}),_Z.ShowToastMessageAction.createWithTimeout({id:Symbol.for(yZ.ElementNavigatorKeyListener.name),message:Dwe.grid.zoom_in_grid})]:this.matchesZoomOutKeystroke(t)?i.length>0?[qE.ZoomElementAction.create(i,Pr.defaultZoomOutFactor)]:[qE.ZoomViewportAction.create(Pr.defaultZoomOutFactor)]:this.matchesZoomInKeystroke(t)?i.length>0?[qE.ZoomElementAction.create(i,Pr.defaultZoomInFactor)]:[qE.ZoomViewportAction.create(Pr.defaultZoomInFactor)]:this.matchesMinZoomLevelKeystroke(t)?[qd.CenterAction.create(i)]:[]}matchesZoomInKeystroke(e){return e.key==="+"||(0,bl.matchesKeystroke)(e,"NumpadAdd")}matchesZoomViaGrid(e){return e.key==="+"&&e.ctrlKey}matchesMinZoomLevelKeystroke(e){return(0,bl.matchesKeystroke)(e,"Digit0","ctrl")||(0,bl.matchesKeystroke)(e,"Numpad0","ctrl")}matchesZoomOutKeystroke(e){return(0,bl.matchesKeystroke)(e,"Minus")||(0,bl.matchesKeystroke)(e,"NumpadSubtract")}}Du.ZoomKeyListener=Pr;Pr.defaultZoomInFactor=1.1;Pr.defaultZoomOutFactor=.9;Object.defineProperty(mf,"__esModule",{value:!0});mf.configureViewKeyTools=mf.viewKeyToolsModule=void 0;const qa=z,zV=tr,Twe=Mu,Owe=Iu,bT=Du;mf.viewKeyToolsModule=new qa.FeatureModule((n,e,t,i)=>{bZ({bind:n,isBound:t,rebind:i})},{featureId:Symbol("viewKeyTools")});function bZ(n){(0,qa.bindAsService)(n,qa.TYPES.IDefaultTool,Owe.MovementKeyTool),(0,qa.bindAsService)(n,qa.TYPES.IDefaultTool,bT.ZoomKeyTool),(0,qa.configureActionHandler)(n,zV.KeyboardGridCellSelectedAction.KIND,bT.ZoomKeyTool),(0,qa.configureActionHandler)(n,zV.KeyboardGridKeyboardEventAction.KIND,bT.ZoomKeyTool),(0,qa.bindAsService)(n,qa.TYPES.IDefaultTool,Twe.DeselectKeyTool)}mf.configureViewKeyTools=bZ;Object.defineProperty(rM,"__esModule",{value:!0});rM.accessibilityModule=void 0;const Lwe=z,Nwe=K9,jwe=U9,Bwe=W9,$we=cf,kwe=df,Fwe=uf,xwe=ff,Hwe=pf,Kwe=Q9,Vwe=mf;rM.accessibilityModule=new Lwe.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,xwe.configureResizeTools)(o),(0,Vwe.configureViewKeyTools)(o),(0,Fwe.configureMoveZoom)(o),(0,Hwe.configureSearchPaletteModule)(o),(0,Bwe.configureShortcutHelpTool)(o),(0,kwe.configureKeyboardToolPaletteTool)(o),(0,$we.configureKeyboardControlTools)(o),(0,Nwe.configureElementNavigationTool)(o),(0,jwe.configureFocusTrackerTool)(o),(0,Kwe.configureToastTool)(o)},{featureId:Symbol("accessibility")});var SZ={};Object.defineProperty(SZ,"__esModule",{value:!0});var EZ={};Object.defineProperty(EZ,"__esModule",{value:!0});var tS={},CZ=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},zwe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(tS,"__esModule",{value:!0});tS.LeftToRightTopToBottomElementNavigator=void 0;const gw=z,K5=F,Gwe=Mo,hl=kt,GV=ti;let vw=class{previous(e,t,i,o=()=>!0){const r=this.getElements(e,o);return t===void 0?r.length>0?r[0]:void 0:r[this.getPreviousIndex(t,r)%r.length]}next(e,t,i,o=()=>!0){const r=this.getElements(e,o);return t===void 0?r.length>0?r[0]:void 0:r[this.getNextIndex(t,r)%r.length]}getElements(e,t){return(0,Gwe.toArray)(e.index.all().filter(o=>(0,hl.isSelectableAndBoundsAware)(o))).sort((o,r)=>this.compare(o,r)).filter(t)}getNextIndex(e,t){for(let i=0;i<t.length;i++)if(this.compare(t[i],e)>0)return i;return 0}getPreviousIndex(e,t){for(let i=t.length-1;i>=0;i--)if(this.compare(t[i],e)<0)return i;return t.length-1}compare(e,t){var i,o;let r,s;e instanceof GV.GEdge&&(0,hl.isRoutable)(e)&&(r=(i=(0,hl.calcElementAndRoute)(e,this.edgeRouterRegistry).newRoutingPoints)===null||i===void 0?void 0:i[0]),t instanceof GV.GEdge&&(0,hl.isRoutable)(t)&&(s=(o=(0,hl.calcElementAndRoute)(t,this.edgeRouterRegistry).newRoutingPoints)===null||o===void 0?void 0:o[0]);const a=(0,gw.findParentByFeature)(e,hl.isSelectableAndBoundsAware),f=(0,gw.findParentByFeature)(t,hl.isSelectableAndBoundsAware);if(r===void 0&&a&&(r=a.bounds),s===void 0&&f&&(s=f.bounds),r&&s){if(r.y!==s.y)return r.y-s.y;if(r.x!==s.x)return r.x-s.x}return 0}};tS.LeftToRightTopToBottomElementNavigator=vw;CZ([(0,K5.inject)(gw.EdgeRouterRegistry),(0,K5.optional)(),zwe("design:type",gw.EdgeRouterRegistry)],vw.prototype,"edgeRouterRegistry",void 0);tS.LeftToRightTopToBottomElementNavigator=vw=CZ([(0,K5.injectable)()],vw);var uM={},gf={};Object.defineProperty(gf,"__esModule",{value:!0});gf.isMouseEvent=gf.createElementFromHTML=void 0;const ST=z;function Uwe(n){const e=document.createElement("template");n=n.trim(),e.innerHTML=n;const t=e.content.firstChild;if(t&&t instanceof HTMLElement)return t}gf.createElementFromHTML=Uwe;function Ywe(n){return ST.AnyObject.is(n)&&(0,ST.hasNumberProp)(n,"pageX")&&(0,ST.hasNumberProp)(n,"pageY")}gf.isMouseEvent=Ywe;var vf={};Object.defineProperty(vf,"__esModule",{value:!0});vf.unsnapModifier=vf.useSnap=void 0;function qwe(n){return!n.shiftKey}vf.useSnap=qwe;function Wwe(){return"shift"}vf.unsnapModifier=Wwe;Object.defineProperty(uM,"__esModule",{value:!0});uM.PointPositionUpdater=void 0;const WE=z,Zwe=kt,UV=gf,Qwe=eh,YV=Jf,Xwe=vf;class Jwe{constructor(e,t){this.positionDelta={x:0,y:0},this.positionSnapper=e instanceof YV.PositionSnapper?e:new YV.PositionSnapper(e,t)}updateLastDragPosition(e){this.lastDragPosition=(0,UV.isMouseEvent)(e)?{x:e.pageX,y:e.pageY}:e}isLastDragPositionUndefined(){return this.lastDragPosition===void 0}resetPosition(){this.lastDragPosition=void 0,this.positionDelta={x:0,y:0}}updatePosition(e,t,i,o){if(!this.lastDragPosition)return;const r=(0,UV.isMouseEvent)(t)?{x:t.pageX,y:t.pageY}:t,s=typeof i=="boolean"?i:(0,Xwe.useSnap)(t),a=typeof i!="boolean"?i:o,f=(0,Zwe.calculateDeltaBetweenPoints)(r,this.lastDragPosition,e);if(this.lastDragPosition=r,WE.Point.equals(f,WE.Point.ORIGIN))return;this.positionDelta.x+=f.x,this.positionDelta.y+=f.y;const h=a??(0,Qwe.getDirectionOf)(this.positionDelta),g=this.positionSnapper.snapDelta(this.positionDelta,e,s,h);if(!WE.Point.equals(g,WE.Point.ORIGIN))return this.positionDelta.x-=g.x,this.positionDelta.y-=g.y,g}}uM.PointPositionUpdater=Jwe;var nS={},PZ=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},eAe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(nS,"__esModule",{value:!0});nS.DeleteElementContextMenuItemProvider=void 0;const wZ=F,AZ=z;let _w=class{async getItems(e,t){const i=await this.editorContextServiceProvider();return[this.createDeleteMenuItem(i)]}createDeleteMenuItem(e){return{id:"delete",label:"Delete",sortString:"d",group:"edit",actions:[AZ.DeleteElementOperation.create(e.selectedElements.map(t=>t.id))],isEnabled:()=>!e.isReadonly&&e.selectedElements.length>0}}};nS.DeleteElementContextMenuItemProvider=_w;PZ([(0,wZ.inject)(AZ.TYPES.IEditorContextServiceProvider),eAe("design:type",Function)],_w.prototype,"editorContextServiceProvider",void 0);nS.DeleteElementContextMenuItemProvider=_w=PZ([(0,wZ.injectable)()],_w);var qn={},n4=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},tAe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(qn,"__esModule",{value:!0});qn.isNative=qn.supportsPaste=qn.supportsCut=qn.supportsCopy=qn.CopyPasteContextMenuItemProvider=qn.InvokeCopyPasteActionHandler=qn.InvokeCopyPasteAction=void 0;const i4=F,Om=z;var R_;(function(n){n.KIND="invokeCopyPaste";function e(i){return Om.Action.hasKind(i,n.KIND)&&(0,Om.hasStringProp)(i,"command")}n.is=e;function t(i){return{kind:n.KIND,command:i}}n.create=t})(R_||(qn.InvokeCopyPasteAction=R_={}));let yw=class{handle(e){switch(e.command){case"copy":RZ()?document.execCommand("copy"):this.notifyUserToUseShortcut("copy");break;case"paste":IZ()?document.execCommand("paste"):this.notifyUserToUseShortcut("paste");break;case"cut":MZ()?document.execCommand("cut"):this.notifyUserToUseShortcut("cut");break}}notifyUserToUseShortcut(e){const t=`Please use the browser's ${e} command or shortcut.`,i=1e4,o="WARNING";this.dispatcher.dispatchAll([Om.StatusAction.create(t,{severity:o,timeout:i}),Om.MessageAction.create(t,{severity:o})])}};qn.InvokeCopyPasteActionHandler=yw;n4([(0,i4.inject)(Om.TYPES.IActionDispatcher),tAe("design:type",Object)],yw.prototype,"dispatcher",void 0);qn.InvokeCopyPasteActionHandler=yw=n4([(0,i4.injectable)()],yw);let V5=class{getItems(e,t){const i=Array.from(e.index.all().filter(Om.isSelected)).length>0;return Promise.resolve([this.createCopyMenuItem(i),this.createCutMenuItem(i),this.createPasteMenuItem()])}createPasteMenuItem(){return{id:"paste",label:"Paste",group:"copy-paste",actions:[R_.create("paste")],isEnabled:()=>!0}}createCutMenuItem(e){return{id:"cut",label:"Cut",group:"copy-paste",actions:[R_.create("cut")],isEnabled:()=>e}}createCopyMenuItem(e){return{id:"copy",label:"Copy",group:"copy-paste",actions:[R_.create("copy")],isEnabled:()=>e}}};qn.CopyPasteContextMenuItemProvider=V5;qn.CopyPasteContextMenuItemProvider=V5=n4([(0,i4.injectable)()],V5);function RZ(){return lM()||document.queryCommandSupported("copy")}qn.supportsCopy=RZ;function MZ(){return lM()||document.queryCommandSupported("cut")}qn.supportsCut=MZ;function IZ(){const n=nAe().indexOf("Chrome")>=0;return lM()||!n&&document.queryCommandSupported("paste")}qn.supportsPaste=IZ;function lM(){return typeof window.process<"u"}qn.isNative=lM;function nAe(){return typeof navigator<"u"?navigator.userAgent:""}var o4={};(function(n){var e=l&&l.__decorate||function(f,h,g,y){var S=arguments.length,P=S<3?h:y===null?y=Object.getOwnPropertyDescriptor(h,g):y,w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(f,h,g,y);else for(var C=f.length-1;C>=0;C--)(w=f[C])&&(P=(S<3?w(P):S>3?w(h,g,P):w(h,g))||P);return S>3&&P&&Object.defineProperty(h,g,P),P},t=l&&l.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)};Object.defineProperty(n,"__esModule",{value:!0}),n.DebugBoundsDecorator=n.CSS_DEBUG_BOUNDS=void 0;const i=z,o=F,r=ti,s=Hu;n.CSS_DEBUG_BOUNDS="debug-bounds";let a=class{decorate(h,g){var y;return!((y=this.debugManager)===null||y===void 0)&&y.isDebugEnabled&&((0,i.isSizeable)(g)&&this.shouldDecorateSizeable(g)&&this.decorateSizeable(h,g),g instanceof r.GGraph&&this.shouldDecorateGraph(g)&&this.decorateGraph(h,g)),h}postUpdate(){}get decorationSize(){return 5}shouldDecorateGraph(h){return!0}decorateGraph(h,g){var y,S,P;(0,i.setClass)(h,n.CSS_DEBUG_BOUNDS,!0);const w=(y=h.children)===null||y===void 0?void 0:y.find(E=>typeof E!="string"&&E.sel==="svg"),C=(S=w==null?void 0:w.children)===null||S===void 0?void 0:S.find(E=>typeof E!="string"&&E.sel==="g");(P=C==null?void 0:C.children)===null||P===void 0||P.push(this.renderOrigin(g))}renderOrigin(h){return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-origin":!0,points:`0,${this.decorationSize} 0,0  ${this.decorationSize},0`},(0,i.svg)("title",null,"Origin = x: 0, y: 0"))}shouldDecorateSizeable(h){return!(0,i.isDecoration)(h)}decorateSizeable(h,g){var y,S,P,w,C;(0,i.setClass)(h,n.CSS_DEBUG_BOUNDS,!0),(y=h.children)===null||y===void 0||y.push(this.renderTopLeftCorner(g)),(S=h.children)===null||S===void 0||S.push(this.renderTopRightCorner(g)),(P=h.children)===null||P===void 0||P.push(this.renderBottomLeftCorner(g)),(w=h.children)===null||w===void 0||w.push(this.renderBottomRightCorner(g)),(C=h.children)===null||C===void 0||C.push(this.renderCenter(g))}renderTopLeftCorner(h){const g=i.Bounds.position(h.bounds),y=i.Bounds.topLeft(h.bounds),S=i.Point.subtract(y,g);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-top-left":!0,points:`${S.x},${S.y+this.decorationSize} ${S.x},${S.y} ${S.x+this.decorationSize},${S.y}`},(0,i.svg)("title",null,"Top Left = x: ",y.x,", y: ",y.y))}renderTopRightCorner(h){const g=i.Bounds.position(h.bounds),y=i.Bounds.topRight(h.bounds),S=i.Point.subtract(y,g);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-top-right":!0,points:`${S.x-this.decorationSize},${S.y} ${S.x},${S.y} ${S.x},${S.y+this.decorationSize}`},(0,i.svg)("title",null,"Top Right = x: ",y.x,", y: ",y.y))}renderBottomLeftCorner(h){const g=i.Bounds.position(h.bounds),y=i.Bounds.bottomLeft(h.bounds),S=i.Point.subtract(y,g);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-bottom-left":!0,points:`${S.x},${S.y-this.decorationSize} ${S.x},${S.y} ${S.x+this.decorationSize},${S.y}`},(0,i.svg)("title",null,"Bottom Left = x: ",y.x,", y: ",y.y))}renderBottomRightCorner(h){const g=i.Bounds.position(h.bounds),y=i.Bounds.bottomRight(h.bounds),S=i.Point.subtract(y,g);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-bottom-right":!0,points:`${S.x-this.decorationSize},${S.y} ${S.x},${S.y} ${S.x},${S.y-this.decorationSize}`},(0,i.svg)("title",null,"Bottom Right = x: ",y.x,", y: ",y.y))}renderCenter(h){const g=h.bounds,y=i.Bounds.position(g),S=i.Bounds.center(g),P=i.Point.subtract(S,y);return(0,i.svg)("g",null,(0,i.svg)("title",null,"Center = x: ",S.x,", y: ",S.y,"\rBounds = x: ",g.x,", y: ",g.y,", width: ",g.width,", height: ",g.height),(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-center":!0,points:`${P.x-this.decorationSize/2},${P.y-this.decorationSize/2} ${P.x+this.decorationSize/2},${P.y+this.decorationSize/2}`}),(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-center":!0,points:`${P.x+this.decorationSize/2},${P.y-this.decorationSize/2} ${P.x-this.decorationSize/2},${P.y+this.decorationSize/2}`}))}};n.DebugBoundsDecorator=a,e([(0,o.inject)(s.DebugManager),(0,o.optional)(),t("design:type",s.DebugManager)],a.prototype,"debugManager",void 0),n.DebugBoundsDecorator=a=e([(0,o.injectable)()],a)})(o4);var fM={};Object.defineProperty(fM,"__esModule",{value:!0});fM.debugModule=void 0;const Bv=z,iAe=o4,qV=Hu,WV=wc;fM.debugModule=new Bv.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,Bv.configureCommand)(o,WV.EnableDebugModeCommand),n(qV.DebugManager).toSelf().inSingletonScope(),(0,Bv.configureActionHandler)(o,WV.EnableDebugModeAction.KIND,qV.DebugManager),(0,Bv.bindAsService)(o,Bv.TYPES.IVNodePostprocessor,iAe.DebugBoundsDecorator)},{featureId:Symbol("debug")});var DZ={};Object.defineProperty(DZ,"__esModule",{value:!0});var hM={},$c={},TZ=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},OZ=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},bw=l&&l.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty($c,"__esModule",{value:!0});$c.GLSPCenterGridSnapper=$c.GridSnapper=void 0;const pM=z,Lp=F;let z5=class{constructor(e={x:10,y:10}){this.grid=e}snap(e,t){return pM.Point.snapToGrid(e,this.grid)}};$c.GridSnapper=z5;$c.GridSnapper=z5=TZ([(0,Lp.injectable)(),bw(0,(0,Lp.optional)()),bw(0,(0,Lp.inject)(pM.TYPES.Grid)),OZ("design:paramtypes",[Object])],z5);let G5=class extends pM.CenterGridSnapper{constructor(e={x:10,y:10}){super(),this.grid=e}get gridX(){return this.grid.x}get gridY(){return this.grid.y}};$c.GLSPCenterGridSnapper=G5;$c.GLSPCenterGridSnapper=G5=TZ([(0,Lp.injectable)(),bw(0,(0,Lp.optional)()),bw(0,(0,Lp.inject)(pM.TYPES.Grid)),OZ("design:paramtypes",[Object])],G5);Object.defineProperty(hM,"__esModule",{value:!0});hM.gridModule=void 0;const $v=z,ZV=Ta,QV=Cc,oAe=$c;hM.gridModule=new $v.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};n($v.TYPES.Grid).toConstantValue({x:10,y:10}),(0,$v.configureCommand)(o,QV.ShowGridCommand),n(ZV.GridManager).toSelf().inSingletonScope(),(0,$v.configureActionHandler)(o,QV.ShowGridAction.KIND,ZV.GridManager),n($v.TYPES.ISnapper).to(oAe.GridSnapper)},{featureId:Symbol("grid")});var B1={};Object.defineProperty(B1,"__esModule",{value:!0});B1.GridProperty=void 0;var XV;(function(n){n.GRID_BACKGROUND_X="--grid-background-x",n.GRID_BACKGROUND_Y="--grid-background-y",n.GRID_BACKGROUND_WIDTH="--grid-background-width",n.GRID_BACKGROUND_HEIGHT="--grid-background-height",n.GRID_BACKGROUND_ZOOM="--grid-background-zoom",n.GRID_COLOR="--grid-color"})(XV||(B1.GridProperty=XV={}));var mM={};(function(n){var e=l&&l.__decorate||function(b,v,R,O){var N=arguments.length,T=N<3?v:O===null?O=Object.getOwnPropertyDescriptor(v,R):O,$;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(b,v,R,O);else for(var Q=b.length-1;Q>=0;Q--)($=b[Q])&&(T=(N<3?$(T):N>3?$(v,R,T):$(v,R))||T);return N>3&&T&&Object.defineProperty(v,R,T),T},t=l&&l.__metadata||function(b,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(b,v)},i=l&&l.__param||function(b,v){return function(R,O){v(R,O,b)}};Object.defineProperty(n,"__esModule",{value:!0}),n.boundsInViewport=n.removeSelectionBounds=n.removeHelperLines=n.RemoveHelperLinesFeedbackCommand=n.RemoveHelperLinesFeedbackAction=n.DrawHelperLinesFeedbackCommand=n.DrawHelperLinesFeedbackAction=n.DEFAULT_DEBUG=n.DEFAULT_ALIGNABLE_ELEMENT_FILTER=n.DEFAULT_EPSILON=n.DEFAULT_VIEWPORT_LINES=n.DEFAULT_ELEMENT_LINES=n.ALL_VIEWPORT_LINE_TYPES=n.ALL_ELEMENT_LINE_TYPES=n.isTopLevelBoundsAwareElement=void 0;const o=z,r=F,s=sh,a=Gn,f=kt,h=Ct,g=Yc,y=eh,S=b=>(0,f.findTopLevelElementByFeature)(b,o.isBoundsAware,o.isViewport)===b;n.isTopLevelBoundsAwareElement=S,n.ALL_ELEMENT_LINE_TYPES=Object.values(y.HelperLineType),n.ALL_VIEWPORT_LINE_TYPES=[y.HelperLineType.Center,y.HelperLineType.Middle],n.DEFAULT_ELEMENT_LINES=n.ALL_ELEMENT_LINE_TYPES,n.DEFAULT_VIEWPORT_LINES=n.ALL_VIEWPORT_LINE_TYPES,n.DEFAULT_EPSILON=1;const P=b=>(0,f.isVisibleOnCanvas)(b)&&!(0,f.isRoutable)(b)&&!(b instanceof o.GLabel)&&b.id!==(0,g.feedbackEdgeId)(b.root)&&b.id!==(0,g.feedbackEdgeEndId)(b.root)&&!(0,o.isDecoration)(b);n.DEFAULT_ALIGNABLE_ELEMENT_FILTER=P,n.DEFAULT_DEBUG=!1;var w;(function(b){b.KIND="drawHelperLines";function v(R){return{kind:b.KIND,...R}}b.create=v})(w||(n.DrawHelperLinesFeedbackAction=w={}));let C=class extends a.FeedbackCommand{constructor(v,R){var O,N,T,$,Q;super(),this.logger=R,this.elementIds=v.elementIds,this.elementLines=(O=v.elementLines)!==null&&O!==void 0?O:n.DEFAULT_ELEMENT_LINES,this.viewportLines=(N=v.viewportLines)!==null&&N!==void 0?N:n.DEFAULT_VIEWPORT_LINES,this.alignmentEpsilon=(T=v.alignmentEpsilon)!==null&&T!==void 0?T:n.DEFAULT_EPSILON,this.alignableElementFilter=($=v.alignmentElementFilter)!==null&&$!==void 0?$:n.DEFAULT_ALIGNABLE_ELEMENT_FILTER,this.isAlignableElementPredicate=this.isAlignableElement.bind(this),this.debug=(Q=v.debug)!==null&&Q!==void 0?Q:n.DEFAULT_DEBUG}execute(v){j(v.root),U(v.root);const R=(0,f.getMatchingElements)(v.root.index,this.isAlignableElementPredicate);this.log("All alignable elements: ",R);const[O,N]=(0,s.partition)(R,Q=>this.elementIds.includes(Q.id));if(this.log("Split alignable elements into reference elements and other elements: ",O,N),O.length===0)return this.log("--> No helper lines as we do not have any reference elements."),v.root;const T=this.calcReferenceBounds(O);this.log("Bounds encompasing all reference elements: ",T);const $=this.calcHelperLines(N,T,v);return O.length>1&&(v.root.add(new y.SelectionBounds(T)),this.log("Render selection bounds for more than one reference element:",T)),$.forEach(Q=>v.root.add(Q)),$.length>0?this.log(`--> Add ${$.length} helper lines to root:`,$):this.log("--> Add no helper lines to root."),v.root}isAlignableElement(v){return(0,o.isBoundsAware)(v)&&this.alignableElementFilter(v,this.elementIds)}calcReferenceBounds(v){return v.map(R=>this.calcBounds(R)).reduce(o.Bounds.combine,o.Bounds.EMPTY)}calcBounds(v){return(0,h.toAbsoluteBounds)(v)}calcHelperLines(v,R,O){const N=[],T=(0,o.findParentByFeature)(O.root,o.isViewport);return T&&N.push(...this.calcHelperLinesForViewport(T,R,this.viewportLines)),v.flatMap($=>this.calcHelperLinesForElement($,R,this.elementLines)).forEach($=>N.push($)),N}calcHelperLinesForViewport(v,R,O){const N=[];this.log("Find helperlines for viewport:",v);const T=(0,h.getViewportBounds)(v,v.canvasBounds);return O.includes(y.HelperLineType.Center)&&this.isAligned(o.Bounds.centerX,T,R,2)&&(N.push(new y.HelperLine(o.Bounds.topCenter(T),o.Bounds.bottomCenter(T),y.HelperLineType.Center)),this.log("- Reference bounds center align with viewport.",T)),O.includes(y.HelperLineType.Middle)&&this.isAligned(o.Bounds.middle,T,R,2)&&(N.push(new y.HelperLine(o.Bounds.middleLeft(T),o.Bounds.middleRight(T),y.HelperLineType.Middle)),this.log("- Reference bounds middle align with viewport.",T)),N.length>0&&this.log(`--> Add ${N.length} helperlines for viewport:`,N),N}calcHelperLinesForElement(v,R,O){return this.log("Find helperlines for element:",v),this.calcHelperLinesForBounds(this.calcBounds(v),R,O)}calcHelperLinesForBounds(v,R,O){const N=[];if(O.includes(y.HelperLineType.Left)&&this.isAligned(o.Bounds.left,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.top,v,R);N.push(new y.HelperLine(o.Bounds.bottomLeft($),o.Bounds.topLeft(T),y.HelperLineType.Left)),this.log("- Reference bounds left align with element",v)}if(O.includes(y.HelperLineType.Center)&&this.isAligned(o.Bounds.centerX,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.top,v,R);N.push(new y.HelperLine(o.Bounds.topCenter(T),o.Bounds.bottomCenter($),y.HelperLineType.Center)),this.log("- Reference bounds center align with element",v)}if(O.includes(y.HelperLineType.Right)&&this.isAligned(o.Bounds.right,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.top,v,R);N.push(new y.HelperLine(o.Bounds.bottomRight($),o.Bounds.topRight(T),y.HelperLineType.Right)),this.log("- Reference bounds right align with element",v)}if(O.includes(y.HelperLineType.Bottom)&&this.isAligned(o.Bounds.bottom,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.left,v,R);N.push(new y.HelperLine(o.Bounds.bottomLeft(T),o.Bounds.bottomRight($),y.HelperLineType.Bottom)),this.log("- Reference bounds bottom align with element",v)}if(O.includes(y.HelperLineType.Middle)&&this.isAligned(o.Bounds.centerY,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.left,v,R);N.push(new y.HelperLine(o.Bounds.middleLeft(T),o.Bounds.middleRight($),y.HelperLineType.Middle)),this.log("- Reference bounds middle align with element",v)}if(O.includes(y.HelperLineType.Top)&&this.isAligned(o.Bounds.top,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.left,v,R);N.push(new y.HelperLine(o.Bounds.topLeft(T),o.Bounds.topRight($),y.HelperLineType.Top)),this.log("- Reference bounds top align with element",v)}return O.includes(y.HelperLineType.LeftRight)&&this.isMatch(o.Bounds.left(v),o.Bounds.right(R),this.alignmentEpsilon)&&(o.Bounds.isAbove(R,v)?(N.push(new y.HelperLine(o.Bounds.bottomLeft(v),o.Bounds.topRight(R),y.HelperLineType.RightLeft)),this.log("- Reference bounds right aligns with element left",v)):(N.push(new y.HelperLine(o.Bounds.topLeft(v),o.Bounds.bottomRight(R),y.HelperLineType.RightLeft)),this.log("- Reference bounds right aligns with element left",v))),O.includes(y.HelperLineType.LeftRight)&&this.isMatch(o.Bounds.right(v),o.Bounds.left(R),this.alignmentEpsilon)&&(o.Bounds.isAbove(R,v)?(N.push(new y.HelperLine(o.Bounds.bottomRight(v),o.Bounds.topLeft(R),y.HelperLineType.LeftRight)),this.log("- Reference bounds left aligns with element right",v)):(N.push(new y.HelperLine(o.Bounds.topRight(v),o.Bounds.bottomLeft(R),y.HelperLineType.LeftRight)),this.log("- Reference bounds left aligns with element right",v))),O.includes(y.HelperLineType.TopBottom)&&this.isMatch(o.Bounds.top(v),o.Bounds.bottom(R),this.alignmentEpsilon)&&(o.Bounds.isBefore(R,v)?(N.push(new y.HelperLine(o.Bounds.topRight(v),o.Bounds.bottomLeft(R),y.HelperLineType.BottomTop)),this.log("- Reference bounds bottom aligns with element top",v)):(N.push(new y.HelperLine(o.Bounds.topLeft(v),o.Bounds.bottomRight(R),y.HelperLineType.BottomTop)),this.log("- Reference bounds bottom aligns with element top",v))),O.includes(y.HelperLineType.TopBottom)&&this.isMatch(o.Bounds.bottom(v),o.Bounds.top(R),this.alignmentEpsilon)&&(o.Bounds.isBefore(R,v)?(N.push(new y.HelperLine(o.Bounds.bottomRight(v),o.Bounds.topLeft(R),y.HelperLineType.TopBottom)),this.log("- Reference bounds top aligns with element bottom",v)):(N.push(new y.HelperLine(o.Bounds.bottomLeft(v),o.Bounds.topRight(R),y.HelperLineType.TopBottom)),this.log("- Reference bounds top aligns with element bottom",v))),N.length>0&&this.log(`--> Add ${N.length} helperlines for element:`,N),N}isAligned(v,R,O,N){return this.isMatch(v(R),v(O),N)}isMatch(v,R,O){return(0,o.equalUpTo)(v,R,O)}log(v,...R){this.debug&&this.logger.log(this,v,R)}};n.DrawHelperLinesFeedbackCommand=C,C.KIND=w.KIND,n.DrawHelperLinesFeedbackCommand=C=e([(0,r.injectable)(),i(0,(0,r.inject)(o.TYPES.Action)),i(1,(0,r.inject)(o.TYPES.ILogger)),t("design:paramtypes",[Object,Object])],C);var E;(function(b){b.KIND="removeHelperLines";function v(R={}){return{kind:b.KIND,...R}}b.create=v})(E||(n.RemoveHelperLinesFeedbackAction=E={}));let D=class extends a.FeedbackCommand{constructor(v){super(),this.action=v}execute(v){return j(v.root),U(v.root),v.root}};n.RemoveHelperLinesFeedbackCommand=D,D.KIND=E.KIND,n.RemoveHelperLinesFeedbackCommand=D=e([(0,r.injectable)(),i(0,(0,r.inject)(o.TYPES.Action)),t("design:paramtypes",[Object])],D);function j(b){(0,f.forEachElement)(b.index,y.isHelperLine,v=>b.remove(v))}n.removeHelperLines=j;function U(b){(0,f.forEachElement)(b.index,y.isSelectionBounds,v=>b.remove(v))}n.removeSelectionBounds=U;function p(b,v){return b instanceof o.GChildElement&&!(0,o.isViewport)(b.parent)?p(b.parent,b.parent.localToParent(v)):v}n.boundsInViewport=p})(mM);var LZ={};Object.defineProperty(LZ,"__esModule",{value:!0});var r4={};(function(n){var e=l&&l.__decorate||function(S,P,w,C){var E=arguments.length,D=E<3?P:C===null?C=Object.getOwnPropertyDescriptor(P,w):C,j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(S,P,w,C);else for(var U=S.length-1;U>=0;U--)(j=S[U])&&(D=(E<3?j(D):E>3?j(P,w,D):j(P,w))||D);return E>3&&D&&Object.defineProperty(P,w,D),D},t=l&&l.__metadata||function(S,P){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(S,P)};Object.defineProperty(n,"__esModule",{value:!0}),n.HelperLineManager=n.DEFAULT_HELPER_LINE_OPTIONS=n.DEFAULT_MOVE_DELTA=void 0;const i=z,o=F,r=Yt,s=Ss,a=no,f=Pn,h=mM,g=eh;n.DEFAULT_MOVE_DELTA={x:1,y:1},n.DEFAULT_HELPER_LINE_OPTIONS={elementLines:h.DEFAULT_ELEMENT_LINES,viewportLines:h.DEFAULT_VIEWPORT_LINES,alignmentEpsilon:h.DEFAULT_EPSILON,alignmentElementFilter:h.DEFAULT_ALIGNABLE_ELEMENT_FILTER,minimumMoveDelta:n.DEFAULT_MOVE_DELTA,debug:h.DEFAULT_DEBUG};let y=class{init(){this.feedback=this.feedbackDispatcher.createEmitter();const P={};this.grid&&(P.alignmentEpsilon=0,P.minimumMoveDelta=i.Point.multiplyScalar(this.grid,2)),this.options={...n.DEFAULT_HELPER_LINE_OPTIONS,...P,...this.userOptions},this.selectionService.onSelectionChanged(w=>this.selectionChanged(w.root,w.selectedElements,w.deselectedElements))}handle(P){f.MoveInitializedEventAction.is(P)?this.handleMoveInitializedAction(P):i.MoveAction.is(P)?this.handleMoveAction(P):f.MoveFinishedEventAction.is(P)?this.handleMoveFinishedAction(P):(i.SetBoundsAction.is(P)||s.SetBoundsFeedbackAction.is(P))&&this.handleSetBoundsAction(P)}handleMoveInitializedAction(P){this.submitHelperLineFeedback()}handleMoveFinishedAction(P){this.feedback.dispose()}handleMoveAction(P){P.finished?this.feedback.dispose():this.submitHelperLineFeedback(P.moves.map(w=>w.elementId))}submitHelperLineFeedback(P=this.selectionService.getSelectedElementIDs()){const w=this.createHelperLineFeedback(P);this.feedback.add(w,[h.RemoveHelperLinesFeedbackAction.create()]).submit()}createHelperLineFeedback(P){return h.DrawHelperLinesFeedbackAction.create({elementIds:P,...this.options})}handleSetBoundsAction(P){this.submitHelperLineFeedback(P.bounds.map(w=>w.elementId))}selectionChanged(P,w,C){this.feedback.dispose()}getMinimumMoveDelta(P,w,C){if(!w)return 0;const E=this.options.minimumMoveDelta;return C===g.Direction.Left||C===g.Direction.Right?E.x:E.y}getMinimumMoveVector(P,w,C){if(!w)return;const E=this.getHelperLineState(P);if(E.helperLines.length===0)return;const D={...i.Vector.ZERO},j=P instanceof a.GResizeHandle?a.ResizeHandleLocation.direction(P.location):[g.Direction.Left,g.Direction.Right,g.Direction.Up,g.Direction.Down];return(E.types.left||E.types.center)&&C.includes(g.Direction.Left)&&j.includes(g.Direction.Left)?D.x=this.getMinimumMoveDelta(P,w,g.Direction.Left):(E.types.right||E.types.center)&&C.includes(g.Direction.Right)&&j.includes(g.Direction.Right)&&(D.x=this.getMinimumMoveDelta(P,w,g.Direction.Right)),(E.types.top||E.types.middle)&&C.includes(g.Direction.Up)&&j.includes(g.Direction.Up)?D.y=this.getMinimumMoveDelta(P,w,g.Direction.Up):(E.types.bottom||E.types.middle)&&C.includes(g.Direction.Down)&&j.includes(g.Direction.Down)&&(D.y=this.getMinimumMoveDelta(P,w,g.Direction.Down)),i.Vector.isZero(D)?void 0:D}getHelperLineState(P){const w=P.root.children.filter(g.isHelperLine)||[],C={left:!1,right:!1,top:!1,bottom:!1,center:!1,middle:!1};for(const E of w)switch(E.lineType){case g.HelperLineType.Left:case g.HelperLineType.LeftRight:C.left=!0;break;case g.HelperLineType.Right:case g.HelperLineType.RightLeft:C.right=!0;break;case g.HelperLineType.Top:case g.HelperLineType.TopBottom:C.top=!0;break;case g.HelperLineType.Bottom:case g.HelperLineType.BottomTop:C.bottom=!0;break;case g.HelperLineType.Center:C.center=!0;break;case g.HelperLineType.Middle:C.middle=!0;break}return{helperLines:w,types:C}}};n.HelperLineManager=y,e([(0,o.inject)(i.TYPES.IFeedbackActionDispatcher),t("design:type",Object)],y.prototype,"feedbackDispatcher",void 0),e([(0,o.inject)(r.SelectionService),t("design:type",r.SelectionService)],y.prototype,"selectionService",void 0),e([(0,o.optional)(),(0,o.inject)(i.TYPES.IHelperLineOptions),t("design:type",Object)],y.prototype,"userOptions",void 0),e([(0,o.optional)(),(0,o.inject)(i.TYPES.Grid),t("design:type",Object)],y.prototype,"grid",void 0),e([(0,o.postConstruct)(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],y.prototype,"init",null),n.HelperLineManager=y=e([(0,o.injectable)()],y)})(r4);var gM={},kc={},NZ=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(kc,"__esModule",{value:!0});kc.SelectionBoundsView=kc.HelperLineView=void 0;const Np=z,jZ=F;let U5=class extends Np.ShapeView{render(e,t){return(0,Np.svg)("g",null,(0,Np.svg)("line",{"data-alignment":e.lineType,x1:e.startPoint.x,y1:e.startPoint.y,x2:e.endPoint.x,y2:e.endPoint.y,"class-helper-line":!0}))}};kc.HelperLineView=U5;kc.HelperLineView=U5=NZ([(0,jZ.injectable)()],U5);let Y5=class extends Np.ShapeView{render(e,t,i){if(this.isVisible(e,t))return(0,Np.svg)("g",null,(0,Np.svg)("rect",{"class-selection-bounds":!0,x:0,y:0,width:Math.max(e.size.width,0),height:Math.max(e.size.height,0)}))}};kc.SelectionBoundsView=Y5;kc.SelectionBoundsView=Y5=NZ([(0,jZ.injectable)()],Y5);Object.defineProperty(gM,"__esModule",{value:!0});gM.helperLineModule=void 0;const Vn=z,rAe=Ss,JV=Pn,ez=mM,sAe=r4,ZE=eh,tz=kc;gM.helperLineModule=new Vn.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,Vn.configureModelElement)(o,ZE.HELPER_LINE,ZE.HelperLine,tz.HelperLineView),(0,Vn.configureModelElement)(o,ZE.SELECTION_BOUNDS,ZE.SelectionBounds,tz.SelectionBoundsView),(0,Vn.configureCommand)(o,ez.DrawHelperLinesFeedbackCommand),(0,Vn.configureCommand)(o,ez.RemoveHelperLinesFeedbackCommand),(0,Vn.bindAsService)(n,Vn.TYPES.IHelperLineManager,sAe.HelperLineManager),(0,Vn.configureActionHandler)(o,Vn.SetBoundsAction.KIND,Vn.TYPES.IHelperLineManager),(0,Vn.configureActionHandler)(o,rAe.SetBoundsFeedbackAction.KIND,Vn.TYPES.IHelperLineManager),(0,Vn.configureActionHandler)(o,Vn.MoveAction.KIND,Vn.TYPES.IHelperLineManager),(0,Vn.configureActionHandler)(o,JV.MoveInitializedEventAction.KIND,Vn.TYPES.IHelperLineManager),(0,Vn.configureActionHandler)(o,JV.MoveFinishedEventAction.KIND,Vn.TYPES.IHelperLineManager)},{featureId:Symbol("helperLine")});var iS={};Object.defineProperty(iS,"__esModule",{value:!0});iS.SaveModelKeyboardListener=void 0;const ET=z;class aAe extends ET.KeyListener{keyDown(e,t){return(0,ET.matchesKeystroke)(t,"KeyS","ctrlCmd")?[ET.SaveModelAction.create()]:[]}}iS.SaveModelKeyboardListener=aAe;var oS={};Object.defineProperty(oS,"__esModule",{value:!0});oS.saveModule=void 0;const CT=z,cAe=iS;oS.saveModule=new CT.FeatureModule(n=>{(0,CT.bindAsService)(n,CT.TYPES.KeyListener,cAe.SaveModelKeyboardListener)},{featureId:Symbol("save")});var rS={};Object.defineProperty(rS,"__esModule",{value:!0});rS.GLSPUndoRedoKeyListener=void 0;const pl=z;class dAe extends pl.KeyListener{keyDown(e,t){return(0,pl.matchesKeystroke)(t,"KeyZ","ctrlCmd")?[pl.UndoAction.create()]:(0,pl.matchesKeystroke)(t,"KeyZ","ctrlCmd","shift")||!(0,pl.isMac)()&&(0,pl.matchesKeystroke)(t,"KeyY","ctrlCmd")?[pl.RedoAction.create()]:[]}}rS.GLSPUndoRedoKeyListener=dAe;var sS={};Object.defineProperty(sS,"__esModule",{value:!0});sS.undoRedoModule=void 0;const PT=z,uAe=rS;sS.undoRedoModule=new PT.FeatureModule((n,e,t,i)=>{(0,PT.bindAsService)(n,PT.TYPES.KeyListener,uAe.GLSPUndoRedoKeyListener)},{featureId:Symbol("undoRedo")});var BZ={};(function(n){var e=l&&l.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=l&&l.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(z,n)})(BZ);var $Z={};(function(n){var e=l&&l.__decorate||function(w,C,E,D){var j=arguments.length,U=j<3?C:D===null?D=Object.getOwnPropertyDescriptor(C,E):D,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(w,C,E,D);else for(var b=w.length-1;b>=0;b--)(p=w[b])&&(U=(j<3?p(U):j>3?p(C,E,U):p(C,E))||U);return j>3&&U&&Object.defineProperty(C,E,U),U},t=l&&l.__metadata||function(w,C){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(w,C)};Object.defineProperty(n,"__esModule",{value:!0}),n.STANDALONE_MODULE_CONFIG=n.STANDALONE_MODULES=n.LayoutKeyListener=n.FallbackActionHandler=n.standaloneDefaultModule=void 0;const i=z,o=F,r=OR,s=NR,a=oS,f=VR,h=sS,g=tM,y=nM;n.standaloneDefaultModule=new i.FeatureModule((w,C,E,D)=>{const j={bind:w,unbind:C,isBound:E,rebind:D};w(S).toSelf().inSingletonScope(),(0,i.configureActionHandler)(j,i.MessageAction.KIND,S),(0,i.configureActionHandler)(j,i.StartProgressAction.KIND,S),(0,i.configureActionHandler)(j,i.UpdateProgressAction.KIND,S),(0,i.configureActionHandler)(j,i.EndProgressAction.KIND,S),(0,i.bindAsService)(j,i.TYPES.KeyListener,P)},{featureId:Symbol("standaloneDefault")});let S=class{handle(C){this.logger.log(this,"Unhandled action received:",C)}};n.FallbackActionHandler=S,e([(0,o.inject)(i.TYPES.ILogger),t("design:type",Object)],S.prototype,"logger",void 0),n.FallbackActionHandler=S=e([(0,o.injectable)()],S);let P=class extends i.KeyListener{keyDown(C,E){return(0,i.matchesKeystroke)(E,"KeyL","ctrlCmd","shift")?[i.LayoutOperation.create()]:[]}};n.LayoutKeyListener=P,n.LayoutKeyListener=P=e([(0,o.injectable)()],P),n.STANDALONE_MODULES=[y.standaloneViewportModule,r.standaloneCopyPasteModule,g.standaloneMarkerNavigatorModule,f.standaloneSelectModule,s.standaloneExportModule,n.standaloneDefaultModule,a.saveModule,h.undoRedoModule],n.STANDALONE_MODULE_CONFIG={add:[...n.STANDALONE_MODULES]}})($Z);var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.isAfter=Ke.isBefore=Ke.isBelow=Ke.isAbove=Ke.compareFunction=Ke.sortBy=Ke.bottomRight=Ke.bottomCenter=Ke.bottomLeft=Ke.middleRight=Ke.middleCenter=Ke.middleLeft=Ke.topRight=Ke.topCenter=Ke.topLeft=Ke.bottom=Ke.middle=Ke.top=Ke.right=Ke.center=Ke.left=void 0;const Fn=z;Ke.left=Fn.Bounds.left;Ke.center=Fn.Bounds.center;Ke.right=Fn.Bounds.right;Ke.top=Fn.Bounds.top;Ke.middle=Fn.Bounds.middle;Ke.bottom=Fn.Bounds.bottom;Ke.topLeft=Fn.Bounds.topLeft;Ke.topCenter=Fn.Bounds.topCenter;Ke.topRight=Fn.Bounds.topRight;Ke.middleLeft=Fn.Bounds.middleLeft;Ke.middleCenter=Fn.Bounds.middleCenter;Ke.middleRight=Fn.Bounds.middleRight;Ke.bottomLeft=Fn.Bounds.bottomLeft;Ke.bottomCenter=Fn.Bounds.bottomCenter;Ke.bottomRight=Fn.Bounds.bottomRight;Ke.sortBy=Fn.Bounds.sortBy;const lAe=n=>(e,t)=>n(e)-n(t);Ke.compareFunction=lAe;Ke.isAbove=Fn.Bounds.isAbove;Ke.isBelow=Fn.Bounds.isBelow;Ke.isBefore=Fn.Bounds.isBefore;Ke.isAfter=Fn.Bounds.isAfter;var Lm={},$1={},fAe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty($1,"__esModule",{value:!0});$1.GEdgeView=void 0;const QE=z,hAe=F,pAe=ls;let q5=class extends QE.PolylineEdgeView{render(e,t){const o=this.edgeRouterRegistry.get(e.routerKind).route(e);return o.length===0?this.renderDanglingEdge("Cannot compute route",e,t):(0,QE.svg)("g",{"class-sprotty-edge":!0,"class-mouseover":e.hoverFeedback,...this.additionalClasses(e,t)},this.renderLine(e,o,t),this.renderAdditionals(e,o,t),t.renderChildren(e,{route:o}))}additionalClasses(e,t){return{}}renderLine(e,t,i){return(0,QE.svg)("path",{d:this.createPathForSegments(t)})}renderAdditionals(e,t,i){const o=pAe.EdgePadding.from(e);return o?[this.renderMouseHandle(t,o)]:[]}renderMouseHandle(e,t){return(0,QE.svg)("path",{"class-mouse-handle":!0,d:this.createPathForSegments(e),"style-stroke-width":t*2,"style-stroke":"transparent","style-stroke-dasharray":"none","style-stroke-dashoffset":"0"})}createPathForSegments(e){const t=e[0];let i=`M ${t.x},${t.y}`;for(let o=1;o<e.length;o++){const r=e[o];i+=` L ${r.x},${r.y}`}return i}};$1.GEdgeView=q5;$1.GEdgeView=q5=fAe([(0,hAe.injectable)()],q5);var k1={},kZ=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},mAe=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(k1,"__esModule",{value:!0});k1.GGraphView=void 0;const kv=z,W5=F,nz=Ta,Fv=B1;let Sw=class extends kv.SGraphView{render(e,t){const i=super.render(e,t);return i.data&&(i.data.style={...i.data.style,...this.getGridStyle(e,t)}),i}getGridStyle(e,t){if(t.targetKind==="hidden"||!this.gridManager)return{};const i=this.getBackgroundBounds(e,t,this.gridManager);return{[Fv.GridProperty.GRID_BACKGROUND_X]:i.x+"px",[Fv.GridProperty.GRID_BACKGROUND_Y]:i.y+"px",[Fv.GridProperty.GRID_BACKGROUND_WIDTH]:i.width+"px",[Fv.GridProperty.GRID_BACKGROUND_HEIGHT]:i.height+"px",[Fv.GridProperty.GRID_BACKGROUND_ZOOM]:e.zoom+""}}getBackgroundBounds(e,t,i){const o=kv.Point.multiplyScalar(kv.Point.subtract(i.grid,e.scroll),e.zoom),r=kv.Dimension.fromPoint(kv.Point.multiplyScalar(i.grid,e.zoom));return{...o,...r}}};k1.GGraphView=Sw;kZ([(0,W5.inject)(nz.GridManager),(0,W5.optional)(),mAe("design:type",nz.GridManager)],Sw.prototype,"gridManager",void 0);k1.GGraphView=Sw=kZ([(0,W5.injectable)()],Sw);var F1={},gAe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(F1,"__esModule",{value:!0});F1.GIssueMarkerView=void 0;const ml=z,vAe=F;let Z5=class extends ml.IssueMarkerView{render(e,t){const i=super.getMaxSeverity(e),o=(0,ml.svg)("g",{"class-sprotty-issue":!0},(0,ml.svg)("g",null,this.getGlspIssueMarkerBackground(i),(0,ml.svg)("path",{d:this.getGlspIssueMarkerPath(i)})));return(0,ml.setClass)(o,"sprotty-"+i,!0),o}getGlspIssueMarkerBackground(e){switch(e){case"warning":return(0,ml.svg)("polygon",{"class-sprotty-issue-background":!0,points:"8 2, 15.9 14.9, 0.2 14.9"});case"error":case"info":return(0,ml.svg)("circle",{"class-sprotty-issue-background":!0,r:this.radius,cx:this.radius,cy:this.radius})}}get radius(){return 8}getGlspIssueMarkerPath(e){switch(e){case"error":return"m 8.8527788,0.00699568 c 1.8523692,0.115773 3.5889642,1.04195762 4.8624692,2.31546152 1.505048,1.620823 2.31546,3.5889653 2.31546,5.9044268 0,1.852369 -0.694637,3.588965 -1.852367,5.094015 -1.157733,1.389277 -2.778554,2.431235 -4.6309235,2.778554 C 7.6950478,16.446772 5.8426784,16.215226 4.2218552,15.289042 2.6010319,14.362857 1.3275281,12.97358 0.63288942,11.236984 -0.06174907,9.5003878 -0.17752216,7.5322456 0.4013433,5.7956494 0.98020876,3.9432802 2.0221665,2.4382302 3.6429898,1.3962725 5.14804,0.35431486 7.0004094,-0.10877742 8.8527788,0.00699568 Z M 9.4316445,14.941722 c 1.5050505,-0.347319 2.8943275,-1.15773 3.9362845,-2.431234 0.926185,-1.273504 1.50505,-2.778554 1.389277,-4.3993771 0,-1.8523692 -0.69464,-3.7047384 -1.968142,-4.9782422 C 11.631331,1.9751379 10.242054,1.2804995 8.6212324,1.1647264 7.1161824,1.0489533 5.4953592,1.3962725 4.2218552,2.3224572 2.9483511,3.2486418 2.0221665,4.5221456 1.5590742,6.1429686 c -0.4630923,1.50505 -0.4630923,3.1258731 0.2315462,4.6309234 0.6946384,1.50505 1.7365963,2.66278 3.1258734,3.473192 1.3892769,0.810411 3.0101002,1.041958 4.5151507,0.694638 z M 8.042367,7.5322456 10.82092,4.6379187 11.631331,5.4483302 8.8527788,8.3426571 11.631331,11.236984 10.82092,12.047395 8.042367,9.1530686 5.2638128,12.047395 4.4534013,11.236984 7.2319555,8.3426571 4.4534013,5.4483302 5.2638128,4.6379187 Z";case"warning":return"M 7.5587159,0.61312771 H 8.565869 L 16.050847,14.644601 15.54727,15.491525 H 0.55442396 L 0.05084746,14.644601 Z M 8.0622924,2.0780776 1.5157974,14.347033 H 14.585897 Z M 8.7776,13.202541 V 12.058049 H 7.3469848 v 1.144492 z M 7.3469848,10.913557 V 6.3355883 H 8.7776 v 4.5779687 z";case"info":return"M 8.7624795,0.01729008 A 7.8878137,7.8878137 0 0 1 13.625085,2.3592747 8.1894066,8.1894066 0 0 1 14.158672,13.251418 7.9458123,7.9458123 0 0 1 4.2061071,15.26977 8.1198082,8.1198082 0 0 1 0.58699265,11.209866 8.259005,8.259005 0 0 1 0.32019895,5.7463948 8.1198082,8.1198082 0 0 1 3.533323,1.3500986 7.8878137,7.8878137 0 0 1 8.7624795,0.01729008 Z M 9.3099868,14.921778 A 6.8322386,6.8322386 0 0 0 13.265493,12.520635 7.0410337,7.0410337 0 0 0 12.801504,3.1712556 6.7510406,6.7510406 0 0 0 4.1829077,2.3128758 7.029434,7.029434 0 0 0 4.762894,14.248994 6.7394408,6.7394408 0 0 0 9.3099868,14.921778 Z M 7.3786322,5.7811939 H 8.8285979 V 4.6212213 H 7.3786322 Z M 8.8285979,6.9411665 V 11.581057 H 7.3786322 V 6.9411665 Z"}}};F1.GIssueMarkerView=Z5;F1.GIssueMarkerView=Z5=gAe([(0,vAe.injectable)()],Z5);var Tu={},_f={};Object.defineProperty(_f,"__esModule",{value:!0});_f.scaledRadius=_f.RoundedCornerWrapper=void 0;class _Ae{constructor(e,t){this.element=e,this.cornerRadius=t}get size(){return this.element.size}get topLeftCorner(){return this._topLeftCorner||(this._topLeftCorner={radiusX:Wa(this.cornerRadius.topLeft,this.element.size.width/2),radiusY:Wa(this.cornerRadius.topLeft,this.element.size.height/2)}),this._topLeftCorner}get topRightCorner(){return this._topRightCorner||(this._topRightCorner={radiusX:Wa(this.cornerRadius.topRight,this.element.size.width/2),radiusY:Wa(this.cornerRadius.topRight,this.element.size.height/2)}),this._topRightCorner}get bottomRightCorner(){return this._bottomRightCorner||(this._bottomRightCorner={radiusX:Wa(this.cornerRadius.bottomRight,this.element.size.width/2),radiusY:Wa(this.cornerRadius.bottomRight,this.element.size.height/2)}),this._bottomRightCorner}get bottomLeftCorner(){return this._bottomLeftCorner||(this._bottomLeftCorner={radiusX:Wa(this.cornerRadius.bottomLeft,this.element.size.width/2),radiusY:Wa(this.cornerRadius.bottomLeft,this.element.size.height/2)}),this._bottomLeftCorner}}_f.RoundedCornerWrapper=_Ae;function Wa(n,e){return n<=e?n:n*(e/n)}_f.scaledRadius=Wa;var yAe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Tu,"__esModule",{value:!0});Tu.toClipPathId=Tu.RoundedCornerNodeView=void 0;const gd=z,bAe=F,SAe=ls,EAe=_f;let Q5=class extends gd.RectangularNodeView{render(e,t){const i=SAe.CornerRadius.from(e);if(!i)return this.renderWithoutRadius(e,t);const o=new EAe.RoundedCornerWrapper(e,i);return(0,gd.svg)("g",{"class-node":!0},(0,gd.svg)("defs",null,(0,gd.svg)("clipPath",{id:FZ(e)},(0,gd.svg)("path",{d:this.renderPath(o,t,this.getClipPathInsets()||0)}))),this.renderPathNode(o,t),t.renderChildren(e))}renderWithoutRadius(e,t){return super.render(e,t)}getClipPathInsets(){return 2}renderPathNode(e,t){return(0,gd.svg)("path",{d:this.renderPath(e,t,0),"class-sprotty-node":e.element instanceof gd.GNode,"class-sprotty-port":e.element instanceof gd.GPort,"class-mouseover":e.element.hoverFeedback,"class-selected":e.element.selected,...this.additionalClasses(e.element,t)})}additionalClasses(e,t){return{}}renderPath(e,t,i){const o=Math.max(0,e.size.width-e.cornerRadius.topLeft-e.cornerRadius.topRight),r=Math.max(0,e.size.height-e.cornerRadius.topRight-e.cornerRadius.bottomRight),s=Math.max(0,e.size.width-e.cornerRadius.bottomLeft-e.cornerRadius.bottomRight);return`M${0+i},${0+e.topLeftCorner.radiusY}q0,${-(e.topLeftCorner.radiusY-i)} ${e.topLeftCorner.radiusX-i},${-(e.topLeftCorner.radiusY-i)}h${o}q${e.topRightCorner.radiusX-i},0 ${e.topRightCorner.radiusX-i},${e.topRightCorner.radiusY-i}v${r}q0,${e.bottomRightCorner.radiusY-i} ${-(e.bottomRightCorner.radiusX-i)},${e.bottomRightCorner.radiusY-i}h${-s}q${-(e.bottomLeftCorner.radiusX-i)},0 ${-(e.bottomLeftCorner.radiusX-i)},${-(e.bottomLeftCorner.radiusY-i)}z `}};Tu.RoundedCornerNodeView=Q5;Tu.RoundedCornerNodeView=Q5=yAe([(0,bAe.injectable)()],Q5);function FZ(n){return`${n.id}_clip_path`}Tu.toClipPathId=FZ;Object.defineProperty(Lm,"__esModule",{value:!0});Lm.configureDefaultModelElements=Lm.baseViewModule=void 0;const be=z,CAe=Ti,iz=ti,PAe=$1,wAe=k1,AAe=F1,RAe=Tu;Lm.baseViewModule=new be.FeatureModule((n,e,t,i)=>{xZ({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("baseView")});function xZ(n){(0,be.configureModelElement)(n,be.DefaultTypes.HTML,be.GHtmlRoot,be.HtmlRootView),(0,be.configureModelElement)(n,be.DefaultTypes.FOREIGN_OBJECT,be.GForeignObjectElement,be.ForeignObjectView,{disable:[be.selectFeature,be.moveFeature]}),(0,be.configureModelElement)(n,be.DefaultTypes.PRE_RENDERED,be.GPreRenderedElement,be.PreRenderedView),(0,be.configureModelElement)(n,be.DefaultTypes.SHAPE_PRE_RENDERED,be.GShapedPreRenderedElement,be.PreRenderedView),(0,be.configureModelElement)(n,be.DefaultTypes.SVG,be.GViewportRootElement,be.SvgViewportView),(0,be.configureModelElement)(n,be.DefaultTypes.GRAPH,iz.GGraph,wAe.GGraphView),(0,be.configureModelElement)(n,be.DefaultTypes.NODE,be.GNode,RAe.RoundedCornerNodeView),(0,be.configureModelElement)(n,be.DefaultTypes.COMPARTMENT,be.GCompartment,be.GCompartmentView),(0,be.configureModelElement)(n,be.DefaultTypes.COMPARTMENT_HEADER,be.GCompartment,be.GCompartmentView),(0,be.configureModelElement)(n,be.DefaultTypes.EDGE,iz.GEdge,PAe.GEdgeView),(0,be.configureModelElement)(n,be.DefaultTypes.PORT,be.GPort,be.RectangularNodeView),(0,be.configureModelElement)(n,be.DefaultTypes.ROUTING_POINT,be.GRoutingHandle,be.GRoutingHandleView),(0,be.configureModelElement)(n,be.DefaultTypes.VOLATILE_ROUTING_POINT,be.GRoutingHandle,be.GRoutingHandleView),(0,be.configureModelElement)(n,be.DefaultTypes.LABEL,be.GLabel,be.GLabelView),(0,be.configureModelElement)(n,be.DefaultTypes.BUTTON_EXPAND,be.GButton,be.ExpandButtonView),(0,be.configureModelElement)(n,be.DefaultTypes.ISSUE_MARKER,CAe.GIssueMarker,AAe.GIssueMarkerView),(0,be.configureModelElement)(n,be.DefaultTypes.NODE_CIRCLE,be.CircularNode,be.CircularNodeView),(0,be.configureModelElement)(n,be.DefaultTypes.NODE_DIAMOND,be.DiamondNode,be.DiamondNodeView),(0,be.configureModelElement)(n,be.DefaultTypes.NODE_RECTANGLE,be.RectangularNode,be.RectangularNodeView)}Lm.configureDefaultModelElements=xZ;var aS={},MAe=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(aS,"__esModule",{value:!0});aS.StructureCompartmentView=void 0;const wT=z,IAe=F;let X5=class extends wT.ShapeView{render(e,t){if(this.isVisible(e,t))return(0,wT.svg)("g",null,(0,wT.svg)("rect",{"class-sprotty-comp":!0,x:"0",y:"0",width:e.size.width,height:e.size.height}),t.renderChildren(e))}};aS.StructureCompartmentView=X5;aS.StructureCompartmentView=X5=MAe([(0,IAe.injectable)()],X5);var cS={},s4=l&&l.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},HZ=l&&l.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(cS,"__esModule",{value:!0});cS.GLSPProjectionView=void 0;const xo=z,Ew=F,oz=dg,rz=Ta,xv=B1;let Zy=class extends xo.ProjectedViewportView{render(e,t,i){const o=(0,xo.html)("div",{"class-sprotty-graph":!1,style:{width:"100%",height:"100%"}},this.renderSvg(e,t,i),this.renderProjections(e,t,i));return(0,xo.setAttr)(o,"tabindex",1),(0,xo.setAttr)(o,"aria-label","Diagram"),o}renderSvg(e,t,i){const o=this.edgeRouterRegistry.routeAllChildren(e),r=`scale(${e.zoom}) translate(${-e.scroll.x},${-e.scroll.y})`,s="http://www.w3.org/2000/svg";return(0,oz.h)("svg",{ns:s,style:{height:"100%",...this.getGridStyle(e,t)},class:{"sprotty-graph":!0}},(0,oz.h)("g",{ns:s,attrs:{transform:r}},t.renderChildren(e,{edgeRouting:o})))}getGridStyle(e,t){if(t.targetKind==="hidden"||!this.gridManager)return{};const i=this.getBackgroundBounds(e,t,this.gridManager);return{[xv.GridProperty.GRID_BACKGROUND_X]:i.x+"px",[xv.GridProperty.GRID_BACKGROUND_Y]:i.y+"px",[xv.GridProperty.GRID_BACKGROUND_WIDTH]:i.width+"px",[xv.GridProperty.GRID_BACKGROUND_HEIGHT]:i.height+"px",[xv.GridProperty.GRID_BACKGROUND_ZOOM]:e.zoom+""}}getBackgroundBounds(e,t,i){const o=xo.Point.multiplyScalar(xo.Point.subtract(i.grid,e.scroll),e.zoom),r=xo.Dimension.fromPoint(xo.Point.multiplyScalar(i.grid,e.zoom));return{...o,...r}}renderProjectionBar(e,t,i,o){const r=super.renderProjectionBar(e,t,i,o);return(0,xo.setClass)(r,"bordered-projection-bar",!0),r}renderViewport(e,t){let i,o;t.orientation==="horizontal"?(i=e.canvasBounds.width,o=(e.scroll.x-t.modelBounds.x)*t.factor):(i=e.canvasBounds.height,o=(e.scroll.y-t.modelBounds.y)*t.factor);let r=i*t.zoomedFactor;o<0?(r+=o,o=0):o>i&&(o=i),r<0?r=0:o+r>i&&(r=i-o),Math.abs(r-i)<1&&(r=0);const s=t.orientation==="horizontal"?{left:`${o}px`,width:`${r}px`}:{top:`${o}px`,height:`${r}px`};return(0,xo.html)("div",{"class-sprotty-viewport":r!==0,"class-projection-scroll-bar":!0,style:s})}renderProjection(e,t,i){const o=super.renderProjection(e,t,i);(0,xo.setClass)(o,"glsp-projection",!0);const r=o.data.style;return r.left?r.height="60%":r.width="60%",o}};cS.GLSPProjectionView=Zy;s4([(0,Ew.inject)(xo.EdgeRouterRegistry),HZ("design:type",xo.EdgeRouterRegistry)],Zy.prototype,"edgeRouterRegistry",void 0);s4([(0,Ew.inject)(rz.GridManager),(0,Ew.optional)(),HZ("design:type",rz.GridManager)],Zy.prototype,"gridManager",void 0);cS.GLSPProjectionView=Zy=s4([(0,Ew.injectable)()],Zy);(function(n){var e=l&&l.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=l&&l.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(Pt,n),t(Zf,n),t(Ig,n),t(ab,n),t(uu,n),t(fq,n),t(cb,n),t(ql,n),t(Dg,n),t(db,n),t(Hr,n),t(An,n),t(it,n),t(_c,n),t(Tg,n),t(Gn,n),t(ub,n),t(Og,n),t(Lg,n),t(Ma,n),t(zc,n),t(lu,n),t(Ao,n),t(ys,n),t(Bg,n),t($g,n),t(Is,n),t(kg,n),t(Yt,n),t(It,n),t(Dr,n),t(Ms,n),t(Hg,n),t(Qf,n),t(Xf,n),t(Kg,n),t(Rq,n),t(rM,n),t(Wc,n),t(A1,n),t(SZ,n),t(er,n),t(Ru,n),t(ga,n),t(K9,n),t(EZ,n),t(tS,n),t(C1,n),t(P1,n),t(U9,n),t(w1,n),t(R1,n),t(eo,n),t(Dc,n),t(W9,n),t(tr,n),t(jr,n),t(ch,n),t(Yo,n),t(M1,n),t(I1,n),t(Zc,n),t(dh,n),t(Qb,n),t(cf,n),t(Xb,n),t(ah,n),t(df,n),t(yo,n),t(uf,n),t(bo,n),t(fs,n),t(ff,n),t(Lc,n),t(Qi,n),t(pf,n),t(Tc,n),t(sr,n),t(Q9,n),t(N1,n),t(Mu,n),t(Iu,n),t(mf,n),t(Du,n),t(fb,n),t(Vg,n),t(hu,n),t(zg,n),t(Ia,n),t(pu,n),t(Ro,n),t(Ss,n),t(Gg,n),t(no,n),t(Rr,n),t(uM,n),t(Jf,n),t(vf,n),t(tf,n),t(Ug,n),t(hb,n),t(Yg,n),t(mu,n),t(pb,n),t(nS,n),t(qg,n),t(gu,n),t(qn,n),t(yc,n),t(OR,n),t(Qg,n),t(o4,n),t(Hu,n),t(wc,n),t(fM,n),t(gb,n),t(Xg,n),t(_o,n),t(Jg,n),t(Yb,n),t(bc,n),t(NR,n),t(e1,n),t(t1,n),t(DZ,n),t(Ta,n),t(Cc,n),t(hM,n),t($c,n),t(B1,n),t(mM,n),t(LZ,n),t(r4,n),t(gM,n),t(eh,n),t(kc,n),t(n1,n),t(ds,n),t(vb,n),t(o1,n),t(yb,n),t(a1,n),t(Sb,n),t(c1,n),t(us,n),t(Eb,n),t(on,n),t(Cb,n),t(na,n),t(Pb,n),t(ih,n),t(_b,n),t(Zi,n),t(Ab,n),t(iS,n),t(oS,n),t(f1,n),t(VR,n),t(h1,n),t(Pc,n),t(Rb,n),t(Ib,n),t(m1,n),t(g1,n),t(Db,n),t(Dn,n),t(Tb,n),t(_i,n),t(Da,n),t(bu,n),t(Pn,n),t(jb,n),t(kb,n),t(UR,n),t(Mc,n),t(mi,n),t(xb,n),t(Yc,n),t(Hb,n),t(Sc,n),t(s1,n),t(r1,n),t(Kb,n),t(Eu,n),t(mt,n),t(oh,n),t(Ji,n),t(zb,n),t(Ic,n),t(Nb,n),t(Gb,n),t(v1,n),t(XR,n),t(p1,n),t(Ub,n),t(ia,n),t(_1,n),t(wu,n),t(rS,n),t(sS,n),t(Ti,n),t(En,n),t(Bn,n),t(tM,n),t(S1,n),t(Ac,n),t(ma,n),t(E1,n),t(nM,n),t(ti,n),t(BZ,n),t($Z,n),t(ls,n),t(Ke,n),t(kt,n),t(gf,n),t(yn,n),t(sf,n),t(Ct,n),t(Lm,n),t(aS,n),t($1,n),t(k1,n),t(cS,n),t(F1,n),t(_f,n),t(Tu,n)})(m);var Cw;(function(n){n.KIND="elementAnimate";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasArrayProp(i,"elementIds")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Cw||(Cw={}));var J5;(function(n){n.KIND="autoAlign";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(J5||(J5={}));var Qy;(function(n){n.KIND="attachBoundary";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasStringProp(i,"elementId")&&ct.hasStringProp(i,"eventKind")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(Qy||(Qy={}));var eL;(function(n){n.KIND="setBreakpoint";function e(t){return{kind:n.KIND,...t}}n.create=e})(eL||(eL={}));var tL;(function(n){n.KIND="toggleBreakpoint";function e(t){return{kind:n.KIND,...t}}n.create=e})(tL||(tL={}));var Pw;(function(n){n.KIND="showBreakpoints";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasArrayProp(i,"elementBreakpoints")&&ct.hasBooleanProp(i,"globalDisabled")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Pw||(Pw={}));var Xy;(function(n){n.KIND="changeColor";function e(o){return i(o)}n.changeColor=e;function t(o){return i(o)}n.deleteColor=t;function i(o){return{kind:n.KIND,isOperation:!0,...o}}n.create=i})(Xy||(Xy={}));var ww;(function(n){n.KIND="updateColorPalette";function e(t){return ct.Action.hasKind(t,n.KIND)}n.is=e})(ww||(ww={}));var nL;(function(n){n.KIND="straightenEdge";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(nL||(nL={}));var iL;(function(n){n.KIND="autoBendEdge";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(iL||(iL={}));var Jy;(function(n){n.KIND="toggleCustomIcons";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasBooleanProp(i,"showCustomIcons")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Jy||(Jy={}));var Aw;(function(n){n.KIND="openDataClassEditor";function e(){return{kind:n.KIND}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)}n.is=t})(Aw||(Aw={}));var oL;(function(n){n.KIND="openDecoratorBrowser";function e(t){return{kind:n.KIND,elementId:t}}n.create=e})(oL||(oL={}));var Rw;(function(n){n.KIND="setExecutedElements";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasArrayProp(i,"elementExecutions")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Rw||(Rw={}));var Mw;(function(n){n.KIND="elementStopped";function e(i){return ct.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Mw||(Mw={}));var Iw;(function(n){n.KIND="openFormEditor";function e(){return{kind:n.KIND}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)}n.is=t})(Iw||(Iw={}));var rL;(function(n){n.KIND="goToSource";function e(t){return{kind:n.KIND,elementId:t}}n.create=e})(rL||(rL={}));var sz;(function(n){n.KIND="openInsertExtension";function e(){return{kind:n.KIND}}n.create=e})(sz||(sz={}));var yf;(function(n){n.KIND="jumpInto";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasStringProp(i,"elementId")}n.is=t})(yf||(yf={}));var sL;(function(n){function e(t,i={}){return{kind:ct.UpdateModelAction.KIND,newRoot:t,...i}}n.create=e})(sL||(sL={}));var az;(function(n){n.KIND="openQuickOutline";function e(){return{kind:n.KIND}}n.create=e})(az||(az={}));var ba;(function(n){n.KIND="updatePaletteItems";function e(){return{kind:n.KIND}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)}n.is=t})(ba||(ba={}));var aL;(function(n){n.KIND="startProcess";function e(i,o){return{kind:n.KIND,elementId:i,processStartUri:o}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasStringProp(i,"elementId")&&ct.hasStringProp(i,"processStartUri")}n.is=t})(aL||(aL={}));var cL;(function(n){n.KIND="searchProcessCallers";function e(t){return{kind:n.KIND,elementId:t}}n.create=e})(cL||(cL={}));var Nm;(function(n){n.KIND="switchTheme";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasStringProp(i,"theme")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Nm||(Nm={}));var dL;(function(n){n.KIND="changeActivityType";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(dL||(dL={}));var e0;(function(n){n.KIND="enableViewport";function e(i){return ct.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(e0||(e0={}));var Dw;(function(n){n.KIND="originViewport";function e(t={}){return{kind:n.KIND,animate:!0,...t}}n.create=e})(Dw||(Dw={}));var t0;(function(n){n.KIND="moveIntoViewport";function e(t){return{kind:n.KIND,animate:!0,retainZoom:!1,...t}}n.create=e})(t0||(t0={}));var jm;(function(n){n.KIND="ivyViewportZoom";function e(i){return ct.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(jm||(jm={}));var uL;(function(n){n.KIND="wrapToSub";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(uL||(uL={}));var lL;(function(n){n.KIND="unwrapSub";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(lL||(lL={}));const vM=Symbol("animateFeature");function cz(n){return n.hasFeature(vM)}var DAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},TAe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},OAe=function(n,e){return function(t,i){e(t,i,n)}},lp,Tw;(function(n){function e(t){return{kind:Ow.KIND,...t}}n.create=e})(Tw||(Tw={}));var Od;let Ow=(Od=class extends m.Command{constructor(t){super();k(this,"action");k(this,"animated",[]);k(this,"deanimated",[]);this.action=t}execute(t){var o;const i=t.root;return this.action.animatedIDs.forEach(r=>{const s=i.index.getById(r);s instanceof m.GChildElement&&cz(s)&&this.animated.push(s)}),(o=this.action.deAnimatedIDs)==null||o.forEach(r=>{const s=i.index.getById(r);s instanceof m.GChildElement&&cz(s)&&this.deanimated.push(s)}),this.redo(t)}undo(t){for(const i of this.animated)m.removeCssClasses(i,lp.CSS_CLASS);for(const i of this.deanimated)m.addCssClasses(i,lp.CSS_CLASS);return t.root}redo(t){for(const i of this.deanimated)m.removeCssClasses(i,lp.CSS_CLASS);for(const i of this.animated)m.addCssClasses(i,lp.CSS_CLASS);return t.root}},lp=Od,k(Od,"KIND","elementAnimateFeedback"),k(Od,"CSS_CLASS","animate"),Od);Ow=lp=DAe([le(),OAe(0,_e(m.TYPES.Action)),TAe("design:paramtypes",[Object])],Ow);var a4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},KZ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Bm=class{constructor(){k(this,"animateElementIDs",new Set);k(this,"feedbackDispatcher");k(this,"actionDispatcher")}handle(e){if(Cw.is(e))for(const t of e.elementIds){this.animateElementIDs.add(t);const i=Tw.create({animatedIDs:[...this.animateElementIDs]});this.feedbackDispatcher.registerFeedback(this,[i]),this.actionDispatcher.dispatch(t0.create({elementIds:[t]})),setTimeout(()=>{this.animateElementIDs.delete(t),this.feedbackDispatcher.registerFeedback(this,[Tw.create({animatedIDs:[...this.animateElementIDs],deAnimatedIDs:[t]})]),this.animateElementIDs.size===0&&this.feedbackDispatcher.deregisterFeedback(this,[])},2e3)}}};a4([_e(m.TYPES.IFeedbackActionDispatcher),KZ("design:type",Object)],Bm.prototype,"feedbackDispatcher",void 0);a4([_e(m.TYPES.IActionDispatcher),KZ("design:type",Object)],Bm.prototype,"actionDispatcher",void 0);Bm=a4([le()],Bm);const LAe=new m.FeatureModule((n,e,t)=>{n(Bm).toSelf().inSingletonScope(),m.configureActionHandler({bind:n,isBound:t},Cw.KIND,Bm),m.configureCommand({bind:n,isBound:t},Ow)}),Ue={QuickActionProvider:Symbol.for("QuickActionProvider"),ToolBarButtonProvider:Symbol.for("ToolBarButtonProvider"),ToolBar:Symbol.for("ToolBar"),ColorPalette:Symbol.for("ColorPalette"),ActivityTypesPalette:Symbol.for("ActivityTypesPalette"),IvyViewerOptions:Symbol.for("IvyViewerOptions")};var B;(function(n){n.ActivitiesGroup="activities-group",n.AlignHorizontal="align-horizontal",n.AlignVertical="align-vertical",n.AlternativeGateways="alternative-gateways",n.Annotation="annotation",n.ArrowRight="arrow-right",n.ArrowUpRight="arrow-up-right",n.ArrowsMaximize="arrows-maximize",n.Attribute="attribute",n.AutoAlign="auto-align",n.Bend="bend",n.Bpmn="bpmn",n.Bug="bug",n.CalendarTime="calendar-time",n.CallOutline="call-outline",n.Call="call",n.Caution="caution",n.Center="center",n.ChangeType="change-type",n.Check="check",n.Checklist="checklist",n.Chevron="chevron",n.ClockOutline="clock-outline",n.Clock="clock",n.Close="close",n.Cms="cms",n.ColorDrop="color-drop",n.Comment="comment",n.Connector="connector",n.CustomImage="custom-image",n.DarkMode="dark-mode",n.DataClass="data-class",n.DatabaseLink="database-link",n.DatabaseOutline="database-outline",n.Database="database",n.DeviceMobile="device-mobile",n.DeviceTablet="device-tablet",n.DialogLayout="dialog-layout",n.Dots="dots",n.Download="download",n.DragDrop="drag-drop",n.EMailOutline="e-mail-outline",n.EMail="e-mail",n.EditDots="edit-dots",n.Edit="edit",n.EndPageOutline="end-page-outline",n.EndPage="end-page",n.ErrorEnd="error-end",n.ErrorStart="error-start",n.ErrorXMark="error-x-mark",n.Error="error",n.EventStartOutline="event-start-outline",n.EventStart="event-start",n.ExitEndOutline="exit-end-outline",n.ExitEnd="exit-end",n.Extension="extension",n.Eye="eye",n.FileImport="file-import",n.File="file",n.FitToScreen="fit-to-screen",n.FolderOpen="folder-open",n.Folders="folders",n.Function="function",n.GatewaysGroup="gateways-group",n.GoToSource="go-to-source",n.GridDots="grid-dots",n.Help="help",n.Helplines="helplines",n.Home="home",n.InfoCircle="info-circle",n.InitStartOutline="init-start-outline",n.InitStart="init-start",n.Ivy="ivy",n.JoinGateways="join-gateways",n.JoinTasksGateways="join-tasks-gateways",n.JumpOut="jump-out",n.Label="label",n.LaneSwimlanes="lane-swimlanes",n.LayoutSidebarRightCollapse="layout-sidebar-right-collapse",n.LetterD="letter-d",n.ListSearch="list-search",n.List="list",n.ManualOutline="manual-outline",n.Manual="manual",n.Market="market",n.MethodStartOutline="method-start-outline",n.MethodStart="method-start",n.MultiSelection="multi-selection",n.NoteOutline="note-outline",n.Note="note",n.PasswordUser="password-user",n.Password="password",n.PenEdit="pen-edit",n.Persistence="persistence",n.Play="play",n.Plus="plus",n.PoolSwimlanes="pool-swimlanes",n.ProcessEnd="process-end",n.Process="process",n.ProgramOutline="program-outline",n.Quote="quote",n.ReceiveOutline="receive-outline",n.Receive="receive",n.Reconnect="reconnect",n.Redo="redo",n.RestClientOutline="rest-client-outline",n.RestClient="rest-client",n.RuleOutline="rule-outline",n.Rule="rule",n.ScriptFileOutline="script-file-outline",n.Script="script",n.Search="search",n.SelectionTool="selection-tool",n.Selector="selector",n.SendOutline="send-outline",n.Send="send",n.SettingsCog="settings-cog",n.SettingsOutline="settings-outline",n.Settings="settings",n.Spinner="spinner",n.Sql="sql",n.StartProgramOutline="start-program-outline",n.StartProgram="start-program",n.StartSignalOutline="start-signal-outline",n.StartSignal="start-signal",n.Start="start",n.Straighten="straighten",n.SubActivitiesDashed="sub-activities-dashed",n.SubActivities="sub-activities",n.SubEndOutline="sub-end-outline",n.SubEnd="sub-end",n.SubManualOutline="sub-manual-outline",n.SubReceiveOutline="sub-receive-outline",n.SubRuleOutline="sub-rule-outline",n.SubScriptOutline="sub-script-outline",n.SubSendOutline="sub-send-outline",n.SubStartOutline="sub-start-outline",n.SubStart="sub-start",n.SubUserOutline="sub-user-outline",n.SubWebService="sub-web-service",n.TaskDoubleOutline="task-double-outline",n.TaskOutline="task-outline",n.Task="task",n.TasksGateways="tasks-gateways",n.Toggle="toggle",n.Tool="tool",n.Trash="trash",n.TriggerOutline="trigger-outline",n.Trigger="trigger",n.Undo="undo",n.Unwrap="unwrap",n.Upload="upload",n.UserDialogOutline="user-dialog-outline",n.UserDialog="user-dialog",n.UserOutline="user-outline",n.UserTaskOutline="user-task-outline",n.UserTask="user-task",n.User="user",n.Users="users",n.WebService="web-service",n.WindowMinimize="window-minimize",n.WrapToSubprocess="wrap-to-subprocess",n.WsStartOutline="ws-start-outline",n.WsStart="ws-start"})(B||(B={}));B.ActivitiesGroup+"",B.AlignHorizontal+"",B.AlignVertical+"",B.AlternativeGateways+"",B.Annotation+"",B.ArrowRight+"",B.ArrowUpRight+"",B.ArrowsMaximize+"",B.Attribute+"",B.AutoAlign+"",B.Bend+"",B.Bpmn+"",B.Bug+"",B.CalendarTime+"",B.CallOutline+"",B.Call+"",B.Caution+"",B.Center+"",B.ChangeType+"",B.Check+"",B.Checklist+"",B.Chevron+"",B.ClockOutline+"",B.Clock+"",B.Close+"",B.Cms+"",B.ColorDrop+"",B.Comment+"",B.Connector+"",B.CustomImage+"",B.DarkMode+"",B.DataClass+"",B.DatabaseLink+"",B.DatabaseOutline+"",B.Database+"",B.DeviceMobile+"",B.DeviceTablet+"",B.DialogLayout+"",B.Dots+"",B.Download+"",B.DragDrop+"",B.EMailOutline+"",B.EMail+"",B.EditDots+"",B.Edit+"",B.EndPageOutline+"",B.EndPage+"",B.ErrorEnd+"",B.ErrorStart+"",B.ErrorXMark+"",B.Error+"",B.EventStartOutline+"",B.EventStart+"",B.ExitEndOutline+"",B.ExitEnd+"",B.Extension+"",B.Eye+"",B.FileImport+"",B.File+"",B.FitToScreen+"",B.FolderOpen+"",B.Folders+"",B.Function+"",B.GatewaysGroup+"",B.GoToSource+"",B.GridDots+"",B.Help+"",B.Helplines+"",B.Home+"",B.InfoCircle+"",B.InitStartOutline+"",B.InitStart+"",B.Ivy+"",B.JoinGateways+"",B.JoinTasksGateways+"",B.JumpOut+"",B.Label+"",B.LaneSwimlanes+"",B.LayoutSidebarRightCollapse+"",B.LetterD+"",B.ListSearch+"",B.List+"",B.ManualOutline+"",B.Manual+"",B.Market+"",B.MethodStartOutline+"",B.MethodStart+"",B.MultiSelection+"",B.NoteOutline+"",B.Note+"",B.PasswordUser+"",B.Password+"",B.PenEdit+"",B.Persistence+"",B.Play+"",B.Plus+"",B.PoolSwimlanes+"",B.ProcessEnd+"",B.Process+"",B.ProgramOutline+"",B.Quote+"",B.ReceiveOutline+"",B.Receive+"",B.Reconnect+"",B.Redo+"",B.RestClientOutline+"",B.RestClient+"",B.RuleOutline+"",B.Rule+"",B.ScriptFileOutline+"",B.Script+"",B.Search+"",B.SelectionTool+"",B.Selector+"",B.SendOutline+"",B.Send+"",B.SettingsCog+"",B.SettingsOutline+"",B.Settings+"",B.Spinner+"",B.Sql+"",B.StartProgramOutline+"",B.StartProgram+"",B.StartSignalOutline+"",B.StartSignal+"",B.Start+"",B.Straighten+"",B.SubActivitiesDashed+"",B.SubActivities+"",B.SubEndOutline+"",B.SubEnd+"",B.SubManualOutline+"",B.SubReceiveOutline+"",B.SubRuleOutline+"",B.SubScriptOutline+"",B.SubSendOutline+"",B.SubStartOutline+"",B.SubStart+"",B.SubUserOutline+"",B.SubWebService+"",B.TaskDoubleOutline+"",B.TaskOutline+"",B.Task+"",B.TasksGateways+"",B.Toggle+"",B.Tool+"",B.Trash+"",B.TriggerOutline+"",B.Trigger+"",B.Undo+"",B.Unwrap+"",B.Upload+"",B.UserDialogOutline+"",B.UserDialog+"",B.UserOutline+"",B.UserTaskOutline+"",B.UserTask+"",B.User+"",B.Users+"",B.WebService+"",B.WindowMinimize+"",B.WrapToSubprocess+"",B.WsStartOutline+"",B.WsStart+"";var _M=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let ni=class{multiQuickAction(e){}};ni=_M([le()],ni);let fL=class{singleQuickAction(e){}};fL=_M([le()],fL);let hL=class{singleQuickAction(e){if(m.isDeletable(e))return this.quickAction([e.id])}multiQuickAction(e){const t=e.filter(i=>m.isDeletable(i)).map(i=>i.id);if(t.length>0)return this.quickAction(t)}quickAction(e){return{icon:B.Trash,title:"Delete",location:"Left",sorting:"A",action:m.DeleteElementOperation.create(e)}}};hL=_M([le()],hL);let pL=class extends fL{multiQuickAction(e){const t=e.map(i=>i.id);if(t.length>0)return{icon:B.AutoAlign,title:"Auto Align (A)",location:"Middle",sorting:"Y",action:J5.create({elementIds:t}),shortcut:"KeyA"}}};pL=_M([le()],pL);const Lw=Symbol("multipleOutgoingEdgesFeature");function NAe(n){return n.hasFeature(Lw)}var c4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},jAe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},mL,wl;let jp=(wl=class extends m.BaseCreationTool{constructor(){super(...arguments);k(this,"anchorRegistry");k(this,"isTriggerAction",$m.is);k(this,"creationToolMouseListener");k(this,"feedbackEndMovingMouseListener")}get id(){return mL.ID}doEnable(){this.creationToolMouseListener=new BAe(this.triggerAction,this),this.feedbackEndMovingMouseListener=new m.FeedbackEdgeEndMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher),this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.creationToolMouseListener)),this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.feedbackEndMovingMouseListener)),this.toDisposeOnDisable.push(this.registerFeedback([m.cursorFeedbackAction(m.CursorCSS.OPERATION_NOT_ALLOWED)],this,[m.RemoveFeedbackEdgeAction.create(),m.cursorFeedbackAction()]))}},mL=wl,k(wl,"ID","quick-action-edge-creation-tool"),wl);c4([_e(m.AnchorComputerRegistry),jAe("design:type",m.AnchorComputerRegistry)],jp.prototype,"anchorRegistry",void 0);jp=mL=c4([le()],jp);class BAe extends m.DragAwareMouseListener{constructor(t,i){super();k(this,"triggerAction");k(this,"tool");k(this,"source");k(this,"target");k(this,"currentTarget");k(this,"allowedTarget",!1);k(this,"proxyEdge");this.triggerAction=t,this.tool=i,this.proxyEdge=new m.GEdge,this.proxyEdge.type=t.elementTypeId,this.proxyEdge.sourceId=t.sourceId,this.source=this.triggerAction.sourceId,this.tool.registerFeedback([m.DrawFeedbackEdgeAction.create({elementTypeId:this.triggerAction.elementTypeId,sourceId:this.source})])}reinitialize(){this.source=void 0,this.target=void 0,this.currentTarget=void 0,this.allowedTarget=!1,this.tool.registerFeedback([m.RemoveFeedbackEdgeAction.create()])}nonDraggingMouseUp(t,i){const o=[];return i.button===0?(this.currentTarget&&(this.target=this.currentTarget.id),this.source&&this.target&&(o.push(this.edgeOperation(this.source,this.target)),m.isCtrlOrCmd(i)?this.reinitialize():o.push(m.EnableDefaultToolsAction.create()))):i.button===2&&o.push(m.EnableDefaultToolsAction.create()),o}edgeOperation(t,i){return this.triggerAction.reconnect&&this.triggerAction.edgeId?m.ReconnectEdgeOperation.create({edgeElementId:this.triggerAction.edgeId,sourceElementId:t,targetElementId:i,args:this.triggerAction.args}):m.CreateEdgeOperation.create({elementTypeId:this.triggerAction.elementTypeId,sourceElementId:t,targetElementId:i,args:this.triggerAction.args})}isSourceSelected(){return this.source!==void 0}isTargetSelected(){return this.target!==void 0}mouseOver(t,i){const o=m.findParentByFeature(t,m.isConnectable);return o!==this.currentTarget?(this.currentTarget=o,this.currentTarget&&(this.isSourceSelected()?this.isTargetSelected()||(this.allowedTarget=this.isAllowedTarget(o)):this.allowedTarget=this.isAllowedSource(o),this.allowedTarget)?[this.isSourceSelected()?m.cursorFeedbackAction(m.CursorCSS.EDGE_CREATION_TARGET):m.cursorFeedbackAction(m.CursorCSS.EDGE_CREATION_SOURCE)]:[m.cursorFeedbackAction(m.CursorCSS.OPERATION_NOT_ALLOWED)]):[]}isAllowedSource(t){return t!==void 0&&m.isConnectable(t)&&t.canConnect(this.proxyEdge,"source")}isAllowedTarget(t){return t!==void 0&&m.isConnectable(t)&&t.canConnect(this.proxyEdge,"target")}}var $m;(function(n){n.KIND="quickActionTriggerEdgeCreation";function e(i){return m.Action.hasKind(i,n.KIND)&&m.hasStringProp(i,"elementTypeId")&&m.hasStringProp(i,"sourceId")}n.is=e;function t(i,o,r={}){return{kind:n.KIND,elementTypeId:i,sourceId:o,...r}}n.create=t})($m||($m={}));let gL=class extends ni{singleQuickAction(e){const t=new m.GEdge;if(t.type="edge",e instanceof m.GNode&&e.canConnect(t,"source")&&(Array.from(e.outgoingEdges).length===0||NAe(e)))return{icon:B.Connector,title:"Connect",location:"Right",sorting:"Z",action:$m.create("edge",e.id)}}};gL=c4([le()],gL);var d4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let vL=class extends ni{singleQuickAction(e){if(e instanceof m.GEdge)return{icon:B.Straighten,title:"Straighten (S)",location:"Middle",sorting:"A",action:nL.create({elementId:e.id}),letQuickActionsOpen:!0,shortcut:"KeyS"}}};vL=d4([le()],vL);let _L=class extends ni{singleQuickAction(e){if(e instanceof m.GEdge)return{icon:B.Bend,title:"Bend (B)",location:"Middle",sorting:"B",action:iL.create({elementId:e.id}),letQuickActionsOpen:!0,shortcut:"KeyB"}}};_L=d4([le()],_L);let yL=class extends ni{singleQuickAction(e){if(e instanceof m.GEdge)return{icon:B.Reconnect,title:"Reconnect (R)",location:"Right",sorting:"A",action:$m.create(e.type,e.sourceId,{edgeId:e.id,reconnect:!0}),letQuickActionsOpen:!0,shortcut:"KeyR"}}};yL=d4([le()],yL);const VZ=new m.FeatureModule(n=>{n(Ue.QuickActionProvider).to(vL),n(Ue.QuickActionProvider).to(_L),n(Ue.QuickActionProvider).to(yL)}),zZ=Symbol("unwrapFeature"),yM=Symbol("wrapFeature"),M_=Symbol("singleWrapFeature");function GZ(n){return n.hasFeature(zZ)}function $Ae(n){return n.hasFeature(yM)}function kAe(n){return n.hasFeature(M_)}const u4=Symbol("errorBoundaryFeature");function FAe(n){return n.hasFeature(u4)}const UZ=Symbol("signalBoundaryFeature");function xAe(n){return n.hasFeature(UZ)}const dS=Symbol("breakpointFeature");function bL(n){return n.hasFeature(dS)}const qw=class qw extends m.GChildElement{constructor(t="",i=!1,o=!1,r=qw.TYPE,s=!1){super();k(this,"condition");k(this,"disabled");k(this,"globalDisabled");k(this,"type");k(this,"hoverFeedback");this.condition=t,this.disabled=i,this.globalDisabled=o,this.type=r,this.hoverFeedback=s}hasFeature(t){return t===m.hoverFeedbackFeature||t===m.selectFeature}mouseUp(t){return[]}};k(qw,"TYPE","breakpoint-handle");let km=qw;function HAe(n,e,t,i){SL(n),n.add(new km(e,t,i))}function SL(n){n.removeAll(e=>e instanceof km)}const uS=Symbol("executionFeature");function Nw(n){return n.hasFeature(uS)}const x1=Symbol("quickActionFeature");function YZ(n){return m.isBoundsAware(n)&&m.isSelectable(n)&&n instanceof m.GParentElement&&n.hasFeature(x1)}var We;(function(n){n.DEFAULT="event:start",n.START=n.DEFAULT+":requestStart",n.START_ERROR=n.DEFAULT+":errorStartEvent",n.START_SIGNAL=n.DEFAULT+":signalStartEvent",n.START_PROGRAM=n.DEFAULT+":programStart",n.START_SUB=n.DEFAULT+":callSubStart",n.START_WS=n.DEFAULT+":webserviceStart",n.START_HD=n.DEFAULT+":htmlDialogStart",n.START_HD_METHOD=n.DEFAULT+":htmlDialogMethodStart",n.START_HD_EVENT=n.DEFAULT+":htmlDialogEventStart",n.START_EMBEDDED=n.DEFAULT+":embeddedStart",n.START_THIRD_PARTY=n.DEFAULT+":thirdPartyProgramStart"})(We||(We={}));var bn;(function(n){n.DEFAULT="event:end",n.END=n.DEFAULT+":taskEnd",n.END_ERROR=n.DEFAULT+":errorEnd",n.END_PAGE=n.DEFAULT+":taskEndPage",n.END_SUB=n.DEFAULT+":callSubEnd",n.END_WS=n.DEFAULT+":webserviceEnd",n.END_HD=n.DEFAULT+":htmlDialogEnd",n.END_HD_EXIT=n.DEFAULT+":htmlDialogExit",n.END_EMBEDDED=n.DEFAULT+":embeddedEnd"})(bn||(bn={}));var nr;(function(n){n.DEFAULT="event:intermediate",n.INTERMEDIATE_TASK=n.DEFAULT+":taskSwitchEvent",n.INTERMEDIATE_WAIT=n.DEFAULT+":waitEvent",n.INTERMEDIATE_THIRD_PARTY=n.DEFAULT+":thirdPartyWaitEvent"})(nr||(nr={}));var Sa;(function(n){n.DEFAULT="event:boundary",n.BOUNDARY_ERROR=n.DEFAULT+":errorBoundaryEvent",n.BOUNDARY_SIGNAL=n.DEFAULT+":signalBoundaryEvent"})(Sa||(Sa={}));var So;(function(n){n.DEFAULT="gateway",n.TASK=n.DEFAULT+":taskSwitchGateway",n.JOIN=n.DEFAULT+":join",n.SPLIT=n.DEFAULT+":split",n.ALTERNATIVE=n.DEFAULT+":alternative"})(So||(So={}));var ye;(function(n){n.DEFAULT="activity",n.GENERIC=n.DEFAULT+":genericActivity",n.COMMENT=n.DEFAULT+":processAnnotation",n.SCRIPT=n.DEFAULT+":script",n.HD=n.DEFAULT+":dialogCall",n.USER=n.DEFAULT+":userTask",n.SOAP=n.DEFAULT+":webServiceCall",n.REST=n.DEFAULT+":restClientCall",n.DB=n.DEFAULT+":database",n.EMAIL=n.DEFAULT+":eMail",n.SUB_PROCESS=n.DEFAULT+":subProcessCall",n.EMBEDDED_PROCESS=n.DEFAULT+":embeddedProcessElement",n.TRIGGER=n.DEFAULT+":triggerCall",n.PROGRAM=n.DEFAULT+":programInterface",n.BPMN_GENERIC=n.DEFAULT+":genericBpmnElement",n.BPMN_USER=n.DEFAULT+":userBpmnElement",n.BPMN_MANUAL=n.DEFAULT+":manualBpmnElement",n.BPMN_SCRIPT=n.DEFAULT+":scriptBpmnElement",n.BPMN_RECEIVE=n.DEFAULT+":receiveBpmnElement",n.BPMN_RULE=n.DEFAULT+":ruleBpmnElement",n.BPMN_SEND=n.DEFAULT+":sendBpmnElement",n.BPMN_SERVICE=n.DEFAULT+":serviceBpmnElement",n.THIRD_PARTY=n.DEFAULT+":thirdPartyProgramInterface",n.THIRD_PARTY_RULE=n.THIRD_PARTY+":RuleActivity",n.LABEL=n.DEFAULT+"-label"})(ye||(ye={}));var ra;(function(n){n.DEFAULT="lanes",n.LANE=n.DEFAULT+":lane",n.POOL=n.DEFAULT+":pool",n.LABEL=n.DEFAULT+":label"})(ra||(ra={}));var Bp;(function(n){n.DEFAULT="edge",n.ASSOCIATION=n.DEFAULT+":association",n.LABEL=n.DEFAULT+":label"})(Bp||(Bp={}));var n0;(function(n){n.DEFAULT="label"})(n0||(n0={}));const bp=class bp extends m.RectangularNode{constructor(){super(...arguments);k(this,"args")}get resizeLocations(){return[m.ResizeHandleLocation.Top,m.ResizeHandleLocation.Bottom]}get editableLabel(){return lS(this,ra.LABEL)}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}isFirstChild(){return this.parent instanceof bp?this.parent.embeddedLanes().indexOf(this)===0:!1}isLastChild(){if(this.parent instanceof bp){const t=this.parent.embeddedLanes();return t.indexOf(this)===t.length-1}return!1}embeddedLanes(){return this.children.filter(t=>t instanceof bp).map(t=>t)}canConnect(t,i){return!1}};k(bp,"DEFAULT_FEATURES",[m.boundsFeature,m.layoutContainerFeature,m.fadeFeature,m.nameFeature,m.withEditLabelFeature,m.selectFeature,x1,m.deletableFeature,m.resizeFeature]);let Ea=bp;class Fm extends m.RectangularNode{constructor(){super(...arguments);k(this,"name","");k(this,"duration");k(this,"taskType");k(this,"reference");k(this,"executionCount");k(this,"args")}get editableLabel(){return lS(this,ye.LABEL)}get customIcon(){var t;return((t=this.args)==null?void 0:t.customIconUri)??this.type}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}get labelBounds(){return{x:-this.bounds.width/2+3,y:0,width:this.bounds.width-6,height:this.bounds.height}}}k(Fm,"DEFAULT_FEATURES",[m.connectableFeature,m.deletableFeature,m.selectFeature,m.boundsFeature,m.resizeFeature,x1,vM,m.moveFeature,m.layoutContainerFeature,m.fadeFeature,m.hoverFeedbackFeature,m.popupFeature,m.nameFeature,m.withEditLabelFeature,m.openFeature,dS,u4,uS,yM,M_]);class KAe extends Fm{get labelBounds(){return{...super.labelBounds,y:0,height:this.bounds.height}}}class $p extends m.CircularNode{constructor(){super(...arguments);k(this,"args");k(this,"executionCount")}get customIcon(){var t;return((t=this.args)==null?void 0:t.customIconUri)??this.type}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}get editableLabel(){return lS(this,n0.DEFAULT)}}k($p,"DEFAULT_FEATURES",[m.connectableFeature,m.deletableFeature,m.selectFeature,m.boundsFeature,vM,m.moveFeature,m.layoutContainerFeature,m.fadeFeature,m.hoverFeedbackFeature,m.popupFeature,m.openFeature,dS,x1,m.withEditLabelFeature,uS,yM]);class VAe extends $p{canConnect(e,t){return super.canConnect(e,t)&&t==="target"}}class I_ extends $p{canConnect(e,t){return super.canConnect(e,t)&&(t==="source"||this.typeOf(e.sourceId)===ye.COMMENT)}typeOf(e){var t;if(e)return(t=this.index.getById(e))==null?void 0:t.type}}class qZ extends m.DiamondNode{constructor(){super(...arguments);k(this,"args");k(this,"executionCount");k(this,"size",{width:32,height:32})}get customIcon(){var t;return((t=this.args)==null?void 0:t.customIconUri)??this.type}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}get editableLabel(){return lS(this,n0.DEFAULT)}}k(qZ,"DEFAULT_FEATURES",[m.connectableFeature,m.deletableFeature,m.selectFeature,m.boundsFeature,vM,m.moveFeature,m.layoutContainerFeature,m.fadeFeature,m.hoverFeedbackFeature,m.popupFeature,m.openFeature,dS,x1,m.withEditLabelFeature,uS,yM,Lw]);class xm extends m.GEdge{constructor(){super(...arguments);k(this,"executionCount")}get color(){var t;return(t=this.args)==null?void 0:t.color}get bounds(){return this.routingPoints.reduce((t,i)=>m.Bounds.combine(t,{x:i.x,y:i.y,width:0,height:0}),this.centerBounds())}centerBounds(){var o,r;const t=m.Bounds.center(((o=this.source)==null?void 0:o.bounds)||m.Bounds.EMPTY),i=m.Bounds.center(((r=this.target)==null?void 0:r.bounds)||m.Bounds.EMPTY);return m.Bounds.translate(m.Bounds.EMPTY,m.centerOfLine(t,i))}get editableLabel(){return lS(this,Bp.LABEL)}}k(xm,"DEFAULT_FEATURES",[m.editFeature,m.reconnectFeature,m.deletableFeature,m.selectFeature,m.fadeFeature,m.hoverFeedbackFeature,m.popupFeature,m.withEditLabelFeature,uS,x1]);class Ku extends m.GLabel{constructor(){super(...arguments);k(this,"isMultiLine",!0)}get editControlDimension(){return{width:Math.max(this.bounds.width+25,144),height:Math.max(this.bounds.height,44)}}get editControlPositionCorrection(){return{x:-2,y:-3}}get labelBounds(){const t=this.font(),i=this.text.split(`
`),o=Math.max(...i.map(s=>this.textWidth(s,t))),r=14*i.length;return{x:-o/2,y:0,width:o,height:r}}textWidth(t,i){const o=document.createElement("canvas");if("getContext"in o){const r=o.getContext("2d");if(r)return r.font=i,r.measureText(t).width}return this.bounds.width}font(t=document.body){const i=this.cssStyle(t,"font-weight"),o="14px",r=this.cssStyle(t,"font-family");return`${i} ${o} ${r}`}cssStyle(t,i){return window.getComputedStyle(t,void 0).getPropertyValue(i)}}k(Ku,"DEFAULT_FEATURES",[m.fadeFeature,m.editLabelFeature]);class l4 extends Ku{get labelBounds(){return{...super.labelBounds,y:-super.labelBounds.height/2}}}class WZ extends Ku{get editControlDimension(){return{width:Math.min(this.bounds.height+25,144),height:Math.max(this.bounds.width,44)}}}class zAe extends Ku{constructor(){super(...arguments);k(this,"isMultiLine",!0)}get editControlDimension(){return m.isBoundsAware(this.parent)?{width:this.parent.bounds.width,height:this.parent.bounds.height}:{width:this.bounds.width,height:this.bounds.height}}get editControlPositionCorrection(){return m.Point.ORIGIN}get labelBounds(){return this.parent instanceof Fm?this.parent.labelBounds:{x:-this.bounds.width/2,y:18,width:this.bounds.width,height:this.bounds.height-18}}}function lS(n,e){const t=n.children.find(i=>i.type===e);if(t&&m.isEditableLabel(t))return t}var GAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},N3,Al;let EL=(Al=class extends m.DecorationPlacer{getPosition(e){if(e instanceof m.GChildElement&&m.isSizeable(e.parent)){const t=-N3.DECORATOR_RADIUS*2,i=e.parent.bounds.height-N3.DECORATOR_RADIUS*2;return e.parent instanceof Fm?{x:t-6,y:i-4}:{x:t-4,y:i}}return m.Point.ORIGIN}},N3=Al,k(Al,"DECORATOR_RADIUS",6),Al);EL=N3=GAe([le()],EL);const UAe=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.bindAsService(i,m.TYPES.IVNodePostprocessor,EL)},{featureId:m.decorationModule.featureId}),fp=Symbol("jumpFeature");function YAe(n){return n.hasFeature(fp)}const hp=Symbol("goToSourceFeature");function qAe(n){return n.hasFeature(hp)}function ZZ(n){return m.isBoundsAware(n)&&m.isSelectable(n)&&n instanceof Ea}var WAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let CL=class{constructor(){k(this,"cssClasses",["movement-not-allowed"])}validate(e,t){if(ZZ(e)||!t)return!0;if(!m.isBoundsAwareMoveable(e))return!1;const i=this.parentLocation(e,m.Point.ORIGIN);return i.x+t.x>=0&&i.y+t.y>=0}parentLocation(e,t){if(e instanceof m.GChildElement){const i=e.parent;if(m.isBoundsAware(i))return this.parentLocation(i,{x:t.x+i.bounds.x,y:t.y+i.bounds.y})}return t}};CL=WAe([le()],CL);var QZ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ZAe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};const Ww=class Ww extends m.GChildElement{constructor(t=m.Bounds.EMPTY,i=m.Bounds.EMPTY,o=Ww.TYPE){super();k(this,"canvasBounds");k(this,"modelBounds");k(this,"type");this.canvasBounds=t,this.modelBounds=i,this.type=o}};k(Ww,"TYPE","negative-marker");let Hm=Ww;function QAe(n){PL(n);const e=n.root.canvasBounds;if(m.isViewport(n.root)){const t=m.getModelBounds(n.root);return n.root.add(new Hm(e,t)),m.Disposable.create(()=>PL(n))}return m.Disposable.empty()}function PL(n){n.root.removeAll(e=>e instanceof Hm)}var i0;(function(n){n.KIND="showNegativeArea";function e(t){return{kind:n.KIND,visible:t.visible}}n.create=e})(i0||(i0={}));var MT;let jw=(MT=class extends m.FeedbackCommand{constructor(){super(...arguments);k(this,"action")}execute(t){return this.action.visible?QAe(t.root):PL(t.root),t.root}},k(MT,"KIND",i0.KIND),MT);QZ([_e(m.TYPES.Action),ZAe("design:type",Object)],jw.prototype,"action",void 0);jw=QZ([le()],jw);var XAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};const AT={createElement:m.svg};let wL=class{render(e,t){return AT.createElement("g",null,AT.createElement("rect",{x:e.modelBounds.x,y:e.modelBounds.y,width:e.modelBounds.width,height:-e.modelBounds.y,"class-negative-area":!0}),AT.createElement("rect",{x:e.modelBounds.x,y:0,width:-e.modelBounds.x,height:e.modelBounds.height,"class-negative-area":!0}))}};wL=XAe([le()],wL);const XE={createElement:m.svg};function f4(n,e){return n.executionCount?XE.createElement("g",null,XE.createElement("rect",{"class-execution-badge":!0,rx:"7",ry:"7",x:e-11,y:-7,width:22,height:14}),XE.createElement("text",{"class-execution-text":!0,x:e,dy:".4em"},n.executionCount)):XE.createElement("g",null)}var JAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let $r=class{constructor(){k(this,"showCustomIcons",!0)}handle(e){if(Jy.is(e))return this.showCustomIcons=e.showCustomIcons,sL.create()}get isShowCustomIcons(){return this.showCustomIcons}set setShowCustomIcons(e){this.showCustomIcons=e}};$r=JAe([le()],$r);var ic;(function(n){n[n.SI=0]="SI",n[n.IMG=1]="IMG",n[n.NO=2]="NO"})(ic||(ic={}));const eRe={res:"",style:ic.NO};var $e;(function(n){n.SIGNAL_EVENT="M10.5 3.5C10.3328 3.5 10.1767 3.58355 10.084 3.72265L2.08398 15.7227C1.98169 15.8761 1.97215 16.0734 2.05916 16.2359C2.14617 16.3985 2.3156 16.5 2.5 16.5L18.5 16.5C18.6844 16.5 18.8538 16.3985 18.9408 16.2359C19.0278 16.0733 19.0183 15.8761 18.916 15.7226L10.916 3.72265C10.8233 3.58355 10.6672 3.5 10.5 3.5ZM17.5657 15.5L3.43426 15.5L10.5 4.90139L17.5657 15.5Z",n.PROGRAM="M11.1712 3.2767C11.4432 3.32408 11.6254 3.58304 11.578 3.85508L9.40725 16.3165C9.35986 16.5886 9.1009 16.7707 8.82886 16.7233C8.55681 16.6759 8.37469 16.417 8.42208 16.1449L10.5928 3.68347C10.6402 3.41143 10.8991 3.22931 11.1712 3.2767ZM5.88773 5.62629C6.09413 5.80975 6.11272 6.12579 5.92926 6.33218L2.66898 9.99999L5.92926 13.6678C6.11272 13.8742 6.09413 14.1902 5.88773 14.3737C5.68134 14.5572 5.36531 14.5386 5.18185 14.3322L1.6263 10.3322C1.4579 10.1427 1.4579 9.85725 1.6263 9.66781L5.18185 5.66781C5.36531 5.46142 5.68134 5.44283 5.88773 5.62629ZM14.1122 5.62629C14.3186 5.44283 14.6347 5.46142 14.8181 5.66781L18.3737 9.66781C18.5421 9.85725 18.5421 10.1427 18.3737 10.3322L14.8181 14.3322C14.6347 14.5386 14.3186 14.5572 14.1122 14.3737C13.9058 14.1902 13.8873 13.8742 14.0707 13.6678L17.331 9.99999L14.0707 6.33218C13.8873 6.12579 13.9058 5.80975 14.1122 5.62629Z",n.ERROR_EVENT="M11.1799 1.5119C11.4087 1.56273 11.5714 1.76564 11.5714 1.99999V7.72221H14.5C14.671 7.72221 14.8301 7.80955 14.9218 7.95377C15.0136 8.098 15.0253 8.27911 14.9529 8.43398L10.3815 18.2118C10.2823 18.424 10.0489 18.5389 9.82011 18.4881C9.59134 18.4372 9.42857 18.2343 9.42857 18V12.2778H6.5C6.32905 12.2778 6.16995 12.1904 6.07817 12.0462C5.98639 11.902 5.97466 11.7209 6.04706 11.566L10.6185 1.78822C10.7177 1.57593 10.9511 1.46106 11.1799 1.5119ZM7.28572 11.2778H9.92857C10.2047 11.2778 10.4286 11.5016 10.4286 11.7778V15.75L13.7143 8.72221H11.0714C10.7953 8.72221 10.5714 8.49835 10.5714 8.22221V4.24999L7.28572 11.2778Z",n.SUB_START="M3.85303 2C3.85303 1.72386 4.07688 1.5 4.35303 1.5H9.00009C9.82851 1.5 10.5001 2.17157 10.5001 3V16.7929L15.2936 11.9994C15.4889 11.8041 15.8054 11.8041 16.0007 11.9994C16.196 12.1947 16.196 12.5112 16.0007 12.7065L10.3536 18.3536C10.2599 18.4473 10.1327 18.5 10.0001 18.5C9.86748 18.5 9.7403 18.4473 9.64653 18.3536L3.99947 12.7065C3.80421 12.5112 3.80421 12.1946 3.99947 11.9994C4.19474 11.8041 4.51132 11.8041 4.70658 11.9994L9.50009 16.7929V3C9.50009 2.72386 9.27623 2.5 9.00009 2.5H4.35303C4.07688 2.5 3.85303 2.27614 3.85303 2Z",n.WS_EVENT="M10.58 1.52C10.51 1.5 10.43 1.49 10.35 1.51C10.23 1.51 10.11 1.51 9.99 1.51C9.87 1.51 9.75 1.51 9.63 1.51C9.55 1.5 9.48 1.51 9.4 1.52C4.99 1.82 1.5 5.5 1.5 10C1.5 14.5 4.99 18.18 9.42 18.48C9.49 18.5 9.57 18.51 9.65 18.49C9.77 18.49 9.89 18.49 10.01 18.49C10.13 18.49 10.25 18.49 10.37 18.49C10.45 18.5 10.52 18.49 10.6 18.48C15.02 18.18 18.52 14.5 18.52 10C18.52 5.5 15.01 1.82 10.58 1.52ZM16.8 6.83H12.91C12.61 5.37 12.09 3.95 11.38 2.62C13.79 3.07 15.79 4.67 16.8 6.83ZM12.24 10C12.24 10.73 12.19 11.45 12.08 12.17H7.93C7.82 11.46 7.77 10.73 7.77 10C7.77 9.27 7.82 8.55 7.93 7.83H12.08C12.19 8.54 12.24 9.27 12.24 10ZM9.83 2.5C9.88 2.5 9.94 2.5 10 2.5C10.06 2.5 10.11 2.5 10.17 2.5C10.98 3.85 11.56 5.31 11.89 6.83H8.11C8.45 5.31 9.03 3.85 9.83 2.5ZM8.61 2.63C7.9 3.95 7.39 5.37 7.08 6.84H3.2C4.21 4.68 6.21 3.08 8.61 2.63ZM2.5 10C2.5 9.25 2.61 8.52 2.82 7.83H6.92C6.82 8.55 6.77 9.27 6.77 10C6.77 10.73 6.82 11.45 6.92 12.17H2.82C2.61 11.48 2.5 10.76 2.5 10ZM3.2 13.17H7.09C7.39 14.63 7.91 16.05 8.62 17.38C6.21 16.93 4.21 15.33 3.2 13.17ZM10.17 17.5C10.12 17.5 10.06 17.5 10 17.5C9.94 17.5 9.89 17.5 9.83 17.5C9.02 16.15 8.44 14.69 8.11 13.17H11.89C11.55 14.69 10.97 16.15 10.17 17.5ZM11.39 17.37C12.1 16.05 12.61 14.63 12.92 13.16H16.81C15.8 15.32 13.8 16.92 11.39 17.37ZM13.09 12.16C13.19 11.44 13.24 10.72 13.24 9.99C13.24 9.26 13.19 8.54 13.09 7.82H17.19C17.4 8.51 17.51 9.23 17.51 9.99C17.51 10.75 17.4 11.47 17.19 12.16H13.09Z",n.INIT_START="M12.3132 4.31313C12.5085 4.11787 12.825 4.11787 13.0203 4.31313L18.3536 9.64647C18.4474 9.74024 18.5001 9.86741 18.5001 10C18.5001 10.1326 18.4474 10.2598 18.3536 10.3536L13.0203 15.6869C12.825 15.8822 12.5085 15.8822 12.3132 15.6869C12.1179 15.4916 12.1179 15.1751 12.3132 14.9798L16.793 10.5L2 10.5C1.72386 10.5 1.5 10.2761 1.5 9.99998C1.5 9.72384 1.72386 9.49998 2 9.49998L16.793 9.50002L12.3132 5.02024C12.1179 4.82498 12.1179 4.5084 12.3132 4.31313Z",n.METHOD_START="M1.50004 3C1.50004 2.17157 2.17161 1.5 3.00004 1.5H17C17.8285 1.5 18.5 2.17157 18.5 3V17C18.5 17.8284 17.8285 18.5 17 18.5H3.00004C2.17161 18.5 1.50004 17.8284 1.50004 17V14C1.50004 13.7239 1.7239 13.5 2.00004 13.5C2.27618 13.5 2.50004 13.7239 2.50004 14V17C2.50004 17.2761 2.7239 17.5 3.00004 17.5H17C17.2762 17.5 17.5 17.2761 17.5 17V3C17.5 2.72386 17.2762 2.5 17 2.5H3.00004C2.7239 2.5 2.50004 2.72386 2.50004 3V6C2.50004 6.27614 2.27618 6.5 2.00004 6.5C1.7239 6.5 1.50004 6.27614 1.50004 6V3ZM8.75769 6.09112C8.95296 5.89586 9.26954 5.89586 9.4648 6.09112L13.0204 9.64668C13.2156 9.84194 13.2156 10.1585 13.0204 10.3538L9.4648 13.9093C9.26954 14.1046 8.95296 14.1046 8.75769 13.9093C8.56243 13.7141 8.56243 13.3975 8.75769 13.2022L11.4597 10.5002L2 10.5002C1.72386 10.5002 1.5 10.2764 1.5 10.0002C1.5 9.72407 1.72386 9.50021 2 9.50021L11.4597 9.50023L8.75769 6.79823C8.56243 6.60297 8.56243 6.28638 8.75769 6.09112Z",n.EVENT_START="M17.61 1.5H3.39C2.62 1.5 2 2.12 2 2.89V11.78C2 12.55 2.62 13.17 3.39 13.17H7.33V17.5H6.05C5.77 17.5 5.55 17.72 5.55 18C5.55 18.28 5.77 18.5 6.05 18.5H14.94C15.22 18.5 15.44 18.28 15.44 18C15.44 17.72 15.22 17.5 14.94 17.5H13.66V13.17H17.6C18.37 13.17 18.99 12.55 18.99 11.78V2.89C18.99 2.12 18.37 1.5 17.6 1.5H17.61ZM12.67 17.5H8.33V13.17H12.66V17.5H12.67ZM18 11.78C18 11.99 17.83 12.17 17.61 12.17H3.39C3.18 12.17 3 12 3 11.78V2.89C3 2.68 3.17 2.5 3.39 2.5H17.61C17.82 2.5 18 2.67 18 2.89V11.78Z",n.TASK="M1.5 4C1.5 3.72386 1.72386 3.5 2 3.5H18C18.2761 3.5 18.5 3.72386 18.5 4C18.5 4.27614 18.2761 4.5 18 4.5H2C1.72386 4.5 1.5 4.27614 1.5 4Z M1.5 10C1.5 9.72386 1.72386 9.5 2 9.5H18C18.2761 9.5 18.5 9.72386 18.5 10C18.5 10.2761 18.2761 10.5 18 10.5H2C1.72386 10.5 1.5 10.2761 1.5 10Z M1.5 16C1.5 15.7239 1.72386 15.5 2 15.5H18C18.2761 15.5 18.5 15.7239 18.5 16C18.5 16.2761 18.2761 16.5 18 16.5H2C1.72386 16.5 1.5 16.2761 1.5 16Z",n.WAIT="M10 2.5C5.85786 2.5 2.5 5.85786 2.5 10C2.5 14.1421 5.85786 17.5 10 17.5C14.1421 17.5 17.5 14.1421 17.5 10C17.5 5.85786 14.1421 2.5 10 2.5ZM1.5 10C1.5 5.30558 5.30558 1.5 10 1.5C14.6944 1.5 18.5 5.30558 18.5 10C18.5 14.6944 14.6944 18.5 10 18.5C5.30558 18.5 1.5 14.6944 1.5 10ZM10 6.64282C10.2761 6.64282 10.5 6.86668 10.5 7.14282V9.79286L12.3536 11.6465C12.5488 11.8417 12.5488 12.1583 12.3535 12.3536C12.1583 12.5488 11.8417 12.5488 11.6464 12.3535L9.64644 10.3535C9.55268 10.2597 9.5 10.1326 9.5 9.99996V7.14282C9.5 6.86668 9.72386 6.64282 10 6.64282Z",n.END_PAGE="M17 1.25H3C2.03 1.25 1.25 2.03 1.25 3V17C1.25 17.97 2.03 18.75 3 18.75H17C17.97 18.75 18.75 17.97 18.75 17V3C18.75 2.03 17.97 1.25 17 1.25ZM2.75 3C2.75 2.86 2.86 2.75 3 2.75H6.58V6.58H2.75V3ZM17.25 17C17.25 17.14 17.14 17.25 17 17.25H3C2.86 17.25 2.75 17.14 2.75 17V8.08H17.25V17ZM17.25 6.58H8.08V2.75H17C17.14 2.75 17.25 2.86 17.25 3V6.58Z",n.SUB_END="M10.5001 1.5C10.6327 1.5 10.7599 1.55268 10.8536 1.64645L16.5007 7.29351C16.696 7.48877 16.696 7.80535 16.5007 8.00061C16.3054 8.19588 15.9889 8.19588 15.7936 8.00061L11.0001 3.20711L11.0001 17C11.0001 17.2761 11.2239 17.5 11.5001 17.5H16.1471C16.4233 17.5 16.6471 17.7239 16.6471 18C16.6471 18.2761 16.4233 18.5 16.1471 18.5H11.5001C10.6717 18.5 10.0001 17.8284 10.0001 17L10.0001 3.20711L5.20658 8.00061C5.01132 8.19587 4.69474 8.19587 4.49947 8.00061C4.30421 7.80535 4.30421 7.48877 4.49947 7.29351L10.1465 1.64645C10.2403 1.55268 10.3675 1.5 10.5001 1.5Z",n.EXIT_END="M3.5 2.5C3.22386 2.5 3 2.72386 3 3L3 17C3 17.2761 3.22386 17.5 3.5 17.5L17.5 17.5C17.7761 17.5 18 17.2761 18 17V12.6667C18 12.3905 18.2239 12.1667 18.5 12.1667C18.7761 12.1667 19 12.3905 19 12.6667V17C19 17.8284 18.3284 18.5 17.5 18.5L3.5 18.5C2.67157 18.5 2 17.8284 2 17L2 3C2 2.17157 2.67158 1.5 3.5 1.5L7.83334 1.5C8.10948 1.5 8.33334 1.72386 8.33334 2C8.33334 2.27614 8.10948 2.5 7.83334 2.5L3.5 2.5ZM12.6667 2C12.6667 1.72386 12.8906 1.5 13.1667 1.5H18.4999C18.7761 1.5 18.9999 1.72385 18.9999 1.99999L19.0001 7.33332C19.0001 7.60946 18.7762 7.83332 18.5001 7.83333C18.224 7.83334 18.0001 7.60949 18.0001 7.33335L18 3.20707L8.18681 13.0202C7.99155 13.2155 7.67496 13.2155 7.4797 13.0202C7.28444 12.825 7.28444 12.5084 7.4797 12.3131L17.2928 2.5H13.1667C12.8906 2.5 12.6667 2.27614 12.6667 2Z",n.ALTERNATIVE="M1.64645 1.64645C1.84171 1.45118 2.15829 1.45118 2.35355 1.64645L10 9.29289L17.6464 1.64646C17.8417 1.4512 18.1583 1.4512 18.3535 1.64646C18.5488 1.84173 18.5488 2.15831 18.3535 2.35357L10.7071 10L18.3535 17.6464C18.5488 17.8417 18.5488 18.1583 18.3535 18.3535C18.1583 18.5488 17.8417 18.5488 17.6464 18.3535L10 10.7071L2.35355 18.3536C2.15829 18.5488 1.84171 18.5488 1.64645 18.3536C1.45118 18.1583 1.45118 17.8417 1.64645 17.6464L9.29289 10L1.64645 2.35355C1.45118 2.15829 1.45118 1.84171 1.64645 1.64645Z",n.SPLIT="M10.0001 1.5C10.2762 1.5 10.5001 1.72386 10.5001 2V9.49999H18C18.2761 9.49999 18.5 9.72385 18.5 9.99999C18.5 10.2761 18.2761 10.5 18 10.5H10.5001V18C10.5001 18.2761 10.2762 18.5 10.0001 18.5C9.72395 18.5 9.5001 18.2761 9.5001 18V10.5H2C1.72386 10.5 1.5 10.2761 1.5 9.99999C1.5 9.72385 1.72386 9.49999 2 9.49999H9.5001V2C9.5001 1.72386 9.72395 1.5 10.0001 1.5Z",n.JOIN="M9.9998 1.5C10.2759 1.5 10.4998 1.72386 10.4998 2V9.49999H18C18.2761 9.49999 18.5 9.72385 18.5 9.99999C18.5 10.2761 18.2761 10.5 18 10.5H10.4998V18C10.4998 18.2761 10.2759 18.5 9.9998 18.5C9.72366 18.5 9.4998 18.2761 9.4998 18V10.5H2C1.72386 10.5 1.5 10.2761 1.5 9.99999C1.5 9.72385 1.72386 9.49999 2 9.49999H9.4998V2C9.4998 1.72386 9.72366 1.5 9.9998 1.5Z",n.TASKS="M10 2.5C5.85786 2.5 2.5 5.85786 2.5 10C2.5 14.1421 5.85786 17.5 10 17.5C14.1421 17.5 17.5 14.1421 17.5 10C17.5 5.85786 14.1421 2.5 10 2.5ZM1.5 10C1.5 5.30558 5.30558 1.5 10 1.5C14.6944 1.5 18.5 5.30558 18.5 10C18.5 14.6944 14.6944 18.5 10 18.5C5.30558 18.5 1.5 14.6944 1.5 10ZM9.99976 6.9857C10.2759 6.9857 10.4998 7.20956 10.4998 7.4857V9.5H12.5143C12.7904 9.5 13.0143 9.72386 13.0143 10C13.0143 10.2761 12.7904 10.5 12.5143 10.5H10.4998V12.5144C10.4998 12.7905 10.2759 13.0144 9.99976 13.0144C9.72361 13.0144 9.49976 12.7905 9.49976 12.5144V10.5H7.4856C7.20945 10.5 6.9856 10.2761 6.9856 10C6.9856 9.72386 7.20945 9.5 7.4856 9.5H9.49976V7.4857C9.49976 7.20956 9.72361 6.9857 9.99976 6.9857Z",n.USER_TASK="M1.5 5.90298C1.5 5.62684 1.72386 5.40298 2 5.40298H10.3056C10.5817 5.40298 10.8056 5.62684 10.8056 5.90298C10.8056 6.17913 10.5817 6.40298 10.3056 6.40298H2C1.72386 6.40298 1.5 6.17913 1.5 5.90298ZM15.4787 6.40298C14.9595 6.40298 14.5387 6.82384 14.5387 7.34298C14.5387 7.86213 14.9595 8.28298 15.4787 8.28298C15.9978 8.28298 16.4187 7.86213 16.4187 7.34298C16.4187 6.82384 15.9978 6.40298 15.4787 6.40298ZM13.5387 7.34298C13.5387 6.27155 14.4072 5.40298 15.4787 5.40298C16.5501 5.40298 17.4187 6.27155 17.4187 7.34298C17.4187 8.41442 16.5501 9.28298 15.4787 9.28298C14.4072 9.28298 13.5387 8.41442 13.5387 7.34298ZM1.5 9.99993C1.5 9.72379 1.72386 9.49993 2 9.49993H10.3056C10.5817 9.49993 10.8056 9.72379 10.8056 9.99993C10.8056 10.2761 10.5817 10.4999 10.3056 10.4999H2C1.72386 10.4999 1.5 10.2761 1.5 9.99993ZM14.6383 12.0756C14.3252 12.0756 14.0248 12.2 13.8034 12.4215C13.5819 12.6429 13.4575 12.9432 13.4575 13.2564V14.0968C13.4575 14.373 13.2337 14.5968 12.9575 14.5968C12.6814 14.5968 12.4575 14.373 12.4575 14.0968V13.2564C12.4575 12.678 12.6873 12.1233 13.0963 11.7144C13.5052 11.3054 14.0599 11.0756 14.6383 11.0756H16.3191C16.8975 11.0756 17.4522 11.3054 17.8612 11.7144C18.2702 12.1233 18.4999 12.678 18.4999 13.2564V14.0968C18.4999 14.373 18.2761 14.5968 17.9999 14.5968C17.7238 14.5968 17.4999 14.373 17.4999 14.0968V13.2564C17.4999 12.9432 17.3755 12.6429 17.1541 12.4215C16.9326 12.2 16.6323 12.0756 16.3191 12.0756H14.6383ZM1.5 14.097C1.5 13.8209 1.72386 13.597 2 13.597H8.03415C8.31029 13.597 8.53415 13.8209 8.53415 14.097C8.53415 14.3731 8.31029 14.597 8.03415 14.597H2C1.72386 14.597 1.5 14.3731 1.5 14.097Z",n.USER_DIALOG="M10 11.23C10.94 11.23 11.7 10.47 11.7 9.53C11.7 8.59 10.94 7.83 10 7.83C9.06 7.83 8.3 8.59 8.3 9.53C8.3 10.47 9.06 11.23 10 11.23ZM10 8.83C10.39 8.83 10.7 9.14 10.7 9.53C10.7 9.92 10.39 10.23 10 10.23C9.61 10.23 9.3 9.92 9.3 9.53C9.3 9.14 9.61 8.83 10 8.83Z M16.86 1.5H3.14C2.2 1.5 1.5 2.31 1.5 3.23V5.66C1.5 5.66 1.5 5.68 1.5 5.69C1.5 5.7 1.5 5.71 1.5 5.72V16.77C1.5 17.69 2.2 18.5 3.14 18.5H16.86C17.8 18.5 18.5 17.69 18.5 16.77V3.23C18.5 2.31 17.8 1.5 16.86 1.5ZM17.5 16.77C17.5 17.21 17.18 17.5 16.86 17.5H3.14C2.82 17.5 2.5 17.21 2.5 16.77V6.19H17.5V16.77ZM17.5 5.19H2.5V3.23C2.5 2.79 2.82 2.5 3.14 2.5H16.86C17.18 2.5 17.5 2.79 17.5 3.23V5.19Z M7.9 15.66C8.18 15.66 8.4 15.44 8.4 15.16V14.46C8.4 14.22 8.49 13.99 8.66 13.82C8.83 13.65 9.06 13.56 9.3 13.56H10.7C10.94 13.56 11.17 13.65 11.34 13.82C11.51 13.99 11.6 14.22 11.6 14.46V15.16C11.6 15.44 11.82 15.66 12.1 15.66C12.38 15.66 12.6 15.44 12.6 15.16V14.46C12.6 13.96 12.4 13.47 12.04 13.12C11.68 12.76 11.2 12.56 10.7 12.56H9.3C8.8 12.56 8.31 12.76 7.96 13.12C7.6 13.48 7.4 13.96 7.4 14.46V15.16C7.4 15.44 7.62 15.66 7.9 15.66Z",n.SCRIPT="M8.45003 10.44C8.20003 10.32 7.90003 10.42 7.78003 10.66L6.89003 12.44C6.82003 12.58 6.82003 12.75 6.89003 12.89L7.78003 14.67C7.90003 14.92 8.20003 15.02 8.45003 14.89C8.70003 14.76 8.80003 14.47 8.67003 14.22L7.89003 12.67L8.67003 11.12C8.79003 10.87 8.69003 10.57 8.45003 10.45V10.44Z M11.56 10.44C11.31 10.56 11.21 10.86 11.34 11.11L12.12 12.66L11.34 14.21C11.22 14.46 11.32 14.76 11.56 14.88C11.8 15 12.11 14.9 12.23 14.66L13.12 12.88C13.19 12.74 13.19 12.57 13.12 12.43L12.23 10.65C12.11 10.4 11.81 10.3 11.56 10.43V10.44Z M16.58 6.09L12.13 1.65C12.04 1.56 11.91 1.5 11.78 1.5H5.56003C4.95003 1.5 4.37003 1.74 3.95003 2.17C3.52003 2.6 3.28003 3.18 3.28003 3.78V16.22C3.28003 16.82 3.52003 17.4 3.95003 17.83C4.38003 18.26 4.96003 18.5 5.56003 18.5H14.45C15.05 18.5 15.63 18.26 16.06 17.83C16.49 17.4 16.73 16.82 16.73 16.22V6.44C16.73 6.31 16.68 6.18 16.58 6.09ZM12.28 3.21L15.02 5.95H12.67C12.57 5.95 12.47 5.91 12.4 5.84C12.33 5.77 12.29 5.67 12.29 5.56V3.21H12.28ZM15.72 16.23C15.72 16.57 15.59 16.89 15.35 17.13C15.11 17.37 14.79 17.5 14.45 17.5H5.56003C5.22003 17.5 4.90003 17.37 4.66003 17.13C4.42003 16.89 4.29003 16.57 4.29003 16.23V3.78C4.29003 3.44 4.42003 3.12 4.66003 2.88C4.90003 2.64 5.22003 2.51 5.56003 2.51H11.28V5.57C11.28 5.94 11.43 6.29 11.69 6.55C11.95 6.81 12.3 6.96 12.67 6.96H15.73V16.22L15.72 16.23Z",n.TRIGGER="M18.46 9.81C18.43 9.75 18.4 9.69 18.35 9.65L14.22 5.52C14.02 5.32 13.71 5.32 13.51 5.52C13.31 5.72 13.31 6.03 13.51 6.23L16.79 9.50999H7.68C7.4 9.50999 7.18 9.72999 7.18 10.01C7.18 10.29 7.4 10.51 7.68 10.51H16.79L13.51 13.79C13.31 13.99 13.31 14.3 13.51 14.5C13.71 14.7 14.02 14.7 14.22 14.5L18.35 10.37C18.35 10.37 18.43 10.27 18.46 10.21C18.51 10.09 18.51 9.95 18.46 9.83V9.81Z M2.77 8.72C2.07 8.72 1.5 9.29 1.5 9.99C1.5 10.69 2.07 11.26 2.77 11.26C3.47 11.26 4.04 10.69 4.04 9.99C4.04 9.29 3.47 8.72 2.77 8.72Z",n.DATABASE="M2.93817 4.02139C2.59033 4.29551 2.5 4.51734 2.5 4.66667C2.5 4.81599 2.59033 5.03782 2.93817 5.31195C3.28037 5.58163 3.80652 5.84636 4.50126 6.07794C5.88551 6.53936 7.82965 6.83333 10 6.83333C12.1704 6.83333 14.1145 6.53936 15.4987 6.07794C16.1935 5.84636 16.7196 5.58163 17.0618 5.31195C17.4097 5.03782 17.5 4.81599 17.5 4.66667C17.5 4.51734 17.4097 4.29551 17.0618 4.02139C16.7196 3.7517 16.1935 3.48697 15.4987 3.25539C14.1145 2.79397 12.1704 2.5 10 2.5C7.82965 2.5 5.88551 2.79397 4.50126 3.25539C3.80652 3.48697 3.28037 3.7517 2.93817 4.02139ZM17.5 6.2309C17.0526 6.54124 16.4751 6.80657 15.815 7.02663C14.3038 7.53035 12.2479 7.83333 10 7.83333C7.75208 7.83333 5.69621 7.53035 4.18503 7.02663C3.52486 6.80657 2.94736 6.54124 2.5 6.2309V9.99999C2.5 10.1399 2.58304 10.3578 2.92244 10.6309C3.25721 10.9004 3.78199 11.1715 4.50126 11.4113C5.93651 11.8897 7.91486 12.1667 10 12.1667C12.0851 12.1667 14.0635 11.8897 15.4987 11.4113C16.218 11.1715 16.7428 10.9004 17.0776 10.6309C17.417 10.3578 17.5 10.1399 17.5 9.99999V6.2309ZM17.5 11.5628C17.0592 11.8694 16.4867 12.136 15.815 12.36C14.2496 12.8817 12.1583 13.1667 10 13.1667C7.84168 13.1667 5.75037 12.8817 4.18503 12.36C3.51327 12.136 2.94081 11.8694 2.5 11.5628V15.3333C2.5 15.4732 2.58304 15.6912 2.92244 15.9643C3.25721 16.2337 3.78199 16.5049 4.50126 16.7446C5.93651 17.223 7.91486 17.5 10 17.5C12.0851 17.5 14.0635 17.223 15.4987 16.7446C16.218 16.5049 16.7428 16.2337 17.0776 15.9643C17.417 15.6912 17.5 15.4732 17.5 15.3333V11.5628ZM18.5 15.3333C18.5 15.9007 18.1616 16.3755 17.7045 16.7434C17.2428 17.1149 16.596 17.433 15.815 17.6933C14.2496 18.2151 12.1583 18.5 10 18.5C7.84168 18.5 5.75037 18.2151 4.18503 17.6933C3.40401 17.433 2.75722 17.1149 2.29549 16.7434C1.83838 16.3755 1.5 15.9007 1.5 15.3333V4.66667C1.5 4.07961 1.85738 3.59992 2.31919 3.23597C2.78664 2.86759 3.43206 2.5577 4.18503 2.30671C5.69621 1.80298 7.75208 1.5 10 1.5C12.2479 1.5 14.3038 1.80298 15.815 2.30671C16.5679 2.5577 17.2134 2.86759 17.6808 3.23597C18.1426 3.59992 18.5 4.07961 18.5 4.66667V15.3333Z",n.WEB_SERVICE="M10.58 1.51999C10.51 1.49999 10.43 1.48999 10.35 1.50999C10.23 1.50999 10.11 1.50999 9.99 1.50999C9.87 1.50999 9.75 1.50999 9.63 1.50999C9.55 1.49999 9.48 1.50999 9.4 1.51999C4.99 1.81999 1.5 5.49999 1.5 9.99999C1.5 14.5 4.99 18.18 9.42 18.48C9.49 18.5 9.57 18.51 9.65 18.49C9.77 18.49 9.89 18.49 10.01 18.49C10.13 18.49 10.25 18.49 10.37 18.49C10.45 18.5 10.52 18.49 10.6 18.48C15.02 18.18 18.52 14.5 18.52 9.99999C18.52 5.49999 15.01 1.81999 10.58 1.51999ZM16.8 6.82999H12.91C12.61 5.36999 12.09 3.94999 11.38 2.61999C13.79 3.06999 15.79 4.66999 16.8 6.82999ZM12.24 9.99999C12.24 10.73 12.19 11.45 12.08 12.17H7.93C7.82 11.46 7.77 10.73 7.77 9.99999C7.77 9.26999 7.82 8.54999 7.93 7.82999H12.08C12.19 8.53999 12.24 9.26999 12.24 9.99999ZM9.83 2.49999C9.88 2.49999 9.94 2.49999 10 2.49999C10.06 2.49999 10.11 2.49999 10.17 2.49999C10.98 3.84999 11.56 5.30999 11.89 6.82999H8.11C8.45 5.30999 9.03 3.84999 9.83 2.49999ZM8.61 2.62999C7.9 3.94999 7.39 5.36999 7.08 6.83999H3.2C4.21 4.67999 6.21 3.07999 8.61 2.62999ZM2.5 9.99999C2.5 9.24999 2.61 8.51999 2.82 7.82999H6.92C6.82 8.54999 6.77 9.26999 6.77 9.99999C6.77 10.73 6.82 11.45 6.92 12.17H2.82C2.61 11.48 2.5 10.76 2.5 9.99999ZM3.2 13.17H7.09C7.39 14.63 7.91 16.05 8.62 17.38C6.21 16.93 4.21 15.33 3.2 13.17ZM10.17 17.5C10.12 17.5 10.06 17.5 10 17.5C9.94 17.5 9.89 17.5 9.83 17.5C9.02 16.15 8.44 14.69 8.11 13.17H11.89C11.55 14.69 10.97 16.15 10.17 17.5ZM11.39 17.37C12.1 16.05 12.61 14.63 12.92 13.16H16.81C15.8 15.32 13.8 16.92 11.39 17.37ZM13.09 12.16C13.19 11.44 13.24 10.72 13.24 9.98999C13.24 9.25999 13.19 8.53999 13.09 7.81999H17.19C17.4 8.50999 17.51 9.22999 17.51 9.98999C17.51 10.75 17.4 11.47 17.19 12.16H13.09Z",n.RULE="M16.8549 1.505H3.14488C2.24488 1.505 1.50488 2.245 1.50488 3.145V16.855C1.50488 17.765 2.24488 18.495 3.14488 18.495H6.52488C6.52488 18.495 6.55488 18.495 6.57488 18.495C6.59488 18.495 6.60488 18.495 6.62488 18.495H16.8549C17.7649 18.495 18.4949 17.755 18.4949 16.855V3.145C18.4949 2.235 17.7549 1.505 16.8549 1.505V1.505ZM6.07488 17.505H3.14488C2.79488 17.505 2.50488 17.215 2.50488 16.865V12.795H6.07488V17.505V17.505ZM6.07488 11.795H2.50488V7.07501H6.07488V11.785V11.795ZM17.5049 16.865C17.5049 17.225 17.2149 17.505 16.8649 17.505H7.07488V12.795H17.5049V16.865ZM17.5049 11.795H7.07488V7.07501H17.5049V11.785V11.795ZM17.5049 6.085H2.50488V3.145C2.50488 2.795 2.79488 2.505 3.14488 2.505H16.8549C17.2049 2.505 17.4949 2.795 17.4949 3.145V6.07501L17.5049 6.085Z",n.REST_CLIENT="M4.34348 14.9871C4.64515 14.7032 5.11981 14.7177 5.40365 15.0193L5.41334 15.0296C5.69718 15.3313 5.68273 15.806 5.38106 16.0898C5.07939 16.3737 4.60473 16.3592 4.32089 16.0575L4.3112 16.0472C4.02736 15.7456 4.04181 15.2709 4.34348 14.9871Z M8.61204 12.0005C7.67503 11.0046 6.38087 10.4217 5.01413 10.3799C4.73812 10.3714 4.52121 10.1408 4.52966 9.86482C4.53811 9.5888 4.76871 9.3719 5.04472 9.38034C6.67649 9.43028 8.22163 10.1263 9.34034 11.3152C10.459 12.5042 11.0597 14.0888 11.0103 15.7206C11.0019 15.9966 10.7714 16.2136 10.4954 16.2053C10.2194 16.1969 10.0024 15.9664 10.0107 15.6903C10.0522 14.3236 9.54904 12.9964 8.61204 12.0005Z M12.7334 8.12283C11.7602 7.08858 10.5929 6.25613 9.29809 5.67303C8.00324 5.08992 6.60622 4.76757 5.18679 4.72438C4.91077 4.71598 4.69383 4.48542 4.70222 4.20941C4.71062 3.93339 4.94118 3.71645 5.2172 3.72485C6.76789 3.77203 8.29411 4.12418 9.7087 4.76122C11.1233 5.39825 12.3986 6.30767 13.4617 7.43757C14.5248 8.56746 15.3549 9.8957 15.9047 11.3464C16.4545 12.7972 16.7131 14.342 16.6659 15.8927C16.6575 16.1687 16.4269 16.3856 16.1509 16.3772C15.8749 16.3688 15.6579 16.1382 15.6663 15.8622C15.7096 14.4428 15.4729 13.0287 14.9696 11.7008C14.4664 10.3729 13.7065 9.15708 12.7334 8.12283Z",n.EMAIL="M2.52467 5.30441L10 10.288L17.4753 5.30441C17.3586 4.71897 16.842 4.27777 16.2222 4.27777H3.77778C3.15804 4.27777 2.64135 4.71897 2.52467 5.30441ZM17.5 6.48981L10.2774 11.3049C10.1094 11.4169 9.8906 11.4169 9.72265 11.3049L2.5 6.48981V14.4444C2.5 15.1501 3.07208 15.7222 3.77778 15.7222H16.2222C16.9279 15.7222 17.5 15.1501 17.5 14.4444V6.48981ZM1.5 5.55555C1.5 4.29757 2.5198 3.27777 3.77778 3.27777H16.2222C17.4802 3.27777 18.5 4.29757 18.5 5.55555V14.4444C18.5 15.7024 17.4802 16.7222 16.2222 16.7222H3.77778C2.5198 16.7222 1.5 15.7024 1.5 14.4444V5.55555Z",n.USER="M10.0001 3.21796C8.46359 3.21796 7.21802 4.46353 7.21802 6.00001C7.21802 7.5365 8.46359 8.78207 10.0001 8.78207C11.5366 8.78207 12.7821 7.5365 12.7821 6.00001C12.7821 4.46353 11.5366 3.21796 10.0001 3.21796ZM6.21802 6.00001C6.21802 3.91124 7.9113 2.21796 10.0001 2.21796C12.0888 2.21796 13.7821 3.91124 13.7821 6.00001C13.7821 8.08878 12.0888 9.78207 10.0001 9.78207C7.9113 9.78207 6.21802 8.08878 6.21802 6.00001ZM8.35896 12.859C7.62111 12.859 6.91349 13.1521 6.39175 13.6739C5.87001 14.1956 5.5769 14.9032 5.5769 15.6411V17.2821C5.5769 17.5582 5.35305 17.7821 5.0769 17.7821C4.80076 17.7821 4.5769 17.5582 4.5769 17.2821V15.6411C4.5769 14.638 4.97537 13.676 5.68464 12.9667C6.39392 12.2575 7.3559 11.859 8.35896 11.859H11.641C12.6441 11.859 13.6061 12.2575 14.3153 12.9667C15.0246 13.676 15.4231 14.638 15.4231 15.6411V17.2821C15.4231 17.5582 15.1992 17.7821 14.9231 17.7821C14.6469 17.7821 14.4231 17.5582 14.4231 17.2821V15.6411C14.4231 14.9032 14.13 14.1956 13.6082 13.6739C13.0865 13.1521 12.3789 12.859 11.641 12.859H8.35896Z",n.MANUAL="M18.37 9.94187C18.28 9.73187 18.16 9.55187 18 9.39187C17.84 9.23187 17.66 9.11187 17.45 9.02187C17.24 8.93187 17.02 8.89187 16.8 8.89187H16.75C16.85 8.67187 16.91 8.44187 16.91 8.19187C16.91 7.74187 16.73 7.31187 16.41 6.99187C16.09 6.67187 15.66 6.49187 15.21 6.49187H10.42L10.74 6.17187C11.05 5.86187 11.25 5.44187 11.31 5.00187C11.36 4.56187 11.27 4.11187 11.04 3.73187C10.81 3.35187 10.45 3.07187 10.02 2.96187C9.58 2.85187 9.13 2.91187 8.74 3.13187C6.03 4.65187 4.52 5.52187 4.13 5.77187L3.89 5.93187C3.16 6.41187 2.55 7.07187 2.14 7.84187C1.76 8.54187 1.54 9.32187 1.5 10.1219C1.5 10.1419 1.5 10.1719 1.5 10.1919V11.7919C1.5 13.2119 2.05 14.5419 3.05 15.5419C4.05 16.5419 5.38 17.0919 6.8 17.0919H13.6C14.05 17.0919 14.49 16.9119 14.8 16.5919C15.11 16.2719 15.3 15.8419 15.3 15.3919C15.3 15.1519 15.24 14.9119 15.14 14.6919H15.2C15.65 14.6919 16.08 14.5119 16.4 14.1919C16.72 13.8719 16.9 13.4419 16.9 12.9919C16.9 12.7419 16.84 12.5119 16.75 12.2919H16.8C17.02 12.2919 17.24 12.2519 17.45 12.1619C17.66 12.0719 17.84 11.9519 18 11.7919C18.16 11.6319 18.28 11.4519 18.37 11.2419C18.45 11.0319 18.5 10.8119 18.5 10.5919C18.5 10.3719 18.46 10.1519 18.37 9.94187ZM17.45 10.8619C17.41 10.9419 17.36 11.0219 17.3 11.0919C17.24 11.1619 17.16 11.2119 17.07 11.2419C16.99 11.2819 16.9 11.2919 16.8 11.2919H15.21C15.21 11.2919 15.21 11.2919 15.2 11.2919H10C9.72 11.2919 9.5 11.5119 9.5 11.7919C9.5 12.0719 9.72 12.2919 10 12.2919H15.21C15.39 12.2919 15.57 12.3619 15.7 12.4919C15.83 12.6219 15.91 12.8019 15.91 12.9919C15.91 13.1819 15.84 13.3619 15.71 13.4919C15.58 13.6219 15.4 13.7019 15.21 13.7019H10.01C9.73 13.7019 9.51 13.9219 9.51 14.2019C9.51 14.4819 9.73 14.7019 10.01 14.7019H13.61C13.79 14.7019 13.97 14.7819 14.11 14.9119C14.24 15.0419 14.31 15.2219 14.31 15.4019C14.31 15.5819 14.24 15.7619 14.1 15.9019C13.97 16.0319 13.79 16.1119 13.6 16.1119H6.8C5.65 16.1119 4.57 15.6619 3.76 14.8519C2.95 14.0419 2.5 12.9619 2.5 11.8119V10.3819C2.5 9.67187 2.68 8.96187 3.01 8.34187C3.35 7.72187 3.84 7.18187 4.43 6.79187L4.67 6.63187C5.04 6.39187 6.57 5.51187 9.22 4.02187C9.38 3.93187 9.57 3.91187 9.74 3.95187C9.92 4.00187 10.07 4.11187 10.16 4.27187C10.27 4.46187 10.32 4.68187 10.29 4.90187C10.26 5.12187 10.16 5.33187 10.01 5.48187L8.83 6.66187C8.83 6.66187 8.75 6.76187 8.72 6.82187C8.67 6.94187 8.67 7.08187 8.72 7.20187C8.77 7.32187 8.87 7.42187 8.99 7.47187C9.05 7.50187 9.12 7.51187 9.18 7.51187H15.18C15.37 7.51187 15.54 7.58187 15.68 7.71187C15.81 7.84187 15.89 8.02187 15.89 8.21187C15.89 8.40187 15.81 8.57187 15.68 8.70187C15.55 8.83187 15.37 8.91187 15.18 8.91187H9.98C9.7 8.91187 9.48 9.13187 9.48 9.41187C9.48 9.69187 9.7 9.91187 9.98 9.91187H16.78C16.87 9.91187 16.96 9.93187 17.05 9.96187C17.14 10.0019 17.21 10.0519 17.28 10.1119C17.35 10.1819 17.4 10.2519 17.43 10.3419C17.47 10.4319 17.48 10.5219 17.48 10.6119C17.48 10.7019 17.46 10.7919 17.43 10.8819L17.45 10.8619Z",n.SERVICE="M11.975 3.05291C11.4727 0.982614 8.5279 0.982526 8.02544 3.05265C7.86008 3.73266 7.08472 4.05496 6.48482 3.69022C4.66486 2.58252 2.5832 4.66517 3.69139 6.48425C3.77602 6.62304 3.82677 6.78001 3.83933 6.94207C3.8519 7.10414 3.82602 7.26688 3.7638 7.41705C3.70158 7.56723 3.60479 7.70059 3.48129 7.80628C3.35779 7.91198 3.21108 7.98702 3.0531 8.02529C0.982807 8.52754 0.982579 11.4724 3.05269 11.9749C3.21053 12.0132 3.35709 12.0883 3.48045 12.194C3.60381 12.2997 3.70049 12.433 3.76263 12.5831C3.82478 12.7332 3.85063 12.8958 3.8381 13.0577C3.82556 13.2197 3.77499 13.3764 3.69049 13.5151C2.58244 15.3352 4.66514 17.4171 6.48431 16.3089C6.6231 16.2243 6.78006 16.1735 6.94213 16.161C7.10419 16.1484 7.26693 16.1743 7.41711 16.2365C7.56728 16.2987 7.70064 16.3955 7.80634 16.519C7.91203 16.6425 7.98707 16.7892 8.02535 16.9472C8.52759 19.0175 11.4724 19.0177 11.9749 16.9476C12.0133 16.7898 12.0884 16.6432 12.1941 16.5199C12.2997 16.3965 12.433 16.2998 12.5831 16.2377C12.7332 16.1755 12.8958 16.1497 13.0578 16.1622C13.2197 16.1747 13.3765 16.2253 13.5152 16.3098C15.3352 17.4179 17.4172 15.3352 16.309 13.516C16.2243 13.3772 16.1736 13.2202 16.161 13.0582C16.1485 12.8961 16.1743 12.7334 16.2365 12.5832C16.2988 12.433 16.3956 12.2997 16.5191 12.194C16.6426 12.0883 16.7893 12.0132 16.9473 11.9749C19.0175 11.4727 19.0175 8.52779 16.9474 8.02533C16.7897 7.98692 16.6432 7.91186 16.5199 7.80624C16.3965 7.70055 16.2999 7.56725 16.2377 7.41717C16.1756 7.26709 16.1497 7.10446 16.1623 6.94251C16.1748 6.78055 16.2254 6.62375 16.3099 6.48502C17.418 4.665 15.3351 2.5832 13.5159 3.69144C13.3771 3.77606 13.2203 3.82671 13.0582 3.83928C12.8962 3.85184 12.7334 3.82597 12.5832 3.76375C12.4331 3.70153 12.2997 3.60473 12.194 3.48124C12.0883 3.35774 12.0132 3.21089 11.975 3.05291ZM8.99719 3.28867C9.25225 2.23732 10.748 2.23727 11.0031 3.28853C11.0785 3.59947 11.2262 3.88837 11.4343 4.13145C11.6423 4.37457 11.9049 4.56512 12.2005 4.6876C12.4961 4.81008 12.8165 4.86102 13.1355 4.83629C13.4545 4.81156 13.7631 4.71187 14.0363 4.54535C14.9603 3.98248 16.0188 5.04014 15.4558 5.965C15.2895 6.23808 15.1899 6.54655 15.1652 6.86533C15.1406 7.18415 15.1915 7.5043 15.3138 7.79975C15.4361 8.09519 15.6265 8.35761 15.8693 8.56565C16.1121 8.7737 16.4006 8.92151 16.7114 8.99707C17.7627 9.25213 17.763 10.7479 16.7118 11.0031C16.4008 11.0784 16.1119 11.2262 15.8688 11.4342C15.6257 11.6423 15.4352 11.9048 15.3127 12.2004C15.1902 12.4961 15.1393 12.8164 15.164 13.1355C15.1887 13.4545 15.2885 13.7632 15.455 14.0364C16.0177 14.9603 14.9601 16.0187 14.0353 15.4557C13.7622 15.2894 13.4538 15.1899 13.135 15.1652C12.9888 15.1539 12.8423 15.1584 12.698 15.1785C12.5277 15.2022 12.3605 15.2475 12.2006 15.3137C12.0404 15.3801 11.89 15.4663 11.7526 15.5701C11.6366 15.6578 11.5299 15.758 11.4346 15.8692C11.2266 16.1121 11.0788 16.4006 11.0032 16.7113C10.7482 17.7627 9.25235 17.7628 8.99719 16.7116C8.92183 16.4006 8.77412 16.1119 8.56609 15.8688C8.35802 15.6257 8.09549 15.4351 7.79986 15.3126C7.50423 15.1902 7.18387 15.1392 6.86483 15.164C6.54579 15.1887 6.2371 15.2884 5.96389 15.455C5.03998 16.0176 3.98155 14.9601 4.54459 14.0352C4.7109 13.7622 4.81044 13.4537 4.83511 13.1349C4.85979 12.8161 4.80889 12.4959 4.68656 12.2005C4.56422 11.9051 4.3739 11.6426 4.13105 11.4346C3.88821 11.2265 3.59944 11.0787 3.28872 11.0031C2.23737 10.7481 2.23746 9.2523 3.28872 8.99714C3.59966 8.92178 3.88842 8.77407 4.13151 8.56603C4.37462 8.35797 4.56517 8.09544 4.68765 7.79981C4.81013 7.50418 4.86108 7.18381 4.83634 6.86477C4.81161 6.5458 4.71193 6.23717 4.5454 5.96399C3.98253 5.04005 5.04044 3.98162 5.96531 4.54469C7.14319 5.26084 8.67189 4.62643 8.99719 3.28867ZM6.83352 10C6.83352 8.25114 8.25128 6.83337 10.0002 6.83337C11.7491 6.83337 13.1669 8.25114 13.1669 10C13.1669 11.7489 11.7491 13.1667 10.0002 13.1667C8.25128 13.1667 6.83352 11.7489 6.83352 10ZM10.0002 7.83337C8.80357 7.83337 7.83352 8.80342 7.83352 10C7.83352 11.1967 8.80357 12.1667 10.0002 12.1667C11.1968 12.1667 12.1669 11.1967 12.1669 10C12.1669 8.80342 11.1968 7.83337 10.0002 7.83337Z",n.SEND="M15.69 11.865C15.49 11.665 15.18 11.665 14.98 11.865C14.78 12.065 14.78 12.375 14.98 12.575L16.79 14.385H12.66C12.38 14.385 12.16 14.605 12.16 14.885C12.16 15.165 12.38 15.385 12.66 15.385H16.79L14.98 17.195C14.78 17.395 14.78 17.705 14.98 17.905C15.18 18.105 15.49 18.105 15.69 17.905L18.36 15.235C18.56 15.035 18.56 14.725 18.36 14.525L15.69 11.855V11.865Z M17.83 2.61501C17.4 2.18501 16.82 1.94501 16.22 1.94501H3.78C3.17 1.94501 2.59 2.18501 2.17 2.61501C1.75 3.04501 1.5 3.62501 1.5 4.22501V13.115C1.5 13.715 1.74 14.295 2.17 14.725C2.6 15.155 3.18 15.395 3.78 15.395H10C10.28 15.395 10.5 15.175 10.5 14.895C10.5 14.615 10.28 14.395 10 14.395H3.78C3.44 14.395 3.12 14.265 2.88 14.025C2.64 13.785 2.51 13.465 2.51 13.125V5.15501L9.73 9.97501C9.9 10.085 10.12 10.085 10.28 9.97501L17.5 5.15501V10.885C17.5 11.165 17.72 11.385 18 11.385C18.28 11.385 18.5 11.165 18.5 10.885V4.22501C18.5 3.62501 18.26 3.04501 17.83 2.61501ZM10 8.95501L2.52 3.97501C2.57 3.72501 2.69 3.50501 2.87 3.32501C3.11 3.08501 3.43 2.95501 3.77 2.95501H16.22C16.56 2.95501 16.88 3.08501 17.12 3.32501C17.3 3.50501 17.42 3.73501 17.47 3.97501L9.99 8.95501H10Z",n.RECEIVE="M17.83 2.61501C17.4 2.18501 16.82 1.94501 16.22 1.94501H3.78C3.17 1.94501 2.59 2.18501 2.17 2.61501C1.74 3.04501 1.5 3.62501 1.5 4.22501V13.115C1.5 13.715 1.74 14.295 2.17 14.725C2.6 15.155 3.18 15.395 3.78 15.395H10C10.28 15.395 10.5 15.175 10.5 14.895C10.5 14.615 10.28 14.395 10 14.395H3.78C3.44 14.395 3.12 14.265 2.88 14.025C2.64 13.785 2.51 13.465 2.51 13.125V5.15501L9.73 9.97501C9.9 10.085 10.12 10.085 10.28 9.97501L17.5 5.15501V10.885C17.5 11.165 17.72 11.385 18 11.385C18.28 11.385 18.5 11.165 18.5 10.885V4.22501C18.5 3.62501 18.26 3.04501 17.83 2.61501ZM10 8.95501L2.52 3.97501C2.57 3.72501 2.69 3.50501 2.87 3.32501C3.11 3.08501 3.43 2.95501 3.77 2.95501H16.22C16.56 2.95501 16.88 3.08501 17.12 3.32501C17.3 3.50501 17.42 3.73501 17.47 3.97501L9.99 8.95501H10Z M18 14.385H13.87L15.68 12.575C15.88 12.375 15.88 12.065 15.68 11.865C15.48 11.665 15.17 11.665 14.97 11.865L12.3 14.535C12.21 14.625 12.15 14.755 12.15 14.885C12.15 15.015 12.2 15.145 12.3 15.235L14.97 17.905C15.17 18.105 15.48 18.105 15.68 17.905C15.88 17.705 15.88 17.395 15.68 17.195L13.87 15.385H18C18.28 15.385 18.5 15.165 18.5 14.885C18.5 14.605 18.28 14.385 18 14.385Z",n.ANGLE_DOWN="m 14.374468,7.8998791 c 0.182994,0.2068134 0.163691,0.5228707 -0.04311,0.7058045 l -4.008014,3.5465644 c -0.189819,0.167972 -0.475268,0.167328 -0.664388,-0.0015 L 5.6669878,8.586132 C 5.4610018,8.4022667 5.4431148,8.0861255 5.6270808,7.8801401 5.8110458,7.6741547 6.127087,7.6563679 6.333072,7.8402331 l 3.660444,3.2685679 3.675158,-3.2520147 c 0.206803,-0.1829338 0.522801,-0.1637207 0.705794,0.043093 z",n.NOTE="M7.34003 7.83H8.23003C8.51003 7.83 8.73003 7.61 8.73003 7.33C8.73003 7.05 8.51003 6.83 8.23003 6.83H7.34003C7.06003 6.83 6.84003 7.05 6.84003 7.33C6.84003 7.61 7.06003 7.83 7.34003 7.83Z M12.67 13.94H7.34003C7.06003 13.94 6.84003 14.16 6.84003 14.44C6.84003 14.72 7.06003 14.94 7.34003 14.94H12.67C12.95 14.94 13.17 14.72 13.17 14.44C13.17 14.16 12.95 13.94 12.67 13.94Z M16.58 6.09L12.13 1.65C12.04 1.56 11.91 1.5 11.78 1.5H5.56003C4.95003 1.5 4.37003 1.74 3.95003 2.17C3.52003 2.6 3.28003 3.18 3.28003 3.78V16.22C3.28003 16.82 3.52003 17.4 3.95003 17.83C4.38003 18.26 4.96003 18.5 5.56003 18.5H14.45C15.05 18.5 15.63 18.26 16.06 17.83C16.49 17.4 16.73 16.82 16.73 16.22V6.44C16.73 6.31 16.68 6.18 16.58 6.09ZM12.28 3.21L15.02 5.95H12.67C12.57 5.95 12.47 5.91 12.4 5.84C12.33 5.77 12.29 5.67 12.29 5.56V3.21H12.28ZM15.72 16.23C15.72 16.57 15.59 16.89 15.35 17.13C15.11 17.37 14.79 17.5 14.45 17.5H5.56003C5.22003 17.5 4.90003 17.37 4.66003 17.13C4.42003 16.89 4.29003 16.57 4.29003 16.23V3.78C4.29003 3.44 4.42003 3.12 4.66003 2.88C4.90003 2.64 5.22003 2.51 5.56003 2.51H11.28V5.57C11.28 5.94 11.43 6.29 11.69 6.55C11.95 6.81 12.3 6.96 12.67 6.96H15.73V16.22L15.72 16.23Z M7.34003 10.39C7.06003 10.39 6.84003 10.61 6.84003 10.89C6.84003 11.17 7.06003 11.39 7.34003 11.39H12.67C12.95 11.39 13.17 11.17 13.17 10.89C13.17 10.61 12.95 10.39 12.67 10.39H7.34003Z",n.PUZZLE="M10.0038 1.95906C10.2954 1.66743 10.6921 1.5 11.1104 1.5C11.5287 1.5 11.9254 1.66742 12.2171 1.95906L13.7162 3.45817C13.8335 3.57549 13.885 3.74336 13.8536 3.90628C13.8222 4.06919 13.7121 4.20594 13.5596 4.2713C13.2336 4.411 12.9448 4.62539 12.7205 4.90144C12.497 5.17656 12.3457 5.50614 12.2757 5.85649C12.2066 6.20173 12.2238 6.5584 12.3276 6.8985C12.4309 7.23723 12.6216 7.5501 12.8707 7.7992C13.1262 8.05472 13.4318 8.23875 13.7714 8.34237L13.7737 8.34307C14.1043 8.44568 14.4672 8.4635 14.8134 8.39426L14.815 8.39395C15.1696 8.32419 15.492 8.17403 15.7685 7.94942L15.7734 7.94542L15.7734 7.94545C16.0446 7.73076 16.2576 7.44522 16.3974 7.11325C16.462 6.95982 16.5987 6.84861 16.7621 6.81661C16.9255 6.78461 17.094 6.83601 17.2118 6.95373L18.7109 8.45284C19.0025 8.74447 19.1699 9.1412 19.1699 9.5595C19.1699 9.97781 19.0025 10.3745 18.7109 10.6662L17.0386 12.3384C17.2914 12.4259 17.5334 12.5455 17.7592 12.6948C18.2824 13.0408 18.6896 13.5321 18.9272 14.1175C19.163 14.6987 19.2215 15.3297 19.1041 15.9414L19.1029 15.9479L19.1029 15.9479C18.977 16.5605 18.675 17.1241 18.2366 17.5632C17.7971 18.0105 17.2313 18.3146 16.6146 18.4336C15.9951 18.5602 15.3632 18.4909 14.7874 18.2573L14.7851 18.2563C14.2114 18.0201 13.7131 17.6153 13.3659 17.0909C13.2152 16.8666 13.0952 16.6236 13.0076 16.3695L11.3361 18.0409C11.0445 18.3326 10.6477 18.5 10.2294 18.5C9.81112 18.5 9.41439 18.3326 9.12276 18.0409L7.62365 16.5418C7.50633 16.4245 7.45485 16.2566 7.48623 16.0937C7.5176 15.9308 7.62775 15.7941 7.78024 15.7287C8.10622 15.589 8.39505 15.3746 8.61934 15.0986C8.84288 14.8234 8.99411 14.4939 9.06418 14.1435C9.13323 13.7983 9.11605 13.4416 9.01229 13.1015C8.90895 12.7628 8.71822 12.4499 8.46912 12.2008C8.2136 11.9453 7.90806 11.7613 7.56842 11.6576L7.56613 11.6569C7.2355 11.5543 6.87262 11.5365 6.52642 11.6057L6.52487 11.606C6.17024 11.6758 5.84781 11.826 5.57136 12.0506L5.56644 12.0546L5.56642 12.0545C5.29523 12.2692 5.08224 12.5548 4.94246 12.8867C4.87786 13.0402 4.74113 13.1514 4.57776 13.1834C4.41439 13.2154 4.24581 13.164 4.12809 13.0463L2.62898 11.5472C2.33735 11.2555 2.16992 10.8588 2.16992 10.4405C2.16992 10.0222 2.33735 9.62547 2.62898 9.33384L4.30121 7.6616C4.04847 7.57405 3.80643 7.45448 3.58063 7.30516C3.05746 6.95919 2.65022 6.46794 2.41265 5.8825C2.17681 5.30131 2.11838 4.67035 2.23571 4.05858L2.23695 4.05211L2.23699 4.05212C2.36289 3.43944 2.66489 2.87586 3.10332 2.43676C3.5428 1.98951 4.10854 1.68537 4.72526 1.56641C5.3447 1.43982 5.97665 1.50909 6.55242 1.74273L6.55479 1.74369L6.55479 1.7437C7.12851 1.97994 7.62681 2.38473 7.97407 2.90917C8.12465 3.13352 8.24467 3.37645 8.33229 3.63053L10.0038 1.95906ZM11.1104 2.5C10.9603 2.5 10.8171 2.55993 10.7109 2.66616L8.35918 5.01785C8.21618 5.16085 8.00112 5.20363 7.81428 5.12624C7.62744 5.04885 7.50562 4.86653 7.50562 4.6643C7.50562 4.2364 7.37809 3.81511 7.14305 3.46542L7.14095 3.4623L7.14096 3.4623C6.90591 3.10684 6.56669 2.83033 6.17521 2.66886C5.77186 2.50544 5.33973 2.46104 4.92331 2.54661L4.91686 2.54793L4.91685 2.54789C4.49831 2.62816 4.11387 2.83465 3.81546 3.1388L3.81212 3.1422L3.81211 3.14219C3.51331 3.44099 3.30468 3.82759 3.21719 4.25017C3.13641 4.67467 3.17765 5.10823 3.33927 5.50648C3.49957 5.90151 3.77439 6.23441 4.13222 6.47104C4.49242 6.70924 4.90834 6.8357 5.33422 6.8357C5.53645 6.8357 5.71877 6.95752 5.79616 7.14436C5.87355 7.3312 5.83077 7.54626 5.68777 7.68926L3.33609 10.0409C3.22985 10.1472 3.16992 10.2904 3.16992 10.4405C3.16992 10.5906 3.22985 10.7338 3.33609 10.8401L4.37025 11.8742C4.53173 11.6498 4.72342 11.4469 4.94325 11.2725C5.34832 10.944 5.82074 10.7254 6.33185 10.6249C6.83737 10.524 7.36868 10.5488 7.86138 10.7015C8.35965 10.8537 8.80681 11.1243 9.17623 11.4937C9.53814 11.8556 9.81633 12.3101 9.96876 12.8097C10.1208 13.308 10.1462 13.8323 10.0448 14.3396C9.94432 14.8418 9.72609 15.3222 9.39546 15.7292C9.21887 15.9465 9.01598 16.1367 8.79349 16.2975L9.82987 17.3338C9.93611 17.4401 10.0793 17.5 10.2294 17.5C10.3795 17.5 10.5227 17.4401 10.629 17.3338L12.9807 14.9821C13.1237 14.8391 13.3387 14.7964 13.5256 14.8738C13.7124 14.9512 13.8342 15.1335 13.8342 15.3357C13.8342 15.7636 13.9618 16.1849 14.1968 16.5346L14.1989 16.5377L14.1989 16.5377C14.434 16.8932 14.7732 17.1697 15.1647 17.3312C15.568 17.4946 16.0001 17.539 16.4165 17.4534L16.423 17.4521L16.423 17.4521C16.8415 17.3718 17.226 17.1653 17.5244 16.8612L17.5277 16.8578L17.5277 16.8578C17.8265 16.559 18.0352 16.1724 18.1227 15.7498C18.2034 15.3253 18.1622 14.8918 18.0006 14.4935C17.8403 14.0985 17.5655 13.7656 17.2076 13.529C16.8474 13.2908 16.4315 13.1643 16.0056 13.1643C15.8034 13.1643 15.6211 13.0425 15.5437 12.8556C15.4663 12.6688 15.5091 12.4537 15.6521 12.3107L18.0038 9.95906C18.11 9.85282 18.1699 9.70958 18.1699 9.5595C18.1699 9.40943 18.11 9.26618 18.0038 9.15995L16.9696 8.12579C16.8081 8.35015 16.6164 8.55311 16.3966 8.72752C15.9916 9.05598 15.5191 9.2746 15.008 9.37514C14.5025 9.47598 13.9712 9.45118 13.4785 9.29849C12.9802 9.14627 12.533 8.87572 12.1636 8.50631C11.8017 8.14439 11.5235 7.68994 11.3711 7.19031C11.2191 6.69204 11.1936 6.16772 11.2951 5.66038C11.3955 5.15816 11.6138 4.67779 11.9444 4.27085C12.121 4.05351 12.3239 3.86328 12.5464 3.70255L11.51 2.66616C11.4037 2.55993 11.2605 2.5 11.1104 2.5Z"})($e||($e={}));const tRe=new Map([[We.START_SIGNAL,$e.SIGNAL_EVENT],[We.START_PROGRAM,$e.PROGRAM],[We.START_THIRD_PARTY,$e.PUZZLE],[We.START_ERROR,$e.ERROR_EVENT],[We.START_SUB,$e.SUB_START],[We.START_WS,$e.WS_EVENT],[We.START_HD,$e.INIT_START],[We.START_HD_METHOD,$e.METHOD_START],[We.START_HD_EVENT,$e.EVENT_START],[nr.INTERMEDIATE_TASK,$e.TASK],[nr.INTERMEDIATE_WAIT,$e.WAIT],[nr.INTERMEDIATE_THIRD_PARTY,$e.PUZZLE],[Sa.BOUNDARY_ERROR,$e.ERROR_EVENT],[Sa.BOUNDARY_SIGNAL,$e.SIGNAL_EVENT],[bn.END_PAGE,$e.END_PAGE],[bn.END_ERROR,$e.ERROR_EVENT],[bn.END_SUB,$e.SUB_END],[bn.END_WS,$e.WS_EVENT],[bn.END_HD_EXIT,$e.EXIT_END],[So.ALTERNATIVE,$e.ALTERNATIVE],[So.SPLIT,$e.SPLIT],[So.JOIN,$e.JOIN],[So.TASK,$e.TASKS],[ye.USER,$e.USER_TASK],[ye.HD,$e.USER_DIALOG],[ye.SCRIPT,$e.SCRIPT],[ye.TRIGGER,$e.TRIGGER],[ye.DB,$e.DATABASE],[ye.SOAP,$e.WEB_SERVICE],[ye.REST,$e.REST_CLIENT],[ye.EMAIL,$e.EMAIL],[ye.THIRD_PARTY,$e.PUZZLE],[ye.THIRD_PARTY_RULE,$e.RULE],[ye.PROGRAM,$e.PROGRAM],[ye.BPMN_USER,$e.USER],[ye.BPMN_MANUAL,$e.MANUAL],[ye.BPMN_SCRIPT,$e.SCRIPT],[ye.BPMN_SERVICE,$e.SERVICE],[ye.BPMN_RULE,$e.RULE],[ye.BPMN_SEND,$e.SEND],[ye.BPMN_RECEIVE,$e.RECEIVE]]),nRe=new Map([["std:Compensation",$e.ANGLE_DOWN],["std:Cancel",$e.ALTERNATIVE],["std:Escalation",$e.TRIGGER],["std:Timer",$e.WAIT],["std:Message",$e.EMAIL],["std:Conditional",$e.NOTE]]),iRe=n=>{if(n.includes("/faces/javax.faces.resource"))return{res:n,style:ic.IMG};if(n.startsWith("ext:"))return{res:$e.PUZZLE,style:ic.SI};const e=tRe.get(n);if(e)return{res:e,style:ic.SI};const t=nRe.get(n);return t?{res:t,style:ic.SI}:eRe},Hv={createElement:m.svg};function oRe(n,e){return JZ(n,{height:14,width:14,x:4,y:3},!1,e)}function XZ(n,e,t){const i={height:14,width:18,x:e-9,y:e-7};return JZ(n,i,!0,t)}function JZ(n,e,t,i){const o=iRe(n);if(o.style===ic.SI)return Hv.createElement("svg",{"class-sprotty-icon-svg":!0,viewBox:"0 0 20 20",height:e.height,width:e.width,x:e.x,y:e.y},Hv.createElement("path",{style:{fill:i},d:o.res}));if(o.style===ic.IMG){const r=oY(`<img src="${o.res}"></img>`);return Hv.createElement("g",null,Hv.createElement("foreignObject",{requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility",height:e.height,width:e.width,x:e.x,y:e.y,"class-sprotty-icon":!0,"class-icon-small":t},r))}return Hv.createElement("g",null)}var h4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},rRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};const Pl={createElement:m.svg};let Km=class extends m.RectangularNodeView{constructor(){super(...arguments);k(this,"customIconHandler")}render(t,i){var r;if(!this.isVisible(t,i))return;const o=this.getRoundedCornerRadius(t);return Pl.createElement("g",null,Pl.createElement("rect",{attrs:{[m.ATTR_BBOX_ELEMENT]:!0},"class-sprotty-node":!0,"class-mouseover":t.hoverFeedback,"class-selected":t.selected,x:0,y:0,rx:o,ry:o,width:t.bounds.width,height:t.bounds.height,style:{stroke:t.color}}),i.renderChildren(t),oRe((r=this.customIconHandler)!=null&&r.isShowCustomIcons?t.customIcon:t.type,t.color),this.getNodeDecorator(t),f4(t,t.bounds.width))}getNodeDecorator(t){return Pl.createElement("g",null)}getRoundedCornerRadius(t){return 5}};h4([_e($r),tg(),rRe("design:type",$r)],Km.prototype,"customIconHandler",void 0);Km=h4([le()],Km);let AL=class extends Km{getNodeDecorator(e){return Pl.createElement("svg",{x:e.bounds.width/2-6,y:e.bounds.height-12-1,height:12,width:12},Pl.createElement("rect",{"class-sprotty-node":!0,"class-sprotty-task-node":!0,x:1,y:1,rx:2,ry:2,width:10,height:10}),Pl.createElement("line",{"class-sprotty-node-decorator":!0,x1:6,y1:3,x2:6,y2:9}),Pl.createElement("line",{"class-sprotty-node-decorator":!0,x1:3,y1:6,x2:9,y2:6}))}};AL=h4([le()],AL);var p4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},sRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};const j3={createElement:m.svg};let Vm=class extends m.CircularNodeView{constructor(){super(...arguments);k(this,"customIconHandler")}render(t,i){var r;const o=this.getRadius(t);return j3.createElement("g",null,m.hiddenBoundingRect(t,i),j3.createElement("circle",{"class-sprotty-node":!0,"class-mouseover":t.hoverFeedback,"class-selected":t.selected,r:o,cx:o,cy:o,style:{stroke:t.color}}),this.getEventDecorator(o),XZ((r=this.customIconHandler)!=null&&r.isShowCustomIcons?t.customIcon:t.type,o,t.color),i.renderChildren(t),f4(t,2*o))}getEventDecorator(t){return j3.createElement("g",null)}};p4([_e($r),tg(),sRe("design:type",$r)],Vm.prototype,"customIconHandler",void 0);Vm=p4([le()],Vm);let Sl=class extends Vm{getEventDecorator(e){return j3.createElement("circle",{"class-sprotty-node":!0,"class-sprotty-task-node":!0,r:e-3,cx:e,cy:e})}};Sl=p4([le()],Sl);var eQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},aRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};const dz={createElement:m.svg};let Bw=class extends m.DiamondNodeView{constructor(){super(...arguments);k(this,"customIconHandler")}render(t,i){var a;const o=new m.Diamond({height:Math.max(t.size.height,0),width:Math.max(t.size.width,0),x:0,y:0}),r=`${this.svgStr(o.topPoint)} ${this.svgStr(o.rightPoint)} ${this.svgStr(o.bottomPoint)} ${this.svgStr(o.leftPoint)}`,s=this.getRadius(t);return dz.createElement("g",null,m.hiddenBoundingRect(t,i),dz.createElement("polygon",{"class-sprotty-node":!0,"class-mouseover":t.hoverFeedback,"class-selected":t.selected,points:r,style:{stroke:t.color}}),XZ((a=this.customIconHandler)!=null&&a.isShowCustomIcons?t.customIcon:t.type,s,t.color),i.renderChildren(t),f4(t,Math.max(t.size.width,0)))}getRadius(t){const i=Math.min(t.size.width,t.size.height);return i>0?i/2:0}svgStr(t){return`${t.x},${t.y}`}};eQ([_e($r),tg(),aRe("design:type",$r)],Bw.prototype,"customIconHandler",void 0);Bw=eQ([le()],Bw);var cRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let RL=class extends m.GLSPProjectionView{getBackgroundBounds(e,t,i){const o=super.getBackgroundBounds(e,t,i);return o.height=o.height*2,o.width=o.width*2,o}};RL=cRe([le()],RL);var m4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};const Td={createElement:m.svg};let $w=class extends m.RectangularNodeView{render(e,t){if(this.isEmbeddedLane(e)){const i=e.isFirstChild()?4:0,o=e.isLastChild()?4:0,r=t.targetKind==="hidden"?0:1,s=`M0,0
      h${Math.max(e.size.width-i,0)}
      q${i},0 ${i},${i}
      v${Math.max(e.size.height-r-i-o,0)}
      q0,${o} -${o},${o}
      h-${Math.max(e.size.width-o,0)}
      z`;return Td.createElement("g",null,Td.createElement("path",{"class-sprotty-node":!0,"class-selected":e.selected,d:s,style:this.laneStyle(e)}),t.renderChildren(e))}return Td.createElement("g",null,Td.createElement("rect",{"class-sprotty-node":!0,"class-selected":e.selected,x:"0",y:"0",rx:"4px",ry:"4px",width:Math.max(e.size.width,0),height:Math.max(e.size.height-1,0),style:this.laneStyle(e)}),this.getDecoratorLine(e),t.renderChildren(e))}isEmbeddedLane(e){return e.parent instanceof Ea}getDecoratorLine(e){return Td.createElement("g",null)}laneStyle(e){return e.color?{"--lane-color":e.color}:{}}};$w=m4([le()],$w);let ML=class extends $w{getDecoratorLine(e){const t=this.getPoolLaneSpace(e),i=e.size.height-1,o=`M${t},0 v${i} h-${t-4} q-4,0 -4,-4 v-${i-8} q0,-4 4,-4 z`;return Td.createElement("path",{"class-sprotty-node":!0,"class-pool-label-rect":!0,d:o})}laneStyle(e){return{}}getPoolLaneSpace(e){let t=24;return m.hasArgs(e)&&e.args&&(t=m.GArgument.getNumber(e,"poolLabelSpace")??24),t-1}};ML=m4([le()],ML);let IL=class extends m.GLabelView{render(e,t){const i=`rotate(270) translate(-${e.bounds.height/2} ${e.bounds.width/2})`;return Td.createElement("text",{"class-sprotty-label":!0,transform:i},e.text.split(`
`).map((o,r)=>Td.createElement("tspan",{dy:r===0?0:"1.2em",x:0,style:o?{}:{visibility:"hidden"}},o||".")))}};IL=m4([le()],IL);function dRe(n){return n.replace(/[\\"&'\\/<>\n]/g,function(e){return{'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#47;","<":"&lt;",">":"&gt;","\n":"<br/>"}[e]??""})}var bM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};const Bd={createElement:m.svg};let D_=class{render(e,t){const i=dRe(e.text),o=e.labelBounds,r=oY(`<div style="height: ${o.height}px;">${i}</div>`);return Bd.createElement("g",null,Bd.createElement("foreignObject",{requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility",height:o.height,width:o.width,x:o.x,y:o.y,z:10,"class-sprotty-label":!0,"class-node-child-label":e.parent.type.startsWith(ye.DEFAULT)},r),t.renderChildren(e))}};D_=bM([le()],D_);let DL=class extends m.PolylineEdgeViewWithGapsOnIntersections{renderLine(e,t,i){const o=super.renderLine(e,t,i,void 0);return o.data&&(o.data.style={stroke:e.color}),o}renderAdditionals(e,t,i){const o=super.renderAdditionals(e,t,i),r=this.edgePadding(e),s=r?[this.renderMouseHandle(t,r)]:[],a=t[t.length-2],f=t[t.length-1],h=Bd.createElement("path",{"class-sprotty-edge":!0,"class-arrow":!0,d:"M 0.5,0 L 6,-3 L 6,3 Z",transform:`rotate(${m.toDegrees(m.angleOfPoint({x:a.x-f.x,y:a.y-f.y}))} ${f.x} ${f.y}) translate(${f.x} ${f.y})`,style:{stroke:e.color,fill:e.color}});return o.push(...s,h),o}edgePadding(e){if(e.args)return m.EdgePadding.from(e)}renderMouseHandle(e,t){return Bd.createElement("path",{"class-mouse-handle":!0,d:this.createPathForSegments(e),"style-stroke-width":t*2,"style-stroke":"transparent","style-stroke-dasharray":"none","style-stroke-dashoffset":"0"})}createPathForSegments(e){const t=e[0];let i=`M ${t.x},${t.y}`;for(let o=1;o<e.length;o++){const r=e[o];i+=` L ${r.x},${r.y}`}return i}intersectionPath(e,t,i,o){try{return super.intersectionPath(e,t,i,o)}catch{return""}}};DL=bM([le()],DL);let TL=class extends m.GEdgeView{renderLine(e,t,i){const o=super.renderLine(e,t,i);return o.data&&(o.data.style={stroke:e.color}),o}renderAdditionals(e,t,i){if(m.hasArgs(e)&&e.args){const o=m.EdgePadding.from(e);return o?[this.renderMouseHandle(t,o)]:[]}return[]}};TL=bM([le()],TL);let OL=class extends m.GResizeHandleView{render(e,t){if(t.targetKind==="hidden")return;const i=e.parent;if(!ZZ(i))return super.render(e,t);const o=this.getLaneHandlePosition(e,i);return o!==void 0?this.renderLandeResizeHandle(e,o):Bd.createElement("g",null)}renderLandeResizeHandle(e,t){const i=Bd.createElement("svg",{"class-lane-resize-handle":!0,"class-mouseover":e.hoverFeedback,x:t.x-20,y:t.y-10,width:40,height:20},Bd.createElement("rect",{x:0,y:0,height:20,width:40,"class-lane-resize-mouse-handle":!0}),Bd.createElement("line",{x1:0,y1:10,x2:40,y2:10}),";");return m.setAttr(i,"data-kind",e.location),i}getLaneHandlePosition(e,t){return e.isNResize()?{x:m.Dimension.center(t.bounds).x,y:5}:e.isSResize()?{x:m.Dimension.center(t.bounds).x,y:m.Bounds.dimension(t.bounds).height-5}:super.getPosition(e)}};OL=bM([le()],OL);var uRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};const Kv={createElement:m.svg};let LL=class extends m.GIssueMarkerView{render(e){const t=super.getMaxSeverity(e),i=Kv.createElement("g",{"class-sprotty-issue":!0},Kv.createElement("g",null,this.getGlspIssueMarkerBackground(t),Kv.createElement("path",{d:this.getGlspIssueMarkerPath(t)})));return m.setClass(i,"sprotty-"+t,!0),i}getGlspIssueMarkerBackground(e){switch(e){case"warning":return Kv.createElement("polygon",{"class-sprotty-issue-background":!0,points:"8 0, 12 12, 0 12"});case"error":case"info":return Kv.createElement("circle",{"class-sprotty-issue-background":!0,r:this.radius,cx:this.radius,cy:this.radius})}}get radius(){return 6}getGlspIssueMarkerPath(e){switch(e){case"error":return"M8 2.5C4.96243 2.5 2.5 4.96243 2.5 8C2.5 11.0376 4.96243 13.5 8 13.5C11.0376 13.5 13.5 11.0376 13.5 8C13.5 4.96243 11.0376 2.5 8 2.5ZM1.5 8C1.5 4.41015 4.41015 1.5 8 1.5C11.5899 1.5 14.5 4.41015 14.5 8C14.5 11.5899 11.5899 14.5 8 14.5C4.41015 14.5 1.5 11.5899 1.5 8Z M6.31311 6.3131C6.50838 6.11784 6.82496 6.11784 7.02022 6.3131L8 7.29288L8.97978 6.3131C9.17504 6.11784 9.49162 6.11784 9.68689 6.3131C9.88215 6.50837 9.88215 6.82495 9.68689 7.02021L8.70711 7.99999L9.68689 8.97977C9.88215 9.17503 9.88215 9.49161 9.68689 9.68688C9.49162 9.88214 9.17504 9.88214 8.97978 9.68688L8 8.7071L7.02022 9.68688C6.82496 9.88214 6.50838 9.88214 6.31311 9.68688C6.11785 9.49161 6.11785 9.17503 6.31311 8.97977L7.29289 7.99999L6.31311 7.02021C6.11785 6.82495 6.11785 6.50837 6.31311 6.3131Z";case"warning":return"M8.00706 6.52274C8.2832 6.52274 8.50706 6.7466 8.50706 7.02274V9.50001C8.50706 9.77615 8.2832 10 8.00706 10C7.73091 10 7.50706 9.77615 7.50706 9.50001V7.02274C7.50706 6.7466 7.73091 6.52274 8.00706 6.52274ZM8.00706 10.5243C8.2832 10.5243 8.50706 10.7482 8.50706 11.0243V11.031C8.50706 11.3071 8.2832 11.531 8.00706 11.531C7.73091 11.531 7.50706 11.3071 7.50706 11.031V11.0243C7.50706 10.7482 7.73091 10.5243 8.00706 10.5243Z M7.06898 2.75412C7.35117 2.58775 7.67277 2.5 8.00035 2.5C8.32793 2.5 8.64953 2.58775 8.93172 2.75412C9.21237 2.91958 9.44384 3.1568 9.60237 3.44136L14.3352 11.6072C14.347 11.6275 14.3573 11.6487 14.3662 11.6704C14.4784 11.9478 14.521 12.2484 14.4904 12.5461C14.4597 12.8437 14.3567 13.1293 14.1903 13.378C14.0239 13.6266 13.7992 13.8308 13.5358 13.9727C13.2724 14.1146 12.9782 14.1899 12.679 14.192L12.6755 14.192H3.33854C3.32627 14.192 3.31411 14.1916 3.30207 14.1907C3.28148 14.1922 3.26058 14.1924 3.23943 14.1913C2.9473 14.1763 2.663 14.0915 2.41028 13.9442C2.15756 13.7969 1.94375 13.5913 1.7867 13.3445C1.62965 13.0977 1.53392 12.8169 1.5075 12.5256C1.48107 12.2342 1.52473 11.9408 1.63481 11.6698C1.64356 11.6482 1.6538 11.6273 1.66546 11.6072L6.39833 3.44136C6.55686 3.1568 6.78833 2.91958 7.06898 2.75412ZM3.30172 13.1933C3.31388 13.1924 3.32616 13.192 3.33854 13.192H12.6736C12.8091 13.1908 12.9422 13.1566 13.0616 13.0923C13.1813 13.0278 13.2835 12.935 13.3592 12.8219C13.4348 12.7088 13.4817 12.5789 13.4956 12.4436C13.5085 12.3186 13.4929 12.1925 13.4503 12.0746L8.72989 3.93021C8.65777 3.79988 8.55216 3.6912 8.42385 3.61555C8.29553 3.5399 8.1493 3.5 8.00035 3.5C7.8514 3.5 7.70517 3.5399 7.57686 3.61555C7.44855 3.6912 7.34284 3.79983 7.27073 3.93017L7.26591 3.93888L2.55022 12.0749C2.50836 12.19 2.49232 12.313 2.50341 12.4352C2.51542 12.5677 2.55895 12.6954 2.63036 12.8076C2.70177 12.9198 2.79899 13.0133 2.9139 13.0803C3.02881 13.1473 3.15808 13.1858 3.29092 13.1927C3.29453 13.1928 3.29813 13.1931 3.30172 13.1933Z";case"info":return"M 6.5719 0.013 A 5.9159 5.9159 90 0 1 10.2188 1.7695 A 6.1421 6.1421 90 0 1 10.619 9.9386 A 5.9594 5.9594 90 0 1 3.1546 11.4523 A 6.0899 6.0899 90 0 1 0.4402 8.4074 A 6.1943 6.1943 90 0 1 0.2401 4.3098 A 6.0899 6.0899 90 0 1 2.65 1.0126 A 5.9159 5.9159 90 0 1 6.5719 0.013 Z M 6.9825 11.1913 A 5.1242 5.1242 90 0 0 9.9491 9.3905 A 5.2808 5.2808 90 0 0 9.6011 2.3784 A 5.0633 5.0633 90 0 0 3.1372 1.7347 A 5.2721 5.2721 90 0 0 3.5722 10.6867 A 5.0546 5.0546 90 0 0 6.9825 11.1913 Z M 5.534 4.3359 H 6.6214 V 3.4659 H 5.534 Z M 6.6214 5.2059 V 8.6858 H 5.534 V 5.2059 Z"}}};LL=uRe([le()],LL);const lRe=new m.FeatureModule((n,e,t,i)=>{i(m.TYPES.ILogger).to(m.ConsoleLogger).inSingletonScope(),i(m.TYPES.LogLevel).toConstantValue(m.LogLevel.warn),n(m.TYPES.IContextMenuItemProvider).to(m.DeleteElementContextMenuItemProvider),n(m.TYPES.IMovementRestrictor).to(CL);const o={bind:n,unbind:e,isBound:t,rebind:i};m.overrideModelElement(o,m.DefaultTypes.GRAPH,m.GGraph,RL),m.overrideModelElement(o,m.DefaultTypes.ISSUE_MARKER,m.GIssueMarker,LL),r(We.START),r(We.START_ERROR),r(We.START_SIGNAL),r(We.START_PROGRAM,{enable:[hp]}),r(We.START_SUB),r(We.START_WS),r(We.START_HD),r(We.START_HD_METHOD),r(We.START_HD_EVENT),r(We.START_EMBEDDED),r(We.START_THIRD_PARTY),s(bn.END),s(bn.END_ERROR),s(bn.END_PAGE),s(bn.END_SUB),s(bn.END_WS),s(bn.END_HD),s(bn.END_HD_EXIT),s(bn.END_EMBEDDED),m.configureModelElement(o,nr.INTERMEDIATE_TASK,$p,Sl),m.configureModelElement(o,nr.INTERMEDIATE_WAIT,$p,Sl,{enable:[hp]}),m.configureModelElement(o,nr.INTERMEDIATE_THIRD_PARTY,$p,Sl),m.configureModelElement(o,Sa.BOUNDARY_ERROR,I_,Sl),m.configureModelElement(o,Sa.BOUNDARY_SIGNAL,I_,Sl),a(So.TASK),a(So.JOIN,{disable:[Lw]}),a(So.SPLIT),a(So.ALTERNATIVE),m.configureModelElement(o,ye.LABEL,zAe,D_),m.configureModelElement(o,ye.COMMENT,KAe,Km,{disable:[dS,u4,M_]}),f(ye.GENERIC),f(ye.SCRIPT),f(ye.SOAP),f(ye.REST),f(ye.DB),f(ye.EMAIL),f(ye.THIRD_PARTY),f(ye.THIRD_PARTY_RULE),f(ye.PROGRAM,{enable:[hp]}),f(ye.TRIGGER,{enable:[fp]}),f(ye.HD,{enable:[fp,hp]}),f(ye.USER,{enable:[UZ,fp,hp]}),h(ye.SUB_PROCESS,{enable:[fp],disable:[M_]}),h(ye.EMBEDDED_PROCESS),h(ye.BPMN_GENERIC),h(ye.BPMN_MANUAL),h(ye.BPMN_RECEIVE),h(ye.BPMN_RULE),h(ye.BPMN_SCRIPT),h(ye.BPMN_SEND),h(ye.BPMN_SERVICE),h(ye.BPMN_USER),m.configureModelElement(o,ra.LANE,Ea,$w),m.configureModelElement(o,ra.POOL,Ea,ML),m.configureModelElement(o,ra.LABEL,WZ,IL),m.overrideModelElement(o,Bp.DEFAULT,xm,DL),m.configureModelElement(o,Bp.ASSOCIATION,xm,TL),m.configureModelElement(o,Bp.LABEL,l4,D_,{enable:[m.selectFeature,m.moveFeature]}),m.overrideModelElement(o,n0.DEFAULT,Ku,D_,{enable:[m.selectFeature,m.moveFeature]}),m.configureModelElement(o,Hm.TYPE,Hm,wL);function r(g,y){m.configureModelElement(o,g,I_,Vm,y)}function s(g,y){m.configureModelElement(o,g,VAe,Vm,y)}function a(g,y){m.configureModelElement(o,g,qZ,Bw,y)}function f(g,y){m.configureModelElement(o,g,Fm,Km,y)}function h(g,y){m.configureModelElement(o,g,Fm,AL,y||{enable:[fp,zZ,Lw],disable:[M_]})}});var fRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let NL=class extends m.DirectLabelEditTool{enable(){this.toDisposeOnDisable.push(this.keyTool.registerListener(this.createEditLabelKeyListener()))}};NL=fRe([le()],NL);var tQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},jL;let BL=class{handle(e){if(m.isEditLabelAction(e))return m.SetUIExtensionVisibilityAction.create({extensionId:kw.IVY_ID,visible:!0,contextElementsId:[e.labelId]})}};BL=tQ([le()],BL);var Rl;let kw=(Rl=class extends m.EditLabelUI{id(){return jL.IVY_ID}configureAndAdd(e,t){super.configureAndAdd(e,t),e.style.top="3px"}},jL=Rl,k(Rl,"IVY_ID","ivyEditLabelUi"),Rl);kw=jL=tQ([le()],kw);var hRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let $L=class extends ni{singleQuickAction(e){if(m.isWithEditableLabel(e)&&e.editableLabel)return{icon:B.Label,title:"Edit Label (L)",location:"Middle",sorting:"C",action:m.EditLabelAction.create(e.editableLabel.id),shortcut:"KeyL"}}};$L=hRe([le()],$L);const nQ=new m.FeatureModule((n,e,t)=>{m.configureCommand({bind:n,isBound:t},m.ApplyLabelEditCommand),n(m.TYPES.IEditLabelValidator).to(m.ServerEditLabelValidator),n(m.TYPES.IEditLabelValidationDecorator).to(m.BalloonLabelValidationDecorator),m.bindAsService(n,m.TYPES.IDefaultTool,NL),n(Ue.QuickActionProvider).to($L)},{featureId:m.labelEditModule.featureId}),iQ=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.configureActionHandler(i,m.EditLabelAction.KIND,BL),m.bindAsService(i,m.TYPES.IUIExtension,kw)},{featureId:m.labelEditUiModule.featureId});var oQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},rQ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},sQ=function(n,e){return function(t,i){e(t,i,n)}},$s,i_,kL;(function(n){function e(t){return{kind:Fw.KIND,...t}}n.create=e})(kL||(kL={}));var xs;let Fw=(xs=class extends m.Command{constructor(t){super();k(this,"action");k(this,"executed",[]);k(this,"failed",[]);k(this,"lastExecutedElement");this.action=t}execute(t){var o;const i=t.root;return this.lastExecutedElement=i.index.getById(this.action.lastExecutedElementId),(o=this.action.oldElementExecutions)==null||o.forEach(r=>{const s=i.index.getById(r.elementId);if(s instanceof m.GChildElement&&Nw(s)){uz(s,0);const a=r.failed?$s.FAILED_CSS_CLASS:$s.EXECUTED_CSS_CLASS;m.removeCssClasses(s,a)}}),this.action.elementExecutions.forEach(r=>{const s=i.index.getById(r.elementId);s instanceof m.GChildElement&&Nw(s)&&(uz(s,r.count),r.failed?this.failed.push(s):this.executed.push(s))}),this.redo(t)}undo(t){return m.removeCssClassOfElements(this.executed,$s.EXECUTED_CSS_CLASS),m.removeCssClassOfElements(this.failed,$s.FAILED_CSS_CLASS),t.root}redo(t){return m.addCssClassToElements(this.executed,$s.EXECUTED_CSS_CLASS),m.addCssClassToElements(this.failed,$s.FAILED_CSS_CLASS),m.removeCssClassOfElements(this.executed,$s.LAST_EXECUTED_CSS_CLASS),this.lastExecutedElement&&m.addCssClasses(this.lastExecutedElement,$s.LAST_EXECUTED_CSS_CLASS),t.root}},$s=xs,k(xs,"KIND","executedFeedbackCommand"),k(xs,"EXECUTED_CSS_CLASS","executed"),k(xs,"LAST_EXECUTED_CSS_CLASS","last"),k(xs,"FAILED_CSS_CLASS","failed"),xs);Fw=$s=oQ([le(),sQ(0,_e(m.TYPES.Action)),rQ("design:paramtypes",[Object])],Fw);var FL;(function(n){function e(t){return{kind:xw.KIND,...t}}n.create=e})(FL||(FL={}));var Ld;let xw=(Ld=class extends m.Command{constructor(t){super();k(this,"action");k(this,"stoppedElement");this.action=t}execute(t){const i=t.root,o=i.index.getById(this.action.oldStoppedElement);o instanceof m.GChildElement&&Nw(o)&&m.removeCssClasses(o,i_.STOPPED_CSS_CLASS);const r=i.index.getById(this.action.stoppedElement??"");return r instanceof m.GChildElement&&Nw(r)&&(this.stoppedElement=r),this.redo(t)}undo(t){return m.removeCssClasses(this.stoppedElement,i_.STOPPED_CSS_CLASS),t.root}redo(t){return m.addCssClasses(this.stoppedElement,i_.STOPPED_CSS_CLASS),t.root}},i_=Ld,k(Ld,"KIND","stoppedFeedbackCommand"),k(Ld,"STOPPED_CSS_CLASS","stopped"),Ld);xw=i_=oQ([le(),sQ(0,_e(m.TYPES.Action)),rQ("design:paramtypes",[Object])],xw);function uz(n,e){n.executionCount=e}var fh=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},fS=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let bf=class{constructor(){k(this,"feedbackDispatcher");k(this,"actionDispatcher");k(this,"modelInitializationConstraint");k(this,"oldExecutions")}handle(e){if(Rw.is(e)){const t=kL.create({oldElementExecutions:this.oldExecutions,elementExecutions:e.elementExecutions,lastExecutedElementId:e.lastExecutedElementId});this.modelInitializationConstraint.onInitialized(()=>{e.elementExecutions.length>0?this.feedbackDispatcher.registerFeedback(this,[t]):this.feedbackDispatcher.deregisterFeedback(this,[t]),this.oldExecutions=e.elementExecutions})}}};fh([_e(m.TYPES.IFeedbackActionDispatcher),fS("design:type",Object)],bf.prototype,"feedbackDispatcher",void 0);fh([_e(m.TYPES.IActionDispatcher),fS("design:type",Object)],bf.prototype,"actionDispatcher",void 0);fh([_e(m.ModelInitializationConstraint),fS("design:type",m.ModelInitializationConstraint)],bf.prototype,"modelInitializationConstraint",void 0);bf=fh([le()],bf);let zm=class{constructor(){k(this,"feedbackDispatcher");k(this,"actionDispatcher");k(this,"oldStoppedElement")}handle(e){if(Mw.is(e)){const t=FL.create({oldStoppedElement:this.oldStoppedElement,stoppedElement:e.elementId});e.elementId&&e.elementId.length>0?this.feedbackDispatcher.registerFeedback(this,[t]):this.feedbackDispatcher.deregisterFeedback(this,[t]),this.oldStoppedElement=e.elementId??""}}};fh([_e(m.TYPES.IFeedbackActionDispatcher),fS("design:type",Object)],zm.prototype,"feedbackDispatcher",void 0);fh([_e(m.TYPES.IActionDispatcher),fS("design:type",Object)],zm.prototype,"actionDispatcher",void 0);zm=fh([le()],zm);const pRe=new m.FeatureModule((n,e,t)=>{n(bf).toSelf().inSingletonScope(),n(zm).toSelf().inSingletonScope(),m.configureActionHandler({bind:n,isBound:t},Rw.KIND,bf),m.configureActionHandler({bind:n,isBound:t},Mw.KIND,zm),m.configureCommand({bind:n,isBound:t},Fw),m.configureCommand({bind:n,isBound:t},xw)});var aQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},mRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Hw=class extends m.GLSPCommandStack{constructor(){super(...arguments);k(this,"actionDispatcher")}undo(){return this.actionDispatcher().then(t=>t.dispatch(m.UndoAction.create())),this.thenUpdate()}redo(){return this.actionDispatcher().then(t=>t.dispatch(m.RedoAction.create())),this.thenUpdate()}};aQ([_e(m.TYPES.IActionDispatcherProvider),mRe("design:type",Function)],Hw.prototype,"actionDispatcher",void 0);Hw=aQ([le()],Hw);var SM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cQ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let o0=class{constructor(){k(this,"actionDispatcher");k(this,"editorContext");k(this,"jumpStack",new Map)}handle(e){if(yf.is(e)&&!e.noViewportUpdate)return this.updateViewport(e),ct.SelectAllAction.create(!1)}updateViewport(e){const t=this.editorContext.modelRoot;if(e.elementId===""){const i=this.jumpStack.get(t.id.substring(0,t.id.lastIndexOf("-")));i&&this.actionDispatcher.dispatch(m.SetViewportAction.create(t.id,i,{animate:!1}))}else m.isViewport(t)&&this.jumpStack.set(this.editorContext.modelRoot.id,t)}};SM([_e(m.TYPES.IActionDispatcher),cQ("design:type",m.GLSPActionDispatcher)],o0.prototype,"actionDispatcher",void 0);SM([_e(m.EditorContextService),cQ("design:type",m.EditorContextService)],o0.prototype,"editorContext",void 0);o0=SM([le()],o0);let xL=class extends ni{singleQuickAction(e){if(YAe(e))return{icon:B.SubStart,title:"Jump (J)",location:"Middle",sorting:"A",action:yf.create({elementId:e.id}),readonlySupport:!0,shortcut:"KeyJ"}}};xL=SM([le()],xL);function Tr(n,e){const t=n?["ivy",`ivy-${n}`]:[];return e&&t.push(...e),Ae("i",t)}function Ae(n,e){const t=document.createElement(n);return e&&t.classList.add(...e),t}class gRe{constructor(e,t){k(this,"state");k(this,"onclick");k(this,"input");this.state=e,this.onclick=t}create(){const e=Ae("label",["switch"]);return this.input=document.createElement("input"),this.input.type="checkbox",this.input.checked=this.state,this.input.onchange=t=>{var o;const i=((o=this.input)==null?void 0:o.checked)??!this.state;this.state=i,this.onclick(i)},e.appendChild(this.input),e.appendChild(Ae("span",["slider","round"])),e}switch(){var e;this.input&&(this.input.checked=!this.state,(e=this.input)==null||e.dispatchEvent(new UIEvent("change")))}}var Qc=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ac=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},HL,Ml;let Ca=(Ml=class extends m.GLSPAbstractUIExtension{constructor(){super(...arguments);k(this,"actionDispatcher");k(this,"feedbackDispatcher");k(this,"selectionService");k(this,"editorContext")}id(){return HL.ID}containerClass(){return"jump-out-container"}postConstruct(){this.feedbackDispatcher.registerFeedback(this,[KL.create()])}initializeContents(t){t.style.position="absolute"}onBeforeShow(t,i,...o){t.innerHTML="";const r=Ae("div",["jump-out-btn"]);r.title="Jump out (J)",r.appendChild(Tr(B.JumpOut)),r.onclick=s=>this.actionDispatcher.dispatch(yf.create({elementId:""})),t.appendChild(r)}},HL=Ml,k(Ml,"ID","jumpOutUi"),Ml);Qc([_e(m.TYPES.IActionDispatcher),ac("design:type",Object)],Ca.prototype,"actionDispatcher",void 0);Qc([_e(m.TYPES.IFeedbackActionDispatcher),ac("design:type",Object)],Ca.prototype,"feedbackDispatcher",void 0);Qc([_e(m.SelectionService),ac("design:type",m.SelectionService)],Ca.prototype,"selectionService",void 0);Qc([_e(m.EditorContextService),ac("design:type",m.EditorContextService)],Ca.prototype,"editorContext",void 0);Qc([p0(),ac("design:type",Function),ac("design:paramtypes",[]),ac("design:returntype",void 0)],Ca.prototype,"postConstruct",null);Ca=HL=Qc([le()],Ca);var KL;(function(n){function e(t){return{kind:Gm.KIND,elementId:t}}n.create=e})(KL||(KL={}));var IT;let Gm=(IT=class extends m.FeedbackCommand{constructor(){super(...arguments);k(this,"action");k(this,"actionDispatcher")}execute(t){return this.actionDispatcher.dispatch(m.SetUIExtensionVisibilityAction.create({extensionId:Ca.ID,visible:this.showJumpOutBtn(t.root)})),t.root}showJumpOutBtn(t){return t.id.includes("-")}},k(IT,"KIND","toolPaletteFeedback"),IT);Qc([_e(m.TYPES.Action),ac("design:type",Object)],Gm.prototype,"action",void 0);Qc([_e(m.TYPES.IActionDispatcher),ac("design:type",Object)],Gm.prototype,"actionDispatcher",void 0);Gm=Qc([le()],Gm);const vRe=new m.FeatureModule((n,e,t)=>{n(Ca).toSelf().inSingletonScope(),n(m.TYPES.IUIExtension).toService(Ca),m.configureCommand({bind:n,isBound:t},Gm),n(Ue.QuickActionProvider).to(xL),m.configureActionHandler({bind:n,isBound:t},yf.KIND,o0)});function dQ(n){if(!n.source||!n.target)return n.bounds;const e=n.source,t=n.target,i=[],o={x:0,y:0,width:0,height:0};i.push(m.Bounds.translate(o,m.Bounds.center(e.bounds))),i.push(...n.routingPoints.map(a=>m.Bounds.translate(o,{x:a.x,y:a.y}))),i.push(m.Bounds.translate(o,m.Bounds.center(t.bounds)));let r=i.reduce((a,f)=>m.Bounds.combine(a,f)),s=n;for(;s instanceof m.GChildElement;){const a=s.parent;r=a.localToParent(r),s=a}return r}function _Re(n){let e=m.Bounds.translate(n.labelBounds,n.position),t=n;for(;t instanceof m.GChildElement;){const i=t.parent;e=i.localToParent(e),t=i}return e}var uQ={exports:{}};(function(n){(function(){function e(p){var b={omitExtraWLInCodeBlocks:{defaultValue:!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{defaultValue:!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{defaultValue:!1,describe:"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix",type:"string"},rawPrefixHeaderId:{defaultValue:!1,describe:'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',type:"boolean"},ghCompatibleHeaderId:{defaultValue:!1,describe:"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)",type:"boolean"},rawHeaderId:{defaultValue:!1,describe:`Remove only spaces, ' and " from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids`,type:"boolean"},headerLevelStart:{defaultValue:!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{defaultValue:!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{defaultValue:!1,describe:"Turn on/off GFM autolink style",type:"boolean"},excludeTrailingPunctuationFromURLs:{defaultValue:!1,describe:"Excludes trailing punctuation from links generated with autoLinking",type:"boolean"},literalMidWordUnderscores:{defaultValue:!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},literalMidWordAsterisks:{defaultValue:!1,describe:"Parse midword asterisks as literal asterisks",type:"boolean"},strikethrough:{defaultValue:!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{defaultValue:!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{defaultValue:!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{defaultValue:!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{defaultValue:!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{defaultValue:!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"},smartIndentationFix:{defaultValue:!1,describe:"Tries to smartly fix indentation in es6 strings",type:"boolean"},disableForced4SpacesIndentedSublists:{defaultValue:!1,describe:"Disables the requirement of indenting nested sublists by 4 spaces",type:"boolean"},simpleLineBreaks:{defaultValue:!1,describe:"Parses simple line breaks as <br> (GFM Style)",type:"boolean"},requireSpaceBeforeHeadingText:{defaultValue:!1,describe:"Makes adding a space between `#` and the header text mandatory (GFM Style)",type:"boolean"},ghMentions:{defaultValue:!1,describe:"Enables github @mentions",type:"boolean"},ghMentionsLink:{defaultValue:"https://github.com/{u}",describe:"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.",type:"string"},encodeEmails:{defaultValue:!0,describe:"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities",type:"boolean"},openLinksInNewWindow:{defaultValue:!1,describe:"Open all links in new windows",type:"boolean"},backslashEscapesHTMLTags:{defaultValue:!1,describe:"Support for HTML Tag escaping. ex: <div>foo</div>",type:"boolean"},emoji:{defaultValue:!1,describe:"Enable emoji support. Ex: `this is a :smile: emoji`",type:"boolean"},underline:{defaultValue:!1,describe:"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`",type:"boolean"},ellipsis:{defaultValue:!0,describe:"Replaces three dots with the ellipsis unicode character",type:"boolean"},completeHTMLDocument:{defaultValue:!1,describe:"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags",type:"boolean"},metadata:{defaultValue:!1,describe:"Enable support for document metadata (defined at the top of the document between `«««` and `»»»` or between `---` and `---`).",type:"boolean"},splitAdjacentBlockquotes:{defaultValue:!1,describe:"Split adjacent blockquote blocks",type:"boolean"}};if(p===!1)return JSON.parse(JSON.stringify(b));var v={};for(var R in b)b.hasOwnProperty(R)&&(v[R]=b[R].defaultValue);return v}function t(){var p=e(!0),b={};for(var v in p)p.hasOwnProperty(v)&&(b[v]=!0);return b}var i={},o={},r={},s=e(!0),a="vanilla",f={github:{omitExtraWLInCodeBlocks:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,disableForced4SpacesIndentedSublists:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghCompatibleHeaderId:!0,ghMentions:!0,backslashEscapesHTMLTags:!0,emoji:!0,splitAdjacentBlockquotes:!0},original:{noHeaderId:!0,ghCodeBlocks:!1},ghost:{omitExtraWLInCodeBlocks:!0,parseImgDimensions:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,smoothLivePreview:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghMentions:!1,encodeEmails:!0},vanilla:e(!0),allOn:t()};i.helper={},i.extensions={},i.setOption=function(p,b){return s[p]=b,this},i.getOption=function(p){return s[p]},i.getOptions=function(){return s},i.resetOptions=function(){s=e(!0)},i.setFlavor=function(p){if(!f.hasOwnProperty(p))throw Error(p+" flavor was not found");i.resetOptions();var b=f[p];a=p;for(var v in b)b.hasOwnProperty(v)&&(s[v]=b[v])},i.getFlavor=function(){return a},i.getFlavorOptions=function(p){if(f.hasOwnProperty(p))return f[p]},i.getDefaultOptions=function(p){return e(p)},i.subParser=function(p,b){if(i.helper.isString(p))if(typeof b<"u")o[p]=b;else{if(o.hasOwnProperty(p))return o[p];throw Error("SubParser named "+p+" not registered!")}},i.extension=function(p,b){if(!i.helper.isString(p))throw Error("Extension 'name' must be a string");if(p=i.helper.stdExtName(p),i.helper.isUndefined(b)){if(!r.hasOwnProperty(p))throw Error("Extension named "+p+" is not registered!");return r[p]}else{typeof b=="function"&&(b=b()),i.helper.isArray(b)||(b=[b]);var v=h(b,p);if(v.valid)r[p]=b;else throw Error(v.error)}},i.getAllExtensions=function(){return r},i.removeExtension=function(p){delete r[p]},i.resetExtensions=function(){r={}};function h(p,b){var v=b?"Error in "+b+" extension->":"Error in unnamed extension",R={valid:!0,error:""};i.helper.isArray(p)||(p=[p]);for(var O=0;O<p.length;++O){var N=v+" sub-extension "+O+": ",T=p[O];if(typeof T!="object")return R.valid=!1,R.error=N+"must be an object, but "+typeof T+" given",R;if(!i.helper.isString(T.type))return R.valid=!1,R.error=N+'property "type" must be a string, but '+typeof T.type+" given",R;var $=T.type=T.type.toLowerCase();if($==="language"&&($=T.type="lang"),$==="html"&&($=T.type="output"),$!=="lang"&&$!=="output"&&$!=="listener")return R.valid=!1,R.error=N+"type "+$+' is not recognized. Valid values: "lang/language", "output/html" or "listener"',R;if($==="listener"){if(i.helper.isUndefined(T.listeners))return R.valid=!1,R.error=N+'. Extensions of type "listener" must have a property called "listeners"',R}else if(i.helper.isUndefined(T.filter)&&i.helper.isUndefined(T.regex))return R.valid=!1,R.error=N+$+' extensions must define either a "regex" property or a "filter" method',R;if(T.listeners){if(typeof T.listeners!="object")return R.valid=!1,R.error=N+'"listeners" property must be an object but '+typeof T.listeners+" given",R;for(var Q in T.listeners)if(T.listeners.hasOwnProperty(Q)&&typeof T.listeners[Q]!="function")return R.valid=!1,R.error=N+'"listeners" property must be an hash of [event name]: [callback]. listeners.'+Q+" must be a function but "+typeof T.listeners[Q]+" given",R}if(T.filter){if(typeof T.filter!="function")return R.valid=!1,R.error=N+'"filter" must be a function, but '+typeof T.filter+" given",R}else if(T.regex){if(i.helper.isString(T.regex)&&(T.regex=new RegExp(T.regex,"g")),!(T.regex instanceof RegExp))return R.valid=!1,R.error=N+'"regex" property must either be a string or a RegExp object, but '+typeof T.regex+" given",R;if(i.helper.isUndefined(T.replace))return R.valid=!1,R.error=N+'"regex" extensions must implement a replace string or function',R}}return R}i.validateExtension=function(p){var b=h(p,null);return b.valid?!0:(console.warn(b.error),!1)},i.hasOwnProperty("helper")||(i.helper={}),i.helper.isString=function(p){return typeof p=="string"||p instanceof String},i.helper.isFunction=function(p){var b={};return p&&b.toString.call(p)==="[object Function]"},i.helper.isArray=function(p){return Array.isArray(p)},i.helper.isUndefined=function(p){return typeof p>"u"},i.helper.forEach=function(p,b){if(i.helper.isUndefined(p))throw new Error("obj param is required");if(i.helper.isUndefined(b))throw new Error("callback param is required");if(!i.helper.isFunction(b))throw new Error("callback param must be a function/closure");if(typeof p.forEach=="function")p.forEach(b);else if(i.helper.isArray(p))for(var v=0;v<p.length;v++)b(p[v],v,p);else if(typeof p=="object")for(var R in p)p.hasOwnProperty(R)&&b(p[R],R,p);else throw new Error("obj does not seem to be an array or an iterable object")},i.helper.stdExtName=function(p){return p.replace(/[_?*+\/\\.^-]/g,"").replace(/\s/g,"").toLowerCase()};function g(p,b){var v=b.charCodeAt(0);return"¨E"+v+"E"}i.helper.escapeCharactersCallback=g,i.helper.escapeCharacters=function(p,b,v){var R="(["+b.replace(/([\[\]\\])/g,"\\$1")+"])";v&&(R="\\\\"+R);var O=new RegExp(R,"g");return p=p.replace(O,g),p},i.helper.unescapeHTMLEntities=function(p){return p.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};var y=function(p,b,v,R){var O=R||"",N=O.indexOf("g")>-1,T=new RegExp(b+"|"+v,"g"+O.replace(/g/g,"")),$=new RegExp(b,O.replace(/g/g,"")),Q=[],K,Z,H,M,Y;do for(K=0;H=T.exec(p);)if($.test(H[0]))K++||(Z=T.lastIndex,M=Z-H[0].length);else if(K&&!--K){Y=H.index+H[0].length;var te={left:{start:M,end:Z},match:{start:Z,end:H.index},right:{start:H.index,end:Y},wholeMatch:{start:M,end:Y}};if(Q.push(te),!N)return Q}while(K&&(T.lastIndex=Z));return Q};i.helper.matchRecursiveRegExp=function(p,b,v,R){for(var O=y(p,b,v,R),N=[],T=0;T<O.length;++T)N.push([p.slice(O[T].wholeMatch.start,O[T].wholeMatch.end),p.slice(O[T].match.start,O[T].match.end),p.slice(O[T].left.start,O[T].left.end),p.slice(O[T].right.start,O[T].right.end)]);return N},i.helper.replaceRecursiveRegExp=function(p,b,v,R,O){if(!i.helper.isFunction(b)){var N=b;b=function(){return N}}var T=y(p,v,R,O),$=p,Q=T.length;if(Q>0){var K=[];T[0].wholeMatch.start!==0&&K.push(p.slice(0,T[0].wholeMatch.start));for(var Z=0;Z<Q;++Z)K.push(b(p.slice(T[Z].wholeMatch.start,T[Z].wholeMatch.end),p.slice(T[Z].match.start,T[Z].match.end),p.slice(T[Z].left.start,T[Z].left.end),p.slice(T[Z].right.start,T[Z].right.end))),Z<Q-1&&K.push(p.slice(T[Z].wholeMatch.end,T[Z+1].wholeMatch.start));T[Q-1].wholeMatch.end<p.length&&K.push(p.slice(T[Q-1].wholeMatch.end)),$=K.join("")}return $},i.helper.regexIndexOf=function(p,b,v){if(!i.helper.isString(p))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";if(!(b instanceof RegExp))throw"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp";var R=p.substring(v||0).search(b);return R>=0?R+(v||0):R},i.helper.splitAtIndex=function(p,b){if(!i.helper.isString(p))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";return[p.substring(0,b),p.substring(b)]},i.helper.encodeEmailAddress=function(p){var b=[function(v){return"&#"+v.charCodeAt(0)+";"},function(v){return"&#x"+v.charCodeAt(0).toString(16)+";"},function(v){return v}];return p=p.replace(/./g,function(v){if(v==="@")v=b[Math.floor(Math.random()*2)](v);else{var R=Math.random();v=R>.9?b[2](v):R>.45?b[1](v):b[0](v)}return v}),p},i.helper.padEnd=function(b,v,R){return v=v>>0,R=String(R||" "),b.length>v?String(b):(v=v-b.length,v>R.length&&(R+=R.repeat(v/R.length)),String(b)+R.slice(0,v))},typeof console>"u"&&(console={warn:function(p){alert(p)},log:function(p){alert(p)},error:function(p){throw p}}),i.helper.regexes={asteriskDashAndColon:/([*_:~])/g},i.helper.emojis={"+1":"👍","-1":"👎",100:"💯",1234:"🔢","1st_place_medal":"🥇","2nd_place_medal":"🥈","3rd_place_medal":"🥉","8ball":"🎱",a:"🅰️",ab:"🆎",abc:"🔤",abcd:"🔡",accept:"🉑",aerial_tramway:"🚡",airplane:"✈️",alarm_clock:"⏰",alembic:"⚗️",alien:"👽",ambulance:"🚑",amphora:"🏺",anchor:"⚓️",angel:"👼",anger:"💢",angry:"😠",anguished:"😧",ant:"🐜",apple:"🍎",aquarius:"♒️",aries:"♈️",arrow_backward:"◀️",arrow_double_down:"⏬",arrow_double_up:"⏫",arrow_down:"⬇️",arrow_down_small:"🔽",arrow_forward:"▶️",arrow_heading_down:"⤵️",arrow_heading_up:"⤴️",arrow_left:"⬅️",arrow_lower_left:"↙️",arrow_lower_right:"↘️",arrow_right:"➡️",arrow_right_hook:"↪️",arrow_up:"⬆️",arrow_up_down:"↕️",arrow_up_small:"🔼",arrow_upper_left:"↖️",arrow_upper_right:"↗️",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",art:"🎨",articulated_lorry:"🚛",artificial_satellite:"🛰",astonished:"😲",athletic_shoe:"👟",atm:"🏧",atom_symbol:"⚛️",avocado:"🥑",b:"🅱️",baby:"👶",baby_bottle:"🍼",baby_chick:"🐤",baby_symbol:"🚼",back:"🔙",bacon:"🥓",badminton:"🏸",baggage_claim:"🛄",baguette_bread:"🥖",balance_scale:"⚖️",balloon:"🎈",ballot_box:"🗳",ballot_box_with_check:"☑️",bamboo:"🎍",banana:"🍌",bangbang:"‼️",bank:"🏦",bar_chart:"📊",barber:"💈",baseball:"⚾️",basketball:"🏀",basketball_man:"⛹️",basketball_woman:"⛹️&zwj;♀️",bat:"🦇",bath:"🛀",bathtub:"🛁",battery:"🔋",beach_umbrella:"🏖",bear:"🐻",bed:"🛏",bee:"🐝",beer:"🍺",beers:"🍻",beetle:"🐞",beginner:"🔰",bell:"🔔",bellhop_bell:"🛎",bento:"🍱",biking_man:"🚴",bike:"🚲",biking_woman:"🚴&zwj;♀️",bikini:"👙",biohazard:"☣️",bird:"🐦",birthday:"🎂",black_circle:"⚫️",black_flag:"🏴",black_heart:"🖤",black_joker:"🃏",black_large_square:"⬛️",black_medium_small_square:"◾️",black_medium_square:"◼️",black_nib:"✒️",black_small_square:"▪️",black_square_button:"🔲",blonde_man:"👱",blonde_woman:"👱&zwj;♀️",blossom:"🌼",blowfish:"🐡",blue_book:"📘",blue_car:"🚙",blue_heart:"💙",blush:"😊",boar:"🐗",boat:"⛵️",bomb:"💣",book:"📖",bookmark:"🔖",bookmark_tabs:"📑",books:"📚",boom:"💥",boot:"👢",bouquet:"💐",bowing_man:"🙇",bow_and_arrow:"🏹",bowing_woman:"🙇&zwj;♀️",bowling:"🎳",boxing_glove:"🥊",boy:"👦",bread:"🍞",bride_with_veil:"👰",bridge_at_night:"🌉",briefcase:"💼",broken_heart:"💔",bug:"🐛",building_construction:"🏗",bulb:"💡",bullettrain_front:"🚅",bullettrain_side:"🚄",burrito:"🌯",bus:"🚌",business_suit_levitating:"🕴",busstop:"🚏",bust_in_silhouette:"👤",busts_in_silhouette:"👥",butterfly:"🦋",cactus:"🌵",cake:"🍰",calendar:"📆",call_me_hand:"🤙",calling:"📲",camel:"🐫",camera:"📷",camera_flash:"📸",camping:"🏕",cancer:"♋️",candle:"🕯",candy:"🍬",canoe:"🛶",capital_abcd:"🔠",capricorn:"♑️",car:"🚗",card_file_box:"🗃",card_index:"📇",card_index_dividers:"🗂",carousel_horse:"🎠",carrot:"🥕",cat:"🐱",cat2:"🐈",cd:"💿",chains:"⛓",champagne:"🍾",chart:"💹",chart_with_downwards_trend:"📉",chart_with_upwards_trend:"📈",checkered_flag:"🏁",cheese:"🧀",cherries:"🍒",cherry_blossom:"🌸",chestnut:"🌰",chicken:"🐔",children_crossing:"🚸",chipmunk:"🐿",chocolate_bar:"🍫",christmas_tree:"🎄",church:"⛪️",cinema:"🎦",circus_tent:"🎪",city_sunrise:"🌇",city_sunset:"🌆",cityscape:"🏙",cl:"🆑",clamp:"🗜",clap:"👏",clapper:"🎬",classical_building:"🏛",clinking_glasses:"🥂",clipboard:"📋",clock1:"🕐",clock10:"🕙",clock1030:"🕥",clock11:"🕚",clock1130:"🕦",clock12:"🕛",clock1230:"🕧",clock130:"🕜",clock2:"🕑",clock230:"🕝",clock3:"🕒",clock330:"🕞",clock4:"🕓",clock430:"🕟",clock5:"🕔",clock530:"🕠",clock6:"🕕",clock630:"🕡",clock7:"🕖",clock730:"🕢",clock8:"🕗",clock830:"🕣",clock9:"🕘",clock930:"🕤",closed_book:"📕",closed_lock_with_key:"🔐",closed_umbrella:"🌂",cloud:"☁️",cloud_with_lightning:"🌩",cloud_with_lightning_and_rain:"⛈",cloud_with_rain:"🌧",cloud_with_snow:"🌨",clown_face:"🤡",clubs:"♣️",cocktail:"🍸",coffee:"☕️",coffin:"⚰️",cold_sweat:"😰",comet:"☄️",computer:"💻",computer_mouse:"🖱",confetti_ball:"🎊",confounded:"😖",confused:"😕",congratulations:"㊗️",construction:"🚧",construction_worker_man:"👷",construction_worker_woman:"👷&zwj;♀️",control_knobs:"🎛",convenience_store:"🏪",cookie:"🍪",cool:"🆒",policeman:"👮",copyright:"©️",corn:"🌽",couch_and_lamp:"🛋",couple:"👫",couple_with_heart_woman_man:"💑",couple_with_heart_man_man:"👨&zwj;❤️&zwj;👨",couple_with_heart_woman_woman:"👩&zwj;❤️&zwj;👩",couplekiss_man_man:"👨&zwj;❤️&zwj;💋&zwj;👨",couplekiss_man_woman:"💏",couplekiss_woman_woman:"👩&zwj;❤️&zwj;💋&zwj;👩",cow:"🐮",cow2:"🐄",cowboy_hat_face:"🤠",crab:"🦀",crayon:"🖍",credit_card:"💳",crescent_moon:"🌙",cricket:"🏏",crocodile:"🐊",croissant:"🥐",crossed_fingers:"🤞",crossed_flags:"🎌",crossed_swords:"⚔️",crown:"👑",cry:"😢",crying_cat_face:"😿",crystal_ball:"🔮",cucumber:"🥒",cupid:"💘",curly_loop:"➰",currency_exchange:"💱",curry:"🍛",custard:"🍮",customs:"🛃",cyclone:"🌀",dagger:"🗡",dancer:"💃",dancing_women:"👯",dancing_men:"👯&zwj;♂️",dango:"🍡",dark_sunglasses:"🕶",dart:"🎯",dash:"💨",date:"📅",deciduous_tree:"🌳",deer:"🦌",department_store:"🏬",derelict_house:"🏚",desert:"🏜",desert_island:"🏝",desktop_computer:"🖥",male_detective:"🕵️",diamond_shape_with_a_dot_inside:"💠",diamonds:"♦️",disappointed:"😞",disappointed_relieved:"😥",dizzy:"💫",dizzy_face:"😵",do_not_litter:"🚯",dog:"🐶",dog2:"🐕",dollar:"💵",dolls:"🎎",dolphin:"🐬",door:"🚪",doughnut:"🍩",dove:"🕊",dragon:"🐉",dragon_face:"🐲",dress:"👗",dromedary_camel:"🐪",drooling_face:"🤤",droplet:"💧",drum:"🥁",duck:"🦆",dvd:"📀","e-mail":"📧",eagle:"🦅",ear:"👂",ear_of_rice:"🌾",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",egg:"🥚",eggplant:"🍆",eight_pointed_black_star:"✴️",eight_spoked_asterisk:"✳️",electric_plug:"🔌",elephant:"🐘",email:"✉️",end:"🔚",envelope_with_arrow:"📩",euro:"💶",european_castle:"🏰",european_post_office:"🏤",evergreen_tree:"🌲",exclamation:"❗️",expressionless:"😑",eye:"👁",eye_speech_bubble:"👁&zwj;🗨",eyeglasses:"👓",eyes:"👀",face_with_head_bandage:"🤕",face_with_thermometer:"🤒",fist_oncoming:"👊",factory:"🏭",fallen_leaf:"🍂",family_man_woman_boy:"👪",family_man_boy:"👨&zwj;👦",family_man_boy_boy:"👨&zwj;👦&zwj;👦",family_man_girl:"👨&zwj;👧",family_man_girl_boy:"👨&zwj;👧&zwj;👦",family_man_girl_girl:"👨&zwj;👧&zwj;👧",family_man_man_boy:"👨&zwj;👨&zwj;👦",family_man_man_boy_boy:"👨&zwj;👨&zwj;👦&zwj;👦",family_man_man_girl:"👨&zwj;👨&zwj;👧",family_man_man_girl_boy:"👨&zwj;👨&zwj;👧&zwj;👦",family_man_man_girl_girl:"👨&zwj;👨&zwj;👧&zwj;👧",family_man_woman_boy_boy:"👨&zwj;👩&zwj;👦&zwj;👦",family_man_woman_girl:"👨&zwj;👩&zwj;👧",family_man_woman_girl_boy:"👨&zwj;👩&zwj;👧&zwj;👦",family_man_woman_girl_girl:"👨&zwj;👩&zwj;👧&zwj;👧",family_woman_boy:"👩&zwj;👦",family_woman_boy_boy:"👩&zwj;👦&zwj;👦",family_woman_girl:"👩&zwj;👧",family_woman_girl_boy:"👩&zwj;👧&zwj;👦",family_woman_girl_girl:"👩&zwj;👧&zwj;👧",family_woman_woman_boy:"👩&zwj;👩&zwj;👦",family_woman_woman_boy_boy:"👩&zwj;👩&zwj;👦&zwj;👦",family_woman_woman_girl:"👩&zwj;👩&zwj;👧",family_woman_woman_girl_boy:"👩&zwj;👩&zwj;👧&zwj;👦",family_woman_woman_girl_girl:"👩&zwj;👩&zwj;👧&zwj;👧",fast_forward:"⏩",fax:"📠",fearful:"😨",feet:"🐾",female_detective:"🕵️&zwj;♀️",ferris_wheel:"🎡",ferry:"⛴",field_hockey:"🏑",file_cabinet:"🗄",file_folder:"📁",film_projector:"📽",film_strip:"🎞",fire:"🔥",fire_engine:"🚒",fireworks:"🎆",first_quarter_moon:"🌓",first_quarter_moon_with_face:"🌛",fish:"🐟",fish_cake:"🍥",fishing_pole_and_fish:"🎣",fist_raised:"✊",fist_left:"🤛",fist_right:"🤜",flags:"🎏",flashlight:"🔦",fleur_de_lis:"⚜️",flight_arrival:"🛬",flight_departure:"🛫",floppy_disk:"💾",flower_playing_cards:"🎴",flushed:"😳",fog:"🌫",foggy:"🌁",football:"🏈",footprints:"👣",fork_and_knife:"🍴",fountain:"⛲️",fountain_pen:"🖋",four_leaf_clover:"🍀",fox_face:"🦊",framed_picture:"🖼",free:"🆓",fried_egg:"🍳",fried_shrimp:"🍤",fries:"🍟",frog:"🐸",frowning:"😦",frowning_face:"☹️",frowning_man:"🙍&zwj;♂️",frowning_woman:"🙍",middle_finger:"🖕",fuelpump:"⛽️",full_moon:"🌕",full_moon_with_face:"🌝",funeral_urn:"⚱️",game_die:"🎲",gear:"⚙️",gem:"💎",gemini:"♊️",ghost:"👻",gift:"🎁",gift_heart:"💝",girl:"👧",globe_with_meridians:"🌐",goal_net:"🥅",goat:"🐐",golf:"⛳️",golfing_man:"🏌️",golfing_woman:"🏌️&zwj;♀️",gorilla:"🦍",grapes:"🍇",green_apple:"🍏",green_book:"📗",green_heart:"💚",green_salad:"🥗",grey_exclamation:"❕",grey_question:"❔",grimacing:"😬",grin:"😁",grinning:"😀",guardsman:"💂",guardswoman:"💂&zwj;♀️",guitar:"🎸",gun:"🔫",haircut_woman:"💇",haircut_man:"💇&zwj;♂️",hamburger:"🍔",hammer:"🔨",hammer_and_pick:"⚒",hammer_and_wrench:"🛠",hamster:"🐹",hand:"✋",handbag:"👜",handshake:"🤝",hankey:"💩",hatched_chick:"🐥",hatching_chick:"🐣",headphones:"🎧",hear_no_evil:"🙉",heart:"❤️",heart_decoration:"💟",heart_eyes:"😍",heart_eyes_cat:"😻",heartbeat:"💓",heartpulse:"💗",hearts:"♥️",heavy_check_mark:"✔️",heavy_division_sign:"➗",heavy_dollar_sign:"💲",heavy_heart_exclamation:"❣️",heavy_minus_sign:"➖",heavy_multiplication_x:"✖️",heavy_plus_sign:"➕",helicopter:"🚁",herb:"🌿",hibiscus:"🌺",high_brightness:"🔆",high_heel:"👠",hocho:"🔪",hole:"🕳",honey_pot:"🍯",horse:"🐴",horse_racing:"🏇",hospital:"🏥",hot_pepper:"🌶",hotdog:"🌭",hotel:"🏨",hotsprings:"♨️",hourglass:"⌛️",hourglass_flowing_sand:"⏳",house:"🏠",house_with_garden:"🏡",houses:"🏘",hugs:"🤗",hushed:"😯",ice_cream:"🍨",ice_hockey:"🏒",ice_skate:"⛸",icecream:"🍦",id:"🆔",ideograph_advantage:"🉐",imp:"👿",inbox_tray:"📥",incoming_envelope:"📨",tipping_hand_woman:"💁",information_source:"ℹ️",innocent:"😇",interrobang:"⁉️",iphone:"📱",izakaya_lantern:"🏮",jack_o_lantern:"🎃",japan:"🗾",japanese_castle:"🏯",japanese_goblin:"👺",japanese_ogre:"👹",jeans:"👖",joy:"😂",joy_cat:"😹",joystick:"🕹",kaaba:"🕋",key:"🔑",keyboard:"⌨️",keycap_ten:"🔟",kick_scooter:"🛴",kimono:"👘",kiss:"💋",kissing:"😗",kissing_cat:"😽",kissing_closed_eyes:"😚",kissing_heart:"😘",kissing_smiling_eyes:"😙",kiwi_fruit:"🥝",koala:"🐨",koko:"🈁",label:"🏷",large_blue_circle:"🔵",large_blue_diamond:"🔷",large_orange_diamond:"🔶",last_quarter_moon:"🌗",last_quarter_moon_with_face:"🌜",latin_cross:"✝️",laughing:"😆",leaves:"🍃",ledger:"📒",left_luggage:"🛅",left_right_arrow:"↔️",leftwards_arrow_with_hook:"↩️",lemon:"🍋",leo:"♌️",leopard:"🐆",level_slider:"🎚",libra:"♎️",light_rail:"🚈",link:"🔗",lion:"🦁",lips:"👄",lipstick:"💄",lizard:"🦎",lock:"🔒",lock_with_ink_pen:"🔏",lollipop:"🍭",loop:"➿",loud_sound:"🔊",loudspeaker:"📢",love_hotel:"🏩",love_letter:"💌",low_brightness:"🔅",lying_face:"🤥",m:"Ⓜ️",mag:"🔍",mag_right:"🔎",mahjong:"🀄️",mailbox:"📫",mailbox_closed:"📪",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",man:"👨",man_artist:"👨&zwj;🎨",man_astronaut:"👨&zwj;🚀",man_cartwheeling:"🤸&zwj;♂️",man_cook:"👨&zwj;🍳",man_dancing:"🕺",man_facepalming:"🤦&zwj;♂️",man_factory_worker:"👨&zwj;🏭",man_farmer:"👨&zwj;🌾",man_firefighter:"👨&zwj;🚒",man_health_worker:"👨&zwj;⚕️",man_in_tuxedo:"🤵",man_judge:"👨&zwj;⚖️",man_juggling:"🤹&zwj;♂️",man_mechanic:"👨&zwj;🔧",man_office_worker:"👨&zwj;💼",man_pilot:"👨&zwj;✈️",man_playing_handball:"🤾&zwj;♂️",man_playing_water_polo:"🤽&zwj;♂️",man_scientist:"👨&zwj;🔬",man_shrugging:"🤷&zwj;♂️",man_singer:"👨&zwj;🎤",man_student:"👨&zwj;🎓",man_teacher:"👨&zwj;🏫",man_technologist:"👨&zwj;💻",man_with_gua_pi_mao:"👲",man_with_turban:"👳",tangerine:"🍊",mans_shoe:"👞",mantelpiece_clock:"🕰",maple_leaf:"🍁",martial_arts_uniform:"🥋",mask:"😷",massage_woman:"💆",massage_man:"💆&zwj;♂️",meat_on_bone:"🍖",medal_military:"🎖",medal_sports:"🏅",mega:"📣",melon:"🍈",memo:"📝",men_wrestling:"🤼&zwj;♂️",menorah:"🕎",mens:"🚹",metal:"🤘",metro:"🚇",microphone:"🎤",microscope:"🔬",milk_glass:"🥛",milky_way:"🌌",minibus:"🚐",minidisc:"💽",mobile_phone_off:"📴",money_mouth_face:"🤑",money_with_wings:"💸",moneybag:"💰",monkey:"🐒",monkey_face:"🐵",monorail:"🚝",moon:"🌔",mortar_board:"🎓",mosque:"🕌",motor_boat:"🛥",motor_scooter:"🛵",motorcycle:"🏍",motorway:"🛣",mount_fuji:"🗻",mountain:"⛰",mountain_biking_man:"🚵",mountain_biking_woman:"🚵&zwj;♀️",mountain_cableway:"🚠",mountain_railway:"🚞",mountain_snow:"🏔",mouse:"🐭",mouse2:"🐁",movie_camera:"🎥",moyai:"🗿",mrs_claus:"🤶",muscle:"💪",mushroom:"🍄",musical_keyboard:"🎹",musical_note:"🎵",musical_score:"🎼",mute:"🔇",nail_care:"💅",name_badge:"📛",national_park:"🏞",nauseated_face:"🤢",necktie:"👔",negative_squared_cross_mark:"❎",nerd_face:"🤓",neutral_face:"😐",new:"🆕",new_moon:"🌑",new_moon_with_face:"🌚",newspaper:"📰",newspaper_roll:"🗞",next_track_button:"⏭",ng:"🆖",no_good_man:"🙅&zwj;♂️",no_good_woman:"🙅",night_with_stars:"🌃",no_bell:"🔕",no_bicycles:"🚳",no_entry:"⛔️",no_entry_sign:"🚫",no_mobile_phones:"📵",no_mouth:"😶",no_pedestrians:"🚷",no_smoking:"🚭","non-potable_water":"🚱",nose:"👃",notebook:"📓",notebook_with_decorative_cover:"📔",notes:"🎶",nut_and_bolt:"🔩",o:"⭕️",o2:"🅾️",ocean:"🌊",octopus:"🐙",oden:"🍢",office:"🏢",oil_drum:"🛢",ok:"🆗",ok_hand:"👌",ok_man:"🙆&zwj;♂️",ok_woman:"🙆",old_key:"🗝",older_man:"👴",older_woman:"👵",om:"🕉",on:"🔛",oncoming_automobile:"🚘",oncoming_bus:"🚍",oncoming_police_car:"🚔",oncoming_taxi:"🚖",open_file_folder:"📂",open_hands:"👐",open_mouth:"😮",open_umbrella:"☂️",ophiuchus:"⛎",orange_book:"📙",orthodox_cross:"☦️",outbox_tray:"📤",owl:"🦉",ox:"🐂",package:"📦",page_facing_up:"📄",page_with_curl:"📃",pager:"📟",paintbrush:"🖌",palm_tree:"🌴",pancakes:"🥞",panda_face:"🐼",paperclip:"📎",paperclips:"🖇",parasol_on_ground:"⛱",parking:"🅿️",part_alternation_mark:"〽️",partly_sunny:"⛅️",passenger_ship:"🛳",passport_control:"🛂",pause_button:"⏸",peace_symbol:"☮️",peach:"🍑",peanuts:"🥜",pear:"🍐",pen:"🖊",pencil2:"✏️",penguin:"🐧",pensive:"😔",performing_arts:"🎭",persevere:"😣",person_fencing:"🤺",pouting_woman:"🙎",phone:"☎️",pick:"⛏",pig:"🐷",pig2:"🐖",pig_nose:"🐽",pill:"💊",pineapple:"🍍",ping_pong:"🏓",pisces:"♓️",pizza:"🍕",place_of_worship:"🛐",plate_with_cutlery:"🍽",play_or_pause_button:"⏯",point_down:"👇",point_left:"👈",point_right:"👉",point_up:"☝️",point_up_2:"👆",police_car:"🚓",policewoman:"👮&zwj;♀️",poodle:"🐩",popcorn:"🍿",post_office:"🏣",postal_horn:"📯",postbox:"📮",potable_water:"🚰",potato:"🥔",pouch:"👝",poultry_leg:"🍗",pound:"💷",rage:"😡",pouting_cat:"😾",pouting_man:"🙎&zwj;♂️",pray:"🙏",prayer_beads:"📿",pregnant_woman:"🤰",previous_track_button:"⏮",prince:"🤴",princess:"👸",printer:"🖨",purple_heart:"💜",purse:"👛",pushpin:"📌",put_litter_in_its_place:"🚮",question:"❓",rabbit:"🐰",rabbit2:"🐇",racehorse:"🐎",racing_car:"🏎",radio:"📻",radio_button:"🔘",radioactive:"☢️",railway_car:"🚃",railway_track:"🛤",rainbow:"🌈",rainbow_flag:"🏳️&zwj;🌈",raised_back_of_hand:"🤚",raised_hand_with_fingers_splayed:"🖐",raised_hands:"🙌",raising_hand_woman:"🙋",raising_hand_man:"🙋&zwj;♂️",ram:"🐏",ramen:"🍜",rat:"🐀",record_button:"⏺",recycle:"♻️",red_circle:"🔴",registered:"®️",relaxed:"☺️",relieved:"😌",reminder_ribbon:"🎗",repeat:"🔁",repeat_one:"🔂",rescue_worker_helmet:"⛑",restroom:"🚻",revolving_hearts:"💞",rewind:"⏪",rhinoceros:"🦏",ribbon:"🎀",rice:"🍚",rice_ball:"🍙",rice_cracker:"🍘",rice_scene:"🎑",right_anger_bubble:"🗯",ring:"💍",robot:"🤖",rocket:"🚀",rofl:"🤣",roll_eyes:"🙄",roller_coaster:"🎢",rooster:"🐓",rose:"🌹",rosette:"🏵",rotating_light:"🚨",round_pushpin:"📍",rowing_man:"🚣",rowing_woman:"🚣&zwj;♀️",rugby_football:"🏉",running_man:"🏃",running_shirt_with_sash:"🎽",running_woman:"🏃&zwj;♀️",sa:"🈂️",sagittarius:"♐️",sake:"🍶",sandal:"👡",santa:"🎅",satellite:"📡",saxophone:"🎷",school:"🏫",school_satchel:"🎒",scissors:"✂️",scorpion:"🦂",scorpius:"♏️",scream:"😱",scream_cat:"🙀",scroll:"📜",seat:"💺",secret:"㊙️",see_no_evil:"🙈",seedling:"🌱",selfie:"🤳",shallow_pan_of_food:"🥘",shamrock:"☘️",shark:"🦈",shaved_ice:"🍧",sheep:"🐑",shell:"🐚",shield:"🛡",shinto_shrine:"⛩",ship:"🚢",shirt:"👕",shopping:"🛍",shopping_cart:"🛒",shower:"🚿",shrimp:"🦐",signal_strength:"📶",six_pointed_star:"🔯",ski:"🎿",skier:"⛷",skull:"💀",skull_and_crossbones:"☠️",sleeping:"😴",sleeping_bed:"🛌",sleepy:"😪",slightly_frowning_face:"🙁",slightly_smiling_face:"🙂",slot_machine:"🎰",small_airplane:"🛩",small_blue_diamond:"🔹",small_orange_diamond:"🔸",small_red_triangle:"🔺",small_red_triangle_down:"🔻",smile:"😄",smile_cat:"😸",smiley:"😃",smiley_cat:"😺",smiling_imp:"😈",smirk:"😏",smirk_cat:"😼",smoking:"🚬",snail:"🐌",snake:"🐍",sneezing_face:"🤧",snowboarder:"🏂",snowflake:"❄️",snowman:"⛄️",snowman_with_snow:"☃️",sob:"😭",soccer:"⚽️",soon:"🔜",sos:"🆘",sound:"🔉",space_invader:"👾",spades:"♠️",spaghetti:"🍝",sparkle:"❇️",sparkler:"🎇",sparkles:"✨",sparkling_heart:"💖",speak_no_evil:"🙊",speaker:"🔈",speaking_head:"🗣",speech_balloon:"💬",speedboat:"🚤",spider:"🕷",spider_web:"🕸",spiral_calendar:"🗓",spiral_notepad:"🗒",spoon:"🥄",squid:"🦑",stadium:"🏟",star:"⭐️",star2:"🌟",star_and_crescent:"☪️",star_of_david:"✡️",stars:"🌠",station:"🚉",statue_of_liberty:"🗽",steam_locomotive:"🚂",stew:"🍲",stop_button:"⏹",stop_sign:"🛑",stopwatch:"⏱",straight_ruler:"📏",strawberry:"🍓",stuck_out_tongue:"😛",stuck_out_tongue_closed_eyes:"😝",stuck_out_tongue_winking_eye:"😜",studio_microphone:"🎙",stuffed_flatbread:"🥙",sun_behind_large_cloud:"🌥",sun_behind_rain_cloud:"🌦",sun_behind_small_cloud:"🌤",sun_with_face:"🌞",sunflower:"🌻",sunglasses:"😎",sunny:"☀️",sunrise:"🌅",sunrise_over_mountains:"🌄",surfing_man:"🏄",surfing_woman:"🏄&zwj;♀️",sushi:"🍣",suspension_railway:"🚟",sweat:"😓",sweat_drops:"💦",sweat_smile:"😅",sweet_potato:"🍠",swimming_man:"🏊",swimming_woman:"🏊&zwj;♀️",symbols:"🔣",synagogue:"🕍",syringe:"💉",taco:"🌮",tada:"🎉",tanabata_tree:"🎋",taurus:"♉️",taxi:"🚕",tea:"🍵",telephone_receiver:"📞",telescope:"🔭",tennis:"🎾",tent:"⛺️",thermometer:"🌡",thinking:"🤔",thought_balloon:"💭",ticket:"🎫",tickets:"🎟",tiger:"🐯",tiger2:"🐅",timer_clock:"⏲",tipping_hand_man:"💁&zwj;♂️",tired_face:"😫",tm:"™️",toilet:"🚽",tokyo_tower:"🗼",tomato:"🍅",tongue:"👅",top:"🔝",tophat:"🎩",tornado:"🌪",trackball:"🖲",tractor:"🚜",traffic_light:"🚥",train:"🚋",train2:"🚆",tram:"🚊",triangular_flag_on_post:"🚩",triangular_ruler:"📐",trident:"🔱",triumph:"😤",trolleybus:"🚎",trophy:"🏆",tropical_drink:"🍹",tropical_fish:"🐠",truck:"🚚",trumpet:"🎺",tulip:"🌷",tumbler_glass:"🥃",turkey:"🦃",turtle:"🐢",tv:"📺",twisted_rightwards_arrows:"🔀",two_hearts:"💕",two_men_holding_hands:"👬",two_women_holding_hands:"👭",u5272:"🈹",u5408:"🈴",u55b6:"🈺",u6307:"🈯️",u6708:"🈷️",u6709:"🈶",u6e80:"🈵",u7121:"🈚️",u7533:"🈸",u7981:"🈲",u7a7a:"🈳",umbrella:"☔️",unamused:"😒",underage:"🔞",unicorn:"🦄",unlock:"🔓",up:"🆙",upside_down_face:"🙃",v:"✌️",vertical_traffic_light:"🚦",vhs:"📼",vibration_mode:"📳",video_camera:"📹",video_game:"🎮",violin:"🎻",virgo:"♍️",volcano:"🌋",volleyball:"🏐",vs:"🆚",vulcan_salute:"🖖",walking_man:"🚶",walking_woman:"🚶&zwj;♀️",waning_crescent_moon:"🌘",waning_gibbous_moon:"🌖",warning:"⚠️",wastebasket:"🗑",watch:"⌚️",water_buffalo:"🐃",watermelon:"🍉",wave:"👋",wavy_dash:"〰️",waxing_crescent_moon:"🌒",wc:"🚾",weary:"😩",wedding:"💒",weight_lifting_man:"🏋️",weight_lifting_woman:"🏋️&zwj;♀️",whale:"🐳",whale2:"🐋",wheel_of_dharma:"☸️",wheelchair:"♿️",white_check_mark:"✅",white_circle:"⚪️",white_flag:"🏳️",white_flower:"💮",white_large_square:"⬜️",white_medium_small_square:"◽️",white_medium_square:"◻️",white_small_square:"▫️",white_square_button:"🔳",wilted_flower:"🥀",wind_chime:"🎐",wind_face:"🌬",wine_glass:"🍷",wink:"😉",wolf:"🐺",woman:"👩",woman_artist:"👩&zwj;🎨",woman_astronaut:"👩&zwj;🚀",woman_cartwheeling:"🤸&zwj;♀️",woman_cook:"👩&zwj;🍳",woman_facepalming:"🤦&zwj;♀️",woman_factory_worker:"👩&zwj;🏭",woman_farmer:"👩&zwj;🌾",woman_firefighter:"👩&zwj;🚒",woman_health_worker:"👩&zwj;⚕️",woman_judge:"👩&zwj;⚖️",woman_juggling:"🤹&zwj;♀️",woman_mechanic:"👩&zwj;🔧",woman_office_worker:"👩&zwj;💼",woman_pilot:"👩&zwj;✈️",woman_playing_handball:"🤾&zwj;♀️",woman_playing_water_polo:"🤽&zwj;♀️",woman_scientist:"👩&zwj;🔬",woman_shrugging:"🤷&zwj;♀️",woman_singer:"👩&zwj;🎤",woman_student:"👩&zwj;🎓",woman_teacher:"👩&zwj;🏫",woman_technologist:"👩&zwj;💻",woman_with_turban:"👳&zwj;♀️",womans_clothes:"👚",womans_hat:"👒",women_wrestling:"🤼&zwj;♀️",womens:"🚺",world_map:"🗺",worried:"😟",wrench:"🔧",writing_hand:"✍️",x:"❌",yellow_heart:"💛",yen:"💴",yin_yang:"☯️",yum:"😋",zap:"⚡️",zipper_mouth_face:"🤐",zzz:"💤",octocat:'<img alt=":octocat:" height="20" width="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',showdown:`<span style="font-family: 'Anonymous Pro', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;">S</span>`},i.Converter=function(p){var b={},v=[],R=[],O={},N=a,T={parsed:{},raw:"",format:""};$();function $(){p=p||{};for(var M in s)s.hasOwnProperty(M)&&(b[M]=s[M]);if(typeof p=="object")for(var Y in p)p.hasOwnProperty(Y)&&(b[Y]=p[Y]);else throw Error("Converter expects the passed parameter to be an object, but "+typeof p+" was passed instead.");b.extensions&&i.helper.forEach(b.extensions,Q)}function Q(M,Y){if(Y=Y||null,i.helper.isString(M))if(M=i.helper.stdExtName(M),Y=M,i.extensions[M]){console.warn("DEPRECATION WARNING: "+M+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),K(i.extensions[M],M);return}else if(!i.helper.isUndefined(r[M]))M=r[M];else throw Error('Extension "'+M+'" could not be loaded. It was either not found or is not a valid extension.');typeof M=="function"&&(M=M()),i.helper.isArray(M)||(M=[M]);var te=h(M,Y);if(!te.valid)throw Error(te.error);for(var ue=0;ue<M.length;++ue){switch(M[ue].type){case"lang":v.push(M[ue]);break;case"output":R.push(M[ue]);break}if(M[ue].hasOwnProperty("listeners"))for(var Re in M[ue].listeners)M[ue].listeners.hasOwnProperty(Re)&&Z(Re,M[ue].listeners[Re])}}function K(M,Y){typeof M=="function"&&(M=M(new i.Converter)),i.helper.isArray(M)||(M=[M]);var te=h(M,Y);if(!te.valid)throw Error(te.error);for(var ue=0;ue<M.length;++ue)switch(M[ue].type){case"lang":v.push(M[ue]);break;case"output":R.push(M[ue]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}function Z(M,Y){if(!i.helper.isString(M))throw Error("Invalid argument in converter.listen() method: name must be a string, but "+typeof M+" given");if(typeof Y!="function")throw Error("Invalid argument in converter.listen() method: callback must be a function, but "+typeof Y+" given");O.hasOwnProperty(M)||(O[M]=[]),O[M].push(Y)}function H(M){var Y=M.match(/^\s*/)[0].length,te=new RegExp("^\\s{0,"+Y+"}","gm");return M.replace(te,"")}this._dispatch=function(Y,te,ue,Re){if(O.hasOwnProperty(Y))for(var ae=0;ae<O[Y].length;++ae){var ot=O[Y][ae](Y,te,this,ue,Re);ot&&typeof ot<"u"&&(te=ot)}return te},this.listen=function(M,Y){return Z(M,Y),this},this.makeHtml=function(M){if(!M)return M;var Y={gHtmlBlocks:[],gHtmlMdBlocks:[],gHtmlSpans:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:v,outputModifiers:R,converter:this,ghCodeBlocks:[],metadata:{parsed:{},raw:"",format:""}};return M=M.replace(/¨/g,"¨T"),M=M.replace(/\$/g,"¨D"),M=M.replace(/\r\n/g,`
`),M=M.replace(/\r/g,`
`),M=M.replace(/\u00A0/g,"&nbsp;"),b.smartIndentationFix&&(M=H(M)),M=`

`+M+`

`,M=i.subParser("detab")(M,b,Y),M=M.replace(/^[ \t]+$/mg,""),i.helper.forEach(v,function(te){M=i.subParser("runExtension")(te,M,b,Y)}),M=i.subParser("metadata")(M,b,Y),M=i.subParser("hashPreCodeTags")(M,b,Y),M=i.subParser("githubCodeBlocks")(M,b,Y),M=i.subParser("hashHTMLBlocks")(M,b,Y),M=i.subParser("hashCodeTags")(M,b,Y),M=i.subParser("stripLinkDefinitions")(M,b,Y),M=i.subParser("blockGamut")(M,b,Y),M=i.subParser("unhashHTMLSpans")(M,b,Y),M=i.subParser("unescapeSpecialChars")(M,b,Y),M=M.replace(/¨D/g,"$$"),M=M.replace(/¨T/g,"¨"),M=i.subParser("completeHTMLDocument")(M,b,Y),i.helper.forEach(R,function(te){M=i.subParser("runExtension")(te,M,b,Y)}),T=Y.metadata,M},this.makeMarkdown=this.makeMd=function(M,Y){if(M=M.replace(/\r\n/g,`
`),M=M.replace(/\r/g,`
`),M=M.replace(/>[ \t]+</,">¨NBSP;<"),!Y)if(window&&window.document)Y=window.document;else throw new Error("HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM");var te=Y.createElement("div");te.innerHTML=M;var ue={preList:et(te)};Ft(te);for(var Re=te.childNodes,ae="",ot=0;ot<Re.length;ot++)ae+=i.subParser("makeMarkdown.node")(Re[ot],ue);function Ft(ht){for(var wt=0;wt<ht.childNodes.length;++wt){var Ot=ht.childNodes[wt];Ot.nodeType===3?!/\S/.test(Ot.nodeValue)&&!/^[ ]+$/.test(Ot.nodeValue)?(ht.removeChild(Ot),--wt):(Ot.nodeValue=Ot.nodeValue.split(`
`).join(" "),Ot.nodeValue=Ot.nodeValue.replace(/(\s)+/g,"$1")):Ot.nodeType===1&&Ft(Ot)}}function et(ht){for(var wt=ht.querySelectorAll("pre"),Ot=[],vt=0;vt<wt.length;++vt)if(wt[vt].childElementCount===1&&wt[vt].firstChild.tagName.toLowerCase()==="code"){var At=wt[vt].firstChild.innerHTML.trim(),yi=wt[vt].firstChild.getAttribute("data-language")||"";if(yi==="")for(var Wt=wt[vt].firstChild.className.split(" "),Ze=0;Ze<Wt.length;++Ze){var ii=Wt[Ze].match(/^language-(.+)$/);if(ii!==null){yi=ii[1];break}}At=i.helper.unescapeHTMLEntities(At),Ot.push(At),wt[vt].outerHTML='<precode language="'+yi+'" precodenum="'+vt.toString()+'"></precode>'}else Ot.push(wt[vt].innerHTML),wt[vt].innerHTML="",wt[vt].setAttribute("prenum",vt.toString());return Ot}return ae},this.setOption=function(M,Y){b[M]=Y},this.getOption=function(M){return b[M]},this.getOptions=function(){return b},this.addExtension=function(M,Y){Y=Y||null,Q(M,Y)},this.useExtension=function(M){Q(M)},this.setFlavor=function(M){if(!f.hasOwnProperty(M))throw Error(M+" flavor was not found");var Y=f[M];N=M;for(var te in Y)Y.hasOwnProperty(te)&&(b[te]=Y[te])},this.getFlavor=function(){return N},this.removeExtension=function(M){i.helper.isArray(M)||(M=[M]);for(var Y=0;Y<M.length;++Y){for(var te=M[Y],ue=0;ue<v.length;++ue)v[ue]===te&&v.splice(ue,1);for(var Re=0;Re<R.length;++Re)R[Re]===te&&R.splice(Re,1)}},this.getAllExtensions=function(){return{language:v,output:R}},this.getMetadata=function(M){return M?T.raw:T.parsed},this.getMetadataFormat=function(){return T.format},this._setMetadataPair=function(M,Y){T.parsed[M]=Y},this._setMetadataFormat=function(M){T.format=M},this._setMetadataRaw=function(M){T.raw=M}},i.subParser("anchors",function(p,b,v){p=v.converter._dispatch("anchors.before",p,b,v);var R=function(O,N,T,$,Q,K,Z){if(i.helper.isUndefined(Z)&&(Z=""),T=T.toLowerCase(),O.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)$="";else if(!$)if(T||(T=N.toLowerCase().replace(/ ?\n/g," ")),$="#"+T,!i.helper.isUndefined(v.gUrls[T]))$=v.gUrls[T],i.helper.isUndefined(v.gTitles[T])||(Z=v.gTitles[T]);else return O;$=$.replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback);var H='<a href="'+$+'"';return Z!==""&&Z!==null&&(Z=Z.replace(/"/g,"&quot;"),Z=Z.replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback),H+=' title="'+Z+'"'),b.openLinksInNewWindow&&!/^#/.test($)&&(H+=' rel="noopener noreferrer" target="¨E95Eblank"'),H+=">"+N+"</a>",H};return p=p.replace(/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,R),p=p.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,R),p=p.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,R),p=p.replace(/\[([^\[\]]+)]()()()()()/g,R),b.ghMentions&&(p=p.replace(/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d.-]+?[a-z\d]+)*))/gmi,function(O,N,T,$,Q){if(T==="\\")return N+$;if(!i.helper.isString(b.ghMentionsLink))throw new Error("ghMentionsLink option must be a string");var K=b.ghMentionsLink.replace(/\{u}/g,Q),Z="";return b.openLinksInNewWindow&&(Z=' rel="noopener noreferrer" target="¨E95Eblank"'),N+'<a href="'+K+'"'+Z+">"+$+"</a>"})),p=v.converter._dispatch("anchors.after",p,b,v),p});var S=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+?\.[^'">\s]+?)()(\1)?(?=\s|$)(?!["<>])/gi,P=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+?)([.!?,()\[\]])?(\1)?(?=\s|$)(?!["<>])/gi,w=/()<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)()>()/gi,C=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gmi,E=/<()(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,D=function(p){return function(b,v,R,O,N,T,$){R=R.replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback);var Q=R,K="",Z="",H=v||"",M=$||"";return/^www\./i.test(R)&&(R=R.replace(/^www\./i,"http://www.")),p.excludeTrailingPunctuationFromURLs&&T&&(K=T),p.openLinksInNewWindow&&(Z=' rel="noopener noreferrer" target="¨E95Eblank"'),H+'<a href="'+R+'"'+Z+">"+Q+"</a>"+K+M}},j=function(p,b){return function(v,R,O){var N="mailto:";return R=R||"",O=i.subParser("unescapeSpecialChars")(O,p,b),p.encodeEmails?(N=i.helper.encodeEmailAddress(N+O),O=i.helper.encodeEmailAddress(O)):N=N+O,R+'<a href="'+N+'">'+O+"</a>"}};i.subParser("autoLinks",function(p,b,v){return p=v.converter._dispatch("autoLinks.before",p,b,v),p=p.replace(w,D(b)),p=p.replace(E,j(b,v)),p=v.converter._dispatch("autoLinks.after",p,b,v),p}),i.subParser("simplifiedAutoLinks",function(p,b,v){return b.simplifiedAutoLink&&(p=v.converter._dispatch("simplifiedAutoLinks.before",p,b,v),b.excludeTrailingPunctuationFromURLs?p=p.replace(P,D(b)):p=p.replace(S,D(b)),p=p.replace(C,j(b,v)),p=v.converter._dispatch("simplifiedAutoLinks.after",p,b,v)),p}),i.subParser("blockGamut",function(p,b,v){return p=v.converter._dispatch("blockGamut.before",p,b,v),p=i.subParser("blockQuotes")(p,b,v),p=i.subParser("headers")(p,b,v),p=i.subParser("horizontalRule")(p,b,v),p=i.subParser("lists")(p,b,v),p=i.subParser("codeBlocks")(p,b,v),p=i.subParser("tables")(p,b,v),p=i.subParser("hashHTMLBlocks")(p,b,v),p=i.subParser("paragraphs")(p,b,v),p=v.converter._dispatch("blockGamut.after",p,b,v),p}),i.subParser("blockQuotes",function(p,b,v){p=v.converter._dispatch("blockQuotes.before",p,b,v),p=p+`

`;var R=/(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;return b.splitAdjacentBlockquotes&&(R=/^ {0,3}>[\s\S]*?(?:\n\n)/gm),p=p.replace(R,function(O){return O=O.replace(/^[ \t]*>[ \t]?/gm,""),O=O.replace(/¨0/g,""),O=O.replace(/^[ \t]+$/gm,""),O=i.subParser("githubCodeBlocks")(O,b,v),O=i.subParser("blockGamut")(O,b,v),O=O.replace(/(^|\n)/g,"$1  "),O=O.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(N,T){var $=T;return $=$.replace(/^  /mg,"¨0"),$=$.replace(/¨0/g,""),$}),i.subParser("hashBlock")(`<blockquote>
`+O+`
</blockquote>`,b,v)}),p=v.converter._dispatch("blockQuotes.after",p,b,v),p}),i.subParser("codeBlocks",function(p,b,v){p=v.converter._dispatch("codeBlocks.before",p,b,v),p+="¨0";var R=/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=¨0))/g;return p=p.replace(R,function(O,N,T){var $=N,Q=T,K=`
`;return $=i.subParser("outdent")($,b,v),$=i.subParser("encodeCode")($,b,v),$=i.subParser("detab")($,b,v),$=$.replace(/^\n+/g,""),$=$.replace(/\n+$/g,""),b.omitExtraWLInCodeBlocks&&(K=""),$="<pre><code>"+$+K+"</code></pre>",i.subParser("hashBlock")($,b,v)+Q}),p=p.replace(/¨0/,""),p=v.converter._dispatch("codeBlocks.after",p,b,v),p}),i.subParser("codeSpans",function(p,b,v){return p=v.converter._dispatch("codeSpans.before",p,b,v),typeof p>"u"&&(p=""),p=p.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(R,O,N,T){var $=T;return $=$.replace(/^([ \t]*)/g,""),$=$.replace(/[ \t]*$/g,""),$=i.subParser("encodeCode")($,b,v),$=O+"<code>"+$+"</code>",$=i.subParser("hashHTMLSpans")($,b,v),$}),p=v.converter._dispatch("codeSpans.after",p,b,v),p}),i.subParser("completeHTMLDocument",function(p,b,v){if(!b.completeHTMLDocument)return p;p=v.converter._dispatch("completeHTMLDocument.before",p,b,v);var R="html",O=`<!DOCTYPE HTML>
`,N="",T=`<meta charset="utf-8">
`,$="",Q="";typeof v.metadata.parsed.doctype<"u"&&(O="<!DOCTYPE "+v.metadata.parsed.doctype+`>
`,R=v.metadata.parsed.doctype.toString().toLowerCase(),(R==="html"||R==="html5")&&(T='<meta charset="utf-8">'));for(var K in v.metadata.parsed)if(v.metadata.parsed.hasOwnProperty(K))switch(K.toLowerCase()){case"doctype":break;case"title":N="<title>"+v.metadata.parsed.title+`</title>
`;break;case"charset":R==="html"||R==="html5"?T='<meta charset="'+v.metadata.parsed.charset+`">
`:T='<meta name="charset" content="'+v.metadata.parsed.charset+`">
`;break;case"language":case"lang":$=' lang="'+v.metadata.parsed[K]+'"',Q+='<meta name="'+K+'" content="'+v.metadata.parsed[K]+`">
`;break;default:Q+='<meta name="'+K+'" content="'+v.metadata.parsed[K]+`">
`}return p=O+"<html"+$+`>
<head>
`+N+T+Q+`</head>
<body>
`+p.trim()+`
</body>
</html>`,p=v.converter._dispatch("completeHTMLDocument.after",p,b,v),p}),i.subParser("detab",function(p,b,v){return p=v.converter._dispatch("detab.before",p,b,v),p=p.replace(/\t(?=\t)/g,"    "),p=p.replace(/\t/g,"¨A¨B"),p=p.replace(/¨B(.+?)¨A/g,function(R,O){for(var N=O,T=4-N.length%4,$=0;$<T;$++)N+=" ";return N}),p=p.replace(/¨A/g,"    "),p=p.replace(/¨B/g,""),p=v.converter._dispatch("detab.after",p,b,v),p}),i.subParser("ellipsis",function(p,b,v){return b.ellipsis&&(p=v.converter._dispatch("ellipsis.before",p,b,v),p=p.replace(/\.\.\./g,"…"),p=v.converter._dispatch("ellipsis.after",p,b,v)),p}),i.subParser("emoji",function(p,b,v){if(!b.emoji)return p;p=v.converter._dispatch("emoji.before",p,b,v);var R=/:([\S]+?):/g;return p=p.replace(R,function(O,N){return i.helper.emojis.hasOwnProperty(N)?i.helper.emojis[N]:O}),p=v.converter._dispatch("emoji.after",p,b,v),p}),i.subParser("encodeAmpsAndAngles",function(p,b,v){return p=v.converter._dispatch("encodeAmpsAndAngles.before",p,b,v),p=p.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),p=p.replace(/<(?![a-z\/?$!])/gi,"&lt;"),p=p.replace(/</g,"&lt;"),p=p.replace(/>/g,"&gt;"),p=v.converter._dispatch("encodeAmpsAndAngles.after",p,b,v),p}),i.subParser("encodeBackslashEscapes",function(p,b,v){return p=v.converter._dispatch("encodeBackslashEscapes.before",p,b,v),p=p.replace(/\\(\\)/g,i.helper.escapeCharactersCallback),p=p.replace(/\\([`*_{}\[\]()>#+.!~=|:-])/g,i.helper.escapeCharactersCallback),p=v.converter._dispatch("encodeBackslashEscapes.after",p,b,v),p}),i.subParser("encodeCode",function(p,b,v){return p=v.converter._dispatch("encodeCode.before",p,b,v),p=p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([*_{}\[\]\\=~-])/g,i.helper.escapeCharactersCallback),p=v.converter._dispatch("encodeCode.after",p,b,v),p}),i.subParser("escapeSpecialCharsWithinTagAttributes",function(p,b,v){p=v.converter._dispatch("escapeSpecialCharsWithinTagAttributes.before",p,b,v);var R=/<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,O=/<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi;return p=p.replace(R,function(N){return N.replace(/(.)<\/?code>(?=.)/g,"$1`").replace(/([\\`*_~=|])/g,i.helper.escapeCharactersCallback)}),p=p.replace(O,function(N){return N.replace(/([\\`*_~=|])/g,i.helper.escapeCharactersCallback)}),p=v.converter._dispatch("escapeSpecialCharsWithinTagAttributes.after",p,b,v),p}),i.subParser("githubCodeBlocks",function(p,b,v){return b.ghCodeBlocks?(p=v.converter._dispatch("githubCodeBlocks.before",p,b,v),p+="¨0",p=p.replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,function(R,O,N,T){var $=b.omitExtraWLInCodeBlocks?"":`
`;return T=i.subParser("encodeCode")(T,b,v),T=i.subParser("detab")(T,b,v),T=T.replace(/^\n+/g,""),T=T.replace(/\n+$/g,""),T="<pre><code"+(N?' class="'+N+" language-"+N+'"':"")+">"+T+$+"</code></pre>",T=i.subParser("hashBlock")(T,b,v),`

¨G`+(v.ghCodeBlocks.push({text:R,codeblock:T})-1)+`G

`}),p=p.replace(/¨0/,""),v.converter._dispatch("githubCodeBlocks.after",p,b,v)):p}),i.subParser("hashBlock",function(p,b,v){return p=v.converter._dispatch("hashBlock.before",p,b,v),p=p.replace(/(^\n+|\n+$)/g,""),p=`

¨K`+(v.gHtmlBlocks.push(p)-1)+`K

`,p=v.converter._dispatch("hashBlock.after",p,b,v),p}),i.subParser("hashCodeTags",function(p,b,v){p=v.converter._dispatch("hashCodeTags.before",p,b,v);var R=function(O,N,T,$){var Q=T+i.subParser("encodeCode")(N,b,v)+$;return"¨C"+(v.gHtmlSpans.push(Q)-1)+"C"};return p=i.helper.replaceRecursiveRegExp(p,R,"<code\\b[^>]*>","</code>","gim"),p=v.converter._dispatch("hashCodeTags.after",p,b,v),p}),i.subParser("hashElement",function(p,b,v){return function(R,O){var N=O;return N=N.replace(/\n\n/g,`
`),N=N.replace(/^\n/,""),N=N.replace(/\n+$/g,""),N=`

¨K`+(v.gHtmlBlocks.push(N)-1)+`K

`,N}}),i.subParser("hashHTMLBlocks",function(p,b,v){p=v.converter._dispatch("hashHTMLBlocks.before",p,b,v);var R=["pre","div","h1","h2","h3","h4","h5","h6","blockquote","table","dl","ol","ul","script","noscript","form","fieldset","iframe","math","style","section","header","footer","nav","article","aside","address","audio","canvas","figure","hgroup","output","video","p"],O=function(M,Y,te,ue){var Re=M;return te.search(/\bmarkdown\b/)!==-1&&(Re=te+v.converter.makeHtml(Y)+ue),`

¨K`+(v.gHtmlBlocks.push(Re)-1)+`K

`};b.backslashEscapesHTMLTags&&(p=p.replace(/\\<(\/?[^>]+?)>/g,function(M,Y){return"&lt;"+Y+"&gt;"}));for(var N=0;N<R.length;++N)for(var T,$=new RegExp("^ {0,3}(<"+R[N]+"\\b[^>]*>)","im"),Q="<"+R[N]+"\\b[^>]*>",K="</"+R[N]+">";(T=i.helper.regexIndexOf(p,$))!==-1;){var Z=i.helper.splitAtIndex(p,T),H=i.helper.replaceRecursiveRegExp(Z[1],O,Q,K,"im");if(H===Z[1])break;p=Z[0].concat(H)}return p=p.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,i.subParser("hashElement")(p,b,v)),p=i.helper.replaceRecursiveRegExp(p,function(M){return`

¨K`+(v.gHtmlBlocks.push(M)-1)+`K

`},"^ {0,3}<!--","-->","gm"),p=p.replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,i.subParser("hashElement")(p,b,v)),p=v.converter._dispatch("hashHTMLBlocks.after",p,b,v),p}),i.subParser("hashHTMLSpans",function(p,b,v){p=v.converter._dispatch("hashHTMLSpans.before",p,b,v);function R(O){return"¨C"+(v.gHtmlSpans.push(O)-1)+"C"}return p=p.replace(/<[^>]+?\/>/gi,function(O){return R(O)}),p=p.replace(/<([^>]+?)>[\s\S]*?<\/\1>/g,function(O){return R(O)}),p=p.replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g,function(O){return R(O)}),p=p.replace(/<[^>]+?>/gi,function(O){return R(O)}),p=v.converter._dispatch("hashHTMLSpans.after",p,b,v),p}),i.subParser("unhashHTMLSpans",function(p,b,v){p=v.converter._dispatch("unhashHTMLSpans.before",p,b,v);for(var R=0;R<v.gHtmlSpans.length;++R){for(var O=v.gHtmlSpans[R],N=0;/¨C(\d+)C/.test(O);){var T=RegExp.$1;if(O=O.replace("¨C"+T+"C",v.gHtmlSpans[T]),N===10){console.error("maximum nesting of 10 spans reached!!!");break}++N}p=p.replace("¨C"+R+"C",O)}return p=v.converter._dispatch("unhashHTMLSpans.after",p,b,v),p}),i.subParser("hashPreCodeTags",function(p,b,v){p=v.converter._dispatch("hashPreCodeTags.before",p,b,v);var R=function(O,N,T,$){var Q=T+i.subParser("encodeCode")(N,b,v)+$;return`

¨G`+(v.ghCodeBlocks.push({text:O,codeblock:Q})-1)+`G

`};return p=i.helper.replaceRecursiveRegExp(p,R,"^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>","^ {0,3}</code>\\s*</pre>","gim"),p=v.converter._dispatch("hashPreCodeTags.after",p,b,v),p}),i.subParser("headers",function(p,b,v){p=v.converter._dispatch("headers.before",p,b,v);var R=isNaN(parseInt(b.headerLevelStart))?1:parseInt(b.headerLevelStart),O=b.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,N=b.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;p=p.replace(O,function(Q,K){var Z=i.subParser("spanGamut")(K,b,v),H=b.noHeaderId?"":' id="'+$(K)+'"',M=R,Y="<h"+M+H+">"+Z+"</h"+M+">";return i.subParser("hashBlock")(Y,b,v)}),p=p.replace(N,function(Q,K){var Z=i.subParser("spanGamut")(K,b,v),H=b.noHeaderId?"":' id="'+$(K)+'"',M=R+1,Y="<h"+M+H+">"+Z+"</h"+M+">";return i.subParser("hashBlock")(Y,b,v)});var T=b.requireSpaceBeforeHeadingText?/^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm:/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;p=p.replace(T,function(Q,K,Z){var H=Z;b.customizedHeaderId&&(H=Z.replace(/\s?\{([^{]+?)}\s*$/,""));var M=i.subParser("spanGamut")(H,b,v),Y=b.noHeaderId?"":' id="'+$(Z)+'"',te=R-1+K.length,ue="<h"+te+Y+">"+M+"</h"+te+">";return i.subParser("hashBlock")(ue,b,v)});function $(Q){var K,Z;if(b.customizedHeaderId){var H=Q.match(/\{([^{]+?)}\s*$/);H&&H[1]&&(Q=H[1])}return K=Q,i.helper.isString(b.prefixHeaderId)?Z=b.prefixHeaderId:b.prefixHeaderId===!0?Z="section-":Z="",b.rawPrefixHeaderId||(K=Z+K),b.ghCompatibleHeaderId?K=K.replace(/ /g,"-").replace(/&amp;/g,"").replace(/¨T/g,"").replace(/¨D/g,"").replace(/[&+$,\/:;=?@"#{}|^¨~\[\]`\\*)(%.!'<>]/g,"").toLowerCase():b.rawHeaderId?K=K.replace(/ /g,"-").replace(/&amp;/g,"&").replace(/¨T/g,"¨").replace(/¨D/g,"$").replace(/["']/g,"-").toLowerCase():K=K.replace(/[^\w]/g,"").toLowerCase(),b.rawPrefixHeaderId&&(K=Z+K),v.hashLinkCounts[K]?K=K+"-"+v.hashLinkCounts[K]++:v.hashLinkCounts[K]=1,K}return p=v.converter._dispatch("headers.after",p,b,v),p}),i.subParser("horizontalRule",function(p,b,v){p=v.converter._dispatch("horizontalRule.before",p,b,v);var R=i.subParser("hashBlock")("<hr />",b,v);return p=p.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm,R),p=p.replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm,R),p=p.replace(/^ {0,2}( ?_){3,}[ \t]*$/gm,R),p=v.converter._dispatch("horizontalRule.after",p,b,v),p}),i.subParser("images",function(p,b,v){p=v.converter._dispatch("images.before",p,b,v);var R=/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,O=/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,N=/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,T=/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,$=/!\[([^\[\]]+)]()()()()()/g;function Q(Z,H,M,Y,te,ue,Re,ae){return Y=Y.replace(/\s/g,""),K(Z,H,M,Y,te,ue,Re,ae)}function K(Z,H,M,Y,te,ue,Re,ae){var ot=v.gUrls,Ft=v.gTitles,et=v.gDimensions;if(M=M.toLowerCase(),ae||(ae=""),Z.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)Y="";else if(Y===""||Y===null)if((M===""||M===null)&&(M=H.toLowerCase().replace(/ ?\n/g," ")),Y="#"+M,!i.helper.isUndefined(ot[M]))Y=ot[M],i.helper.isUndefined(Ft[M])||(ae=Ft[M]),i.helper.isUndefined(et[M])||(te=et[M].width,ue=et[M].height);else return Z;H=H.replace(/"/g,"&quot;").replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback),Y=Y.replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback);var ht='<img src="'+Y+'" alt="'+H+'"';return ae&&i.helper.isString(ae)&&(ae=ae.replace(/"/g,"&quot;").replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback),ht+=' title="'+ae+'"'),te&&ue&&(te=te==="*"?"auto":te,ue=ue==="*"?"auto":ue,ht+=' width="'+te+'"',ht+=' height="'+ue+'"'),ht+=" />",ht}return p=p.replace(T,K),p=p.replace(N,Q),p=p.replace(O,K),p=p.replace(R,K),p=p.replace($,K),p=v.converter._dispatch("images.after",p,b,v),p}),i.subParser("italicsAndBold",function(p,b,v){p=v.converter._dispatch("italicsAndBold.before",p,b,v);function R(O,N,T){return N+O+T}return b.literalMidWordUnderscores?(p=p.replace(/\b___(\S[\s\S]*?)___\b/g,function(O,N){return R(N,"<strong><em>","</em></strong>")}),p=p.replace(/\b__(\S[\s\S]*?)__\b/g,function(O,N){return R(N,"<strong>","</strong>")}),p=p.replace(/\b_(\S[\s\S]*?)_\b/g,function(O,N){return R(N,"<em>","</em>")})):(p=p.replace(/___(\S[\s\S]*?)___/g,function(O,N){return/\S$/.test(N)?R(N,"<strong><em>","</em></strong>"):O}),p=p.replace(/__(\S[\s\S]*?)__/g,function(O,N){return/\S$/.test(N)?R(N,"<strong>","</strong>"):O}),p=p.replace(/_([^\s_][\s\S]*?)_/g,function(O,N){return/\S$/.test(N)?R(N,"<em>","</em>"):O})),b.literalMidWordAsterisks?(p=p.replace(/([^*]|^)\B\*\*\*(\S[\s\S]*?)\*\*\*\B(?!\*)/g,function(O,N,T){return R(T,N+"<strong><em>","</em></strong>")}),p=p.replace(/([^*]|^)\B\*\*(\S[\s\S]*?)\*\*\B(?!\*)/g,function(O,N,T){return R(T,N+"<strong>","</strong>")}),p=p.replace(/([^*]|^)\B\*(\S[\s\S]*?)\*\B(?!\*)/g,function(O,N,T){return R(T,N+"<em>","</em>")})):(p=p.replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g,function(O,N){return/\S$/.test(N)?R(N,"<strong><em>","</em></strong>"):O}),p=p.replace(/\*\*(\S[\s\S]*?)\*\*/g,function(O,N){return/\S$/.test(N)?R(N,"<strong>","</strong>"):O}),p=p.replace(/\*([^\s*][\s\S]*?)\*/g,function(O,N){return/\S$/.test(N)?R(N,"<em>","</em>"):O})),p=v.converter._dispatch("italicsAndBold.after",p,b,v),p}),i.subParser("lists",function(p,b,v){function R(T,$){v.gListLevel++,T=T.replace(/\n{2,}$/,`
`),T+="¨0";var Q=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,K=/\n[ \t]*\n(?!¨0)/.test(T);return b.disableForced4SpacesIndentedSublists&&(Q=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0|\2([*+-]|\d+[.])[ \t]+))/gm),T=T.replace(Q,function(Z,H,M,Y,te,ue,Re){Re=Re&&Re.trim()!=="";var ae=i.subParser("outdent")(te,b,v),ot="";return ue&&b.tasklists&&(ot=' class="task-list-item" style="list-style-type: none;"',ae=ae.replace(/^[ \t]*\[(x|X| )?]/m,function(){var Ft='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return Re&&(Ft+=" checked"),Ft+=">",Ft})),ae=ae.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g,function(Ft){return"¨A"+Ft}),H||ae.search(/\n{2,}/)>-1?(ae=i.subParser("githubCodeBlocks")(ae,b,v),ae=i.subParser("blockGamut")(ae,b,v)):(ae=i.subParser("lists")(ae,b,v),ae=ae.replace(/\n$/,""),ae=i.subParser("hashHTMLBlocks")(ae,b,v),ae=ae.replace(/\n\n+/g,`

`),K?ae=i.subParser("paragraphs")(ae,b,v):ae=i.subParser("spanGamut")(ae,b,v)),ae=ae.replace("¨A",""),ae="<li"+ot+">"+ae+`</li>
`,ae}),T=T.replace(/¨0/g,""),v.gListLevel--,$&&(T=T.replace(/\s+$/,"")),T}function O(T,$){if($==="ol"){var Q=T.match(/^ *(\d+)\./);if(Q&&Q[1]!=="1")return' start="'+Q[1]+'"'}return""}function N(T,$,Q){var K=b.disableForced4SpacesIndentedSublists?/^ ?\d+\.[ \t]/gm:/^ {0,3}\d+\.[ \t]/gm,Z=b.disableForced4SpacesIndentedSublists?/^ ?[*+-][ \t]/gm:/^ {0,3}[*+-][ \t]/gm,H=$==="ul"?K:Z,M="";if(T.search(H)!==-1)(function te(ue){var Re=ue.search(H),ae=O(T,$);Re!==-1?(M+=`

<`+$+ae+`>
`+R(ue.slice(0,Re),!!Q)+"</"+$+`>
`,$=$==="ul"?"ol":"ul",H=$==="ul"?K:Z,te(ue.slice(Re))):M+=`

<`+$+ae+`>
`+R(ue,!!Q)+"</"+$+`>
`})(T);else{var Y=O(T,$);M=`

<`+$+Y+`>
`+R(T,!!Q)+"</"+$+`>
`}return M}return p=v.converter._dispatch("lists.before",p,b,v),p+="¨0",v.gListLevel?p=p.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(T,$,Q){var K=Q.search(/[*+-]/g)>-1?"ul":"ol";return N($,K,!0)}):p=p.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(T,$,Q,K){var Z=K.search(/[*+-]/g)>-1?"ul":"ol";return N(Q,Z,!1)}),p=p.replace(/¨0/,""),p=v.converter._dispatch("lists.after",p,b,v),p}),i.subParser("metadata",function(p,b,v){if(!b.metadata)return p;p=v.converter._dispatch("metadata.before",p,b,v);function R(O){v.metadata.raw=O,O=O.replace(/&/g,"&amp;").replace(/"/g,"&quot;"),O=O.replace(/\n {4}/g," "),O.replace(/^([\S ]+): +([\s\S]+?)$/gm,function(N,T,$){return v.metadata.parsed[T]=$,""})}return p=p.replace(/^\s*«««+(\S*?)\n([\s\S]+?)\n»»»+\n/,function(O,N,T){return R(T),"¨M"}),p=p.replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/,function(O,N,T){return N&&(v.metadata.format=N),R(T),"¨M"}),p=p.replace(/¨M/g,""),p=v.converter._dispatch("metadata.after",p,b,v),p}),i.subParser("outdent",function(p,b,v){return p=v.converter._dispatch("outdent.before",p,b,v),p=p.replace(/^(\t|[ ]{1,4})/gm,"¨0"),p=p.replace(/¨0/g,""),p=v.converter._dispatch("outdent.after",p,b,v),p}),i.subParser("paragraphs",function(p,b,v){p=v.converter._dispatch("paragraphs.before",p,b,v),p=p.replace(/^\n+/g,""),p=p.replace(/\n+$/g,"");for(var R=p.split(/\n{2,}/g),O=[],N=R.length,T=0;T<N;T++){var $=R[T];$.search(/¨(K|G)(\d+)\1/g)>=0?O.push($):$.search(/\S/)>=0&&($=i.subParser("spanGamut")($,b,v),$=$.replace(/^([ \t]*)/g,"<p>"),$+="</p>",O.push($))}for(N=O.length,T=0;T<N;T++){for(var Q="",K=O[T],Z=!1;/¨(K|G)(\d+)\1/.test(K);){var H=RegExp.$1,M=RegExp.$2;H==="K"?Q=v.gHtmlBlocks[M]:Z?Q=i.subParser("encodeCode")(v.ghCodeBlocks[M].text,b,v):Q=v.ghCodeBlocks[M].codeblock,Q=Q.replace(/\$/g,"$$$$"),K=K.replace(/(\n\n)?¨(K|G)\d+\2(\n\n)?/,Q),/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(K)&&(Z=!0)}O[T]=K}return p=O.join(`
`),p=p.replace(/^\n+/g,""),p=p.replace(/\n+$/g,""),v.converter._dispatch("paragraphs.after",p,b,v)}),i.subParser("runExtension",function(p,b,v,R){if(p.filter)b=p.filter(b,R.converter,v);else if(p.regex){var O=p.regex;O instanceof RegExp||(O=new RegExp(O,"g")),b=b.replace(O,p.replace)}return b}),i.subParser("spanGamut",function(p,b,v){return p=v.converter._dispatch("spanGamut.before",p,b,v),p=i.subParser("codeSpans")(p,b,v),p=i.subParser("escapeSpecialCharsWithinTagAttributes")(p,b,v),p=i.subParser("encodeBackslashEscapes")(p,b,v),p=i.subParser("images")(p,b,v),p=i.subParser("anchors")(p,b,v),p=i.subParser("autoLinks")(p,b,v),p=i.subParser("simplifiedAutoLinks")(p,b,v),p=i.subParser("emoji")(p,b,v),p=i.subParser("underline")(p,b,v),p=i.subParser("italicsAndBold")(p,b,v),p=i.subParser("strikethrough")(p,b,v),p=i.subParser("ellipsis")(p,b,v),p=i.subParser("hashHTMLSpans")(p,b,v),p=i.subParser("encodeAmpsAndAngles")(p,b,v),b.simpleLineBreaks?/\n\n¨K/.test(p)||(p=p.replace(/\n+/g,`<br />
`)):p=p.replace(/  +\n/g,`<br />
`),p=v.converter._dispatch("spanGamut.after",p,b,v),p}),i.subParser("strikethrough",function(p,b,v){function R(O){return b.simplifiedAutoLink&&(O=i.subParser("simplifiedAutoLinks")(O,b,v)),"<del>"+O+"</del>"}return b.strikethrough&&(p=v.converter._dispatch("strikethrough.before",p,b,v),p=p.replace(/(?:~){2}([\s\S]+?)(?:~){2}/g,function(O,N){return R(N)}),p=v.converter._dispatch("strikethrough.after",p,b,v)),p}),i.subParser("stripLinkDefinitions",function(p,b,v){var R=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=¨0))/gm,O=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=¨0)|(?=\n\[))/gm;p+="¨0";var N=function(T,$,Q,K,Z,H,M){return $=$.toLowerCase(),p.toLowerCase().split($).length-1<2?T:(Q.match(/^data:.+?\/.+?;base64,/)?v.gUrls[$]=Q.replace(/\s/g,""):v.gUrls[$]=i.subParser("encodeAmpsAndAngles")(Q,b,v),H?H+M:(M&&(v.gTitles[$]=M.replace(/"|'/g,"&quot;")),b.parseImgDimensions&&K&&Z&&(v.gDimensions[$]={width:K,height:Z}),""))};return p=p.replace(O,N),p=p.replace(R,N),p=p.replace(/¨0/,""),p}),i.subParser("tables",function(p,b,v){if(!b.tables)return p;var R=/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|¨0)/gm,O=/^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|¨0)/gm;function N(Z){return/^:[ \t]*--*$/.test(Z)?' style="text-align:left;"':/^--*[ \t]*:[ \t]*$/.test(Z)?' style="text-align:right;"':/^:[ \t]*--*[ \t]*:$/.test(Z)?' style="text-align:center;"':""}function T(Z,H){var M="";return Z=Z.trim(),(b.tablesHeaderId||b.tableHeaderId)&&(M=' id="'+Z.replace(/ /g,"_").toLowerCase()+'"'),Z=i.subParser("spanGamut")(Z,b,v),"<th"+M+H+">"+Z+`</th>
`}function $(Z,H){var M=i.subParser("spanGamut")(Z,b,v);return"<td"+H+">"+M+`</td>
`}function Q(Z,H){for(var M=`<table>
<thead>
<tr>
`,Y=Z.length,te=0;te<Y;++te)M+=Z[te];for(M+=`</tr>
</thead>
<tbody>
`,te=0;te<H.length;++te){M+=`<tr>
`;for(var ue=0;ue<Y;++ue)M+=H[te][ue];M+=`</tr>
`}return M+=`</tbody>
</table>
`,M}function K(Z){var H,M=Z.split(`
`);for(H=0;H<M.length;++H)/^ {0,3}\|/.test(M[H])&&(M[H]=M[H].replace(/^ {0,3}\|/,"")),/\|[ \t]*$/.test(M[H])&&(M[H]=M[H].replace(/\|[ \t]*$/,"")),M[H]=i.subParser("codeSpans")(M[H],b,v);var Y=M[0].split("|").map(function(ht){return ht.trim()}),te=M[1].split("|").map(function(ht){return ht.trim()}),ue=[],Re=[],ae=[],ot=[];for(M.shift(),M.shift(),H=0;H<M.length;++H)M[H].trim()!==""&&ue.push(M[H].split("|").map(function(ht){return ht.trim()}));if(Y.length<te.length)return Z;for(H=0;H<te.length;++H)ae.push(N(te[H]));for(H=0;H<Y.length;++H)i.helper.isUndefined(ae[H])&&(ae[H]=""),Re.push(T(Y[H],ae[H]));for(H=0;H<ue.length;++H){for(var Ft=[],et=0;et<Re.length;++et)i.helper.isUndefined(ue[H][et]),Ft.push($(ue[H][et],ae[et]));ot.push(Ft)}return Q(Re,ot)}return p=v.converter._dispatch("tables.before",p,b,v),p=p.replace(/\\(\|)/g,i.helper.escapeCharactersCallback),p=p.replace(R,K),p=p.replace(O,K),p=v.converter._dispatch("tables.after",p,b,v),p}),i.subParser("underline",function(p,b,v){return b.underline&&(p=v.converter._dispatch("underline.before",p,b,v),b.literalMidWordUnderscores?(p=p.replace(/\b___(\S[\s\S]*?)___\b/g,function(R,O){return"<u>"+O+"</u>"}),p=p.replace(/\b__(\S[\s\S]*?)__\b/g,function(R,O){return"<u>"+O+"</u>"})):(p=p.replace(/___(\S[\s\S]*?)___/g,function(R,O){return/\S$/.test(O)?"<u>"+O+"</u>":R}),p=p.replace(/__(\S[\s\S]*?)__/g,function(R,O){return/\S$/.test(O)?"<u>"+O+"</u>":R})),p=p.replace(/(_)/g,i.helper.escapeCharactersCallback),p=v.converter._dispatch("underline.after",p,b,v)),p}),i.subParser("unescapeSpecialChars",function(p,b,v){return p=v.converter._dispatch("unescapeSpecialChars.before",p,b,v),p=p.replace(/¨E(\d+)E/g,function(R,O){var N=parseInt(O);return String.fromCharCode(N)}),p=v.converter._dispatch("unescapeSpecialChars.after",p,b,v),p}),i.subParser("makeMarkdown.blockquote",function(p,b){var v="";if(p.hasChildNodes())for(var R=p.childNodes,O=R.length,N=0;N<O;++N){var T=i.subParser("makeMarkdown.node")(R[N],b);T!==""&&(v+=T)}return v=v.trim(),v="> "+v.split(`
`).join(`
> `),v}),i.subParser("makeMarkdown.codeBlock",function(p,b){var v=p.getAttribute("language"),R=p.getAttribute("precodenum");return"```"+v+`
`+b.preList[R]+"\n```"}),i.subParser("makeMarkdown.codeSpan",function(p){return"`"+p.innerHTML+"`"}),i.subParser("makeMarkdown.emphasis",function(p,b){var v="";if(p.hasChildNodes()){v+="*";for(var R=p.childNodes,O=R.length,N=0;N<O;++N)v+=i.subParser("makeMarkdown.node")(R[N],b);v+="*"}return v}),i.subParser("makeMarkdown.header",function(p,b,v){var R=new Array(v+1).join("#"),O="";if(p.hasChildNodes()){O=R+" ";for(var N=p.childNodes,T=N.length,$=0;$<T;++$)O+=i.subParser("makeMarkdown.node")(N[$],b)}return O}),i.subParser("makeMarkdown.hr",function(){return"---"}),i.subParser("makeMarkdown.image",function(p){var b="";return p.hasAttribute("src")&&(b+="!["+p.getAttribute("alt")+"](",b+="<"+p.getAttribute("src")+">",p.hasAttribute("width")&&p.hasAttribute("height")&&(b+=" ="+p.getAttribute("width")+"x"+p.getAttribute("height")),p.hasAttribute("title")&&(b+=' "'+p.getAttribute("title")+'"'),b+=")"),b}),i.subParser("makeMarkdown.links",function(p,b){var v="";if(p.hasChildNodes()&&p.hasAttribute("href")){var R=p.childNodes,O=R.length;v="[";for(var N=0;N<O;++N)v+=i.subParser("makeMarkdown.node")(R[N],b);v+="](",v+="<"+p.getAttribute("href")+">",p.hasAttribute("title")&&(v+=' "'+p.getAttribute("title")+'"'),v+=")"}return v}),i.subParser("makeMarkdown.list",function(p,b,v){var R="";if(!p.hasChildNodes())return"";for(var O=p.childNodes,N=O.length,T=p.getAttribute("start")||1,$=0;$<N;++$)if(!(typeof O[$].tagName>"u"||O[$].tagName.toLowerCase()!=="li")){var Q="";v==="ol"?Q=T.toString()+". ":Q="- ",R+=Q+i.subParser("makeMarkdown.listItem")(O[$],b),++T}return R+=`
<!-- -->
`,R.trim()}),i.subParser("makeMarkdown.listItem",function(p,b){for(var v="",R=p.childNodes,O=R.length,N=0;N<O;++N)v+=i.subParser("makeMarkdown.node")(R[N],b);return/\n$/.test(v)?v=v.split(`
`).join(`
    `).replace(/^ {4}$/gm,"").replace(/\n\n+/g,`

`):v+=`
`,v}),i.subParser("makeMarkdown.node",function(p,b,v){v=v||!1;var R="";if(p.nodeType===3)return i.subParser("makeMarkdown.txt")(p,b);if(p.nodeType===8)return"<!--"+p.data+`-->

`;if(p.nodeType!==1)return"";var O=p.tagName.toLowerCase();switch(O){case"h1":v||(R=i.subParser("makeMarkdown.header")(p,b,1)+`

`);break;case"h2":v||(R=i.subParser("makeMarkdown.header")(p,b,2)+`

`);break;case"h3":v||(R=i.subParser("makeMarkdown.header")(p,b,3)+`

`);break;case"h4":v||(R=i.subParser("makeMarkdown.header")(p,b,4)+`

`);break;case"h5":v||(R=i.subParser("makeMarkdown.header")(p,b,5)+`

`);break;case"h6":v||(R=i.subParser("makeMarkdown.header")(p,b,6)+`

`);break;case"p":v||(R=i.subParser("makeMarkdown.paragraph")(p,b)+`

`);break;case"blockquote":v||(R=i.subParser("makeMarkdown.blockquote")(p,b)+`

`);break;case"hr":v||(R=i.subParser("makeMarkdown.hr")(p,b)+`

`);break;case"ol":v||(R=i.subParser("makeMarkdown.list")(p,b,"ol")+`

`);break;case"ul":v||(R=i.subParser("makeMarkdown.list")(p,b,"ul")+`

`);break;case"precode":v||(R=i.subParser("makeMarkdown.codeBlock")(p,b)+`

`);break;case"pre":v||(R=i.subParser("makeMarkdown.pre")(p,b)+`

`);break;case"table":v||(R=i.subParser("makeMarkdown.table")(p,b)+`

`);break;case"code":R=i.subParser("makeMarkdown.codeSpan")(p,b);break;case"em":case"i":R=i.subParser("makeMarkdown.emphasis")(p,b);break;case"strong":case"b":R=i.subParser("makeMarkdown.strong")(p,b);break;case"del":R=i.subParser("makeMarkdown.strikethrough")(p,b);break;case"a":R=i.subParser("makeMarkdown.links")(p,b);break;case"img":R=i.subParser("makeMarkdown.image")(p,b);break;default:R=p.outerHTML+`

`}return R}),i.subParser("makeMarkdown.paragraph",function(p,b){var v="";if(p.hasChildNodes())for(var R=p.childNodes,O=R.length,N=0;N<O;++N)v+=i.subParser("makeMarkdown.node")(R[N],b);return v=v.trim(),v}),i.subParser("makeMarkdown.pre",function(p,b){var v=p.getAttribute("prenum");return"<pre>"+b.preList[v]+"</pre>"}),i.subParser("makeMarkdown.strikethrough",function(p,b){var v="";if(p.hasChildNodes()){v+="~~";for(var R=p.childNodes,O=R.length,N=0;N<O;++N)v+=i.subParser("makeMarkdown.node")(R[N],b);v+="~~"}return v}),i.subParser("makeMarkdown.strong",function(p,b){var v="";if(p.hasChildNodes()){v+="**";for(var R=p.childNodes,O=R.length,N=0;N<O;++N)v+=i.subParser("makeMarkdown.node")(R[N],b);v+="**"}return v}),i.subParser("makeMarkdown.table",function(p,b){var v="",R=[[],[]],O=p.querySelectorAll("thead>tr>th"),N=p.querySelectorAll("tbody>tr"),T,$;for(T=0;T<O.length;++T){var Q=i.subParser("makeMarkdown.tableCell")(O[T],b),K="---";if(O[T].hasAttribute("style")){var Z=O[T].getAttribute("style").toLowerCase().replace(/\s/g,"");switch(Z){case"text-align:left;":K=":---";break;case"text-align:right;":K="---:";break;case"text-align:center;":K=":---:";break}}R[0][T]=Q.trim(),R[1][T]=K}for(T=0;T<N.length;++T){var H=R.push([])-1,M=N[T].getElementsByTagName("td");for($=0;$<O.length;++$){var Y=" ";typeof M[$]<"u"&&(Y=i.subParser("makeMarkdown.tableCell")(M[$],b)),R[H].push(Y)}}var te=3;for(T=0;T<R.length;++T)for($=0;$<R[T].length;++$){var ue=R[T][$].length;ue>te&&(te=ue)}for(T=0;T<R.length;++T){for($=0;$<R[T].length;++$)T===1?R[T][$].slice(-1)===":"?R[T][$]=i.helper.padEnd(R[T][$].slice(-1),te-1,"-")+":":R[T][$]=i.helper.padEnd(R[T][$],te,"-"):R[T][$]=i.helper.padEnd(R[T][$],te);v+="| "+R[T].join(" | ")+` |
`}return v.trim()}),i.subParser("makeMarkdown.tableCell",function(p,b){var v="";if(!p.hasChildNodes())return"";for(var R=p.childNodes,O=R.length,N=0;N<O;++N)v+=i.subParser("makeMarkdown.node")(R[N],b,!0);return v.trim()}),i.subParser("makeMarkdown.txt",function(p){var b=p.nodeValue;return b=b.replace(/ +/g," "),b=b.replace(/¨NBSP;/g," "),b=i.helper.unescapeHTMLEntities(b),b=b.replace(/([*_~|`])/g,"\\$1"),b=b.replace(/^(\s*)>/g,"\\$1>"),b=b.replace(/^#/gm,"\\#"),b=b.replace(/^(\s*)([-=]{3,})(\s*)$/,"$1\\$2$3"),b=b.replace(/^( {0,3}\d+)\./gm,"$1\\."),b=b.replace(/^( {0,3})([+-])/gm,"$1\\$2"),b=b.replace(/]([\s]*)\(/g,"\\]$1\\("),b=b.replace(/^ {0,3}\[([\S \t]*?)]:/gm,"\\[$1]:"),b});var U=this;n.exports?n.exports=i:U.showdown=i}).call(l)})(uQ);var yRe=uQ.exports;const JE=new Map([[We.START,B.Start],[We.START_SIGNAL,B.StartSignalOutline],[We.START_PROGRAM,B.StartProgramOutline],[We.START_ERROR,B.ErrorStart],[We.START_SUB,B.SubStartOutline],[We.START_WS,B.WsStartOutline],[We.START_HD,B.InitStartOutline],[We.START_HD_METHOD,B.MethodStartOutline],[We.START_HD_EVENT,B.EventStartOutline],[We.START_THIRD_PARTY,B.Extension],[nr.INTERMEDIATE_TASK,B.TaskDoubleOutline],[nr.INTERMEDIATE_WAIT,B.ClockOutline],[nr.INTERMEDIATE_THIRD_PARTY,B.Extension],[Sa.BOUNDARY_ERROR,B.ErrorStart],[Sa.BOUNDARY_SIGNAL,B.StartSignalOutline],[bn.END,B.ProcessEnd],[bn.END_PAGE,B.EndPageOutline],[bn.END_ERROR,B.ErrorEnd],[bn.END_SUB,B.SubEndOutline],[bn.END_WS,B.WsStartOutline],[bn.END_HD,B.ProcessEnd],[bn.END_HD_EXIT,B.ExitEndOutline],[So.ALTERNATIVE,B.AlternativeGateways],[So.SPLIT,B.JoinGateways],[So.JOIN,B.JoinGateways],[So.TASK,B.JoinTasksGateways],[ye.USER,B.UserTaskOutline],[ye.HD,B.UserDialogOutline],[ye.SCRIPT,B.ScriptFileOutline],[ye.EMBEDDED_PROCESS,B.SubActivitiesDashed],[ye.SUB_PROCESS,B.SubActivities],[ye.TRIGGER,B.TriggerOutline],[ye.DB,B.DatabaseOutline],[ye.SOAP,B.WebService],[ye.REST,B.RestClientOutline],[ye.EMAIL,B.EMailOutline],[ye.THIRD_PARTY,B.Extension],[ye.THIRD_PARTY_RULE,B.RuleOutline],[ye.PROGRAM,B.ProgramOutline],[ye.BPMN_GENERIC,B.SubActivitiesDashed],[ye.BPMN_USER,B.SubUserOutline],[ye.BPMN_MANUAL,B.SubManualOutline],[ye.BPMN_SCRIPT,B.SubScriptOutline],[ye.BPMN_SERVICE,B.SubWebService],[ye.BPMN_RULE,B.SubRuleOutline],[ye.BPMN_SEND,B.SubSendOutline],[ye.BPMN_RECEIVE,B.SubReceiveOutline],[ye.COMMENT,B.NoteOutline],[ra.POOL,B.PoolSwimlanes],[ra.LANE,B.LaneSwimlanes]]);class bRe{constructor(){k(this,"menuCssClass",["bar-menu","simple-menu"]);k(this,"bodyDiv")}create(e){return this.bodyDiv=Ae("div",this.menuCssClass),e.appendChild(this.bodyDiv),this.createMenuBody(this.bodyDiv),this.bodyDiv}remove(){var e;(e=this.bodyDiv)==null||e.remove()}}const Ho=class Ho{constructor(e,t){k(this,"actionDispatcher");k(this,"action");k(this,"menuCssClass",["bar-menu"]);k(this,"paletteItems");k(this,"paletteItemsCopy",[]);k(this,"bodyDiv");k(this,"searchField");k(this,"itemsDiv");this.actionDispatcher=e,this.action=t,this.paletteItems=this.action.paletteItems(),this.paletteItemsCopy=JSON.parse(JSON.stringify(this.paletteItems))}create(e){return this.bodyDiv=Ae("div",this.menuCssClass),e.appendChild(this.bodyDiv),this.action.customCssClass&&this.bodyDiv.classList.add(this.action.customCssClass),this.action.showSearch&&this.bodyDiv.appendChild(this.createPaletteItemSearchField()),this.createItemsDiv(this.bodyDiv),this.appendMenuParts(this.bodyDiv),this.bodyDiv}remove(){var e;(e=this.bodyDiv)==null||e.remove()}appendMenuParts(e){}createPaletteItemSearchField(){const e=Ae("div",["bar-menu-search"]);return e.appendChild(Tr(B.Search)),this.searchField=Ae("input",["menu-search-input"]),this.searchField.type="text",this.searchField.placeholder="Search",this.searchField.onkeyup=t=>this.filterKeyUp(t),this.searchField.onkeydown=t=>this.clearSearchInputOnEscape(t),setTimeout(()=>{var t;return(t=this.searchField)==null?void 0:t.focus()},1),e.appendChild(this.searchField),e}filterKeyUp(e){var t;zi(e,"ArrowUp")||zi(e,"ArrowLeft")?this.navigateUpOrDown(-1):zi(e,"ArrowDown")||zi(e,"ArrowRight")?this.navigateUpOrDown(1):zi(e,"Enter")?this.triggerItem():this.requestFilterUpdate(((t=this.searchField)==null?void 0:t.value)??"")}clearSearchInputOnEscape(e){zi(e,"Escape")&&this.searchField&&(this.searchField.value="",this.requestFilterUpdate(""))}requestFilterUpdate(e){this.paletteItems=JSON.parse(JSON.stringify(this.paletteItemsCopy));const t=[];for(const i of this.paletteItems)if(i.children){const o=i.children.filter(r=>r.label.toLowerCase().includes(e.toLowerCase()));o.length>0&&(i.children.splice(0,i.children.length),o.forEach(r=>i.children.push(r)),t.push(i))}this.paletteItems=t,this.bodyDiv&&this.createItemsDiv(this.bodyDiv)}navigateUpOrDown(e){if(this.itemsDiv){const t=Array.from(this.itemsDiv.querySelectorAll(`.${Ho.ITEM_BUTTON}`)),i=t.filter(s=>s.classList.contains(Ho.ACTIVE_ELEMENT))[0];let o=t.indexOf(i)+e;o<0?o=t.length-1:o>=t.length&&(o=0);const r=t[o];this.focusButton(r),r==null||r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}}triggerItem(){const e=this.currentItem();e==null||e.click()}createItemsDiv(e){const t=Ae("div",["bar-menu-items"]);let i=0;if(this.paletteItems.sort(m.compare).forEach(o=>{if(o.children){const r=this.createToolGroup(t,o);o.children.sort(m.compare).forEach(s=>r.appendChild(this.createToolButton(s,i++))),this.appendItemToGroup(r)}}),this.paletteItems.length===0){const o=Ae("div");o.innerText="No results found.",o.classList.add("no-result"),t.appendChild(o)}this.itemsDiv&&e.removeChild(this.itemsDiv),e.appendChild(t),this.itemsDiv=t,this.navigateUpOrDown(1)}appendItemToGroup(e){}createToolGroup(e,t){const i=Ae("div",[Ho.ITEM_GROUP]);i.id=t.id,e.appendChild(i);const o=Ae("div",["menu-group-header"]);o.textContent=t.label,i.appendChild(o);const r=Ae("div",["menu-group-items"]);return i.appendChild(r),r}createToolButton(e,t){const i=Ae("div",[Ho.ITEM_BUTTON]);return i.tabIndex=t,i.appendChild(this.appendPaletteIcon(i,e)),i.insertAdjacentText("beforeend",e.label),i.onclick=o=>this.actionDispatcher.dispatchAll(this.toolButtonOnClick(e)),i.onmouseenter=o=>this.focusButton(i),this.appendToToolButton(i,e),i}appendToToolButton(e,t){}focusButton(e){var t;(t=this.currentItem())==null||t.classList.remove(Ho.ACTIVE_ELEMENT),e==null||e.classList.add(Ho.ACTIVE_ELEMENT)}currentItem(){var e;return(e=this.itemsDiv)==null?void 0:e.querySelector(`.${Ho.ITEM_BUTTON}.${Ho.ACTIVE_ELEMENT}`)}appendPaletteIcon(e,t){return t.icon?Tr(this.resolveIcon(t.icon)):Tr()}resolveIcon(e){const t=JE.get(e);if(!t){if(e.startsWith(ye.THIRD_PARTY))return JE.get(ye.THIRD_PARTY);if(e.startsWith(We.START_THIRD_PARTY))return JE.get(We.START_THIRD_PARTY);if(e.startsWith(nr.INTERMEDIATE_THIRD_PARTY))return JE.get(nr.INTERMEDIATE_THIRD_PARTY)}return t}};k(Ho,"ACTIVE_ELEMENT","focus"),k(Ho,"ITEM_GROUP","menu-group"),k(Ho,"ITEM_BUTTON","menu-item");let r0=Ho;class SRe{constructor(e,t,i){k(this,"actionDispatcher");k(this,"elementIds");k(this,"editUi");k(this,"item");k(this,"colorNameInput");k(this,"colorInput");k(this,"colorPickerInput");k(this,"colorPickerDecorator");k(this,"deleteBtn");this.actionDispatcher=e,this.elementIds=t,this.editUi=this.createEditUi(i)}showEditUi(e){this.item=e,this.setInputValue(this.colorNameInput,e==null?void 0:e.label),this.setInputValue(this.colorInput,e==null?void 0:e.icon),this.setInputValue(this.colorPickerInput,e==null?void 0:e.icon),this.colorPickerDecorator&&(this.colorPickerDecorator.style.backgroundColor=(e==null?void 0:e.icon)??""),this.deleteBtn&&(this.deleteBtn.style.display=e?"block":"none"),this.editUi.style.display="block"}setInputValue(e,t){e&&(e.value=t??"")}createEditUi(e){const t=Ae("div",["edit-color"]);return t.appendChild(this.createBody()),t.appendChild(this.createFooter()),e.appendChild(t),t}createBody(){const e=Ae("div",["edit-color-body"]),[t,i]=this.createInput("Name",this.colorNameInput);e.appendChild(t),this.colorNameInput=i;const[o,r]=this.createInput("Color",this.colorInput,!0);return e.appendChild(o),this.colorInput=r,e}createInput(e,t,i=!1){const o=`input-${e}`,r=Ae("div",["edit-color-input"]),s=Ae("label");if(s.htmlFor=o,s.textContent=e,r.appendChild(s),t=document.createElement("input"),t.name=e,t.id=o,i){const a=Ae("div",["color-picker"]);this.colorPickerDecorator=Ae("span",["decorator"]),this.colorPickerInput=document.createElement("input"),this.colorPickerDecorator.onclick=()=>this.colorPickerInput.click(),this.colorPickerInput.type="color",this.colorPickerInput.onchange=f=>this.colorInputChange(f.target),t.onchange=f=>this.colorInputChange(f.target),a.appendChild(this.colorPickerDecorator),a.appendChild(this.colorPickerInput),a.appendChild(t),r.appendChild(a)}else r.appendChild(t);return[r,t]}colorInputChange(e){if(e instanceof HTMLInputElement){const t=e.value;this.colorPickerInput.value=t,this.colorPickerDecorator.style.backgroundColor=t,this.colorInput.value=t}}createFooter(){const e=Ae("footer",["edit-color-footer"]);this.deleteBtn=Ae("button",["edit-color-delete"]),this.deleteBtn.textContent="Delete",this.deleteBtn.autofocus=!0,this.deleteBtn.type="button",this.deleteBtn.onclick=()=>this.deleteColor();const t=Ae("button",["edit-color-save"]);return t.textContent="Save",t.type="button",t.onclick=i=>this.validateInputsAndRun(()=>this.changeColor()),e.appendChild(this.deleteBtn),e.appendChild(t),e}validateInputsAndRun(e){const t=this.validateInput(this.colorNameInput),i=this.validateInput(this.colorInput);t&&i&&e()}validateInput(e){if(e){if(e.value==="")return e.classList.add("error"),!1;e.classList.remove("error")}return!0}deleteColor(){this.item&&this.actionDispatcher.dispatch(Xy.deleteColor({elementIds:this.elementIds,oldColor:this.item.label}))}changeColor(){var i,o;const e=((i=this.colorNameInput)==null?void 0:i.value)??"",t=((o=this.colorInput)==null?void 0:o.value)??"";this.actionDispatcher.dispatch(Xy.create({elementIds:this.elementIds,color:t,colorName:e}))}}var Cs;(function(n){n.KIND="showQuickActionMenu";function e(o){return{kind:n.KIND,...o}}n.create=e;function t(){return e({elementIds:[],paletteItems:()=>[],actions:(o,r)=>[]})}n.empty=t;function i(o){return m.Action.hasKind(o,n.KIND)}n.is=i})(Cs||(Cs={}));class ERe extends r0{constructor(t,i){super(t,i);k(this,"actionDispatcher");k(this,"action");k(this,"menuCssClass",["bar-menu","quick-action-bar-menu"]);k(this,"editUi");this.actionDispatcher=t,this.action=i}appendMenuParts(t){this.action.isEditable&&(this.editUi=new SRe(this.actionDispatcher,this.action.elementIds,t))}remove(){var t;(t=this.bodyDiv)==null||t.remove()}appendItemToGroup(t){if(this.action.isEditable){const i=Ae("div",[r0.ITEM_BUTTON,"new-color-btn"]);i.appendChild(Ae("span",["new-color-icon","ivy",`ivy-${B.Plus}`])),i.insertAdjacentText("beforeend","New Color"),i.onclick=()=>{var o;return(o=this.editUi)==null?void 0:o.showEditUi()},i.onmouseenter=o=>this.focusButton(i),t.appendChild(i)}}toolButtonOnClick(t){return this.action.actions(t,this.action.elementIds)}appendToToolButton(t,i){this.action.isEditable&&i.label!=="default"&&t.appendChild(this.createEditButton(i))}createEditButton(t){const i=Tr(B.Edit,["color-edit-button"]);return i.title="Edit Color",i.onclick=o=>{var r;o.stopPropagation(),(r=this.editUi)==null||r.showEditUi(t)},i}appendPaletteIcon(t,i){if(this.action.isEditable)if(i.icon&&i.icon.length>0){const o=Ae("span",["color-icon"]);return o.style.backgroundColor=i.icon,o}else return Ae("span",["empty-icon"]);return super.appendPaletteIcon(t,i)}}var Um;(function(n){n.KIND="showSimpleQuickActionMenu";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return m.Action.hasKind(i,n.KIND)}n.is=t})(Um||(Um={}));class CRe extends bRe{constructor(t){super();k(this,"action");this.action=t}createMenuBody(t){const i=Ae("div",["bar-menu-text"]);if(t.appendChild(i),this.action.title&&i.appendChild(this.createTitle(this.action.title)),this.action.markers.forEach(o=>i.appendChild(this.createMarker(o))),this.action.text&&i.appendChild(this.createDescription(this.action.text)),this.action.info)for(const[o,r]of Object.entries(this.action.info))i.appendChild(this.addInfo(o,r));i.appendChild(this.createInfo("PID",this.action.elementId))}addInfo(t,i){switch(i.type){case"STRING":return this.createInfo(t,i.value);case"CODE":return this.createCodeInfo(t,i.value)}}createTitle(t){const i=Ae("p",["simple-menu-header"]);return i.textContent=t,i}createCodeInfo(t,i){const o=Ae("p",["simple-menu-text","simple-menu-small"]),r=Ae("strong");r.textContent=`${t}: `,o.prepend(r);const s=Ae("pre");return s.textContent=i,o.appendChild(s),o}createInfo(t,i){const o=Ae("p",["simple-menu-text","simple-menu-small"]),r=Ae("strong");return o.textContent=i,r.textContent=`${t}: `,o.prepend(r),o}createDescription(t){const o=new yRe.Converter({simpleLineBreaks:!0}).makeHtml(t),r=document.createElement("template");r.innerHTML=o;const s=Ae("div",["simple-menu-text"]);for(const a of r.content.childNodes)s.appendChild(a);return s}createMarker(t){const i=Ae("div",["menu-marker"]);return t.issues.forEach(o=>i.appendChild(this.createIssue(o))),i}createIssue(t){const i=Ae("div",["menu-issue"]),o=Ae("div",["menu-issue-title"]);o.appendChild(Tr(this.ivyIconForSeverity(t.severity)));const r=Ae("span");r.textContent=t.severity==="error"?"Error":"Caution",o.appendChild(r),i.appendChild(o);const s=Ae("p",["menu-issue-message"]);return s.textContent=t.message,i.appendChild(s),i}ivyIconForSeverity(t){switch(t){case"info":return B.InfoCircle;case"warning":return B.Caution;case"error":return B.ErrorXMark}}}var hh=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Wd=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},pp,Il;let Bt=(Il=class extends m.GLSPAbstractUIExtension{constructor(){super(...arguments);k(this,"activeQuickActions",[]);k(this,"activeQuickActionBtn");k(this,"quickActionBar");k(this,"quickActionMenu");k(this,"actionDispatcherProvider");k(this,"selectionService");k(this,"mouseTool");k(this,"editorContext");k(this,"quickActionProviders")}id(){return pp.ID}init(){this.selectionService.onSelectionChanged(t=>this.selectionChanged(t.root,t.selectedElements)),this.mouseTool.register(new PRe(this))}containerClass(){return"quick-actions-container"}getActiveQuickActions(){return this.activeQuickActions}initializeContents(t){t.style.position="absolute",t.onwheel=i=>i.ctrlKey?i.preventDefault():!0}selectionChanged(t,i){var o;(o=this.editorContext.modelRoot.cssClasses)!=null&&o.includes(m.CursorCSS.MARQUEE)||i.length<1?this.hideUi():this.showUi()}handle(t){Cs.is(t)&&this.showItemMenu(t),Um.is(t)&&this.showSimpleMenu(t),m.RemoveMarqueeAction.is(t)&&this.editorContext.selectedElements.length>0&&this.showUi()}showSimpleMenu(t){this.removeMenu(),this.quickActionMenu=new CRe(t),this.createMenu(this.quickActionMenu)}async showItemMenu(t){this.removeMenu(),t.elementIds.length>0?(this.quickActionMenu=new ERe(await this.actionDispatcherProvider(),t),this.createMenu(this.quickActionMenu)):this.setActiveQuickActionBtn()}createMenu(t){if(this.quickActionBar){const i=t.create(this.containerElement);i.offsetWidth>this.quickActionBar.offsetWidth?(i.classList.add("border-radius"),this.quickActionBar.classList.add("no-bottom-border-radius"),this.shiftBar(i,8)):this.shiftBar(i,24)}}removeMenu(){var t;(t=this.quickActionMenu)==null||t.remove(),this.quickActionMenu=void 0}showUi(){this.activeQuickActions=[],this.actionDispatcherProvider().then(t=>t.dispatch(m.SetUIExtensionVisibilityAction.create({extensionId:pp.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]})))}hideUi(){this.activeQuickActions=[],this.actionDispatcherProvider().then(t=>t.dispatch(m.SetUIExtensionVisibilityAction.create({extensionId:pp.ID,visible:!1})))}onBeforeShow(t,i,...o){t.innerHTML="";const r=wRe(o,i),s=r.filter(a=>!(a instanceof m.GRoutableElement)||!(a instanceof xm));if(s.length>1)this.showMultiQuickActionUi(t,s);else if(r.length===1&&r[0]instanceof m.GEdge&&YZ(r[0]))this.showEdgeQuickActionUi(t,r[0]);else{const a=ARe(s);this.showSingleQuickActionUi(t,a)}}showMultiQuickActionUi(t,i){if(this.activeQuickActions=this.loadMultiQuickActions(i),this.activeQuickActions.length===0)return;const o=i.filter(r=>!(r instanceof l4)).map(m.getAbsoluteBounds).filter(m.Bounds.isValid).reduce(m.Bounds.combine);this.quickActionBar=this.createQuickActionsBar(t,o,!0),this.createQuickActions(this.quickActionBar,this.activeQuickActions),this.shiftBar(this.quickActionBar)}showSingleQuickActionUi(t,i){if(m.isNotUndefined(i)){if(this.activeQuickActions=this.loadSingleQuickActions(i),this.activeQuickActions.length===0)return;this.quickActionBar=this.createQuickActionsBar(t,m.getAbsoluteBounds(i)),this.createQuickActions(this.quickActionBar,this.activeQuickActions),this.shiftBar(this.quickActionBar)}}showEdgeQuickActionUi(t,i){if(m.isNotUndefined(i)&&!i.id.endsWith("_feedback_edge")&&i.source&&i.target){if(this.activeQuickActions=this.loadSingleQuickActions(i),this.activeQuickActions.length===0)return;const o=dQ(i);this.quickActionBar=this.createQuickActionsBar(t,o),this.createQuickActions(this.quickActionBar,this.activeQuickActions),this.shiftBar(this.quickActionBar)}}shiftBar(t,i=16){const o=t.getBoundingClientRect();let r=o.width/2;const s=o.x+o.width+i-r,a=this.getParentContainer();s>a.offsetWidth&&(r+=s-a.offsetWidth);const f=o.x-i;r>f&&(r=f),t.style.marginLeft=`${-r}px`}createQuickActionsBar(t,i,o=!1){if(t.style.left=`${i.x+i.width/2}px`,t.style.top=`${i.y+i.height}px`,o){const s=Ae("div",["multi-selection-box"]);s.style.marginLeft=`-${i.width/2}px`,s.style.marginTop=`-${i.height}px`,s.style.height=`${i.height+10}px`,s.style.width=`${i.width+10}px`,t.appendChild(s)}const r=Ae("div",["quick-actions-bar"]);return t.appendChild(r),r}createQuickActions(t,i){this.createQuickActionGroup(t,i,"Left"),this.createQuickActionGroup(t,i,"Middle"),this.createQuickActionGroup(t,i,"Right"),this.setContainerVisible(!0)}createQuickActionGroup(t,i,o){const r=Ae("div",["quick-actions-group"]);i.filter(s=>s.location===o).sort((s,a)=>s.sorting.localeCompare(a.sorting)).forEach(s=>{r.appendChild(this.createQuickActionBtn(s))}),r.children.length>0&&t.appendChild(r)}createQuickActionBtn(t){const i=Ae("span");i.appendChild(Tr(t.icon)),i.title=t.title;const o=[t.action];return t.letQuickActionsOpen||o.push(m.SetUIExtensionVisibilityAction.create({extensionId:pp.ID,visible:!1})),t.removeSelection&&o.push(m.SelectAllAction.create(!1)),i.onclick=()=>this.triggerQuickActionBtn(i,o),i}triggerQuickActionBtn(t,i){this.activeQuickActionBtn===t&&this.quickActionMenu?(this.setActiveQuickActionBtn(),this.removeMenu()):(this.setActiveQuickActionBtn(t),this.actionDispatcherProvider().then(o=>o.dispatchAll(i)))}setActiveQuickActionBtn(t){var i,o;(i=this.activeQuickActionBtn)==null||i.classList.remove("active"),this.activeQuickActionBtn=t,(o=this.activeQuickActionBtn)==null||o.classList.add("active")}loadSingleQuickActions(t){return this.filterQuickActions(this.quickActionProviders.map(i=>i.singleQuickAction(t)))}loadMultiQuickActions(t){return this.filterQuickActions(this.quickActionProviders.map(i=>i.multiQuickAction(t)))}filterQuickActions(t){return t.filter(m.isNotUndefined).filter(i=>!this.isReadonly()||i.readonlySupport)}isReadonly(){return this.editorContext.isReadonly}},pp=Il,k(Il,"ID","quickActionsUi"),Il);hh([_e(m.TYPES.IActionDispatcherProvider),Wd("design:type",Function)],Bt.prototype,"actionDispatcherProvider",void 0);hh([_e(m.SelectionService),Wd("design:type",m.SelectionService)],Bt.prototype,"selectionService",void 0);hh([_e(m.GLSPMouseTool),Wd("design:type",m.GLSPMouseTool)],Bt.prototype,"mouseTool",void 0);hh([_e(m.EditorContextService),Wd("design:type",m.EditorContextService)],Bt.prototype,"editorContext",void 0);hh([L6(Ue.QuickActionProvider),Wd("design:type",Array)],Bt.prototype,"quickActionProviders",void 0);hh([p0(),Wd("design:type",Function),Wd("design:paramtypes",[]),Wd("design:returntype",void 0)],Bt.prototype,"init",null);Bt=pp=hh([le()],Bt);class PRe extends m.MouseListener{constructor(t){super();k(this,"quickActionUi");this.quickActionUi=t}wheel(t,i){return this.quickActionUi.showUi(),[]}}function wRe(n,e){return n.map(t=>e.index.getById(t)).filter(m.isNotUndefined)}function ARe(n,e){return n.filter(YZ)[0]}var EM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},g4=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Ym=class extends m.KeyListener{constructor(){super(...arguments);k(this,"selectionService");k(this,"movementRestrictor");k(this,"gridManager")}keyDown(t,i){const o=this.moveDelta(i);return o===void 0?[]:this.selectionService.hasSelectedElements()?this.moveElements(o):this.moveGraph(t,o)}moveDelta(t){if(zi(t,"ArrowUp"))return{x:0,y:-this.gridManager.grid.y};if(zi(t,"ArrowDown"))return{x:0,y:this.gridManager.grid.y};if(zi(t,"ArrowLeft"))return{x:-this.gridManager.grid.x,y:0};if(zi(t,"ArrowRight"))return{x:this.gridManager.grid.x,y:0}}moveGraph(t,i){const o=m.findParentByFeature(t,m.isViewport);if(o===void 0)return[];const r={scroll:{x:o.scroll.x+i.x,y:o.scroll.y+i.y},zoom:o.zoom};return[m.SetViewportAction.create(o.id,r,{animate:!1})]}moveElements(t){let i=m.getElements(this.selectionService.getModelRoot().index,Array.from(this.selectionService.getSelectedElementIDs()),m.isBoundsAware);if(i=i.filter(r=>!this.isChildOfSelected(i,r)).filter(r=>r.hasFeature(m.boundsFeature)),i.length===0)return[];const o=i.filter(r=>this.isMovementAllowed(r,t)).map(r=>this.getElementAndUpdatedBound(r,t));return o.length!==i.length?[]:[ct.ChangeBoundsOperation.create(o),m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!0,contextElementsId:[...i.map(r=>r.id)]})]}isChildOfSelected(t,i){return i instanceof m.GChildElement&&t.includes(i.parent)}isMovementAllowed(t,i){if(this.movementRestrictor){const o=this.updatePosition(t,i);return this.movementRestrictor.validate(t,o)}return!0}getElementAndUpdatedBound(t,i){const o=m.toElementAndBounds(t);return o.newPosition=this.updatePosition(t,i),o}updatePosition(t,i){return{x:t.bounds.x+i.x,y:t.bounds.y+i.y}}};EM([_e(m.SelectionService),g4("design:type",m.SelectionService)],Ym.prototype,"selectionService",void 0);EM([_e(m.TYPES.IMovementRestrictor),tg(),g4("design:type",Object)],Ym.prototype,"movementRestrictor",void 0);EM([_e(m.GridManager),g4("design:type",m.GridManager)],Ym.prototype,"gridManager",void 0);Ym=EM([le()],Ym);var v4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},lQ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let qm=class extends m.KeyListener{constructor(){super(...arguments);k(this,"selectionService");k(this,"quickActionUi")}keyDown(t,i){return zi(i,"KeyJ")&&this.isJumpOutActive()?[yf.create({elementId:""})]:[]}isJumpOutActive(){return this.selectionService.getModelRoot().id.includes("-")&&!this.isJumpIntoActive()}isJumpIntoActive(){return this.quickActionUi.getActiveQuickActions().map(t=>t.action).map(t=>t.kind).some(t=>t==="jumpInto")}};v4([_e(m.SelectionService),lQ("design:type",m.SelectionService)],qm.prototype,"selectionService",void 0);v4([_e(Bt),lQ("design:type",Bt)],qm.prototype,"quickActionUi",void 0);qm=v4([le()],qm);var fQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},RRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let s0=class extends m.KeyListener{constructor(){super(...arguments);k(this,"quickActionUi")}keyDown(t,i){const o=this.quickActionUi.getActiveQuickActions().filter(r=>r.shortcut&&zi(i,r.shortcut));return o.length===1&&!o[0].letQuickActionsOpen?[o[0].action,m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!1})]:o.map(r=>r.action)}};fQ([_e(Bt),RRe("design:type",Bt)],s0.prototype,"quickActionUi",void 0);s0=fQ([le()],s0);const hQ=new m.FeatureModule(n=>{n(m.TYPES.KeyListener).to(Ym),n(m.TYPES.KeyListener).to(s0),n(m.TYPES.KeyListener).to(qm)});var MRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let VL=class extends ni{singleQuickAction(e){if(e instanceof Ea&&e.type===ra.POOL)return{icon:B.LaneSwimlanes,title:"Create Lane",location:"Right",sorting:"A",letQuickActionsOpen:!0,action:m.CreateNodeOperation.create(ra.LANE,{containerId:e.id})}}};VL=MRe([le()],VL);const pQ=new m.FeatureModule((n,e,t)=>{n(Ue.QuickActionProvider).to(VL)});var mQ={exports:{}};/*!
 * Toastify js 1.12.0
 * https://github.com/apvarun/toastify-js
 * @license MIT licensed
 *
 * Copyright (C) 2018 Varun A P
 */(function(n){(function(e,t){n.exports?n.exports=t():e.Toastify=t()})(l,function(e){var t=function(s){return new t.lib.init(s)},i="1.12.0";t.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,ariaLive:"polite",style:{background:""}},t.lib=t.prototype={toastify:i,constructor:t,init:function(s){return s||(s={}),this.options={},this.toastElement=null,this.options.text=s.text||t.defaults.text,this.options.node=s.node||t.defaults.node,this.options.duration=s.duration===0?0:s.duration||t.defaults.duration,this.options.selector=s.selector||t.defaults.selector,this.options.callback=s.callback||t.defaults.callback,this.options.destination=s.destination||t.defaults.destination,this.options.newWindow=s.newWindow||t.defaults.newWindow,this.options.close=s.close||t.defaults.close,this.options.gravity=s.gravity==="bottom"?"toastify-bottom":t.defaults.gravity,this.options.positionLeft=s.positionLeft||t.defaults.positionLeft,this.options.position=s.position||t.defaults.position,this.options.backgroundColor=s.backgroundColor||t.defaults.backgroundColor,this.options.avatar=s.avatar||t.defaults.avatar,this.options.className=s.className||t.defaults.className,this.options.stopOnFocus=s.stopOnFocus===void 0?t.defaults.stopOnFocus:s.stopOnFocus,this.options.onClick=s.onClick||t.defaults.onClick,this.options.offset=s.offset||t.defaults.offset,this.options.escapeMarkup=s.escapeMarkup!==void 0?s.escapeMarkup:t.defaults.escapeMarkup,this.options.ariaLive=s.ariaLive||t.defaults.ariaLive,this.options.style=s.style||t.defaults.style,s.backgroundColor&&(this.options.style.background=s.backgroundColor),this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var s=document.createElement("div");s.className="toastify on "+this.options.className,this.options.position?s.className+=" toastify-"+this.options.position:this.options.positionLeft===!0?(s.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):s.className+=" toastify-right",s.className+=" "+this.options.gravity,this.options.backgroundColor&&console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.');for(var a in this.options.style)s.style[a]=this.options.style[a];if(this.options.ariaLive&&s.setAttribute("aria-live",this.options.ariaLive),this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)s.appendChild(this.options.node);else if(this.options.escapeMarkup?s.innerText=this.options.text:s.innerHTML=this.options.text,this.options.avatar!==""){var f=document.createElement("img");f.src=this.options.avatar,f.className="toastify-avatar",this.options.position=="left"||this.options.positionLeft===!0?s.appendChild(f):s.insertAdjacentElement("afterbegin",f)}if(this.options.close===!0){var h=document.createElement("button");h.type="button",h.setAttribute("aria-label","Close"),h.className="toast-close",h.innerHTML="&#10006;",h.addEventListener("click",(function(E){E.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}).bind(this));var g=window.innerWidth>0?window.innerWidth:screen.width;(this.options.position=="left"||this.options.positionLeft===!0)&&g>360?s.insertAdjacentElement("afterbegin",h):s.appendChild(h)}if(this.options.stopOnFocus&&this.options.duration>0){var y=this;s.addEventListener("mouseover",function(E){window.clearTimeout(s.timeOutValue)}),s.addEventListener("mouseleave",function(){s.timeOutValue=window.setTimeout(function(){y.removeElement(s)},y.options.duration)})}if(typeof this.options.destination<"u"&&s.addEventListener("click",(function(E){E.stopPropagation(),this.options.newWindow===!0?window.open(this.options.destination,"_blank"):window.location=this.options.destination}).bind(this)),typeof this.options.onClick=="function"&&typeof this.options.destination>"u"&&s.addEventListener("click",(function(E){E.stopPropagation(),this.options.onClick()}).bind(this)),typeof this.options.offset=="object"){var S=o("x",this.options),P=o("y",this.options),w=this.options.position=="left"?S:"-"+S,C=this.options.gravity=="toastify-top"?P:"-"+P;s.style.transform="translate("+w+","+C+")"}return s},showToast:function(){this.toastElement=this.buildToast();var s;if(typeof this.options.selector=="string"?s=document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||typeof ShadowRoot<"u"&&this.options.selector instanceof ShadowRoot?s=this.options.selector:s=document.body,!s)throw"Root element is not defined";var a=t.defaults.oldestFirst?s.firstChild:s.lastChild;return s.insertBefore(this.toastElement,a),t.reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout((function(){this.removeElement(this.toastElement)}).bind(this),this.options.duration)),this},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(s){s.className=s.className.replace(" on",""),window.setTimeout((function(){this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),s.parentNode&&s.parentNode.removeChild(s),this.options.callback.call(s),t.reposition()}).bind(this),400)}},t.reposition=function(){for(var s={top:15,bottom:15},a={top:15,bottom:15},f={top:15,bottom:15},h=document.getElementsByClassName("toastify"),g,y=0;y<h.length;y++){r(h[y],"toastify-top")===!0?g="toastify-top":g="toastify-bottom";var S=h[y].offsetHeight;g=g.substr(9,g.length-1);var P=15,w=window.innerWidth>0?window.innerWidth:screen.width;w<=360?(h[y].style[g]=f[g]+"px",f[g]+=S+P):r(h[y],"toastify-left")===!0?(h[y].style[g]=s[g]+"px",s[g]+=S+P):(h[y].style[g]=a[g]+"px",a[g]+=S+P)}return this};function o(s,a){return a.offset[s]?isNaN(a.offset[s])?a.offset[s]:a.offset[s]+"px":"0px"}function r(s,a){return!s||typeof a!="string"?!1:!!(s.className&&s.className.trim().split(/\s+/gi).indexOf(a)>-1)}return t.lib.init.prototype=t.lib,t})})(mQ);var IRe=mQ.exports;const gQ=Yoe(IRe);var DRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let Cd=class{constructor(){k(this,"duration",2e3);k(this,"messageToast");k(this,"progressMessages",new Map)}handle(e){if(m.MessageAction.is(e))return this.updateToast(e.message,e.severity);if(m.StartProgressAction.is(e))return this.updateToast(this.progress(e),"INFO");if(m.UpdateProgressAction.is(e))return this.updateToast(this.progress(e),"INFO");if(m.EndProgressAction.is(e))return this.updateToast(this.progress(e),"NONE")}progress(e){m.StartProgressAction.is(e)&&this.progressMessages.set(e.progressId,e.title);let t=this.progressMessages.get(e.progressId)??"";e.message&&(t+=t.length>0?`${t}: ${e.message}`:e.message);const i=m.EndProgressAction.is(e)?void 0:e.percentage;return i&&i>0&&(t+=t.length>0?`${t} (${i}%)`:`${i}%`),m.EndProgressAction.is(e)&&this.progressMessages.delete(e.progressId),t}message(e){var t;(t=this.messageToast)==null||t.hideToast(),e.severity!=="NONE"&&(this.messageToast=this.createToast(e.message,e.severity),this.messageToast.showToast())}updateToast(e,t){var i;(i=this.messageToast)==null||i.hideToast(),t!=="NONE"&&(this.messageToast=this.createToast(e,t),this.messageToast.showToast())}createToast(e,t){return gQ({text:e,close:!0,gravity:"bottom",position:"left",className:`severity-${t}`,duration:t==="ERROR"?void 0:this.duration})}};Cd=DRe([le()],Cd);const TRe=new m.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};n(Cd).toSelf().inSingletonScope(),m.configureActionHandler(o,m.StatusAction.KIND,Cd),m.configureActionHandler(o,m.MessageAction.KIND,Cd),m.configureActionHandler(o,m.StartProgressAction.KIND,Cd),m.configureActionHandler(o,m.UpdateProgressAction.KIND,Cd),m.configureActionHandler(o,m.EndProgressAction.KIND,Cd)}),ORe=()=>({hideSensitiveInfo:!1});function LRe(n,e){const t=n.get(Ue.IvyViewerOptions);return Hz(t,e),t}var NRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let zL=class extends m.GLSPSvgExporter{getBounds(e){const t=[];return e.index.all().filter(i=>i.root!==i).filter(i=>!(i instanceof WZ)).forEach(i=>{i instanceof m.GNode&&t.push(m.getAbsoluteBounds(i)),i instanceof Ku&&i.text.length>0&&t.push(_Re(i)),i instanceof m.GEdge&&t.push(dQ(i))}),t.filter(m.Bounds.isValid).reduce(m.Bounds.combine)}};zL=NRe([le()],zL);var vQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},jRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Kw=class extends m.ChangeBoundsManager{constructor(){super(...arguments);k(this,"selectionService")}addMoveFeedback(t,i,o,r){return super.addMoveFeedback(t,i,o,r),this.hideQuickUIFeedback(t),this.showNegativeArea(t),t}addResizeFeedback(t,i,o,r){return super.addResizeFeedback(t,i,o,r),this.hideQuickUIFeedback(t),this.showNegativeArea(t),t}hideQuickUIFeedback(t){t.add(m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!1}),m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]}))}showNegativeArea(t){t.add(i0.create({visible:!0}),i0.create({visible:!1}))}};vQ([_e(m.SelectionService),jRe("design:type",m.SelectionService)],Kw.prototype,"selectionService",void 0);Kw=vQ([le()],Kw);var BRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let GL=class extends m.RankedSelectMouseListener{mouseUp(e,t){return this.isMouseDown?super.mouseUp(e,t):[]}};GL=BRe([le()],GL);const _Q=new m.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};m.configureCommand(o,m.ShowChangeBoundsToolResizeFeedbackCommand),m.configureCommand(o,m.HideChangeBoundsToolResizeFeedbackCommand),m.bindAsService(o,m.TYPES.IDefaultTool,m.ChangeBoundsTool),m.bindAsService(o,m.ChangeBoundsManager,Kw),m.configureView(o,m.GResizeHandle.TYPE,OL),m.configureCommand(o,jw)},{featureId:m.changeBoundsToolModule.featureId}),$Re=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.bindAsService(i,m.TYPES.HiddenVNodePostprocessor,m.ExportSvgPostprocessor),m.configureCommand(i,m.ExportSvgCommand),m.bindAsService(i,m.TYPES.SvgExporter,zL)},{featureId:m.exportModule.featureId}),kRe=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.configureCommand(i,m.SelectCommand),m.configureCommand(i,m.SelectAllCommand),m.configureCommand(i,m.SelectFeedbackCommand),m.bindAsService(i,m.TYPES.MouseListener,GL)},{featureId:m.selectModule.featureId});var yQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},FRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let $d=class{constructor(){k(this,"actionDispatcher");k(this,"paletteItems",[])}getPaletteItems(){return this.paletteItems}handle(e){ba.is(e)&&this.updateColorPalette(),ww.is(e)&&(this.paletteItems=e.paletteItems,this.actionDispatcher.dispatch(Cs.empty()))}async updateColorPalette(){this.actionDispatcher.request(m.RequestContextActions.create({contextId:"ivy-tool-color-palette",editorContext:{selectedElementIds:[]}})).then(e=>{m.SetContextActions.is(e)&&(this.paletteItems=e.actions.map(t=>t))})}};yQ([_e(m.TYPES.IActionDispatcher),FRe("design:type",m.GLSPActionDispatcher)],$d.prototype,"actionDispatcher",void 0);$d=yQ([le()],$d);var _4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},bQ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let a0=class{constructor(){k(this,"colors");k(this,"actionDispatcher");k(this,"actions",(e,t)=>[Xy.changeColor({elementIds:t,color:e.icon,colorName:e.label})])}singleQuickAction(e){return this.quickAction([e.id],()=>this.colors.getPaletteItems())}multiQuickAction(e){return this.quickAction(e.map(t=>t.id),()=>this.colors.getPaletteItems())}quickAction(e,t){return{icon:B.ColorDrop,title:"Select color",location:"Middle",sorting:"Z",action:Cs.create({elementIds:e,paletteItems:t,actions:this.actions,customCssClass:"colors-menu",isEditable:!0}),letQuickActionsOpen:!0,readonlySupport:!1}}};_4([_e(Ue.ColorPalette),bQ("design:type",$d)],a0.prototype,"colors",void 0);_4([_e(m.TYPES.IActionDispatcher),bQ("design:type",m.GLSPActionDispatcher)],a0.prototype,"actionDispatcher",void 0);a0=_4([le()],a0);var y4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},SQ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Wm=class extends ni{constructor(){super(...arguments);k(this,"actionDispatcher");k(this,"options")}singleQuickAction(t){if(!(t instanceof Ea||this.options.hideSensitiveInfo&&t instanceof m.GEdge))return{icon:B.InfoCircle,title:"Information (I)",location:"Left",sorting:"B",action:Um.create({elementId:t.id,markers:this.markers(t),title:this.name(t),text:m.hasArgs(t)&&t.args?m.GArgument.getString(t,"desc"):"",info:this.info(t)}),letQuickActionsOpen:!0,readonlySupport:!0,shortcut:"KeyI"}}info(t){return m.hasArgs(t)&&t.args?t.args.info:void 0}name(t){var r;let i="";m.isWithEditableLabel(t)&&t.editableLabel&&(i=(r=t.editableLabel)==null?void 0:r.text);const o=this.nameAddition(t);return o&&(i+=o),i.length>0?i.trim():void 0}nameAddition(t){if(m.hasArgs(t)&&t.args){const i=m.GArgument.getString(t,"varName");if(i)return` [${i}]`;const o=m.GArgument.getString(t,"outerElement");if(o)return` [${o}]`}}markers(t){return t instanceof m.GChildElement?t.children.filter(i=>i instanceof m.GIssueMarker).map(i=>i):[]}};y4([_e(m.TYPES.IActionDispatcher),SQ("design:type",m.GLSPActionDispatcher)],Wm.prototype,"actionDispatcher",void 0);y4([_e(Ue.IvyViewerOptions),SQ("design:type",Object)],Wm.prototype,"options",void 0);Wm=y4([le()],Wm);var xRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},UL;let Sf=UL=class{theme(){return document.documentElement.dataset.theme??UL.prefsColorScheme()}handle(e){if(Nm.is(e)){const t=document.documentElement;t.dataset.theme=e.theme,t.classList.remove("light","dark"),t.classList.add(e.theme)}}static prefsColorScheme(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}};Sf=UL=xRe([le()],Sf);var Zm;(function(n){n.KIND="showToolBarOptionsMenu";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return m.Action.hasKind(i,n.KIND)}n.is=t})(Zm||(Zm={}));var CM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},b4=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},ji;(function(n){n.Left="left",n.Middle="middle",n.Right="right"})(ji||(ji={}));function HRe(n,e){const t=n.sorting.localeCompare(e.sorting);return t!==0?t:n.title.localeCompare(e.title)}const KRe={icon:B.SelectionTool,title:"Selection Tool",sorting:"A",action:()=>m.EnableDefaultToolsAction.create(),id:"btn_default_tools",location:ji.Left,readonly:!0,switchFocus:!0},VRe={icon:B.MultiSelection,title:"Marquee Tool (Shift)",sorting:"B",action:()=>m.EnableToolsAction.create([m.MarqueeMouseTool.ID]),id:"btn_marquee_tools",location:ji.Left,readonly:!0,switchFocus:!0},zRe={icon:B.Undo,title:"Undo",sorting:"C",action:()=>m.UndoAction.create(),id:"btn_undo_tools",location:ji.Left},GRe={icon:B.Redo,title:"Redo",sorting:"D",action:()=>m.RedoAction.create(),id:"btn_redo_tools",location:ji.Left};let Qm=class{constructor(){k(this,"customIconHandler");k(this,"gridManager");k(this,"switchThemeHandler")}button(){const e=()=>this.customIconHandler.isShowCustomIcons,t=()=>this.gridManager.isGridVisible,i=this.switchThemeHandler?()=>this.switchThemeHandler.theme():void 0;return{icon:B.Settings,title:"Settings",sorting:"Y",action:()=>Zm.create({customIconState:e,grid:t,theme:i}),id:"btn_options_menu",location:ji.Right,readonly:!0,switchFocus:!0}}};CM([_e($r),b4("design:type",$r)],Qm.prototype,"customIconHandler",void 0);CM([_e(m.GridManager),b4("design:type",m.GridManager)],Qm.prototype,"gridManager",void 0);CM([_e(Sf),tg(),b4("design:type",Sf)],Qm.prototype,"switchThemeHandler",void 0);Qm=CM([le()],Qm);class URe{constructor(e=B.DarkMode,t="Darkmode",i=o=>Nm.create({theme:o?"dark":"light"})){k(this,"icon");k(this,"label");k(this,"action");this.icon=e,this.label=t,this.action=i}}class YRe{constructor(e=B.GridDots,t="Grid",i=o=>m.ShowGridAction.create({show:o})){k(this,"icon");k(this,"label");k(this,"action");this.icon=e,this.label=t,this.action=i}}class qRe{constructor(e=B.CustomImage,t="Custom Icon",i=o=>Jy.create({showCustomIcons:o})){k(this,"icon");k(this,"label");k(this,"action");this.icon=e,this.label=t,this.action=i}}class WRe{constructor(e,t){k(this,"actionDispatcher");k(this,"showAction");k(this,"bodyDiv");this.actionDispatcher=e,this.showAction=t}create(e){this.bodyDiv=Ae("div",["tool-bar-options-menu"]),e.appendChild(this.bodyDiv),this.bodyDiv.appendChild(this.createHeader()),this.bodyDiv.appendChild(this.createOptions());const t=document.querySelector("#btn_options_menu");if(t){const i=e.offsetWidth,o=t.offsetLeft+t.offsetWidth/2;this.bodyDiv.style.setProperty("--menu-arrow-pos",`${i-o-15}px`)}return this.bodyDiv}createHeader(){const e=Ae("div",["tool-bar-options-header"]);e.appendChild(Tr(B.Settings));const t=document.createElement("label");return t.textContent="Options",e.appendChild(t),e}createOptions(){const e=Ae("div",["tool-bar-options"]);return this.showAction.theme&&e.appendChild(this.createOption(new URe,this.showAction.theme()==="dark")),e.appendChild(this.createOption(new YRe,this.showAction.grid())),e.appendChild(this.createOption(new qRe,this.showAction.customIconState())),e}createOption(e,t){const i=Ae("div",["tool-bar-option"]);i.appendChild(Tr(e.icon));const o=document.createElement("label");o.textContent=e.label,i.appendChild(o);const r=new gRe(t,s=>this.actionDispatcher.dispatch(e.action(s)));return i.appendChild(r.create()),o.onclick=s=>r.switch(),i}remove(){var e;(e=this.bodyDiv)==null||e.remove()}}var Ps;(function(n){n.KIND="showToolBarMenu";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return m.Action.hasKind(i,n.KIND)}n.is=t})(Ps||(Ps={}));class ZRe extends r0{constructor(t,i){super(t,i);k(this,"actionDispatcher");k(this,"action");k(this,"menuCssClass",["bar-menu","tool-bar-menu"]);this.actionDispatcher=t,this.action=i}toolButtonOnClick(t){return this.action.actions(t)}}var ph=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Zd=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},QRe=function(n,e){return function(t,i){e(t,i,n)}},o_;const lz="clicked";var Dl;let Wn=(Dl=class extends m.GLSPAbstractUIExtension{constructor(){super(...arguments);k(this,"actionDispatcher");k(this,"selectionService");k(this,"editorContext");k(this,"toolBarButtonProvider");k(this,"lastActivebutton");k(this,"defaultToolsButton");k(this,"toggleCustomIconsButton");k(this,"verticalAlignButton");k(this,"lastMenuAction");k(this,"toolBarMenu");k(this,"toDisposeOnDisable",new m.DisposableCollection);k(this,"toDisposeOnHide",new m.DisposableCollection)}id(){return o_.ID}init(){this.toDisposeOnDisable.push(this.editorContext.onEditModeChanged(t=>this.editModeChanged(t.oldValue,t.newValue)))}containerClass(){return o_.ID}initializeContents(t){this.createHeader(),this.lastActivebutton=this.defaultToolsButton,t.onwheel=i=>i.ctrlKey?i.preventDefault():!0}onBeforeShow(t,i){this.toDisposeOnHide.push(this.selectionService.onSelectionChanged(o=>this.selectionChanged(o.root,o.selectedElements)))}hide(){super.hide(),this.toDisposeOnHide.dispose()}createHeader(){const t=Ae("div",["tool-bar-header"]);t.appendChild(this.createLeftButtons()),t.appendChild(this.createMiddleButtons()),t.appendChild(this.createRightButtons()),this.containerElement.innerHTML="",this.containerElement.appendChild(t),this.changeActiveButton()}createLeftButtons(){const t=Ae("div",["left-buttons"]);if(this.defaultToolsButton=this.createToolButton(KRe),t.appendChild(this.defaultToolsButton),t.appendChild(this.createToolButton(VRe)),!this.editorContext.isReadonly){const i=Ae("div",["edit-buttons"]);i.appendChild(this.createToolButton(zRe)),i.appendChild(this.createToolButton(GRe)),t.appendChild(i)}return t}createMiddleButtons(){const t=Ae("div",["middle-buttons"]);return this.appendProvidedButtons(t,ji.Middle),t}createRightButtons(){const t=Ae("div",["right-buttons"]);return this.appendProvidedButtons(t,ji.Right),t}appendProvidedButtons(t,i){this.toolBarButtonProvider.map(o=>o.button()).filter(m.isNotUndefined).filter(o=>o.location===i).filter(o=>!this.editorContext.isReadonly||o.readonly).sort(HRe).forEach(o=>t.appendChild(this.createToolButton(o)))}createToolButton(t){const i=Ae("span",["tool-bar-button"]);return i.appendChild(Tr(t.icon)),i.title=t.title,t.id&&(i.id=t.id),i.onclick=o=>{this.dispatchAction([t.action()]),t.switchFocus&&this.changeActiveButton(i)},this.createTitleToolButton(i,t)}createTitleToolButton(t,i){if(i.showTitle){const o=Ae("span",["tool-bar-title-button"]),r=document.createElement("label");return r.textContent=i.title,i.isNotMenu||t.appendChild(Tr(B.Chevron)),o.appendChild(r),o.appendChild(t),o}return t}dispatchAction(t){this.actionDispatcher.dispatchAll(t.concat(m.SelectAllAction.create(!1)))}handle(t){if(m.EnableToolPaletteAction.is(t))return m.SetUIExtensionVisibilityAction.create({extensionId:o_.ID,visible:!0});m.EnableDefaultToolsAction.is(t)&&(this.changeActiveButton(),this.restoreFocus()),Zm.is(t)&&this.toggleOptionsMenu(t),Ps.is(t)&&this.toggleToolBarMenu(t),ba.is(t)&&this.containerElement&&this.createHeader()}toggleToolBarMenu(t){const i=t.paletteItems();if(i.length!==0&&!(Ps.is(this.lastMenuAction)&&this.lastMenuAction.paletteItems().length===i.length&&this.lastMenuAction.paletteItems()[0].label===i[0].label)){this.toolBarMenu=new ZRe(this.actionDispatcher,t);const o=this.toolBarMenu.create(this.containerElement);if(this.lastActivebutton){const r=o.offsetLeft+o.offsetWidth,s=this.lastActivebutton.offsetLeft+this.lastActivebutton.offsetWidth/2;o.style.setProperty("--menu-arrow-pos",`${r-s-6}px`)}this.setLastMenuAction(t)}else this.changeActiveButton(),this.setLastMenuAction(void 0)}toggleOptionsMenu(t){Zm.is(this.lastMenuAction)?(this.changeActiveButton(),this.setLastMenuAction(void 0)):(this.toolBarMenu=new WRe(this.actionDispatcher,t),this.toolBarMenu.create(this.containerElement),this.setLastMenuAction(t))}setLastMenuAction(t){this.lastMenuAction=t}changeActiveButton(t){var o;(o=this.lastActivebutton)==null||o.classList.remove(lz);let i=this.defaultToolsButton;t&&(i=t),i==null||i.classList.add(lz),this.lastActivebutton=i,this.hideMenus()}hideMenus(){var t;(t=this.toolBarMenu)==null||t.remove(),this.toolBarMenu=void 0}editModeChanged(t,i){this.containerElement&&this.createHeader()}selectionChanged(t,i){}disable(){this.toDisposeOnDisable.dispose()}},o_=Dl,k(Dl,"ID","ivy-tool-bar"),Dl);ph([_e(m.TYPES.IActionDispatcher),Zd("design:type",m.GLSPActionDispatcher)],Wn.prototype,"actionDispatcher",void 0);ph([_e(m.SelectionService),Zd("design:type",m.SelectionService)],Wn.prototype,"selectionService",void 0);ph([_e(m.EditorContextService),Zd("design:type",m.EditorContextService)],Wn.prototype,"editorContext",void 0);ph([L6(Ue.ToolBarButtonProvider),Zd("design:type",Array)],Wn.prototype,"toolBarButtonProvider",void 0);ph([p0(),Zd("design:type",Function),Zd("design:paramtypes",[]),Zd("design:returntype",void 0)],Wn.prototype,"init",null);Wn=o_=ph([le()],Wn);let YL=class extends m.MouseListener{constructor(t){super();k(this,"toolBar");this.toolBar=t}mouseDown(t,i){return this.toolBar.changeActiveButton(),this.toolBar.setLastMenuAction(),[]}};YL=ph([le(),QRe(0,_e(Wn)),Zd("design:paramtypes",[Wn])],YL);var EQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},XRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Fc=class{constructor(){k(this,"actionDispatcher");k(this,"paletteItems",[])}getPaletteItems(){return this.paletteItems}handle(e){ba.is(e)&&this.updateElementPalette()}async updateElementPalette(){this.actionDispatcher.request(m.RequestContextActions.create({contextId:Wn.ID,editorContext:{selectedElementIds:[]}})).then(e=>{m.SetContextActions.is(e)&&(this.paletteItems=e.actions.map(t=>t))})}};EQ([_e(m.TYPES.IActionDispatcher),XRe("design:type",m.GLSPActionDispatcher)],Fc.prototype,"actionDispatcher",void 0);Fc=EQ([le()],Fc);var hS=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},JRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};class pS extends ni{constructor(){super(...arguments);k(this,"paletteHandler");k(this,"element");k(this,"actions",(t,i)=>[m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!1}),...t.actions.map(o=>eMe(o,i[0])).filter(m.isNotUndefined)])}singleQuickAction(t){if(this.element=t,!(!m.isConnectable(t)||!t.canConnect(new m.GEdge,"source")||t.type===ye.COMMENT))return this.quickAction()}hasOutgoingEdges(){return this.element instanceof m.GConnectableElement&&Array.from(this.element.outgoingEdges).length>0}paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(t=>!this.filterPaletteGroups().includes(t.id))}filterPaletteGroups(){const t=["event-start-group","swimlane-group"];return this.hasOutgoingEdges()&&t.push("event-end-group"),t}quickActionItem(){return{id:"",actions:[],label:"",sortString:""}}quickAction(){const t=this.quickActionItem();return{icon:t.icon,title:`${t.label} (A)`,location:"Right",sorting:t.sortString,action:Cs.create({elementIds:[this.element.id],paletteItems:this.paletteItems(),actions:this.actions}),readonlySupport:!1,letQuickActionsOpen:!0}}}hS([_e(Fc),JRe("design:type",Fc)],pS.prototype,"paletteHandler",void 0);let qL=class extends pS{paletteItems(){return()=>{const e=this.paletteHandler.getPaletteItems().filter(i=>this.filterPaletteGroups().includes(i.id)),t=tMe(this.element);return t&&e.push(t),e}}filterPaletteGroups(){const e=["event-intermediate-group"];return this.hasOutgoingEdges()||e.push("event-end-group"),e}quickActionItem(){return{label:"Events",icon:B.Start,sortString:"A",id:"",actions:[]}}};qL=hS([le()],qL);let WL=class extends pS{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="gateway-group")}quickActionItem(){return{label:"Gateways",icon:B.GatewaysGroup,sortString:"B",id:"",actions:[]}}};WL=hS([le()],WL);let ZL=class extends pS{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="activity-group"||e.id==="interface-activity-group"||e.id==="bpmn-activity-group")}quickActionItem(){return{label:"Activities",icon:B.ActivitiesGroup,sortString:"C",id:"",actions:[]}}};ZL=hS([le()],ZL);let QL=class extends pS{quickAction(){return{icon:B.Task,title:"Create Node",location:"Hidden",sorting:"Z",action:Cs.create({elementIds:[this.element.id],paletteItems:this.paletteItems(),actions:this.actions,showSearch:!0}),letQuickActionsOpen:!0,readonlySupport:!1,shortcut:"KeyA"}}};QL=hS([le()],QL);function eMe(n,e){if(m.TriggerNodeCreationAction.is(n))return m.CreateNodeOperation.create(n.elementTypeId,{args:{previousElementId:e}});if(Qy.is(n))return n}function tMe(n){const e=[];if(FAe(n)&&e.push({id:"error-boundary",label:"Error Boundary",sortString:"A",actions:[Qy.create({elementId:n.id,eventKind:"error"})],icon:Sa.BOUNDARY_ERROR}),xAe(n)&&e.push({id:"signal-boundary",label:"Signal Boundary",sortString:"B",actions:[Qy.create({elementId:n.id,eventKind:"signal"})],icon:Sa.BOUNDARY_SIGNAL}),e.length!==0)return{id:"boundary-group",label:"Boundary Events",sortString:"Z",actions:[],children:e}}var CQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},nMe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Fl=class{constructor(){k(this,"actionDispatcher");k(this,"paletteItems",[])}getPaletteItems(){return this.paletteItems}handle(e){ba.is(e)&&this.updateActivityTypePalette()}async updateActivityTypePalette(){this.actionDispatcher.request(m.RequestContextActions.create({contextId:"ivy-tool-activity-type-palette",editorContext:{selectedElementIds:[]}})).then(e=>{m.SetContextActions.is(e)&&(this.paletteItems=e.actions.map(t=>t))})}};CQ([_e(m.TYPES.IActionDispatcher),nMe("design:type",m.GLSPActionDispatcher)],Fl.prototype,"actionDispatcher",void 0);Fl=CQ([le()],Fl);var S4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},PQ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let c0=class extends ni{constructor(){super(...arguments);k(this,"types");k(this,"actionDispatcher");k(this,"actions",(t,i)=>[dL.create({elementId:i[0],typeId:t.id}),Cs.empty()])}singleQuickAction(t){if(GZ(t))return{icon:B.ChangeType,title:"Select Activity Type",location:"Middle",sorting:"Y",action:Cs.create({elementIds:[t.id],paletteItems:()=>this.types.getPaletteItems(),actions:this.actions,customCssClass:"activity-type-menu"}),letQuickActionsOpen:!0,readonlySupport:!1}}};S4([_e(Ue.ActivityTypesPalette),PQ("design:type",Fl)],c0.prototype,"types",void 0);S4([_e(m.TYPES.IActionDispatcher),PQ("design:type",m.GLSPActionDispatcher)],c0.prototype,"actionDispatcher",void 0);c0=S4([le()],c0);const wQ=new m.FeatureModule((n,e,t)=>{m.bindAsService(n,m.TYPES.IUIExtension,Bt),m.configureActionHandler({bind:n,isBound:t},Cs.KIND,Bt),m.configureActionHandler({bind:n,isBound:t},Um.KIND,Bt),m.configureActionHandler({bind:n,isBound:t},m.RemoveMarqueeAction.KIND,Bt),iMe({bind:n,isBound:t}),oMe({bind:n}),rMe({bind:n,isBound:t}),sMe({bind:n,isBound:t})});function iMe(n){n.bind(jp).toSelf().inSingletonScope(),n.bind(m.TYPES.ITool).toService(jp),m.configureActionHandler(n,$m.KIND,jp)}function oMe(n){n.bind(Ue.QuickActionProvider).to(hL),n.bind(Ue.QuickActionProvider).to(Wm),n.bind(Ue.QuickActionProvider).to(gL),n.bind(Ue.QuickActionProvider).to(pL),n.bind(Ue.QuickActionProvider).to(qL),n.bind(Ue.QuickActionProvider).to(WL),n.bind(Ue.QuickActionProvider).to(ZL),n.bind(Ue.QuickActionProvider).to(QL)}function rMe(n){n.bind($d).toSelf().inSingletonScope(),n.bind(Ue.ColorPalette).toService($d),m.configureActionHandler(n,ba.KIND,$d),m.configureActionHandler(n,ww.KIND,$d),n.bind(Ue.QuickActionProvider).to(a0)}function sMe(n){n.bind(Fl).toSelf().inSingletonScope(),n.bind(Ue.ActivityTypesPalette).toService(Fl),m.configureActionHandler(n,ba.KIND,Fl),n.bind(Ue.QuickActionProvider).to(c0)}var mh=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},aMe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Ou=class{constructor(){k(this,"paletteHandler");k(this,"actions",e=>[Ps.create({paletteItems:()=>[],actions:t=>[]}),...e.actions])}button(){return this.createToolBarButton(this.paletteItems())}paletteItems(){return()=>this.paletteHandler.getPaletteItems()}};mh([_e(Fc),aMe("design:type",Fc)],Ou.prototype,"paletteHandler",void 0);Ou=mh([le()],Ou);let XL=class extends Ou{createToolBarButton(e){return{icon:B.Task,title:"All Elements",sorting:"A",action:()=>Ps.create({paletteItems:e,actions:this.actions,showSearch:!0}),id:"btn_all_elements_menu",location:ji.Middle,switchFocus:!0,showTitle:!0}}};XL=mh([le()],XL);let JL=class extends Ou{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id.match(/event-[a-z]+-group/))}createToolBarButton(e){return{icon:B.Start,title:"Events",sorting:"B",action:()=>Ps.create({paletteItems:e,actions:this.actions}),id:"btn_events_menu",location:ji.Middle,switchFocus:!0,showTitle:!0}}};JL=mh([le()],JL);let e6=class extends Ou{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="gateway-group")}createToolBarButton(e){return{icon:B.GatewaysGroup,title:"Gateways",sorting:"C",action:()=>Ps.create({paletteItems:e,actions:this.actions}),id:"btn_gateways_menu",location:ji.Middle,switchFocus:!0,showTitle:!0}}};e6=mh([le()],e6);let t6=class extends Ou{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="activity-group"||e.id==="interface-activity-group"||e.id==="bpmn-activity-group")}createToolBarButton(e){return{icon:B.ActivitiesGroup,title:"Activities",sorting:"D",action:()=>Ps.create({paletteItems:e,actions:this.actions}),id:"btn_activities_menu",location:ji.Middle,switchFocus:!0,showTitle:!0}}};t6=mh([le()],t6);let n6=class extends Ou{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="swimlane-group"||e.id==="annotation-group")}createToolBarButton(e){return{icon:B.PoolSwimlanes,title:"Artifacts",sorting:"E",action:()=>Ps.create({paletteItems:e,actions:this.actions}),id:"btn_artifacts_menu",location:ji.Middle,switchFocus:!0,showTitle:!0}}};n6=mh([le()],n6);const AQ=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.bindAsService(i,Ue.ToolBar,Wn),n(m.TYPES.IUIExtension).toService(Wn),m.configureActionHandler(i,m.EnableToolPaletteAction.KIND,Wn),m.configureActionHandler(i,Ps.KIND,Wn),m.configureActionHandler(i,Zm.KIND,Wn),cMe(i),m.bindAsService(i,m.TYPES.MouseListener,YL),n($r).toSelf().inSingletonScope(),m.configureActionHandler(i,Jy.KIND,$r),m.configureActionHandler(i,m.EnableDefaultToolsAction.KIND,Wn),m.configureActionHandler(i,ba.KIND,Wn)},{featureId:m.toolPaletteModule.featureId});function cMe(n){n.bind(Fc).toSelf().inSingletonScope(),m.configureActionHandler(n,ba.KIND,Fc),n.bind(Ue.ToolBarButtonProvider).to(XL),n.bind(Ue.ToolBarButtonProvider).to(JL),n.bind(Ue.ToolBarButtonProvider).to(e6),n.bind(Ue.ToolBarButtonProvider).to(t6),n.bind(Ue.ToolBarButtonProvider).to(n6),n.bind(Ue.ToolBarButtonProvider).to(Qm)}var PM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},T_=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Qd=class extends m.GLSPScrollMouseListener{constructor(){super(...arguments);k(this,"quickActionUi");k(this,"mouseTool")}init(){this.mouseTool.registerListener(this)}mouseDown(t,i){return m.findParentByFeature(t,m.toTypeGuard(m.GResizeHandle))?[]:super.mouseDown(t,i)}mouseMove(t,i){const o=super.mouseMove(t,i);return this.lastScrollPosition&&this.quickActionUi.hideUi(),o}mouseUp(t,i){return this.lastScrollPosition&&this.quickActionUi.showUi(),super.mouseUp(t,i)}wheel(t,i){if(m.isCtrlOrCmd(i))return[];const o=m.findParentByFeature(t,m.isViewport),r={x:i.pageX,y:i.pageY};return i.shiftKey?r.x+=i.deltaY!==0?i.deltaY:i.deltaX:(r.x+=i.deltaX,r.y+=i.deltaY),o?this.dragCanvas(o,i,r):[]}};PM([_e(Bt),T_("design:type",Bt)],Qd.prototype,"quickActionUi",void 0);PM([_e(m.GLSPMouseTool),T_("design:type",m.GLSPMouseTool)],Qd.prototype,"mouseTool",void 0);PM([p0(),T_("design:type",Function),T_("design:paramtypes",[]),T_("design:returntype",void 0)],Qd.prototype,"init",null);Qd=PM([le()],Qd);class dMe{constructor(e,t=B.Center,i="centerBtn",o="Center",r=()=>m.CenterAction.create(e())){k(this,"elementIds");k(this,"icon");k(this,"id");k(this,"title");k(this,"action");this.elementIds=e,this.icon=t,this.id=i,this.title=o,this.action=r}}class uMe{constructor(e=B.WindowMinimize,t="originBtn",i="Origin screen",o=()=>Dw.create()){k(this,"icon");k(this,"id");k(this,"title");k(this,"action");this.icon=e,this.id=t,this.title=i,this.action=o}}class lMe{constructor(e=B.FitToScreen,t="fitToScreenBtn",i="Fit to screen",o=()=>m.FitToScreenAction.create([],{padding:10})){k(this,"icon");k(this,"id");k(this,"title");k(this,"action");this.icon=e,this.id=t,this.title=i,this.action=o}}var mS=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},wM=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},r_,Tl;let Xs=(Tl=class extends m.GLSPAbstractUIExtension{constructor(){super(...arguments);k(this,"actionDispatcher");k(this,"toolManager");k(this,"editorContext");k(this,"selectionService");k(this,"zoomLevel","100%");k(this,"zoomLevelElement")}id(){return r_.ID}containerClass(){return r_.ID}initializeContents(t){this.createBar(),t.onwheel=i=>i.ctrlKey?i.preventDefault():!0}createBar(){const t=Ae("div",["viewport-bar"]);t.appendChild(this.createViewportTools()),this.containerElement.appendChild(t)}createViewportTools(){const t=Ae("div",["viewport-bar-tools"]);return t.appendChild(this.createViewportButton(new uMe)),t.appendChild(this.createViewportButton(new lMe)),t.appendChild(this.createViewportButton(new dMe(()=>[...this.selectionService.getSelectedElementIDs()]))),this.zoomLevelElement=document.createElement("label"),this.zoomLevelElement.textContent=this.zoomLevel,t.appendChild(this.zoomLevelElement),t}createViewportButton(t){const i=Ae("span");return i.appendChild(Tr(t.icon)),i.id=t.id,i.title=t.title,i.onclick=()=>this.actionDispatcher.dispatch(t.action()).then(()=>{const o=this.editorContext.modelRoot;m.isViewport(o)&&this.actionDispatcher.dispatchAll([m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]}),m.SetViewportAction.create(o.id,o,{})])}),i}handle(t){e0.is(t)&&this.actionDispatcher.dispatch(m.SetUIExtensionVisibilityAction.create({extensionId:r_.ID,visible:!0})),m.SetViewportAction.is(t)?this.updateZoomLevel(t.newViewport.zoom):jm.is(t)&&this.updateZoomLevel(t.zoom)}updateZoomLevel(t){this.zoomLevel=(t*100).toFixed(0).toString()+"%",this.zoomLevelElement&&(this.zoomLevelElement.textContent=this.zoomLevel)}},r_=Tl,k(Tl,"ID","ivy-viewport-bar"),Tl);mS([_e(m.TYPES.IActionDispatcher),wM("design:type",m.GLSPActionDispatcher)],Xs.prototype,"actionDispatcher",void 0);mS([_e(m.TYPES.IToolManager),wM("design:type",Object)],Xs.prototype,"toolManager",void 0);mS([_e(m.EditorContextService),wM("design:type",m.EditorContextService)],Xs.prototype,"editorContext",void 0);mS([_e(m.SelectionService),wM("design:type",m.SelectionService)],Xs.prototype,"selectionService",void 0);Xs=r_=mS([le()],Xs);var H1=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},gS=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},AM=function(n,e){return function(t,i){e(t,i,n)}},DT;let i6=(DT=class extends m.BoundsAwareViewportCommand{constructor(t){super(t.animate);k(this,"action");this.action=t}getElementIds(){return[]}initialize(t){if(!m.isViewport(t))return;this.oldViewport={scroll:t.scroll,zoom:t.zoom};const i=this.getNewViewport(m.Bounds.EMPTY,t);if(i){const{zoomLimits:o,horizontalScrollLimits:r,verticalScrollLimits:s}=this.viewerOptions;this.newViewport=m.limitViewport(i,t.canvasBounds,r,s,o)}}getNewViewport(t,i){return{zoom:1,scroll:{x:0,y:0}}}},k(DT,"KIND",Dw.KIND),DT);i6=H1([le(),AM(0,_e(m.TYPES.Action)),gS("design:paramtypes",[Object])],i6);function Vw(n){return!!n&&m.isBoundsAware(n)&&!(n instanceof Ku)}function RQ(n){return m.isSelected(n)&&m.isBoundsAware(n)&&!(n instanceof Ku)}var TT;let o6=(TT=class extends m.FitToScreenCommand{constructor(t){super(t);k(this,"action");this.action=t}getNewViewport(t,i){if(!m.Dimension.isValid(i.canvasBounds))return;const o=m.Bounds.center(t),r=this.action.padding===void 0?0:2*this.action.padding,s=this.toolBarHeight();let a=Math.min(i.canvasBounds.width/(t.width+r),(i.canvasBounds.height-s)/(t.height+r));return this.action.maxZoom!==void 0&&(a=Math.min(a,this.action.maxZoom)),a===1/0&&(a=1),{scroll:{x:o.x-.5*i.canvasBounds.width/a,y:o.y-.5*(i.canvasBounds.height+s)/a},zoom:a}}toolBarHeight(){const t=document.querySelector('[id$="_'+Wn.ID+'"]');return t?t.getBoundingClientRect().height:0}initialize(t){if(m.isViewport(t)){this.oldViewport={scroll:t.scroll,zoom:t.zoom};const i=[];m.getElements(t.index,this.getElementIds(),Vw).forEach(r=>i.push(this.boundsInViewport(r,r.bounds,t))),i.length===0&&m.forEachElement(t.index,RQ,r=>i.push(this.boundsInViewport(r,r.bounds,t))),i.length===0&&m.forEachElement(t.index,Vw,r=>i.push(this.boundsInViewport(r,r.bounds,t)));const o=i.reduce((r,s)=>m.Bounds.combine(r,s),m.Bounds.EMPTY);if(m.Dimension.isValid(o)){const r=this.getNewViewport(o,t);if(r){const{zoomLimits:s,horizontalScrollLimits:a,verticalScrollLimits:f}=this.viewerOptions;this.newViewport=m.limitViewport(r,t.canvasBounds,a,f,s)}}}}},k(TT,"KIND",m.FitToScreenAction.KIND),TT);o6=H1([le(),AM(0,_e(m.TYPES.Action)),gS("design:paramtypes",[Object])],o6);let zw=class extends m.CenterCommand{constructor(){super(...arguments);k(this,"selectionService")}getNewViewport(t,i){if(m.Dimension.isValid(i.canvasBounds))return super.getNewViewport(t,i)}initialize(t){if(!m.isViewport(t))return;this.oldViewport={scroll:t.scroll,zoom:t.zoom};const i=[];m.getElements(t.index,this.getElementIds(),Vw).forEach(r=>i.push(this.boundsInViewport(r,r.bounds,t))),i.length===0&&m.forEachElement(t.index,RQ,r=>i.push(this.boundsInViewport(r,r.bounds,t))),i.length===0&&m.forEachElement(t.index,Vw,r=>i.push(this.boundsInViewport(r,r.bounds,t)));const o=i.reduce((r,s)=>m.Bounds.combine(r,s),m.Bounds.EMPTY);if(m.Dimension.isValid(o)){const r=this.getNewViewport(o,t);if(r){const{zoomLimits:s,horizontalScrollLimits:a,verticalScrollLimits:f}=this.viewerOptions;this.newViewport=m.limitViewport(r,t.canvasBounds,a,f,s)}}}};H1([_e(m.SelectionService),gS("design:type",m.SelectionService)],zw.prototype,"selectionService",void 0);zw=H1([le()],zw);var OT;let r6=(OT=class extends m.BoundsAwareViewportCommand{constructor(t){super(t.animate);k(this,"action");this.action=t}getElementIds(){return this.action.elementIds}getNewViewport(t,i){if(m.Dimension.isValid(i.canvasBounds))return fMe(i.canvasBounds,m.isViewport(i)?i.scroll:m.Point.ORIGIN,m.Bounds.center(t),this.action.retainZoom&&m.isViewport(i)?i.zoom:1)}},k(OT,"KIND",t0.KIND),OT);r6=H1([le(),AM(0,_e(m.TYPES.Action)),gS("design:paramtypes",[Object])],r6);function fMe(n,e,t,i){return{scroll:{x:fz(n.width,e.x,t.x,i),y:fz(n.height,e.y,t.y,i)},zoom:i}}function fz(n,e,t,i){const o=t-e;return o>n||o<0?t-.5*n/i:e}var LT;let s6=(LT=class extends m.Command{constructor(t){super();k(this,"action");this.action=t}execute(t){const i=t.root;return m.isViewport(i)&&(i.zoom=this.action.zoom),i}undo(t){return t.logger.error(this,"Cannot undo a ivy viewport zoom command"),t.root}redo(t){return t.logger.error(this,"Cannot redo a ivy viewport zoom command"),t.root}},k(LT,"KIND",jm.KIND),LT);s6=H1([le(),AM(0,_e(m.TYPES.Action)),gS("design:paramtypes",[Object])],s6);var hMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let a6=class extends m.ZoomMouseListener{wheel(e,t){return m.isCtrlOrCmd(t)?super.wheel(e,t):[]}getZoomFactor(e){return e.deltaMode===e.DOM_DELTA_PAGE?Math.exp(-e.deltaY*.5):e.deltaMode===e.DOM_DELTA_LINE?Math.exp(-e.deltaY*.05):Math.exp(-e.deltaY*.003)}};a6=hMe([le()],a6);const pMe=new m.FeatureModule((n,e,t,i)=>{const o={bind:n,isBound:t,rebind:i};m.configureCommand(o,m.GetViewportCommand),m.configureCommand(o,m.SetViewportCommand),m.configureCommand(o,m.RepositionCommand),m.bindAsService(o,m.TYPES.IDiagramStartup,m.RestoreViewportHandler),m.configureActionHandler(o,m.EnableDefaultToolsAction.KIND,m.RestoreViewportHandler),m.configureActionHandler(o,m.FocusDomAction.KIND,m.RestoreViewportHandler),m.configureCommand(o,zw),m.configureCommand(o,o6),m.bindAsService(o,m.TYPES.MouseListener,a6),n(Qd).toSelf().inSingletonScope(),m.configureActionHandler(o,m.EnableToolsAction.KIND,Qd),m.configureActionHandler(o,m.EnableDefaultToolsAction.KIND,Qd),m.bindAsService(o,m.TYPES.IUIExtension,Xs),m.configureActionHandler(o,e0.KIND,Xs),m.configureActionHandler(o,m.SetViewportAction.KIND,Xs),m.configureActionHandler(o,jm.KIND,Xs),m.configureCommand(o,i6),m.configureCommand(o,r6),m.configureCommand(o,s6),m.bindAsService(o,m.TYPES.KeyListener,m.CenterKeyboardListener)},{featureId:m.viewportModule.featureId});var MQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let c6=class extends ni{singleQuickAction(e){if(GZ(e))return{icon:B.Unwrap,title:"Unwrap embedded subprocess (U)",location:"Middle",sorting:"B",action:lL.create({elementId:e.id}),shortcut:"KeyU"}}};c6=MQ([le()],c6);let d6=class{singleQuickAction(e){if(kAe(e))return this.quickAction([e.id])}multiQuickAction(e){const t=e.map(i=>i.id);if(t.length>0&&!e.find(i=>!$Ae(i)))return this.quickAction(t)}quickAction(e){return{icon:B.WrapToSubprocess,title:"Wrap to embedded process (W)",location:"Middle",sorting:"B",action:uL.create({elementIds:e}),shortcut:"KeyW"}}};d6=MQ([le()],d6);const IQ=new m.FeatureModule(n=>{n(Ue.QuickActionProvider).to(c6),n(Ue.QuickActionProvider).to(d6)});var mMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},gMe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},vMe=function(n,e){return function(t,i){e(t,i,n)}};let u6=class extends m.BringToFrontCommand{constructor(t){super(t);k(this,"action");this.action=t}addToSelection(t){t instanceof Ea||this.selected.push({element:t,index:t.parent.children.indexOf(t)})}};u6=mMe([le(),vMe(0,_e(m.TYPES.Action)),gMe("design:paramtypes",[Object])],u6);const _Me=new m.FeatureModule((n,e,t)=>{m.configureCommand({bind:n,isBound:t},u6)},{featureId:m.zorderModule.featureId});var yMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let l6=class extends m.MarqueeUtil{isMarkableNode(){return m.typeGuard(m.typeGuardOr(m.toTypeGuard(m.GNode),m.toTypeGuard(m.GLabel)),m.isSelectableAndBoundsAware)}getNodeBounds(e){return e instanceof l4?e.bounds:super.getNodeBounds(e)}};l6=yMe([le()],l6);function bMe(n,...e){const t=m.initializeDiagramContainer(new Bz,{remove:[m.hoverModule,m.navigationModule,m.statusModule,m.contextMenuModule]},m.baseViewModule,m.helperLineModule,m.gridModule,{replace:pMe},{replace:UAe},{replace:_Me},{replace:AQ},{replace:nQ},{replace:iQ},{replace:_Q},{replace:$Re},{replace:kRe},lRe,wQ,IQ,vRe,pQ,LAe,pRe,VZ,hQ,TRe,...e);return m.bindOrRebind(t,m.TYPES.Grid).toConstantValue({x:8,y:8}),t.bind(Ue.IvyViewerOptions).toConstantValue(ORe()),t.bind(m.TYPES.IHelperLineOptions).toConstantValue({alignmentElementFilter:i=>!(i instanceof Ea)&&m.DEFAULT_ALIGNABLE_ELEMENT_FILTER(i)}),m.bindOrRebind(t,m.MarqueeUtil).to(l6).inSingletonScope(),m.bindOrRebind(t,m.TYPES.IMarqueeBehavior).toConstantValue({entireEdge:!0,entireElement:!0}),m.bindOrRebind(t,m.TYPES.ICommandStack).to(Hw).inSingletonScope(),m.bindOrRebind(t,m.TYPES.ILogger).to(m.ConsoleLogger).inSingletonScope(),m.bindOrRebind(t,m.TYPES.LogLevel).toConstantValue(m.LogLevel.warn),m.bindOrRebind(t,m.TYPES.ISnapper).to(m.GLSPCenterGridSnapper),m.overrideViewerOptions(t,{baseDiv:n,hiddenDiv:n+"_hidden"}),t}var SMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let f6=class extends ni{singleQuickAction(e){if(bL(e))return{icon:B.Bug,title:"Toggle Breakpoint (B)",location:"Left",sorting:"C",action:eL.create({elementId:e.id}),letQuickActionsOpen:!0,readonlySupport:!0,shortcut:"KeyB"}}};f6=SMe([le()],f6);var DQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},EMe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},CMe=function(n,e){return function(t,i){e(t,i,n)}},h6;(function(n){function e(t){return{kind:Gw.KIND,...t}}n.create=e})(h6||(h6={}));var NT;let Gw=(NT=class extends m.Command{constructor(t){super();k(this,"action");k(this,"showBreakpoints",[]);this.action=t}execute(t){var i;return(i=this.action.oldBreakpoints)==null||i.forEach(o=>{const r=t.root.index.getById(o.elementId);r instanceof m.GChildElement&&bL(r)&&SL(r)}),this.action.breakpoints.forEach(o=>{const r=t.root.index.getById(o.elementId);r instanceof m.GChildElement&&bL(r)&&this.showBreakpoints.push({element:r,condition:o.condition,disabled:o.disabled,globalDisabled:this.action.globalDisabled??!1})}),this.redo(t)}undo(t){for(const i of this.showBreakpoints)SL(i.element);return t.root}redo(t){for(const i of this.showBreakpoints)HAe(i.element,i.condition,i.disabled,i.globalDisabled);return t.root}},k(NT,"KIND","elementBreakpointFeedback"),NT);Gw=DQ([le(),CMe(0,_e(m.TYPES.Action)),EMe("design:paramtypes",[Object])],Gw);let p6=class extends m.MouseListener{mouseUp(e,t){return e instanceof km?[tL.create({elementId:e.parent.id,disable:!e.disabled})]:[]}};p6=DQ([le()],p6);var TQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},PMe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let d0=class{constructor(){k(this,"oldBreakpoints",[]);k(this,"feedbackDispatcher")}handle(e){if(Pw.is(e)){const t=h6.create({breakpoints:e.elementBreakpoints,oldBreakpoints:this.oldBreakpoints,globalDisabled:e.globalDisabled});this.feedbackDispatcher.registerFeedback(this,[t]),this.oldBreakpoints=e.elementBreakpoints}}};TQ([_e(m.TYPES.IFeedbackActionDispatcher),PMe("design:type",Object)],d0.prototype,"feedbackDispatcher",void 0);d0=TQ([le()],d0);var wMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};const e3={createElement:m.svg};let m6=class{render(e,t){var i;return m.isBoundsAware(e.parent)?e3.createElement("g",null,e3.createElement("circle",{"class-ivy-breakpoint-handle":!0,"class-disabled":e.disabled,"class-condition":((i=e.condition)==null?void 0:i.length)>0&&e.condition!=="true","class-mouseover":e.hoverFeedback,cx:-10,cy:9,r:4}),e.globalDisabled&&e3.createElement("line",{"class-ivy-breakpoint-handle-globaldisable":!0,x1:-15,y1:14,x2:-5,y2:4})):e3.createElement("g",null)}};m6=wMe([le()],m6);new m.FeatureModule((n,e,t)=>{n(d0).toSelf().inSingletonScope(),m.configureActionHandler({bind:n,isBound:t},Pw.KIND,d0),m.configureCommand({bind:n,isBound:t},Gw),m.configureView({bind:n,isBound:t},km.TYPE,m6),n(Ue.QuickActionProvider).to(f6),n(m.TYPES.MouseListener).to(p6)});const AMe=new m.FeatureModule((n,e,t)=>{n(Sf).toSelf().inSingletonScope(),m.configureActionHandler({bind:n,isBound:t},Nm.KIND,Sf)});let RMe=class extends m.KeyListener{keyDown(e,t){return zi(t,"KeyC")?[Aw.create()]:[]}};var MMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let g6=class{button(){return{icon:B.DatabaseLink,title:"Open Data Class (C)",sorting:"E",action:()=>Aw.create(),location:ji.Right,readonly:!0}}};g6=MMe([le()],g6);new m.FeatureModule(n=>{n(m.TYPES.KeyListener).to(RMe),n(Ue.ToolBarButtonProvider).to(g6)});function IMe(n){return n.hasFeature(m.openFeature)}var DMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let v6=class extends ni{singleQuickAction(e){if(IMe(e)&&e.type!==ye.COMMENT)return{icon:B.CustomImage,title:"Custom Icon",location:"Middle",sorting:"C",action:oL.create(e.id)}}};v6=DMe([le()],v6);new m.FeatureModule(n=>{n(Ue.QuickActionProvider).to(v6)});class TMe extends m.KeyListener{keyDown(e,t){return zi(t,"KeyF")?[Iw.create()]:[]}}var OQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},OMe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Uw=class{constructor(){k(this,"editorContext")}button(){try{if(m.hasArgs(this.editorContext.modelRoot)&&m.GArgument.getString(this.editorContext.modelRoot,"kind")==="html-dialog")return{icon:B.File,title:"Open Form Editor (F)",sorting:"F",action:()=>Iw.create(),location:ji.Right,readonly:!0}}catch(e){console.log("Couldn't load model root",e)}}};OQ([_e(m.EditorContextService),OMe("design:type",m.EditorContextService)],Uw.prototype,"editorContext",void 0);Uw=OQ([le()],Uw);new m.FeatureModule(n=>{n(m.TYPES.KeyListener).to(TMe),n(Ue.ToolBarButtonProvider).to(Uw)});var LMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let _6=class extends ni{singleQuickAction(e){if(qAe(e))return{icon:B.GoToSource,title:"Go To Source (S)",location:"Middle",sorting:"B",action:rL.create(e.id),readonlySupport:!0,shortcut:"KeyS"}}};_6=LMe([le()],_6);new m.FeatureModule(n=>{n(Ue.QuickActionProvider).to(_6)});var LQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let y6=class extends ni{singleQuickAction(e){if(e instanceof I_&&e.type===We.START){const t=m.GArgument.getString(e,"processStartUri")??"";return{icon:B.Play,title:"Start Process (X)",location:"Left",sorting:"A",action:aL.create(e.id,t),readonlySupport:!0,shortcut:"KeyX",removeSelection:!0}}}};y6=LQ([le()],y6);let b6=class extends ni{constructor(){super(...arguments);k(this,"supportedEventTypes",[We.START,We.START_ERROR,We.START_SUB,We.START_HD,We.START_HD_METHOD])}singleQuickAction(t){if(t instanceof I_&&this.isSearchViewAvailable(t.type))return{icon:B.Search,title:"Search callers of this process (O)",location:"Left",sorting:"B",action:cL.create(t.id),letQuickActionsOpen:!0,readonlySupport:!0,shortcut:"KeyO"}}isSearchViewAvailable(t){return this.supportedEventTypes.includes(t)}};b6=LQ([le()],b6);new m.FeatureModule(n=>{n(Ue.QuickActionProvider).to(y6),n(Ue.QuickActionProvider).to(b6)});class NMe extends m.BaseJsonrpcGLSPClient{error(e,...t){console.error(`[IvyJsonrpcGLSPClient] ${e}`,t),gQ({text:`${e}  (Click to reload)`,className:"severity-ERROR",duration:-1,close:!0,gravity:"bottom",position:"left",onClick:()=>window.location.reload()}).showToast()}handleConnectionError(e,t,i){this.error("Connection to server is erroring. Shutting down server.",e),this.stop(),this.state=m.ClientState.ServerError}handleConnectionClosed(){if(!(this.state===m.ClientState.Stopping||this.state===m.ClientState.Stopped)){try{this.resolvedConnection&&(this.resolvedConnection.dispose(),this.connectionPromise=void 0,this.resolvedConnection=void 0)}catch{}this.error("Connection to server got closed."),this.state=m.ClientState.ServerError}}}const jMe=new m.FeatureModule(n=>{n(m.TYPES.KeyListener).to(s0),n(m.TYPES.KeyListener).to(qm)});var BMe=Object.defineProperty,$Me=Object.getOwnPropertyDescriptor,kMe=(n,e,t,i)=>{for(var o=i>1?void 0:i?$Me(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&BMe(e,t,o),o};let S6=class{handle(n){m.NavigateToExternalTargetAction.is(n)&&window.open(this.evaluateTargetUrl(n.target),"_self")}evaluateTargetUrl(n){const e=new URL(window.location.href);e.searchParams.set("pmv",this.evaluatePmv(n));const t=this.getArg(n,"processPid");if(t)e.searchParams.set("pid",t),e.searchParams.delete("file");else{const o=n.uri.substring(this.indexOfPmvSlashInUri(n.uri));e.searchParams.set("file",o),e.searchParams.delete("pid")}const i=this.getArg(n,m.NavigationTarget.ELEMENT_IDS);return i&&e.searchParams.set("select",i),e.toString()}evaluatePmv(n){const e=this.getArg(n,"pmv");return e||n.uri.substring(1,this.indexOfPmvSlashInUri(n.uri))}indexOfPmvSlashInUri(n){return n.indexOf("/",1)}getArg(n,e){if(n.args&&n.args[e])return n.args[e].toString()}};S6=kMe([le()],S6);const FMe=new m.FeatureModule((n,e,t)=>{m.configureActionHandler({bind:n,isBound:t},ct.NavigateToExternalTargetAction.KIND,S6)},{featureId:m.navigationModule.featureId}),xMe=new m.FeatureModule((n,e,t)=>{m.bindAsService(n,m.TYPES.IUIExtension,Bt),m.configureActionHandler({bind:n,isBound:t},Cs.KIND,Bt),m.configureActionHandler({bind:n,isBound:t},Um.KIND,Bt),m.configureActionHandler({bind:n,isBound:t},m.RemoveMarqueeAction.KIND,Bt),n(Ue.QuickActionProvider).to(Wm)});function HMe(){const n=window.location.protocol;if(n.startsWith("http")){const e=window.location.href;return e.substring(n.length+2,e.indexOf("/process-viewer"))}return"localhost:8081"}function KMe(){return window.location.protocol==="https:"||E4().get("secure")==="true"}function VMe(){return E4().get("mode")==="preview"}function E4(){return new URLSearchParams(window.location.search)}const Zw=class Zw extends m.GLabel{constructor(e=m.Bounds.EMPTY,t="",i="start",o=Zw.TYPE){super(),this.canvasBounds=e,this.caption=t,this.location=i,this.type=o}};k(Zw,"TYPE","diagram-caption");let Xm=Zw;var NQ=Object.defineProperty,zMe=Object.getOwnPropertyDescriptor,GMe=(n,e,t)=>e in n?NQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,UMe=(n,e,t,i)=>{for(var o=i>1?void 0:i?zMe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&NQ(e,t,o),o},YMe=(n,e)=>(t,i)=>e(t,i,n),qMe=(n,e,t)=>GMe(n,e+"",t),Jm;(n=>{n.KIND="minigCommand";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return m.Action.hasKind(i,n.KIND)}n.is=t})(Jm||(Jm={}));let Yw=class extends m.Command{constructor(e){super();k(this,"startCaption");k(this,"endCaption");k(this,"getModelBounds",e=>e.children.filter(m.isBoundsAware).map(i=>i.bounds).reduce((i,o)=>m.Bounds.combine(i,o),m.Bounds.EMPTY));this.action=e}execute(e){const t=e.root;this.action.data.nodes.forEach(o=>{const r=t.index.getById(o.id);r instanceof xm&&(r.args===void 0&&(r.args={}),r.args.labelvalue=o.labelValue,r.args.relativevalue=o.relativeValue)});const i=this.getModelBounds(t);return this.startCaption=new Xm(i,`Analysis of ${this.action.data.processName}`,"start"),this.endCaption=new Xm(i,`${this.action.data.numberOfInstances} instances (investigation period: ${new Date(this.action.data.timeFrame.start).toDateString()} - ${new Date(this.action.data.timeFrame.end).toDateString()})`,"end"),t.add(this.startCaption),t.add(this.endCaption),t}undo(e){const t=e.root;return this.action.data.nodes.forEach(i=>{const o=t.index.getById(i.id);o instanceof xm&&o.args!==void 0&&(delete o.args.labelvalue,delete o.args.relativevalue)}),t.remove(this.startCaption),t.remove(this.endCaption),t}redo(e){return this.execute(e)}};qMe(Yw,"KIND",Jm.KIND);Yw=UMe([le(),YMe(0,_e(m.TYPES.Action))],Yw);var WMe=Object.defineProperty,ZMe=Object.getOwnPropertyDescriptor,RM=(n,e,t,i)=>{for(var o=i>1?void 0:i?ZMe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&WMe(e,t,o),o};const jQ=Symbol("ContainerSymbol");let Ef=class{constructor(){k(this,"actionDispatcher");k(this,"options");k(this,"container")}async postModelInitialization(){await this.dispatchAfterModelInitialized(),VMe()||this.actionDispatcher.dispatch(e0.create())}async dispatchAfterModelInitialized(){const n=[];this.isNumeric(this.options.zoom)?(n.push(jm.create({zoom:+this.options.zoom/100})),n.push(...this.showElement(t=>m.CenterAction.create(t,{animate:!1,retainZoom:!0})))):n.push(...this.showElement(t=>t0.create({elementIds:t,animate:!1,retainZoom:!0}))),n.push(Nm.create({theme:this.options.theme}));const e=await(await XMe(this.options.miningUrl)).json();return console.log(this.options.miningUrl),console.log(e),n.push(Jm.create({data:e})),this.actionDispatcher.dispatchAll(n)}showElement(n){if(this.options.highlight)return[n([this.options.highlight])];if(this.options.select){const e=this.options.select.split(m.NavigationTarget.ELEMENT_IDS_SEPARATOR);return[m.SelectAction.create({selectedElementsIDs:e}),n(e)]}return[]}isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n)}};RM([_e(m.GLSPActionDispatcher)],Ef.prototype,"actionDispatcher",2);RM([_e(m.TYPES.IDiagramOptions)],Ef.prototype,"options",2);RM([_e(jQ)],Ef.prototype,"container",2);Ef=RM([le()],Ef);const QMe=new $z(n=>{n(m.TYPES.IDiagramStartup).toDynamicValue(e=>{const t=e.container.createChild();return t.bind(Ef).toSelf().inSingletonScope(),t.bind(jQ).toConstantValue(e.container),t.get(Ef)}).inSingletonScope()}),XMe=async n=>fetch(n);var JMe=Object.defineProperty,eIe=Object.getOwnPropertyDescriptor,C4=(n,e,t,i)=>{for(var o=i>1?void 0:i?eIe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&JMe(e,t,o),o};let u0=class{constructor(){k(this,"feedbackDispatcher");k(this,"modelInitializationConstraint")}handle(n){Jm.is(n.kind)&&this.modelInitializationConstraint.onInitialized(()=>{this.feedbackDispatcher.registerFeedback(this,[n])})}};C4([_e(m.TYPES.IFeedbackActionDispatcher)],u0.prototype,"feedbackDispatcher",2);C4([_e(m.ModelInitializationConstraint)],u0.prototype,"modelInitializationConstraint",2);u0=C4([le()],u0);var tIe=Object.defineProperty,nIe=Object.getOwnPropertyDescriptor,iIe=(n,e,t,i)=>{for(var o=i>1?void 0:i?nIe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&tIe(e,t,o),o};const hz={createElement:m.svg};let E6=class extends m.PolylineEdgeViewWithGapsOnIntersections{renderLine(n,e,t){if(m.GArgument.getString(n,"labelvalue")){const s=n.editableLabel;s&&(s.text=n.args.labelvalue.toString())}const i=super.renderLine(n,e,t,void 0);let o="",r=n.color;return m.GArgument.getString(n,"labelvalue")&&m.GArgument.getNumber(n,"relativevalue")&&([o,r]=this.getColorAndSize(n),i.data||(i.data={}),i.data.style={stroke:r,"stroke-width":o}),i}renderAdditionals(n,e,t){const i=super.renderAdditionals(n,e,t),o=this.edgePadding(n),r=o?[this.renderMouseHandle(e,o)]:[];let s="",a=n.color;m.GArgument.getString(n,"labelvalue")&&m.GArgument.getNumber(n,"relativevalue")&&([s,a]=this.getColorAndSize(n));const f=e[e.length-2],h=e[e.length-1],g=hz.createElement("path",{"class-sprotty-edge":!0,"class-arrow":!0,d:"M 0.5,0 L 6,-3 L 6,3 Z",transform:`rotate(${m.toDegrees(m.angleOfPoint({x:f.x-h.x,y:f.y-h.y}))} ${h.x} ${h.y}) translate(${h.x} ${h.y})`,style:{stroke:a,fill:a,"stroke-width":s}});return i.push(...r,g),i}edgePadding(n){if(n.args)return m.EdgePadding.from(n)}renderMouseHandle(n,e){return hz.createElement("path",{"class-mouse-handle":!0,d:this.createPathForSegments(n),"style-stroke-width":e*2,"style-stroke":"transparent","style-stroke-dasharray":"none","style-stroke-dashoffset":"0"})}createPathForSegments(n){const e=n[0];let t=`M ${e.x},${e.y}`;for(let i=1;i<n.length;i++){const o=n[i];t+=` L ${o.x},${o.y}`}return t}intersectionPath(n,e,t,i){try{return super.intersectionPath(n,e,t,i)}catch{return""}}getColorAndSize(n){if(!n.args)return["",""];const e=20,t=m.GArgument.getNumber(n,"relativevalue")??1,i=t*e,r="#0000"+(255-255*t).toString(16).split(".")[0].padStart(2,"0");return[i.toString(),r]}};E6=iIe([le()],E6);var oIe=Object.defineProperty,rIe=Object.getOwnPropertyDescriptor,sIe=(n,e,t,i)=>{for(var o=i>1?void 0:i?rIe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&oIe(e,t,o),o};const pz={createElement:m.svg};let C6=class extends m.GLabelView{render(n,e){const t=n.canvasBounds.x;let i=n.canvasBounds.y-20;return n.location==="end"&&(i=n.canvasBounds.height+40),pz.createElement("g",null,pz.createElement("text",{"class-diagram-caption":!0,"class-sprotty-label":!0,x:t,y:i},n.caption))}};C6=sIe([le()],C6);const aIe=new m.FeatureModule((n,e,t)=>{m.configureActionHandler({bind:n,isBound:t},Jm.KIND,u0),m.configureCommand({bind:n,isBound:t},Yw),m.configureView({bind:n,isBound:t},"edge",E6),m.configureModelElement({bind:n,isBound:t},Xm.TYPE,Xm,C6)});function cIe(n){const e=bMe("sprotty",m.createDiagramOptionsModule(n),AMe,FMe,QMe,aIe,{remove:[nQ,iQ,_Q,IQ,pQ,VZ,m.deletionToolModule,m.edgeEditToolModule,m.nodeCreationToolModule,AQ]},{remove:wQ,add:xMe},{remove:hQ,add:jMe});return LRe(e,{hideSensitiveInfo:!0}),e}const La=E4(),P4=La.get("app")??"designer";let P6=La.get("server");P6||(P6=HMe().replace(P4,""));const dIe=La.get("miningUrl")??"http://localhost:3000/mock.json",uIe=La.get("pmv")??"",BQ=La.get("pid")??"",$Q=La.get("file")??"",mz=La.get("highlight")??"",lIe=La.get("select"),fIe=La.get("zoom")??"",hIe=La.get("theme")??Sf.prefsColorScheme(),w6="ivy-glsp-process-viewer",gz="ivy-glsp-process",pIe=ct.ApplicationIdProvider.get()+"_"+$Q+BQ,mIe=`${KMe()?"wss":"ws"}://${P6}/`,gIe=`${mIe}${P4}/${w6}`;let A6,RT;const vIe=new m.GLSPWebSocketProvider(gIe,{reconnectDelay:5e3,reconnectAttempts:120});vIe.listen({onConnection:kQ,onReconnect:_Ie,logger:console});async function kQ(n,e=!1){A6=new NMe({id:w6,connectionProvider:n}),RT=cIe({clientId:pIe,diagramType:gz,glspClientProvider:async()=>A6,sourceUri:$Q,editMode:m.EditMode.READONLY,highlight:mz,select:lIe,zoom:fIe,theme:hIe,miningUrl:dIe}),await RT.get(m.DiagramLoader).load({requestModelOptions:{isReconnecting:e,app:P4,pmv:uIe,pid:BQ,highlight:mz,readonly:!0,diagramType:gz},initializeParameters:{applicationId:ct.ApplicationIdProvider.get(),protocolVersion:ct.GLSPClient.protocolVersion}});const i=RT.get(m.GLSPActionDispatcher);if(e){const o=`Connection to the ${w6} glsp server got closed. Connection was successfully re-established.`,r=5e3,s="WARNING";i.dispatchAll([m.StatusAction.create(o,{severity:s,timeout:r}),m.MessageAction.create(o,{severity:s})])}}async function _Ie(n){A6.stop(),kQ(n,!0)}
